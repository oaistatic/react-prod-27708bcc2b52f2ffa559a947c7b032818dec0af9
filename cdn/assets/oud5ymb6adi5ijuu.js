import{c as se,e as oe,r as T,j as a}from"./fg33krlcm0qyi6yw.js";import{i as Y,P as ne}from"./gu5ca6zbhbrzb20i.js";import{M as ie,C as le}from"./mtk1qztvnb31pw5r.js";import{u as re}from"./ggfzz2rfetupp0ca.js";import"./jwm2780gzkkhdmn4.js";import"./k65njl5wlgspihfr.js";import"./ia54sddtrl9qa2wj.js";import"./i9er4nvdxr1wepj7.js";import"./dlydj2t7w31dzqec.js";import"./mcmrxiy9039fw9r6.js";import"./h7j5jaik108ahib8.js";import"./maum0adk5rsfsldc.js";import"./ns7plxqxfok4w8o8.js";import"./fnhhsiipu8vwj3on.js";import"./l9v3ntkj34comb67.js";import"./odbvdbv7o06jw7ls.js";import"./l6gg4oal15ycpbhj.js";import"./27egyxvdbhiyko0z.js";import"./he7oe7s4xa3cph5y.js";import"./gy1lpvuoewmzh42c.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./nfccle6oyncifphl.js";import"./hu1bt0oauegdhua6.js";import"./ojve869uwykk95at.js";import"./ly75bs3d14n5v622.js";import"./b7abh8aw9icifmym.js";const q=R=>R.trim().replace(/\s+/g,"").startsWith("+1");function De(R){"use forget";const e=se.c(63),{onClose:m,triggeringProduct:B,logEvent:n,onContinue:I,onCancel:F,onSkipVerification:G,initialPhoneNumber:A}=R,t=oe(),[i,ee]=T.useState(A!=null?A:""),[p,k]=T.useState(null),l=re();let r,j,u,w;if(e[0]!==t||e[1]!==i){u=i.trim();let s;e[6]!==t?(s=t.formatMessage({id:"LGmH6v",defaultMessage:"Please enter a phone number with a +1 country code"}),e[6]=t,e[7]=s):s=e[7],r=s,j=Y(u),w=q(u),e[0]=t,e[1]=i,e[2]=r,e[3]=j,e[4]=u,e[5]=w}else r=e[2],j=e[3],u=e[4],w=e[5];const X=w,te=u.length>0&&j&&!X?r:null,H=p!=null?p:te;let U,V;e[8]!==n?(U=()=>{n("sheet_shown",{step:"start_enrollment"})},V=[n],e[8]=n,e[9]=U,e[10]=V):(U=e[9],V=e[10]),T.useEffect(U,V);let E;e[11]!==F||e[12]!==m?(E=()=>{F(),m()},e[11]=F,e[12]=m,e[13]=E):E=e[13];const J=E;let O;e[14]!==r||e[15]!==t||e[16]!==n||e[17]!==m||e[18]!==I||e[19]!==G||e[20]!==i||e[21]!==l||e[22]!==B?(O=async()=>{var $,K;n("send_code_tapped",{step:"start_enrollment"});const s=i.trim();if(!Y(s)){k(t.formatMessage({id:"O2638w",defaultMessage:"Please enter a valid phone number"}));return}if(!q(s)){k(r);return}let Z;try{k(null);const D=await l.mutateAsync({phoneNumber:s,triggeringProduct:B});Z=D.sms_sent===!1,n("send_code_succeeded",{step:"start_enrollment",sms_sent:D.sms_sent})}catch(D){const o=D,N=typeof(($=o==null?void 0:o.json)==null?void 0:$.detail)=="string"?o.json.detail:void 0;n("send_code_failed",{step:"start_enrollment",reason:N!=null?N:o==null?void 0:o.message}),k((K=N!=null?N:o==null?void 0:o.message)!=null?K:t.formatMessage({id:"ptsFtS",defaultMessage:"We couldn't send a code. Please check your number and try again."}));return}if(m(),Z){G();return}I(s)},e[14]=r,e[15]=t,e[16]=n,e[17]=m,e[18]=I,e[19]=G,e[20]=i,e[21]=l,e[22]=B,e[23]=O):O=e[23];const c=O;let d;e[24]!==t?(d=t.formatMessage({id:"WUzqsU",defaultMessage:"Verify your phone number"}),e[24]=t,e[25]=d):d=e[25];let f;e[26]!==d?(f=a.jsx("span",{className:"text-heading-3",children:d}),e[26]=d,e[27]=f):f=e[27];let h;e[28]!==t?(h=t.formatMessage({id:"G/pZCX",defaultMessage:"Send code"}),e[28]=t,e[29]=h):h=e[29];const L=!j||!X||l.isPending;let g;e[30]!==c||e[31]!==l.isPending||e[32]!==h||e[33]!==L?(g=a.jsx(ie.Button,{"data-testid":"shopping-checkout-phone-number-step-up-modal__continue",title:h,color:"primary",disabled:L,loading:l.isPending,onClick:c}),e[30]=c,e[31]=l.isPending,e[32]=h,e[33]=L,e[34]=g):g=e[34];let b;e[35]!==c?(b=s=>{s.preventDefault(),c()},e[35]=c,e[36]=b):b=e[36];let x;e[37]!==t?(x=t.formatMessage({id:"d2OOS4",defaultMessage:"We use your phone number to confirm it's really you before completing checkout."}),e[37]=t,e[38]=x):x=e[38];let y;e[39]!==x?(y=a.jsx("p",{children:x}),e[39]=x,e[40]=y):y=e[40];let P;e[41]!==t?(P=t.formatMessage({id:"pQgrkU",defaultMessage:"Phone number"}),e[41]=t,e[42]=P):P=e[42];let S;e[43]!==p?(S=s=>{ee(s!=null?s:""),p&&k(null)},e[43]=p,e[44]=S):S=e[44];let W;e[45]===Symbol.for("react.memo_cache_sentinel")?(W=["US"],e[45]=W):W=e[45];let v;e[46]===Symbol.for("react.memo_cache_sentinel")?(v={layout:"inline",showDialCodePrefix:!1,rounded:"lg",densePadding:!0,triggerShowOnlyDialCode:!0,fullWidthJustifyDialCode:!1,placeholderTextSize:"sm",dropdownPanelWidthPx:320},e[46]=v):v=e[46];const Q=H!=null?H:void 0;let _;e[47]!==i||e[48]!==P||e[49]!==S||e[50]!==Q?(_=a.jsx(ne,{label:P,value:i,setValue:S,defaultCountry:"US",countries:W,initialValueFormat:"national",appearance:v,error:Q}),e[47]=i,e[48]=P,e[49]=S,e[50]=Q,e[51]=_):_=e[51];let M;e[52]!==y||e[53]!==_?(M=a.jsxs("div",{className:"flex flex-col gap-3",children:[y,_]}),e[52]=y,e[53]=_,e[54]=M):M=e[54];let C;e[55]!==b||e[56]!==M?(C=a.jsx("form",{onSubmit:b,className:"text-token-text-primary w-full text-sm",children:M}),e[55]=b,e[56]=M,e[57]=C):C=e[57];let z;return e[58]!==J||e[59]!==g||e[60]!==C||e[61]!==f?(z=a.jsx(le,{testId:"modal-shopping-checkout-phone-number-step-up",isOpen:!0,type:"success",noPadding:!0,contentClassName:"flex flex-col items-start gap-6 p-6",headerClassName:"!px-6 !py-0 !h-[76px] !items-center",showCloseButton:!0,hasSeparator:!0,onClose:J,title:f,primaryButton:g,children:C}),e[58]=J,e[59]=g,e[60]=C,e[61]=f,e[62]=z):z=e[62],z}export{De as ShoppingCheckoutPhoneNumberStartEnrollmentModal};
//# sourceMappingURL=oud5ymb6adi5ijuu.js.map
