const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l6t1zzojzszmmhgw.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/k65njl5wlgspihfr.js","assets/conversation-small-332fs9rk.css","assets/hbcazfftvcth68xe.js"])))=>i.map(i=>d[i]);
var _n=Object.freeze,jn=Object.defineProperty,wa=Object.defineProperties;var ja=Object.getOwnPropertyDescriptors;var vn=Object.getOwnPropertySymbols;var ka=Object.prototype.hasOwnProperty,Ca=Object.prototype.propertyIsEnumerable;var wn=(a,e,s)=>e in a?jn(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,ge=(a,e)=>{for(var s in e||(e={}))ka.call(e,s)&&wn(a,s,e[s]);if(vn)for(var s of vn(e))Ca.call(e,s)&&wn(a,s,e[s]);return a},jt=(a,e)=>wa(a,ja(e));var kt=(a,e)=>_n(jn(a,"raw",{value:_n(e||a.slice())}));import{e as It,j as t,f as Ls,r as W,c as Ce,M as oe,_ as Na,v as Ma,d as et,n as Ia}from"./fg33krlcm0qyi6yw.js";import{F as os,cY as Ta,a9 as nt,bH as Sa,bT as Aa,g$ as Jn,gh as Ea,T as Xs,nW as Fa,M as Mt,aY as Xn,bX as Ra,hv as Oa,c3 as kn,qF as La,c4 as $a,bh as Ba,l as xe,i9 as Yn,aq as Pa,py as Wa,as as za,dF as nn,dH as Cn,dG as Da,_ as Ua,mO as qa,yL as Qn,kA as Ha,eh as Ga,e4 as Ka,e2 as Va,eK as Ja,uZ as Nn,td as Mn,bg as an,cX as Xa,o as Zn,b as $s,gF as Ya,dB as Rs,d as ke,lx as Qa,ac as Za,eG as eo,aX as In,mv as Ys,kN as to,lt as fs,dI as ea,iV as Tn,hd as Qs,gz as ta,dL as sa,js as so,cU as Zs,aK as no,fZ as ao,bv as oo,e1 as na,aS as io,jV as lo,hh as ro,hF as co,fN as mo,hG as uo,s3 as Sn,bp as fo,mN as po,lL as An,iU as En,lM as Fn,R as go,bn as xo,dQ as Rn,k8 as ho,b4 as yo}from"./mtk1qztvnb31pw5r.js";import{fn as On,b2 as bo,de as _o,gd as en,eE as rn,Z as vo,ru as wo,cH as jo,zA as Ln,bB as aa,zB as ko,eD as Co,l5 as No,tn as Mo,qC as Io,qo as To,g1 as So,tl as ps,cw as oa,jz as ia,ek as Ao,zC as Es,or as Eo,ec as Ct,y as Fo,ed as $n,zD as Ro,zE as Bn,cx as Oo,a7 as Lo}from"./k65njl5wlgspihfr.js";import{I as $o}from"./fbnn8bh19p4wun84.js";import{g as Bo}from"./grhyrnbc9eq7z08k.js";import{L as on}from"./gk1ydinzmvc3mi3f.js";import{p as cn,h as as,g as la,a as ra,b as ca,c as da,d as ma,J as N,e as ua,i as Pe,f as Po,j as Wo,k as zo,l as Do,A as Uo,m as qo,n as Pn,C as Ho}from"./hakyprpr5m8dolws.js";import{E as Go,g as Ko,m as Vo,e as Wn,n as Jo,o as Xo,p as Yo}from"./hwvghg24zujdhy4q.js";import{A as Qo}from"./cnrdqaihcmlb57i1.js";import{A as Zo}from"./lbbnz7rb7sd2lk50.js";import{a as tn}from"./acd1cl9alifs5fnh.js";import"./fnhhsiipu8vwj3on.js";import"./ktlrbeajo849nxci.js";import"./kl7c6054usfnqmd4.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";var Un;const ei=os.div(Un||(Un=kt(["h-px bg-token-border-default"])));var qn;const tt=os.div(qn||(qn=kt(["text-sm font-medium py-3 leading-6"])));var Hn;const ti=os.div(Hn||(Hn=kt(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),sn=":",si=({to:a,cc:e,bcc:s,subject:n,body:o,onClick:r,isDraft:i=!0,isCanceled:d=!1})=>{const l=It(),g=[];return a&&g.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(tt,{className:"text-token-text-tertiary me-1",children:[l.formatMessage(Nt.draftToFieldLabel),sn]}),t.jsx(tt,{children:a})]})},"to")),e&&g.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(tt,{className:"text-token-text-tertiary me-1",children:[l.formatMessage(Nt.draftCcFieldLabel),sn]}),t.jsx(tt,{children:e})]})},"cc")),s&&g.push(t.jsx("div",{children:t.jsxs("div",{className:"flex",children:[t.jsxs(tt,{className:"text-token-text-tertiary me-1",children:[l.formatMessage(Nt.draftBccFieldLabel),sn]}),t.jsx(tt,{children:s})]})},"bcc")),n&&g.push(t.jsx(tt,{children:n},"subject")),o&&g.push(t.jsx(tt,{className:"whitespace-pre-line",children:o},"body")),t.jsxs(ti,{children:[t.jsxs("div",{className:"mb-4 flex items-center",children:[t.jsx(Ta,{className:"icon-sm me-4"}),t.jsx("div",{className:"font-semibold",children:i?l.formatMessage(Nt.draftMessageLabel):l.formatMessage(Nt.sentMessageLabel)})]}),g.map((x,f)=>t.jsxs(W.Fragment,{children:[t.jsx(ei,{}),x]},f)),i&&!d&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(nt,{color:"primary",className:"py-2",onClick:r,children:l.formatMessage(Nt.sendButton)})}),d&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(nt,{color:"primary",className:"py-2",disabled:!0,children:l.formatMessage(Nt.canceledButton)})})]})},Nt=Ls({draftMessageLabel:{id:"emailView.draftMessageLabel",defaultMessage:"Draft Message"},sentMessageLabel:{id:"emailView.sentMessageLabel",defaultMessage:"Sent Message"},sendButton:{id:"emailView.sendButton",defaultMessage:"Send"},draftToFieldLabel:{id:"emailView.draftToLabel",defaultMessage:"To"},draftCcFieldLabel:{id:"emailView.draftCcLabel",defaultMessage:"Cc"},draftBccFieldLabel:{id:"emailView.draftBccLabel",defaultMessage:"Bcc"},canceledButton:{id:"emailView.canceledButton",defaultMessage:"Canceled"}}),ni=a=>{"use forget";const e=Ce.c(19),{clientThreadId:s,action:n,messages:o,onRequestCompletion:r,handleUserAction:i,rememberAnswer:d,toolCallSafetySummary:l}=a;let g;e[0]!==o?(g=cn(o),e[0]=o,e[1]=g):g=e[1];const{assistantMessage:x}=g,f=Sa();let u;e[2]!==l?(u=l!=null&&l.sensitive_data?Object.keys(l.sensitive_data).some(ai):!1,e[2]=l,e[3]=u):u=e[3];const c=u,h=(l==null?void 0:l.danger_level)==="HIGH"||c;let v;return e[4]!==n.allow||e[5]!==n.always_allow||e[6]!==n.deny||e[7]!==n.name||e[8]!==n.type||e[9]!==f||e[10]!==x||e[11]!==s||e[12]!==i||e[13]!==h||e[14]!==o||e[15]!==r||e[16]!==d||e[17]!==l?(v=n.type==="deny"?t.jsx(nt,{className:"flex-1",color:h?"primary":"secondary",size:"medium",onClick:y=>{i({clientThreadId:s,sourceEvent:y,onRequestCompletion:r,assistantMessage:x,allMessages:o,actionData:jt(ge({type:"deny"},n.deny),{remember_answer:d}),activeSystemHint:f})},children:t.jsx(oe,ge({},n.name==="decline"?gs.decline:gs.deny))}):n.type==="allow"?t.jsx(nt,{className:"flex-1",color:h?"secondary":"primary",size:"medium",onClick:y=>{i({clientThreadId:s,sourceEvent:y,onRequestCompletion:r,assistantMessage:x,allMessages:o,actionData:jt(ge({type:"allow"},n.allow),{remember_answer:d}),activeSystemHint:f})},children:l!=null&&l.action_name?l.action_name:t.jsx(oe,ge({},n.name==="allow"?gs.allow:gs.confirm))}):n.type==="always_allow"?t.jsx(nt,{className:"flex-1",color:"secondary",size:"medium",onClick:y=>{i({clientThreadId:s,sourceEvent:y,onRequestCompletion:r,assistantMessage:x,allMessages:o,actionData:ge({type:"always_allow"},n.always_allow),activeSystemHint:f})},children:t.jsx(oe,ge({},gs.alwaysAllow))}):null,e[4]=n.allow,e[5]=n.always_allow,e[6]=n.deny,e[7]=n.name,e[8]=n.type,e[9]=f,e[10]=x,e[11]=s,e[12]=i,e[13]=h,e[14]=o,e[15]=r,e[16]=d,e[17]=l,e[18]=v):v=e[18],v},gs=Ls({alwaysAllow:{id:"jitPluginMessage.alwaysAllow",defaultMessage:"Always Allow"},allow:{id:"jitPluginMessage.allow",defaultMessage:"Allow"},decline:{id:"jitPluginMessage.decline",defaultMessage:"Decline"},confirm:{id:"jitPluginMessage.confirm",defaultMessage:"Confirm"},deny:{id:"jitPluginMessage.deny",defaultMessage:"Deny"}});function ai(a){return a==="Suspicious Content"}const oi=Ea({path:kn,args:a=>{if(La(a))return a;try{return $a(JSON.parse(kn(a)))}catch(e){return{}}}});function fa({functionName:a,params:e,toolCallSafetySummary:s,result:n,isWrite:o,messages:r,clientThreadId:i,jitPluginData:d,onRequestCompletion:l,rememberForThisConversation:g}){var p,m,O,S;const x=Aa(),f=Jn(),{namespace:u,actionName:c}=ii(a),h=((p=d==null?void 0:d.from_server)==null?void 0:p.type)!=="denied_by_user"?(m=d==null?void 0:d.from_server)==null?void 0:m.body.actions.map(($,B)=>t.jsx(ni,{clientThreadId:i,messages:r,onRequestCompletion:l,action:$,handleUserAction:as,rememberAnswer:g,toolCallSafetySummary:s},B)):null,v=W.useMemo(()=>oi(e),[e]);let y=u,j=null,T=c;const{path:F,args:M}=v;if(F&&M&&Object.keys(M).length>0){const[$,B,V]=F.split("/").filter(Boolean),P=[...x.connectorLinks.values()].flat().find(q=>q.id===B),I=P&&f.platformConnectors.get(P.connector_id);T=V!=null?V:c,y=(O=I==null?void 0:I.name)!=null?O:$,j=(S=I==null?void 0:I.logo_url)!=null?S:null,e=M}return t.jsx(li,{connector:{name:y,logo_url:j},actionName:T,isWrite:o,params:e,result:n,toolCallSafetySummary:s,actionButtons:h})}function ii(a){const e=a.indexOf("."),s=e===-1?a:a.slice(0,e),n=e===-1?"":a.slice(e+1);return{namespace:s,actionName:n}}function li({connector:a,actionName:e,params:s,result:n,isWrite:o,toolCallSafetySummary:r,actionButtons:i}){var $,B,V,P;const d=It(),[l,g]=W.useState(!1),[,x]=W.useState("request"),f=W.useId(),u=W.useId(),c=($=r==null?void 0:r.title)!=null?$:"",h=(B=r==null?void 0:r.description)!=null?B:"",v=e,y=Object.entries((V=r==null?void 0:r.sensitive_data)!=null?V:{}).filter(([,I])=>I==null?!1:Array.isArray(I)),j=Object.entries((P=r==null?void 0:r.suspicious_data)!=null?P:{}).filter(([,I])=>I==null?!1:Array.isArray(I)),T=y.length>0||j.length>0,F=I=>I.join(", "),M=I=>{const q=F(I);return q.length<20?q:q.slice(0,20)+"..."},p=s!=null,m=n!=null,O=p||m,S=()=>{x(p?"request":"response"),g(!0)};return r?t.jsxs("div",{className:"mt-1 mb-4 w-full max-w-md",children:[t.jsxs("div",{className:"border-token-border-heavy bg-token-bg-primary flex flex-col gap-3 rounded-3xl border p-5 text-start",children:[t.jsx("div",{className:"flex items-center justify-between gap-2",children:t.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[t.jsx(On,{connector:a,size:"xsmall"}),t.jsx("div",{className:"flex flex-1 flex-col gap-2",children:t.jsx("div",{className:"text-token-text-secondary text-sm tracking-wide",children:a.name})})]})}),t.jsxs("div",{className:"flex flex-col gap-2 px-1",children:[t.jsx("h2",{className:"text-token-text-primary text-lg font-semibold",children:c}),h&&t.jsxs("p",{className:"text-token-text-secondary text-sm",children:[h,O&&t.jsxs(t.Fragment,{children:[" ",t.jsx("button",{type:"button",onClick:S,className:"text-token-text-secondary font-regular underline",children:t.jsx(oe,ge({},st.details))})]})]})]}),T&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col gap-2 px-1 py-2",children:[t.jsx("div",{className:"text-token-text-tertiary font-regular text-sm",children:d.formatMessage(st.dataShared)}),t.jsxs("dl",{className:"",children:[y.map(([I,q])=>{const z=F(q),A=M(q);return t.jsxs("div",{className:"flex flex-col gap-1 py-1 sm:flex-row sm:items-center sm:gap-4",children:[t.jsx("dt",{className:"font-regular text-token-text-tertiary text-start text-sm",children:I}),t.jsx("dd",{className:"text-token-text-primary text-sm font-normal sm:ms-auto sm:max-w-xs sm:truncate sm:text-end",children:t.jsx(Xs,{side:"top",align:"end",label:z?t.jsx("div",{className:"text-token-text-primary max-w-xs text-start text-sm break-words",children:z}):void 0,children:t.jsx("span",{className:"block truncate",children:A})})})]},I)}),j.map(([I,q])=>{const z=F(q),A=M(q);return t.jsxs("div",{className:"flex flex-col gap-1 py-1 sm:flex-row sm:items-center sm:gap-4",children:[t.jsx("dt",{className:"font-regular text-interactive-label-warning-secondary text-start text-sm",children:t.jsx(Xs,{side:"top",align:"start",label:d.formatMessage(st.suspiciousContentTooltip),children:t.jsxs("span",{className:"inline-flex items-center gap-1",children:[t.jsx("span",{className:"text-token-text-error",children:I}),t.jsx(Fa,{"aria-hidden":"true",className:"interactive-label-warning-secondary icon-xs text-token-text-error"})]})})}),t.jsx("dd",{className:"text-token-text-primary text-sm font-normal sm:ms-auto sm:max-w-xs sm:truncate sm:text-end",children:t.jsx(Xs,{side:"top",align:"end",label:z?t.jsx("div",{className:"text-token-text-primary max-w-xs text-start text-sm break-words",children:z}):void 0,children:t.jsx("span",{className:"block truncate",children:A})})})]},I)})]})]}),t.jsx("div",{className:"token-border-subtle mx-1 mt-1 h-0 border-t"})]}),i&&Array.isArray(i)&&i.length>0&&t.jsx("div",{className:"mt-3 mb-1 flex flex-wrap justify-end gap-3",children:i})]}),t.jsx("div",{className:"text-token-text-tertiary mt-3 text-center text-sm",children:t.jsx(oe,{id:"APIToolCallCard.toolCallSafetyWarning",defaultMessage:"Using tools comes with risks. <link>Learn more</link>",values:{link:I=>t.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:I},"link")}})}),O&&t.jsx(Mt.Root,{testId:"modal-api-tool-call-details",isOpen:l,onClose:g,children:t.jsx(Mt.Overlay,{children:t.jsx(Mt.Content,{size:"large",className:"max-w-2xl",ariaLabelledBy:f,ariaDescribedBy:h?u:void 0,children:t.jsxs("div",{className:"flex flex-col py-2",children:[t.jsx(Mt.Header,{hasSeparator:!0,title:t.jsx("span",{id:f,className:"px-2",children:t.jsx(oe,ge({},st.details))}),closeButton:t.jsx(Xn,{className:"me-2",onClick:()=>g(!1)})}),t.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[h&&t.jsx("p",{id:u,className:"text-token-text-secondary text-sm",children:h}),t.jsx("div",{className:"border-token-border-subtle bg-token-bg-secondary/40 flex flex-col overflow-hidden rounded-2xl border",children:t.jsxs("div",{className:"border-token-border-subtle flex flex-wrap items-center justify-between gap-3 py-1",children:[t.jsxs("div",{className:"border-token-border-subtle flex w-full items-center justify-between border-b px-4 py-3",children:[t.jsx("span",{className:"text-token-text-primary text-sm font-semibold",children:v}),o&&t.jsx("div",{className:"bg-token-bg-status-error/10 text-token-text-error inline-flex min-w-[60px] items-center justify-center rounded-full px-2 text-[10px] font-semibold tracking-wide uppercase",children:t.jsx(oe,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),t.jsxs("div",{className:"mb-4 grid w-full gap-4 px-1",children:[s!=null&&t.jsx(Fs,{isInitialLevelExpanded:o,name:st.request,params:s}),n!=null&&t.jsx(Fs,{name:st.response,params:n})]})]})})]})]})})})})]}):t.jsxs("div",{className:"bg-token-bg-primary border-token-border-heavy mt-1 mb-4 grid w-full max-w-xl gap-4 rounded-3xl border p-5",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(On,{connector:{name:a.name,logo_url:a.logo_url,logo_url_dark:void 0},size:"large"}),t.jsxs("div",{className:"flex flex-1 flex-col",children:[t.jsx("div",{className:"text-token-text-secondary text-xs",children:a.name}),t.jsx("div",{className:"text-token-text-primary text-sm",children:e})]}),o&&t.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:t.jsx(oe,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),s!=null&&t.jsx(Fs,{isInitialLevelExpanded:o,name:st.request,params:s}),n!=null&&t.jsx(Fs,{name:st.response,params:n}),o&&t.jsxs("div",{className:"text-token-text-secondary text-sm",children:[t.jsx(Ra,{className:"icon-sm me-1 mb-0.5 inline-block"}),t.jsx(oe,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:I=>t.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:I},"link")}})]}),i&&t.jsx("div",{className:"flex gap-3",children:i})]})}function Fs({name:a,afterName:e,params:s,isInitialLevelExpanded:n=!1}){const o=It();return t.jsxs("div",{className:"bg-token-bg-secondary/30 max-w-full min-w-0 space-y-3 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-token-text-secondary text-xs",children:typeof a=="string"?a:o.formatMessage(a)}),e]}),t.jsx(bo,{buttonText:!0,className:"text-token-text-secondary text-xs",onCopy:()=>Oa(typeof s=="string"?s:JSON.stringify(s))})]}),typeof s=="string"?t.jsx("div",{className:"text-token-text-primary line-clamp-3 font-mono text-sm",children:s}):t.jsx(on,{isInitialLevelExpanded:n,value:s})]})}const st=Ls({request:{id:"APIToolCallCard.request",defaultMessage:"Request"},response:{id:"APIToolCallCard.response",defaultMessage:"Response"},details:{id:"APIToolCallCard.details",defaultMessage:"Details"},noDetails:{id:"APIToolCallCard.noDetails",defaultMessage:"No additional details available."},dataShared:{id:"APIToolCallCard.dataShared",defaultMessage:"Sharing data includes:"},functionLabel:{id:"APIToolCallCard.function",defaultMessage:"Function"},allowForConversation:{id:"APIToolCallCard.allowForConversation",defaultMessage:"Allow for conversation"},suspiciousContentTooltip:{id:"APIToolCallCard.suspiciousContentTooltip",defaultMessage:"There is a suspicious piece of text being shared that looks like random or encrypted data. It could be risky, for example it could contain your personal information encrypted in some way. It may not be harmful though, for example if it is part of a legitimate link being shared. It is safe to deny the action."}}),ri=Ba(()=>Na(()=>import("./l6t1zzojzszmmhgw.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(a=>a.EcosystemAppFeedback)),ci=a=>{"use forget";const e=Ce.c(30),{logoUrl:s,name:n,isLoading:o,onClick:r,conversationId:i,chatSDK:d,withGutter:l,withMarginBottom:g,tintLogoToText:x}=a,f=l===void 0?!1:l,u=g===void 0?!1:g,c=x===void 0?!1:x;let h,v,y,j,T;if(e[0]!==o||e[1]!==s||e[2]!==n||e[3]!==r||e[4]!==c||e[5]!==f||e[6]!==u){const O=xe("h-5 w-5 rounded-lg"),S=u&&"mb-4",$=f&&"px-4";e[12]!==$||e[13]!==S?(T=xe("text-token-text-secondary dark:text-token-text-tertiary flex w-full items-center gap-2 max-sm:mt-1",S,$),e[12]=$,e[13]=S,e[14]=T):T=e[14],h="group inline-flex items-center gap-2",v=r,y="button",j=!s||o?t.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-lg"}):s&&n&&(c?t.jsx("span",{role:"img","aria-label":n,className:xe(O,"inline-block"),style:{backgroundColor:"currentColor",maskImage:"url(".concat(s,")"),WebkitMaskImage:"url(".concat(s,")"),maskRepeat:"no-repeat",WebkitMaskRepeat:"no-repeat",maskPosition:"center",WebkitMaskPosition:"center",maskSize:"contain",WebkitMaskSize:"contain"}}):t.jsx("img",{className:O,src:s,alt:n})),e[0]=o,e[1]=s,e[2]=n,e[3]=r,e[4]=c,e[5]=f,e[6]=u,e[7]=h,e[8]=v,e[9]=y,e[10]=j,e[11]=T}else h=e[7],v=e[8],y=e[9],j=e[10],T=e[11];let F;e[15]!==n?(F=n?t.jsx("button",{className:"hover:text-token-text-primary group-hover:text-token-text-primary",children:n}):t.jsx("div",{className:"loading-results-shimmer h-5 w-16 rounded-md"}),e[15]=n,e[16]=F):F=e[16];let M;e[17]!==h||e[18]!==v||e[19]!==y||e[20]!==j||e[21]!==F?(M=t.jsxs("span",{className:h,onClick:v,role:y,children:[j,F]}),e[17]=h,e[18]=v,e[19]=y,e[20]=j,e[21]=F,e[22]=M):M=e[22];let p;e[23]!==d||e[24]!==i?(p=t.jsx("span",{className:"ms-auto",children:t.jsx(ri,{chatSDK:d,conversationId:i})}),e[23]=d,e[24]=i,e[25]=p):p=e[25];let m;return e[26]!==M||e[27]!==p||e[28]!==T?(m=t.jsxs("div",{className:T,children:[M,p]}),e[26]=M,e[27]=p,e[28]=T,e[29]=m):m=e[29],m},di=a=>{"use forget";const e=Ce.c(18),{title:s,widgetDisplayName:n,widgetDomain:o,onClickBack:r,onClickClose:i,onClickForward:d,onClickOpenInApp:l,canGoBack:g,canGoForward:x,logo:f,hideOpenInAppButton:u}=a;let c;e[0]!==g||e[1]!==x||e[2]!==r||e[3]!==i||e[4]!==d?(c=t.jsx(pa,{onClickBack:r,onClickForward:d,canGoBack:g,canGoForward:x,onClickClose:i,isNavOnly:!1}),e[0]=g,e[1]=x,e[2]=r,e[3]=i,e[4]=d,e[5]=c):c=e[5];let h;e[6]!==s?(h=t.jsx("div",{className:"text-token-text-secondary flex items-center justify-center text-base",children:s}),e[6]=s,e[7]=h):h=e[7];let v;e[8]!==u||e[9]!==f||e[10]!==l||e[11]!==n||e[12]!==o?(v=!u&&o&&t.jsx("div",{className:"flex items-center justify-end",children:t.jsxs(nt,{icon:f?void 0:_o,onClick:l,color:"secondary",children:[f&&t.jsx("img",{src:f,alt:n,className:"me-2 h-4 w-4"}),t.jsx(oe,{id:"JvQEOX",defaultMessage:"Open in {app}",values:{app:n}})]})}),e[8]=u,e[9]=f,e[10]=l,e[11]=n,e[12]=o,e[13]=v):v=e[13];let y;return e[14]!==c||e[15]!==h||e[16]!==v?(y=t.jsxs("div",{className:"border-token-border-secondary bg-token-bg-primary sm:bg-token-bg-primary z-10 grid h-(--header-height) grid-cols-[1fr_auto_1fr] border-b px-2",children:[c,h,v]}),e[14]=c,e[15]=h,e[16]=v,e[17]=y):y=e[17],y},mi=40,pa=a=>{"use forget";const e=Ce.c(19),{onClickBack:s,onClickForward:n,onClickClose:o,canGoBack:r,canGoForward:i,isNavOnly:d}=a,l=It(),g=d&&"absolute start-2 top-2 z-10";let x;e[0]!==g?(x=xe("flex items-center justify-start gap-3",g),e[0]=g,e[1]=x):x=e[1];let f;e[2]!==l?(f=l.formatMessage({id:"H0F9KU",defaultMessage:"Close"}),e[2]=l,e[3]=f):f=e[3];let u;e[4]===Symbol.for("react.memo_cache_sentinel")?(u=xe("h-7! w-7!"),e[4]=u):u=e[4];let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(Yn,{className:"icon"}),e[5]=c):c=e[5];let h;e[6]!==o||e[7]!==f?(h=t.jsx(en,{label:f,className:u,onClick:o,icon:c}),e[6]=o,e[7]=f,e[8]=h):h=e[8];let v;e[9]!==r||e[10]!==i||e[11]!==l||e[12]!==s||e[13]!==n?(v=(r||i)&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(en,{label:l.formatMessage({id:"y0H9Ps",defaultMessage:"Back"}),className:xe("h-7! w-7!"),onClick:s,disabled:!r,icon:t.jsx(Qo,{className:"icon"})}),t.jsx(en,{label:l.formatMessage({id:"4zGgS+",defaultMessage:"Forward"}),className:xe("h-7! w-7!"),onClick:n,disabled:!i,icon:t.jsx(Zo,{className:"icon"})})]}),e[9]=r,e[10]=i,e[11]=l,e[12]=s,e[13]=n,e[14]=v):v=e[14];let y;return e[15]!==x||e[16]!==h||e[17]!==v?(y=t.jsxs("div",{className:x,children:[h,v]}),e[15]=x,e[16]=h,e[17]=v,e[18]=y):y=e[18],y},xs=a=>{"use forget";const e=Ce.c(52),{heightHint:s,title:n,conversation:o,chatSDK:r,clientThreadId:i,resolvedWidget:d,onClose:l,domain:g,html:x,attributionId:f,widgetId:u,widgetParent:c,suggestionMessageId:h,widgetType:v,features:y,subdomain:j,csp:T,locale:F,params:M}=a,p=s===void 0?null:s,[m,O]=W.useState(!1),[S,$]=W.useState(!1),B=W.useRef(null),[V,P]=W.useState(null),I=V!=null?V:0;let q;e[0]!==I?(q={insets:{top:I,bottom:0,left:0,right:0}},e[0]=I,e[1]=q):q=e[1];const z=q,A=!S,se=S?"opacity-100":"opacity-0";let D;e[2]!==se?(D=xe(se),e[2]=se,e[3]=D):D=e[3];const G=!S,Se=S?"opacity-100":"opacity-0";let E;e[4]!==Se?(E=xe("relative flex min-h-0 max-w-xl flex-col overflow-hidden lg:max-w-3xl",Se),e[4]=Se,e[5]=E):E=e[5];let Ae;e[6]!==n?(Ae=t.jsx(Pa,{asChild:!0,className:"sr-only",children:t.jsx("span",{children:n})}),e[6]=n,e[7]=Ae):Ae=e[7];let he;e[8]===Symbol.for("react.memo_cache_sentinel")?(he=rn({axis:"height",onChange:Ie=>{const{height:Xe}=Ie;return P(Xe)}}),e[8]=he):he=e[8];let Y;e[9]!==m?(Y=m&&t.jsx(vo,{onClick:()=>{var Ie;return(Ie=B.current)==null?void 0:Ie.navigate({delta:-1})},className:"text-white mix-blend-difference grayscale",children:t.jsx(Wa,{})}),e[9]=m,e[10]=Y):Y=e[10];let ie;e[11]!==l?(ie=t.jsx(za,{asChild:!0,children:t.jsx(Xn,{onClick:l,iconSize:"lg",className:"ms-auto text-white mix-blend-difference grayscale"})}),e[11]=l,e[12]=ie):ie=e[12];let L;e[13]!==Y||e[14]!==ie?(L=t.jsxs("header",{className:"absolute start-0 end-0 top-0 flex items-center p-2",ref:he,children:[Y,ie]}),e[13]=Y,e[14]=ie,e[15]=L):L=e[15];let le;e[16]===Symbol.for("react.memo_cache_sentinel")?(le=()=>$(!0),e[16]=le):le=e[16];let ve;e[17]!==f||e[18]!==r||e[19]!==i||e[20]!==o||e[21]!==T||e[22]!==g||e[23]!==y||e[24]!==p||e[25]!==x||e[26]!==F||e[27]!==l||e[28]!==M||e[29]!==d||e[30]!==z||e[31]!==j||e[32]!==h||e[33]!==n||e[34]!==u||e[35]!==c||e[36]!==v?(ve=t.jsx(Go,{onReady:le,onClose:l,onCanGoBack:O,widgetRef:B,domain:g,html:x,attributionId:f,widgetId:u,widgetParent:c,suggestionMessageId:h,widgetType:v,features:y,subdomain:j,csp:T,locale:F,params:M,displayMode:"modal",heightHint:p,safeArea:z,conversation:o,chatSDK:r,clientThreadId:i,resolvedWidget:d,title:n}),e[17]=f,e[18]=r,e[19]=i,e[20]=o,e[21]=T,e[22]=g,e[23]=y,e[24]=p,e[25]=x,e[26]=F,e[27]=l,e[28]=M,e[29]=d,e[30]=z,e[31]=j,e[32]=h,e[33]=n,e[34]=u,e[35]=c,e[36]=v,e[37]=ve):ve=e[37];let ue;e[38]!==Ae||e[39]!==L||e[40]!==ve||e[41]!==G||e[42]!==E?(ue=t.jsxs(Mt.Content,{"aria-hidden":G,className:E,children:[Ae,L,ve]}),e[38]=Ae,e[39]=L,e[40]=ve,e[41]=G,e[42]=E,e[43]=ue):ue=e[43];let Ne;e[44]!==S||e[45]!==ue?(Ne=t.jsx(Mt.Overlay,{showBackground:S,children:ue}),e[44]=S,e[45]=ue,e[46]=Ne):Ne=e[46];let Me;return e[47]!==l||e[48]!==Ne||e[49]!==A||e[50]!==D?(Me=t.jsx(Mt.Root,{"aria-hidden":A,className:D,isOpen:!0,onClose:l,testId:"modal-kanzi-widget",children:Ne}),e[47]=l,e[48]=Ne,e[49]=A,e[50]=D,e[51]=Me):Me=e[51],Me},ui=(a,{csp:e,domain:s,subdomain:n})=>"".concat(a.metadata.html_asset_pointer,"-").concat(JSON.stringify(e),"-").concat(s,"-").concat(n),fi=({chatSDK:a,prompt:e,persistedSystemHintsStore:s,clientThreadId:n,systemPrompt:o,isVisible:r=!1,hint:i})=>{var u,c;const d=nn.getRequestId(Cn(n));if(Da(d))return null;if(!e)return Ua.addError("No prompt provided to sendFollowUpMessage"),null;const l=Cn(n),g=nn.getBranch(l).findLast(({message:h})=>qa(h)),x=Qn(s),f=[...o?[Ha(['The user is referring to the "'.concat(a.widgetType,'" tool with additional instructions:\n').concat(o)],{exclude_after_next_user_message:!0})]:[]];return{completionType:Ja.Next,appendMessages:f,promptMessage:{id:Ma(),author:{role:Va.Tool,name:a.widgetType},content:{content_type:Ka.Text,parts:[e]},recipient:"all",metadata:jt(ge({},i?{chatgpt_sdk_followup_hint:i}:{}),{system_hints:x,developer_mode_connector_ids:(u=g==null?void 0:g.message.metadata)==null?void 0:u.developer_mode_connector_ids,chatgpt_sdk_attribution:a.metadata.attribution_id,is_visually_hidden_from_conversation:!r})},completionMetadata:{conversationMode:(c=l==null?void 0:l.mode)!=null?c:{kind:Ga.PrimaryAssistant},systemHints:x},eventSource:"mouse"}},zn=a=>{"use forget";const e=Ce.c(6),{onClose:s,onSubmit:n,clientX:o,clientY:r,placeholder:i}=a;let d;return e[0]!==o||e[1]!==r||e[2]!==s||e[3]!==n||e[4]!==i?(d=t.jsx("div",{className:"pointer-events-none fixed inset-0 z-[1000]",children:t.jsx(pi,{clientX:o,clientY:r,placeholder:i,onSubmit:n,onBlur:s})}),e[0]=o,e[1]=r,e[2]=s,e[3]=n,e[4]=i,e[5]=d):d=e[5],d},pi=a=>{"use forget";const e=Ce.c(43),{placeholder:s,clientX:n,clientY:o,onBlur:r,onSubmit:i}=a,d=It(),[l,g]=W.useState("");let x;e[0]!==l?(x=l.trim(),e[0]=l,e[1]=x):x=e[1];const f=!!x;let u;e[2]!==i||e[3]!==l?(u=E=>{const{metaKey:Ae,shiftKey:he,key:Y}=E;Y==="Enter"&&!E.nativeEvent.isComposing&&l.trim()&&!(he||Ae)?(i==null||i(E,l),E.preventDefault()):Y==="Escape"&&g("")},e[2]=i,e[3]=l,e[4]=u):u=e[4];const c=u,h=Nn(0),v=Nn(0);let y;e[5]!==o?(y=E=>o-8<=E?o+E+E:o-8,e[5]=o,e[6]=y):y=e[6];const j=Mn(h,y);let T;e[7]!==n?(T=E=>n+E>window.innerWidth?n-E:n,e[7]=n,e[8]=T):T=e[8];const F=Mn(v,T);let M;e[9]!==h||e[10]!==v?(M=rn({axis:"both",onChange:E=>{h.set(E.height),v.set(E.width)}}),e[9]=h,e[10]=v,e[11]=M):M=e[11];let p,m;e[12]===Symbol.for("react.memo_cache_sentinel")?(p={opacity:0,scale:.95},m={opacity:1,scale:1},e[12]=p,e[13]=m):(p=e[12],m=e[13]);let O;e[14]!==F||e[15]!==j?(O={top:j,left:F},e[14]=F,e[15]=j,e[16]=O):O=e[16];let S,$,B;e[17]===Symbol.for("react.memo_cache_sentinel")?(B={opacity:0,scale:.95},S={type:"spring",bounce:.1,duration:.1},$=xe("pointer-events-auto absolute z-[1000] -translate-y-full"),e[17]=S,e[18]=$,e[19]=B):(S=e[17],$=e[18],B=e[19]);let V;e[20]===Symbol.for("react.memo_cache_sentinel")?(V=E=>g(E.target.value),e[20]=V):V=e[20];let P;e[21]!==c||e[22]!==r||e[23]!==s?(P=t.jsx("div",{children:t.jsx("input",{autoFocus:!0,className:"border-none text-sm shadow-[none] outline-none focus:border-none focus:outline-none",placeholder:s,onBlur:r,onChange:V,onKeyDown:c})}),e[21]=c,e[22]=r,e[23]=s,e[24]=P):P=e[24];let I;e[25]===Symbol.for("react.memo_cache_sentinel")?(I=t.jsx(tn.Separator,{}),e[25]=I):I=e[25];const q=!f;let z;e[26]!==d?(z=d.formatMessage({id:"iIqOqN",defaultMessage:"Submit"}),e[26]=d,e[27]=z):z=e[27];let A;e[28]!==i||e[29]!==l?(A=E=>i==null?void 0:i(E,l),e[28]=i,e[29]=l,e[30]=A):A=e[30];let se;e[31]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(wo,{className:"h-4 w-4 text-white dark:text-black"}),e[31]=se):se=e[31];let D;e[32]!==q||e[33]!==z||e[34]!==A?(D=t.jsx(tn.Button,{disabled:q,"aria-label":z,className:"ms-2 me-1 flex h-6 w-6 items-center justify-center rounded-full bg-black dark:bg-white",onClick:A,children:se}),e[32]=q,e[33]=z,e[34]=A,e[35]=D):D=e[35];let G;e[36]!==P||e[37]!==D?(G=t.jsxs(tn,{children:[P,I,D]}),e[36]=P,e[37]=D,e[38]=G):G=e[38];let Se;return e[39]!==G||e[40]!==M||e[41]!==O?(Se=t.jsx(an.div,{ref:M,initial:p,animate:m,style:O,exit:B,transition:S,className:$,children:G}),e[39]=G,e[40]=M,e[41]=O,e[42]=Se):Se=e[42],Se},gi=({title:a,logoUrl:e})=>t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light my-2 flex w-fit items-center gap-2 rounded-xl px-4 py-2 pe-6",children:[e?t.jsx("img",{className:"h-5 w-5 rounded-md",src:e,alt:a!=null?a:""}):t.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-md"}),t.jsx("div",{className:"text-token-text-primary text-base font-medium",children:a})]}),xi=a=>{"use forget";const e=Ce.c(6),{errorMessage:s,onClickRetry:n}=a;let o,r;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(Xa,{className:"icon"}),r=t.jsx(oe,{id:"DTbTrQ",defaultMessage:"Error loading app"}),e[0]=o,e[1]=r):(o=e[0],r=e[1]);let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(oe,{id:"thEh3U",defaultMessage:"Retry"}),e[2]=i):i=e[2];let d;return e[3]!==s||e[4]!==n?(d=t.jsx(jo,{type:"error",icon:o,title:r,content:s,primaryCtaText:i,primaryCtaColor:"secondary",onPrimaryCtaClick:n}),e[3]=s,e[4]=n,e[5]=d):d=e[5],d};function ga(a){"use forget";var O;const e=Ce.c(28),{messages:s,isLastMessageInTurn:n,clientThreadId:o,onRequestCompletion:r}=a;let i;e[0]!==n||e[1]!==s?(i=la(s,n),e[0]=n,e[1]=s,e[2]=i):i=e[2];const d=i;let l;e[3]!==s?(l=cn(s),e[3]=s,e[4]=l):l=e[4];const{assistantMessage:g}=l;let x;e[5]!==n||e[6]!==s?(x=ra(s,n),e[5]=n,e[6]=s,e[7]=x):x=e[7];const{uiState:f,jitPluginData:u}=x;let c;e[8]!==n||e[9]!==s?(c=ca(s,n),e[8]=n,e[9]=s,e[10]=c):c=e[10];const h=c;let v;e[11]!==s?(v=da(s),e[11]=s,e[12]=v):v=e[12];const y=v;let j;e[13]!==n||e[14]!==s?(j=ma(s,n),e[13]=n,e[14]=s,e[15]=j):j=e[15];const T=j,F=f===N.UserConfirmation,M=(O=g.recipient)!=null?O:T;let p;e[16]!==u?(p=u!=null?u:{},e[16]=u,e[17]=p):p=e[17];let m;return e[18]!==o||e[19]!==s||e[20]!==r||e[21]!==h||e[22]!==y||e[23]!==F||e[24]!==M||e[25]!==p||e[26]!==d?(m=t.jsx(fa,{isWrite:F,functionName:M,params:h,result:y,toolCallSafetySummary:d,messages:s,clientThreadId:o,jitPluginData:p,onRequestCompletion:r,rememberForThisConversation:!1}),e[18]=o,e[19]=s,e[20]=r,e[21]=h,e[22]=y,e[23]=F,e[24]=M,e[25]=p,e[26]=d,e[27]=m):m=e[27],m}const hi=a=>{"use forget";var mn,un,fn,pn,gn,xn;const e=Ce.c(287),{chatSDK:s,clientThreadId:n,onRequestCompletion:o,isLastMessageInTurn:r}=a,i=$s();let d;e[0]!==i?(d=()=>ta(i),e[0]=i,e[1]=d):d=e[1];const l=ke(d);let g;e[2]!==i?(g=Za(),e[2]=i,e[3]=g):g=e[3];const{locale:x}=g;let f,u;e[4]!==n||e[5]!==i?(f=Rs(i,n),u=aa(f),e[4]=n,e[5]=i,e[6]=f,e[7]=u):(f=e[6],u=e[7]);const c=u,h=ko(),[v,y]=W.useState(null),j=Co(s),{refetch:T,isLoading:F,isError:M,html:p,domain:m,subdomain:O,name:S,logoUrl:$,csp:B,fitWidth:V,prefersBorder:P,hideWidgetAttribution:I,hideFullScreenHeader:q}=j,z=q===void 0?!1:q,{widgetParent:A,widgetType:se,metadata:D}=s,[G,Se]=W.useState(null),[E,Ae]=W.useState(null),he=W.useRef(null),Y=W.useRef(null),ie=eo.useStore(),{setTargetedContent:L}=No();let le;e[8]!==s||e[9]!==n||e[10]!==o||e[11]!==ie?(le=_=>{const{prompt:H,systemPrompt:X,isVisible:te,scrollToBottom:Fe,hint:Je}=_,wt=fi({prompt:H,systemPrompt:X,isVisible:te,chatSDK:s,persistedSystemHintsStore:ie,clientThreadId:n,hint:Je});wt!=null&&(Fe&&sa(n,_i),o(wt))},e[8]=s,e[9]=n,e[10]=o,e[11]=ie,e[12]=le):le=e[12];const ve=le;let ue;e[13]!==L?(ue=_=>{const{text:H}=_;if(typeof H!="string")return;const X=H.trim();X&&L({type:"text",label:X,createNewCompletionParams:te=>{var Je;const Fe=so(X);return jt(ge({},te),{promptMessage:Io({},te.promptMessage,{metadata:{targeted_reply:X,targeted_reply_label:X}}),appendMessages:[...(Je=te.appendMessages)!=null?Je:[],Fe]})}})},e[13]=L,e[14]=ue):ue=e[14];const Ne=In(ue);let Me;e[15]!==c?(Me=()=>c.title$(),e[15]=c,e[16]=Me):Me=e[16];const Ie=ke(Me);let Xe;e[17]!==s||e[18]!==c?(Xe=()=>c.isPinned$(s),e[17]=s,e[18]=c,e[19]=Xe):Xe=e[19];const ne=ke(Xe);let We;e[20]!==s||e[21]!==c?(We=()=>c.isPinOrigin$(s),e[20]=s,e[21]=c,e[22]=We):We=e[22];const re=ke(We);let Tt;e[23]!==s||e[24]!==c?(Tt=()=>c.isPinOrigin$(s)?c.displayMode$():"inline",e[23]=s,e[24]=c,e[25]=Tt):Tt=e[25];const ye=ke(Tt),k=ye==="fullscreen",at=ye==="pip";let ce;e[26]!==z||e[27]!==k?(ce=k&&!z&&!Ys(),e[26]=z,e[27]=k,e[28]=ce):ce=e[28];const St=ce;let ot;e[29]!==z||e[30]!==k?(ot=k&&(z||Ys()),e[29]=z,e[30]=k,e[31]=ot):ot=e[31];const At=ot;let ze;e[32]!==c?(ze=()=>c.maxWidgetHeight$(),e[32]=c,e[33]=ze):ze=e[33];const be=ke(ze),[is,dn]=W.useState(null);let ls;e[34]!==s.widgetId||e[35]!==c?(ls=()=>c.transitioningId$()===s.widgetId,e[34]=s.widgetId,e[35]=c,e[36]=ls):ls=e[36];const Oe=ke(ls);let Ee;e[37]!==s||e[38]!==c?(Ee=()=>c.getLatestChatSDK$(s),e[37]=s,e[38]=c,e[39]=Ee):Ee=e[39];const rs=ke(Ee),fe=v!=null?v:s;let it;e[40]!==fe||e[41]!==c?(it=()=>c.getWidgetStateAndProps$(fe),e[40]=fe,e[41]=c,e[42]=it):it=e[42];const{toolInput:cs,toolOutput:Le,widgetState:Et,toolResponseMetadata:lt}=ke(it),ds=(un=(mn=fe.metadata)==null?void 0:mn.subject_id)!=null?un:null,Ft=rs.messages,Q=fe.widgetId,De=(fn=D==null?void 0:D.attribution_id)!=null?fn:A,K=s.distributionChannel,[$e,Bs]=W.useState(0),[Ue,rt]=W.useState(!1),[Te,ms]=W.useState(!1),[qe,hs]=W.useState(!1),[He,ys]=W.useState(!1),[Ye,us]=W.useState(null),Rt=to(),Ot=K===fs.OPENAI;let ct;e[43]!==fe.connectorId||e[44]!==i?(ct=_=>new Promise(H=>{const X=_!=null?_:fe.connectorId;if(!X){H({didConnect:!1});return}const te=window.location.href;Zs(i,To,{connectorId:X,redirectAfter:te,onComplete:()=>{H({didConnect:!0})},onClose:()=>{H({didConnect:!1})}})}),e[43]=fe.connectorId,e[44]=i,e[45]=ct):ct=e[45];const Ge=ct;let dt;e[46]!==Q||e[47]!==s||e[48]!==ye||e[49]!==Ye||e[50]!==G||e[51]!==re||e[52]!==c||e[53]!==ie||e[54]!==P?(dt=(_,H)=>{if(_===ye)return{mode:_};_==="fullscreen"&&(no.setSidebarOpen(!1),us(Qn(ie)),ie.setActiveSystemHint(null)),_==="inline"&&(Ye==null||Ye.forEach(te=>{ie.setActiveSystemHint(te)}),us(null)),re?c.transitioningId$.set(Q):c.transitioningId$.set(s.widgetId),_!=="inline"&&c.subscribeToNewMessages$(s,y);const X=()=>{var te,Fe;(te=Y.current)==null||te.focus(),_==="inline"?(Fe=he.current)==null||Fe.navigate({popToRoot:!0}):c.setPinnedWidgetHeight(G!=null?G:0),y(null),c.setDisplayMode$(s,_,H)};return P?(So({forceFlushSync:!0,className:_==="inline"?[ps["pinned-widget"],ps["becoming-inline"]]:ye==="inline"?[ps["pinned-widget"],ps["becoming-pinned"]]:ps["pinned-widget"],update:X}).finished.then(()=>{c.transitioningId$.set(null)}),{mode:_}):(X(),c.transitioningId$.set(null),{mode:_})},e[46]=Q,e[47]=s,e[48]=ye,e[49]=Ye,e[50]=G,e[51]=re,e[52]=c,e[53]=ie,e[54]=P,e[55]=dt):dt=e[55];const U=In(dt);let mt,ut;e[56]!==ne||e[57]!==U?(mt=()=>{if(ne)return ao(window,{keydown:_=>{_.key==="Escape"&&U("inline")}})},ut=[ne,U],e[56]=ne,e[57]=U,e[58]=mt,e[59]=ut):(mt=e[58],ut=e[59]),W.useEffect(mt,ut);let ft;e[60]!==T||e[61]!==$e?(ft=()=>{T(),rt(!1),ms(!1),Bs($e+1)},e[60]=T,e[61]=$e,e[62]=ft):ft=e[62];const Lt=ft;let pt;e[63]!==U?(pt=()=>{rt(!0),U("inline")},e[63]=U,e[64]=pt):pt=e[64];const $t=pt;let gt;e[65]!==n||e[66]!==i?(gt=Mo(Rs(i,n)),e[65]=n,e[66]=i,e[67]=gt):gt=e[67];const{height$:Bt,marginBottom$:Pt}=gt;let xt;e[68]!==Bt||e[69]!==re||e[70]!==k||e[71]!==Pt?(xt=()=>{var _,H;return k&&re?16+((_=Bt())!=null?_:0)+((H=Pt())!=null?H:0):0},e[68]=Bt,e[69]=re,e[70]=k,e[71]=Pt,e[72]=xt):xt=e[72];const Wt=ke(xt),zt=At?mi:0;let ht;e[73]!==zt||e[74]!==Wt?(ht={insets:{top:zt,bottom:Wt,left:0,right:0}},e[73]=zt,e[74]=Wt,e[75]=ht):ht=e[75];const Dt=ht;let yt;e[76]!==s||e[77]!==l?(yt=Ko(l,s),e[76]=s,e[77]=l,e[78]=yt):yt=e[78];const Ke=yt;if(h){let _;return e[79]!==$||e[80]!==S?(_=t.jsx(gi,{title:S,logoUrl:$}),e[79]=$,e[80]=S,e[81]=_):_=e[81],_}else if(ne&&!re&&!Oe)return null;const bt=k?void 0:G?"".concat(Math.min(G,be!=null?be:1/0),"px"):"auto",bs=k?void 0:E&&V?"".concat(E,"px"):void 0,_t=(pn=s.metadata.height_hint)!=null?pn:400,_s=(gn=s.metadata.width_hint)!=null?gn:void 0;let vt;e[82]!==n||e[83]!==re||e[84]!==r||e[85]!==Ft||e[86]!==o?(vt=ua(Ft,r||re)&&t.jsx(ga,{messages:Ft,isLastMessageInTurn:r||re,clientThreadId:n,onRequestCompletion:o}),e[82]=n,e[83]=re,e[84]=r,e[85]=Ft,e[86]=o,e[87]=vt):vt=e[87];const Be=vt,Qe=F||!Te||G==null;let b;e[88]!==m?(b=Vo(m),e[88]=m,e[89]=b):b=e[89];const C=b;let R;e[90]!==n?(R=ea(n),e[90]=n,e[91]=R):R=e[91];const w=R;let ae;e[92]!==Q||e[93]!==De||e[94]!==s||e[95]!==n||e[96]!==f||e[97]!==B||e[98]!==i||e[99]!==m||e[100]!==Ke||e[101]!==p||e[102]!==x||e[103]!==D.suggestion_message_id||e[104]!==j||e[105]!==O||e[106]!==A||e[107]!==se?(ae=_=>{const{title:H,params:X,heightHint:te}=_;Zs(i,xs,{resolvedWidget:j,conversation:f,chatSDK:s,features:Ke,clientThreadId:n,title:H,params:X,html:p,attributionId:De,widgetId:Q,widgetParent:A,suggestionMessageId:D==null?void 0:D.suggestion_message_id,widgetType:se,subdomain:O,domain:m,csp:B,locale:x,heightHint:te})},e[92]=Q,e[93]=De,e[94]=s,e[95]=n,e[96]=f,e[97]=B,e[98]=i,e[99]=m,e[100]=Ke,e[101]=p,e[102]=x,e[103]=D.suggestion_message_id,e[104]=j,e[105]=O,e[106]=A,e[107]=se,e[108]=ae):ae=e[108];const Z=ae,de=Oe&&P&&"[view-transition-name:pinned-kanzi-widget]",me=!re&&"relative mb-2";let ee;e[109]!==ye||e[110]!==bt||e[111]!==_t||e[112]!==k||e[113]!==at||e[114]!==ne||e[115]!==P||e[116]!==de||e[117]!==me?(ee=xe("no-scrollbar max-w-full",de,me,ye==="inline"&&xe("@w-sm/main:w-full",!ne&&"mx-0 max-sm:-mx-(--thread-content-margin) max-sm:w-[100cqw] max-sm:overflow-hidden",P&&!ne&&!k&&"max-sm:overflow-visible max-sm:px-4"),at&&"@w-xl/main:top-4 fixed start-4 end-4 top-4 z-50 mx-auto max-w-(--thread-content-max-width) sm:start-0 sm:end-0 sm:top-(--header-height) sm:w-full",k?"fixed start-0 end-0 top-0 bottom-0 z-50 mx-auto flex w-auto flex-col overflow-hidden":"overflow-visible",!bt&&!_t&&!k&&"opacity-0"),e[109]=ye,e[110]=bt,e[111]=_t,e[112]=k,e[113]=at,e[114]=ne,e[115]=P,e[116]=de,e[117]=me,e[118]=ee):ee=e[118];let we;e[119]!==be?(we={maxHeight:be},e[119]=be,e[120]=we):we=e[120];let je;e[121]===Symbol.for("react.memo_cache_sentinel")?(je=rn({axis:"width",onChange:_=>{const{width:H}=_;return dn(H)}}),e[121]=je):je=e[121];let _e;e[122]!==k||e[123]!==ne||e[124]!==U?(_e=ne&&!k&&t.jsx("button",{className:"absolute -start-2 -top-1.5 z-10 rounded-full bg-[#3a3a3a] p-1.25 text-white shadow-[0px_0px_0px_1px_var(--border-heavy),0px_4px_12px_rgba(0,0,0,0.12)] hover:bg-[#6a6a6a] md:-start-6",onClick:()=>U("inline"),children:t.jsx(Yn,{className:"h-4.5 w-4.5"})}),e[122]=k,e[123]=ne,e[124]=U,e[125]=_e):_e=e[125];let Ve;e[126]!==qe||e[127]!==He||e[128]!==K||e[129]!==Ie||e[130]!==$||e[131]!==S||e[132]!==U||e[133]!==St||e[134]!==C?(Ve=St&&t.jsx(di,{logo:$,hideOpenInAppButton:K===fs.OPENAI,onClickBack:()=>{var _;return(_=he.current)==null?void 0:_.navigate({delta:-1})},onClickClose:()=>U("inline"),onClickForward:()=>{var _;return(_=he.current)==null?void 0:_.navigate({delta:1})},canGoBack:qe,canGoForward:He,title:(xn=Ie!=null?Ie:S)!=null?xn:"",widgetDisplayName:S!=null?S:"",widgetDomain:C!=null?C:null,onClickOpenInApp:()=>{var _;(_=he.current)==null||_.getCurrentPath().then(H=>{H==null||!C||window.open(new URL(H.replace(/^\/+/,""),C),"_blank")})}}),e[126]=qe,e[127]=He,e[128]=K,e[129]=Ie,e[130]=$,e[131]=S,e[132]=U,e[133]=St,e[134]=C,e[135]=Ve):Ve=e[135];let Ze;e[136]!==qe||e[137]!==He||e[138]!==U||e[139]!==At?(Ze=At&&t.jsx(pa,{isNavOnly:!0,onClickBack:()=>{var _;return(_=he.current)==null?void 0:_.navigate({delta:-1})},onClickForward:()=>{var _;return(_=he.current)==null?void 0:_.navigate({delta:1})},onClickClose:()=>U("inline"),canGoBack:qe,canGoForward:He}),e[136]=qe,e[137]=He,e[138]=U,e[139]=At,e[140]=Ze):Ze=e[140];const Ps=k?"flex-1":"h-full",Ws=!ne&&P&&"border-token-border-light shadow-short rounded-2xl sm:rounded-3xl dark:shadow-[0px_0px_0px_1px_#414141,0px_4px_14px_rgba(0,0,0,0.24)]",zs=!k&&(P||at)&&"rounded-2xl sm:rounded-3xl",Ds=at&&"shadow-[0px_0px_0px_1px_var(--border-heavy),0px_6px_20px_rgba(0,0,0,0.1)] md:-mx-4";let Ut;e[141]!==Ps||e[142]!==Ws||e[143]!==zs||e[144]!==Ds?(Ut=xe("relative max-w-full overflow-hidden",Ps,Ws,zs,Ds),e[141]=Ps,e[142]=Ws,e[143]=zs,e[144]=Ds,e[145]=Ut):Ut=e[145];const Us=Qe?_t:bt,qs=Qe?_s:bs;let qt;e[146]!==Us||e[147]!==qs?(qt={height:Us,width:qs},e[146]=Us,e[147]=qs,e[148]=qt):qt=e[148];let Ht;e[149]!==Qe?(Ht=Qe&&t.jsx(an.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"loading-results-shimmer absolute inset-0 sm:rounded-3xl"},"loading-results-shimmer"),e[149]=Qe,e[150]=Ht):Ht=e[150];let Gt;e[151]!==Ht?(Gt=t.jsx(oo,{initial:!1,children:Ht}),e[151]=Ht,e[152]=Gt):Gt=e[152];let Kt;e[153]!==fe||e[154]!==$e||e[155]!==j?(Kt=$e||ui(fe,j),e[153]=fe,e[154]=$e,e[155]=j,e[156]=Kt):Kt=e[156];const Hs=Rt!=null?Rt:"light",Gs=ye!=null?ye:"inline";let vs;e[157]===Symbol.for("react.memo_cache_sentinel")?(vs=()=>ms(!0),e[157]=vs):vs=e[157];let Vt;if(e[158]!==Q||e[159]!==s||e[160]!==n||e[161]!==f||e[162]!==w||e[163]!==B||e[164]!==i||e[165]!==K||e[166]!==m||e[167]!==Z||e[168]!==c||e[169]!==Ge||e[170]!==Ne||e[171]!==j||e[172]!==ve||e[173]!==U||e[174]!==A){let _;e[176]!==i?(_=J=>{const{clientX:pe,clientY:Re,placeholder:ya}=J;return new Promise((ba,_a)=>{var hn,yn,bn;const ns=(hn=Y.current)==null?void 0:hn.getBoundingClientRect();Zs(i,zn,{placeholder:ya,clientX:pe+((yn=ns==null?void 0:ns.left)!=null?yn:0),clientY:Re+((bn=ns==null?void 0:ns.top)!=null?bn:0),onSubmit:(Xi,va)=>{ba({prompt:va}),Qs(i,zn)},onClose:_a})})},e[176]=i,e[177]=_):_=e[177];let H;e[178]!==s||e[179]!==f||e[180]!==K||e[181]!==Z?(H=K===fs.OPENAI?J=>{const{title:pe,params:Re}=J;Ys()?Z({title:pe,params:Re}):Wn.set(f,{focusedObject:{title:pe,params:Re},chatSDK:s})}:void 0,e[178]=s,e[179]=f,e[180]=K,e[181]=Z,e[182]=H):H=e[182];let X;e[183]!==f||e[184]!==i||e[185]!==K?(X=K===fs.OPENAI?()=>{Tn(i,xs)?Qs(i,xs):Wn.set(f,null)}:void 0,e[183]=f,e[184]=i,e[185]=K,e[186]=X):X=e[186];let te;e[187]!==Q||e[188]!==i||e[189]!==c?(te=()=>{if(Tn(i,xs))return Qs(i,xs);c.closeWidget$(Q,"request_close")},e[187]=Q,e[188]=i,e[189]=c,e[190]=te):te=e[190];let Fe;e[191]!==s||e[192]!==n||e[193]!==i||e[194]!==j?(Fe=J=>Xo({ctx:i,chatSDK:s,clientThreadId:n,checkoutSession:J,resolvedWidget:j}),e[191]=s,e[192]=n,e[193]=i,e[194]=j,e[195]=Fe):Fe=e[195];let Je;e[196]!==U?(Je=()=>U("inline"),e[196]=U,e[197]=Je):Je=e[197];let wt;e[198]===Symbol.for("react.memo_cache_sentinel")?(wt=J=>{const{canGoBack:pe,canGoForward:Re}=J;hs(pe),ys(Re)},e[198]=wt):wt=e[198];let ks;e[199]!==c?(ks=(J,pe)=>c.setWidgetState$(J,pe),e[199]=c,e[200]=ks):ks=e[200];let Cs;e[201]!==U?(Cs=J=>{const{mode:pe,title:Re}=J;return U(pe,Re)},e[201]=U,e[202]=Cs):Cs=e[202];let Ns,Ms,Is,Ts;e[203]!==c||e[204]!==A?(Ns=(J,pe)=>c.callTool$(A,J,pe),Ms=J=>c.uploadFile$(A,J),Is=J=>c.getFileDownloadUrl$(A,J.fileId),Ts=J=>c.getFileMetadata$(A,J.fileId),e[203]=c,e[204]=A,e[205]=Ns,e[206]=Ms,e[207]=Is,e[208]=Ts):(Ns=e[205],Ms=e[206],Is=e[207],Ts=e[208]);let Ss,As;e[209]!==Ge?(Ss=J=>{const{connectorId:pe}=J;return Ge(pe)},As=()=>Ge(),e[209]=Ge,e[210]=Ss,e[211]=As):(Ss=e[210],As=e[211]),Vt={openExternal(J){var Re;const{href:pe}=J;Yo({ctx:i,href:pe,resolvedPineappleUri:(Re=s.metadata.resolved_pineapple_uri)!=null?Re:null,csp:B,redirectDomains:j.redirectDomains,domain:m,distributionChannel:K,redirectUrl:w?new URL(na(w),window.location.origin).toString():new URL(window.location.href).toString()})},openPromptInput:_,requestFocusedObject:H,requestCloseFocusedObject:X,requestModal:Z,requestClose:te,requestCheckout:Fe,notifyEscapeKey:Je,notifyNavigation:wt,notifyIntrinsicHeight:Se,notifyIntrinsicWidth:Ae,sendFollowUpMessage:ve,requestTargetedReply:Ne,updateWidgetState:ks,requestDisplayMode:Cs,callTool:Ns,uploadFile:Ms,getFileDownloadUrl:Is,getFileMetadata:Ts,requestLinkToConnector:Ss,requestConnectSheet:As},e[158]=Q,e[159]=s,e[160]=n,e[161]=f,e[162]=w,e[163]=B,e[164]=i,e[165]=K,e[166]=m,e[167]=Z,e[168]=c,e[169]=Ge,e[170]=Ne,e[171]=j,e[172]=ve,e[173]=U,e[174]=A,e[175]=Vt}else Vt=e[175];let Jt;e[212]!==Q||e[213]!==De||e[214]!==w||e[215]!==B||e[216]!==K||e[217]!==Ke||e[218]!==V||e[219]!==$t||e[220]!==p||e[221]!==x||e[222]!==be||e[223]!==is||e[224]!==D.suggestion_message_id||e[225]!==Dt||e[226]!==O||e[227]!==ds||e[228]!==Kt||e[229]!==Hs||e[230]!==Gs||e[231]!==Vt||e[232]!==cs||e[233]!==Le||e[234]!==lt||e[235]!==A||e[236]!==Et||e[237]!==se?(Jt=t.jsx(Jo,{iframeRef:Y,measureWidth:V,ref:he,host:"chatgpt",title:se,locale:x,html:p,csp:B,features:Ke,subdomain:O,attributionId:De,conversationId:w,widgetId:Q,suggestionMessageId:D.suggestion_message_id,widgetType:se,widgetParent:A,widgetState:Et,widgetDistributionChannel:K,toolInput:cs,toolOutput:Le,toolResponseMetadata:lt,subjectId:ds,maxHeight:be,maxWidth:is,theme:Hs,displayMode:Gs,safeArea:Dt,onReady:vs,onError:$t,api:Vt},Kt),e[212]=Q,e[213]=De,e[214]=w,e[215]=B,e[216]=K,e[217]=Ke,e[218]=V,e[219]=$t,e[220]=p,e[221]=x,e[222]=be,e[223]=is,e[224]=D.suggestion_message_id,e[225]=Dt,e[226]=O,e[227]=ds,e[228]=Kt,e[229]=Hs,e[230]=Gs,e[231]=Vt,e[232]=cs,e[233]=Le,e[234]=lt,e[235]=A,e[236]=Et,e[237]=se,e[238]=Jt):Jt=e[238];let Xt;e[239]!==Be||e[240]!==k?(Xt=!!Be&&t.jsx("div",{className:xe("bg-token-bg-secondary/50 pointer-events-auto absolute inset-0 z-0 flex items-center justify-center rounded-none",k?"fixed z-50":"sm:rounded-3xl")}),e[239]=Be,e[240]=k,e[241]=Xt):Xt=e[241];let Yt;e[242]!==Ut||e[243]!==qt||e[244]!==Gt||e[245]!==Jt||e[246]!==Xt?(Yt=t.jsxs("div",{className:Ut,style:qt,children:[Gt,Jt,Xt]}),e[242]=Ut,e[243]=qt,e[244]=Gt,e[245]=Jt,e[246]=Xt,e[247]=Yt):Yt=e[247];let Qt;e[248]!==Be||e[249]!==k||e[250]!==Te?(Qt=Te&&Be&&t.jsx(an.div,{className:xe("pointer-events-auto inset-0 z-50 flex justify-center",k?"fixed top-(--header-height) z-20 items-center":"absolute items-start pt-10"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:.1,duration:.24},children:Be}),e[248]=Be,e[249]=k,e[250]=Te,e[251]=Qt):Qt=e[251];let ws;e[252]!==ee||e[253]!==we||e[254]!==je||e[255]!==_e||e[256]!==Ve||e[257]!==Ze||e[258]!==Yt||e[259]!==Qt?(ws=t.jsxs("div",{className:ee,style:we,ref:je,children:[_e,Ve,Ze,Yt,Qt]}),e[252]=ee,e[253]=we,e[254]=je,e[255]=_e,e[256]=Ve,e[257]=Ze,e[258]=Yt,e[259]=Qt,e[260]=ws):ws=e[260];const Ks=ws,Vs=M||Ue,Js=!M&&!I;let Zt;e[261]!==k?(Zt=k&&t.jsx("div",{className:"bg-token-bg-primary fixed start-0 end-0 top-0 bottom-0 z-10"}),e[261]=k,e[262]=Zt):Zt=e[262];let es;e[263]!==s||e[264]!==w||e[265]!==F||e[266]!==$||e[267]!==S||e[268]!==Js||e[269]!==Ot||e[270]!==C?(es=Js&&t.jsx("div",{className:"mt-2 sm:mt-4",children:t.jsx(ci,{withMarginBottom:!0,onClick:C?()=>window.open(C,"_blank","noopener,noreferrer"):void 0,isLoading:F,logoUrl:$,name:S,conversationId:w,chatSDK:s,tintLogoToText:Ot})}),e[263]=s,e[264]=w,e[265]=F,e[266]=$,e[267]=S,e[268]=Js,e[269]=Ot,e[270]=C,e[271]=es):es=e[271];let ts;e[272]!==Lt||e[273]!==Vs||e[274]!==M||e[275]!==Ue||e[276]!==Ks?(ts=Vs?t.jsx("div",{className:xe(M&&"mt-2"),children:t.jsx(xi,{onClickRetry:Lt,errorMessage:M?"Failed to fetch template":Ue?"Runtime error":void 0})}):Ks,e[272]=Lt,e[273]=Vs,e[274]=M,e[275]=Ue,e[276]=Ks,e[277]=ts):ts=e[277];let ss;e[278]!==K||e[279]!==k||e[280]!==P?(ss=!k&&!P&&K!==fs.OPENAI&&t.jsx("div",{className:"bg-token-border-default my-3 h-px w-full"}),e[278]=K,e[279]=k,e[280]=P,e[281]=ss):ss=e[281];let js;return e[282]!==Zt||e[283]!==es||e[284]!==ts||e[285]!==ss?(js=t.jsxs(t.Fragment,{children:[Zt,es,ts,ss]}),e[282]=Zt,e[283]=es,e[284]=ts,e[285]=ss,e[286]=js):js=e[286],js},yi=a=>{"use forget";const e=Ce.c(18),{messages:s,clientThreadId:n,onRequestCompletion:o,isLastMessageInTurn:r}=a;let i;e[0]!==s?(i=Ln(s),e[0]=s,e[1]=i):i=e[1];const d=i,l=$s();let g,x;e[2]!==n||e[3]!==l?(g=Rs(l,n),x=aa(g),e[2]=n,e[3]=l,e[4]=g,e[5]=x):(g=e[4],x=e[5]);const f=x;let u;e[6]!==d.widgetId||e[7]!==f?(u=()=>f.closedWidgetIds$().has(d.widgetId),e[6]=d.widgetId,e[7]=f,e[8]=u):u=e[8];const c=ke(u);let h;e[9]!==d||e[10]!==g||e[11]!==f?(h=()=>{if(!d.sessionId||f.isPinned$(d))return!0;const j=Qa(g);for(let T=j.length-1;T>=0;T--){const{messages:F}=j[T];let M;try{M=Ln(F)}catch(O){continue}if(M==null)continue;const{sessionId:p,invocationUuid:m}=M;if(p&&p===d.sessionId)return m===d.invocationUuid}return!0},e[9]=d,e[10]=g,e[11]=f,e[12]=h):h=e[12];const v=ke(h);if(d.metadata.is_widget_closed||c||d.isError||!v)return null;let y;return e[13]!==d||e[14]!==n||e[15]!==r||e[16]!==o?(y=t.jsx(hi,{clientThreadId:n,onRequestCompletion:o,isLastMessageInTurn:r,chatSDK:d}),e[13]=d,e[14]=n,e[15]=r,e[16]=o,e[17]=y):y=e[17],y},bi=a=>{"use forget";const e=Ce.c(5),{messages:s,clientThreadId:n,onRequestCompletion:o,isLastMessageInTurn:r}=a,i=$s();if(Zn(i,"1037317296"))return null;let d;return e[0]!==n||e[1]!==r||e[2]!==s||e[3]!==o?(d=t.jsx(Ya,{name:"ChatSDKContent",children:t.jsx(yi,{messages:s,clientThreadId:n,onRequestCompletion:o,isLastMessageInTurn:r})}),e[0]=n,e[1]=r,e[2]=s,e[3]=o,e[4]=d):d=e[4],d};function _i(a){a.scrollToMessageId="finalAgentTurn",a.scrollToMessageIsAssistant=!0}function vi({messageMetadata:a}){const[e,s]=W.useState(!1);return t.jsxs("div",{className:"my-2 flex flex-col text-sm",children:[t.jsxs("div",{className:"flex flex-row items-center hover:cursor-pointer",onClick:()=>{s(!e)},children:[e?t.jsx(oa,{className:"icon-sm"}):t.jsx(io,{className:"icon-sm"}),t.jsx("div",{className:"font-semibold",children:a.display_message})]}),e&&t.jsx("pre",{children:JSON.stringify(a.data,null,2)})]})}function wi({debugMessages:a}){return a.length===0?null:t.jsx("div",{children:a.map((e,s)=>{var o,r;const n=(r=(o=e.metadata)==null?void 0:o.jit_plugin_data)==null?void 0:r.from_server;return n&&n.type==="debug"?t.jsx(vi,{messageMetadata:n.body},s):null})})}const xa="openaiFileIdRefs",ji=["send_email","batch_modify_email","create_event","update_event","delete_event"];function ki({name:a,params:e,result:s,privacyPolicyUrl:n,isPromptingForPermission:o}){var d;const i=((d=e==null?void 0:e[xa])!=null?d:[]).map((l,g)=>{const x=l.name.startsWith("dalle-");let f=l.name;return x&&(f="".concat(f,".webp")),t.jsx(ia,{file:f,fileId:l.id},g)});return t.jsxs("div",{className:"divide-token-border-default border-token-border-default mt-1 mb-4 divide-y overflow-hidden rounded-xl border",children:[a&&t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary px-4 py-2 text-sm",children:t.jsx(oe,{id:"JITPluginMessage.params.toolCall",defaultMessage:"Tool call: {name}",values:{name:t.jsx("span",{className:"text-token-text-primary",children:a})}})}),e&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:[o?t.jsx(oe,{id:"JITPluginMessage.params.sharing.present",defaultMessage:"The following will be shared:"}):t.jsx(oe,{id:"JITPluginMessage.params.sharing.past",defaultMessage:"The following was shared:"}),n&&t.jsx("a",{href:lo(n),className:"text-token-text-primary",target:"_blank",rel:"noreferrer",children:t.jsx(oe,ge({},Pe.privacyPolicyLink))})]}),t.jsx("div",{className:"px-4 py-2",children:t.jsx(on,{value:e})}),i.length>0&&t.jsx("div",{className:"px-4 py-2",children:i})]}),s&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:t.jsx(oe,{id:"JITPluginMessage.params.result",defaultMessage:"Result:"})}),t.jsx("div",{className:"px-4 py-2",children:t.jsx(on,{value:s})})]})]})}var Gn;const Ci=os.div(Gn||(Gn=kt(["h-px bg-token-border-default"])));var Kn;const Dn=os.div(Kn||(Kn=kt(["text-sm font-medium py-3 leading-6"])));var Vn;const Ni=os.div(Vn||(Vn=kt(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),Mi=":",Ii=({functionName:a,parameters:e,onClick:s,isDraft:n=!0,isCanceled:o=!1})=>{const r=It(),i=Object.entries(e).filter(([d,l])=>!l||d==="timezone_str"&&l===Intl.DateTimeFormat().resolvedOptions().timeZone?!1:l.length>0);return t.jsxs(Ni,{children:[t.jsx("div",{className:"mb-4 flex items-center font-semibold",children:t.jsx("div",{children:n?ln(a):Ti(a,r)})}),i.map(([d,l])=>t.jsxs("div",{children:[t.jsx(Ci,{}),t.jsxs("div",{className:"flex",children:[t.jsxs(Dn,{className:"text-token-text-tertiary me-1",children:[ln(d),Mi]}),t.jsx(Dn,{className:"whitespace-pre-line",children:ha(l,r)})]})]},d)),n&&!o&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(nt,{color:"primary",className:"py-2",onClick:s,children:r.formatMessage(Os.approveButton)})}),o&&t.jsx("div",{className:"mt-2 flex justify-end gap-4",children:t.jsx(nt,{color:"primary",className:"py-2",disabled:!0,children:r.formatMessage(Os.canceledButton)})})]})},Ti=(a,e)=>{switch(a){case"create_event":return"Created Event ✅";default:return"".concat(ln(a)," ").concat(e.formatMessage(Os.completedAction)," ✅")}},ln=a=>{switch(a){case"timezone_str":return"Timezone";default:return a.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}},ha=(a,e)=>{if(Array.isArray(a))return a.map(o=>ha(o,e)).join(e.formatMessage(Os.valueSeparator));if(typeof a=="object")return JSON.stringify(a);if(a.match(/^\s*\d{4}-\d{2}-\d{2}/)==null)return a;const n=new Date(a);return Number.isNaN(n.getTime())?a:e.formatDate(n,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},Os=Ls({approveButton:{id:"ParametersView.approveButton",defaultMessage:"Approve"},completedAction:{id:"ParametersView.completedAction",defaultMessage:"Completed"},canceledButton:{id:"ParametersView.canceledButton",defaultMessage:"Canceled"},valueSeparator:{id:"ParametersView.valueSeparator",defaultMessage:","}}),Si="list_resources",Ai="read_resource",Ei="search_tools",Fi="call_tool",Ri="api_tool.list_resources",Oi="api_tool.search_tools",Li="api_tool",$i=new Set([Ri,Oi,Li]),Bi=a=>$i.has(a);function Pi(a,e,s,n,o,r=null){const i=Wi(e,n,o,r);return i?typeof i=="string"?i:a.formatMessage(i,s):null}function Wi(a,e,s,n=null){if(![N.Finished,N.Running,N.Stopped].includes(s)||!e)return a;if(e.endsWith(Si)){const o=n==null?void 0:n[s];return o!=null?o:s===N.Finished||s===N.Stopped?et({id:"OdEouq",defaultMessage:"Looked for available tools"}):et({id:"hSyoq0",defaultMessage:"Looking for available tools"})}else if(e.endsWith(Ei)){const o=n==null?void 0:n[s];return o!=null?o:s===N.Finished||s===N.Stopped?et({id:"4et5qC",defaultMessage:"Searched tools"}):et({id:"V0IDh0",defaultMessage:"Searching tools"})}else if(e.endsWith(Fi)){const o=n==null?void 0:n[s];return o!=null?o:s===N.Finished||s===N.Stopped?et({id:"NTASw4",defaultMessage:"Called tool"}):et({id:"gc64KQ",defaultMessage:"Calling tool"})}else if(e.endsWith(Ai)){const o=n==null?void 0:n[s];return o!=null?o:s===N.Finished||s===N.Stopped?et({id:"f8Ld/y",defaultMessage:"Read resource"}):et({id:"1dbn0w",defaultMessage:"Reading resource"})}return a}const zi=(a,e)=>{const s=a.recipient==="api_tool.call_tool",n=["mcp://komi","mcp://kakao"],o=Rn(a).toLowerCase(),r=s&&n.some(d=>o.includes(d));let i=!1;if(r&&e){const d=Rn(e);if(d){let l;try{l=JSON.parse(d)}catch(g){}i=typeof l=="object"&&l!==null&&"widget"in l}}return{calledKakoMCP:r,displayedWidget:i}};function pl(a){"use forget";var ms,qe,hs,He,ys,Ye,us,Rt,Ot,ct,Ge,dt,U,mt,ut,ft,Lt,pt,$t,gt,Bt,Pt,xt,Wt,zt,ht,Dt,yt,Ke,bt,bs,_t,_s,vt,Be,Qe;const e=Ce.c(65),{messages:s,nextMessage:n,clientThreadId:o,isLastMessageInTurn:r,isLastTurnInConversation:i,connectorFixture:d,onRequestCompletion:l}=a,g=$s(),[x,f]=Ia(),{assistantMessage:u,toolMessages:c,debugMessages:h,lastToolMessage:v}=cn(s),y=(ms=u.recipient)!=null?ms:"",j=ro(o);let T;e[0]!==o||e[1]!==j?(T=()=>j!=null?j:ea(o),e[0]=o,e[1]=j,e[2]=T):T=e[2];const F=T,{addSource:M}=Ao(o),{uiState:p,jitPluginData:m,fileAttachments:O,invokedPlugin:S,lastConfirmActionJitPluginData:$}=ra(s,r);let B;e[3]!==s?(B=Es(s),e[3]=s,e[4]=B):B=e[4];const V=B,P=c.some(Po),I=It(),q=co(),[z,A,se]=mo(o,b=>{var R,w,ae;const C=(w=(R=u.metadata)==null?void 0:R.gizmo_id)!=null?w:b?nn.getGizmoId(b):q;return[C,Lo(b==null?void 0:b.mode,C),(ae=b==null?void 0:b.conversationOrigin)!=null?ae:null]}),D=zi(u,v);let G;e[5]!==A||e[6]!==z?(G=Eo(A)&&A.gizmo_id===z,e[5]=A,e[6]=z,e[7]=G):G=e[7];const E=(qe=uo(z,G))==null?void 0:qe.data,[Ae,he]=W.useState(!1),[Y,ie]=W.useState(!1),L=Sn(u.recipient);let le;if((L==null?void 0:L.functionName)!=null&&(E==null?void 0:E.tools)!=null){for(const b of E.tools)if(Wo(b,L.functionName)){le=b;break}}const ve=(hs=Sn(n==null?void 0:n.recipient))==null?void 0:hs.namespace,{connectorId:ue,connectorToolStatus:Ne,connectorStatusMessage:Me,showConnectorConnect:Ie,showStandaloneWidgetOverlayMessage:Xe}=zo(L==null?void 0:L.namespace,ve,c,i);let ne;e[8]!==g?(ne=()=>ta(g),e[8]=g,e[9]=ne):ne=e[9];const We=ke(ne);let re;e[10]!==s?(re=Es(s),e[10]=s,e[11]=re):re=e[11];const Tt=re,ye=Jn(!0,fo.JIT_PLUGIN),k=d!=null?d:ye.platformConnectors.get(ue!=null?ue:""),at=po();let ce=((He=m==null?void 0:m.from_server)==null?void 0:He.type)!=="denied_by_user"?(ys=m==null?void 0:m.from_server)==null?void 0:ys.body.domain:(Ye=le==null?void 0:le.metadata)==null?void 0:Ye.domain,St=null,ot=null;if(!ce&&(L!=null&&L.functionName)&&L.namespace==="kanzi_app"){const[b,C]=L.functionName.split("/");ce=b.replace(/_/g," ");const R="/kanzi/studio/c/".concat(C);let w;e[12]===Symbol.for("react.memo_cache_sentinel")?(w=t.jsx(Oo,{}),e[12]=w):w=e[12];let ae;e[13]!==R?(ae=t.jsx(yo,{openNewTab:!0,className:"text-token-text-secondary pt-1 opacity-0 transition-opacity duration-200 group-hover/tool-message:opacity-100",href:R,children:w}),e[13]=R,e[14]=ae):ae=e[14],St=ae}if(We&&y==="api_tool.call_tool"){let b;e[15]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx($o,{}),e[15]=b):b=e[15],ot=t.jsx("button",{onClick:()=>Bo(Rs(g,o)).focusMessage$(u.id),className:"text-token-text-secondary",children:b})}ce?ce.endsWith("__jit_plugin")&&(ce=ce.slice(0,-12)):ce="connector";const At=(us=le==null?void 0:le.metadata)==null?void 0:us.privacy_policy_url;W.useEffect(()=>{var C,R;if(((C=Do(m==null?void 0:m.from_client))==null?void 0:C.type)==="oauth_success")return;const b=x.get("oauth_success");if(((R=m==null?void 0:m.from_server)==null?void 0:R.type)==="oauth_required"&&b){f(Ji,{replace:!0});for(const w of m.from_server.body.actions)if(w.type==="oauth_redirect"){as({eventSource:"url",assistantMessage:u,onRequestCompletion:l,actionData:{type:"oauth_success",target_message_id:w.oauth_redirect.target_message_id},clientThreadId:o});return}}},[A,u,s,o,l,m,i,x,f,M]);let ze;e[16]!==u||e[17]!==o||e[18]!==m||e[19]!==l||e[20]!==x||e[21]!==f?(ze=[x,f,u,o,l,m],e[16]=u,e[17]=o,e[18]=m,e[19]=l,e[20]=x,e[21]=f,e[22]=ze):ze=e[22],W.useEffect(()=>{var R;const b=x.get("link_success"),C=x.get("oauth_success");if((b||C)&&((R=m==null?void 0:m.from_server)==null?void 0:R.type)==="link_required"){f(Vi,{replace:!0});for(const w of m.from_server.body.actions)if(w.type==="link_created"){as({eventSource:"url",assistantMessage:u,onRequestCompletion:l,actionData:{type:"link_success",target_message_id:w.link_created.target_message_id},clientThreadId:o});return}}},ze);let be;e[23]!==g?(be=g&&Zn(g,"2792858552"),e[23]=g,e[24]=be):be=e[24];const is=be;if(!(V||P)&&ve===(L==null?void 0:L.namespace))return null;let Oe=Ct.Running,Ee=ce?Pe.running:Pe.starting,rs={domain:ce};if(p===N.Hidden)return null;if(p===N.OauthLogin||p===N.UserConfirmation||p===N.NoAuthLink){Oe=Ct.Paused,Ee=Pe.confirmingSimple;const b={gizmoName:(Rt=E==null?void 0:E.gizmo.display.name)!=null?Rt:"ChatGPT",domain:ce};rs=jt(ge({},b),{title:Ki,subtitle:Gi})}else p===N.Finished?(Oe=Ct.Finished,Ee=Pe.finished,rs={domain:ce}):p===N.Error?(Oe=Ct.Error,Ee=Pe.error):p===N.Stopped||p===N.Denied?(Oe=Ct.Stopped,Ee=p===N.Denied?Pe.declined:Pe.stopped):p===N.Allowed&&(Oe=Ct.Stopped,Ee=Pe.allowed);const fe=((Ot=m==null?void 0:m.from_server)==null?void 0:Ot.type)!=="denied_by_user"?(ct=m==null?void 0:m.from_server)==null?void 0:ct.body.actions.map((b,C)=>t.jsx(Uo,{clientThreadId:o,messages:s,onRequestCompletion:l,action:b,domain:ce,handleUserAction:as,rememberAnswer:Y},C)):null;let it=null;((Ge=u.metadata)!=null&&Ge.tool_invoking_message||(dt=u.metadata)!=null&&dt.tool_invoked_message||(mt=(U=u.metadata)==null?void 0:U.chatgpt_sdk)!=null&&mt.tool_invoking_message||(ft=(ut=u.metadata)==null?void 0:ut.chatgpt_sdk)!=null&&ft.tool_invoked_message)&&(it={[N.Running]:(Bt=(gt=(pt=(Lt=u.metadata)==null?void 0:Lt.chatgpt_sdk)==null?void 0:pt.tool_invoking_message)!=null?gt:($t=u.metadata)==null?void 0:$t.tool_invoking_message)!=null?Bt:void 0,[N.Finished]:(ht=(zt=(xt=(Pt=u.metadata)==null?void 0:Pt.chatgpt_sdk)==null?void 0:xt.tool_invoked_message)!=null?zt:(Wt=u.metadata)==null?void 0:Wt.tool_invoked_message)!=null?ht:void 0,[N.Stopped]:(bs=(bt=(yt=(Dt=u.metadata)==null?void 0:Dt.chatgpt_sdk)==null?void 0:yt.tool_invoked_message)!=null?bt:(Ke=u.metadata)==null?void 0:Ke.tool_invoked_message)!=null?bs:void 0});const cs=Pi(I,Ee,rs,y,p,it);if(D.calledKakoMCP&&!D.displayedWidget||Bi(y)&&!r&&!We)return null;const Le=ca([u,...c],r),Et=la([u,...c],r),lt=da([u,...c]),ds=(_t=Le==null?void 0:Le[xa])!=null?_t:[],Ft=(!Es([u,...c])||We)&&(!!Le||!!lt||ds.length>0)&&(L==null?void 0:L.functionName)!=="list_resources"&&p!==N.Running;let Q;e[25]!==r||e[26]!==s?(Q=ua(s,r),e[25]=r,e[26]=s,e[27]=Q):Q=e[27];const De=Q;let K;e[28]!==r||e[29]!==s?(K=qo(s,r),e[28]=r,e[29]=s,e[30]=K):K=e[30];const $e=K,Bs=Es(s)&&p!==N.Denied&&!We;let Ue;e[31]===Symbol.for("react.memo_cache_sentinel")?(Ue=t.jsx(t.Fragment,{}),e[31]=Ue):Ue=e[31];let rt=Ue;const Te=ma(s,r);if(ji.includes(Te)&&(p===N.UserConfirmation||p===N.Finished||p===N.Stopped||p===N.Denied)){const b=p!==N.Finished,C=(p===N.Stopped||p===N.Denied)&&!i,R=(_s=Pn(m,S))!=null?_s:Pn($,void 0),w=R&&typeof R=="object"?Object.fromEntries(Object.entries(R).map(Hi)):{},ae=Z=>{var de,me,ee,we,je,_e,Ve;((de=m==null?void 0:m.from_server)==null?void 0:de.type)==="confirm_action"&&((we=(ee=(me=m==null?void 0:m.from_server)==null?void 0:me.body)==null?void 0:ee.actions)==null?void 0:we[0].type)==="allow"&&(as({clientThreadId:o,assistantMessage:u,onRequestCompletion:l,sourceEvent:Z,actionData:ge({type:"allow"},(Ve=(_e=(je=m==null?void 0:m.from_server)==null?void 0:je.body)==null?void 0:_e.actions)==null?void 0:Ve[0].allow)}),sa(o,Ze=>{Ze.scrollToMessageId=o}))};e:switch(Te){case"send_email":{const Z=w==null?void 0:w.to,de=w==null?void 0:w.cc,me=w==null?void 0:w.bcc,ee=w==null?void 0:w.subject,we=w==null?void 0:w.body,je=p===N.UserConfirmation?ae:qi;let _e;e[32]!==C||e[33]!==b||e[34]!==Z||e[35]!==de||e[36]!==me||e[37]!==ee||e[38]!==we||e[39]!==je?(_e=t.jsx(si,{to:Z,cc:de,bcc:me,subject:ee,body:we,onClick:je,isDraft:b,isCanceled:C}),e[32]=C,e[33]=b,e[34]=Z,e[35]=de,e[36]=me,e[37]=ee,e[38]=we,e[39]=je,e[40]=_e):_e=e[40],rt=_e;break e}default:{const Z=Te!=null?Te:"",de=p===N.UserConfirmation?ae:Ui;let me;e[41]!==w||e[42]!==C||e[43]!==b||e[44]!==Z||e[45]!==de?(me=t.jsx(Ii,{functionName:Z,parameters:w,onClick:de,isDraft:b,isCanceled:C}),e[41]=w,e[42]=C,e[43]=b,e[44]=Z,e[45]=de,e[46]=me):me=e[46],rt=me}}}else if((p===N.UserConfirmation||p===N.NoAuthLink||p===N.OauthLogin)&&fe&&!Et){const b=((vt=m==null?void 0:m.from_server)==null?void 0:vt.type)==="confirm_action";let C;e[47]!==$e||e[48]!==Y?(C=$e&&t.jsx("div",{className:"flex gap-2 text-sm",children:t.jsx(Fo,{id:"dont-ask-again",label:t.jsx(oe,ge({},Pe.rememberForThisConversation)),checked:Y,onChange:w=>ie(w.target.checked)})}),e[47]=$e,e[48]=Y,e[49]=C):C=e[49];let R;e[50]!==fe||e[51]!==b||e[52]!==C?(R=t.jsx(t.Fragment,{children:t.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[fe,b,C]})}),e[50]=fe,e[51]=b,e[52]=C,e[53]=R):R=e[53],rt=R}return m==null||m.from_server,ue?t.jsxs(t.Fragment,{children:[Me&&t.jsx($n,{highlightedCommand:k?I.formatMessage(Me,{domain:k.name}):t.jsx("br",{}),status:Ne,showWorkUserSetting:!1}),Ie&&k&&t.jsx("div",{className:"mb-2 flex gap-2",children:t.jsx(Ho,{connector:k,clientThreadId:o,hasWidget:Tt,onConnect:()=>{var w;const b=F(),C=b?new URL(na(b),window.location.origin):new URL(window.location.href);C.searchParams.set("oauth_success","true");const R=((w=m==null?void 0:m.from_server)==null?void 0:w.type)==="oauth_required"?"OAUTH":is?void 0:"NONE";at({connectorId:k.id,redirectAfter:C.toString(),referrer:xo.JitPluginMessage,authTypeOverride:R}),An(k.id,Fn.ConnectorPromptAccept,jt(ge({},En({clientThreadId:b!=null?b:o})),{auth_type_override:R!=null?R:"",supports_mixed_auth:k.supported_auth.length>1?"true":"false"})),b&&Bn({conversationId:b,messageId:u.id,connectorId:k.id,eventType:"click"})},onProceedWithoutConnecting:b=>{var R,w,ae,Z;const C=(R=m==null?void 0:m.from_server)==null?void 0:R.type;if(C==="oauth_required"||C==="link_required"){for(const de of(ae=(w=m==null?void 0:m.from_server)==null?void 0:w.body.actions)!=null?ae:[])if(de.type==="deny"){const me=de.deny.target_message_id,ee=F();as({eventSource:Ro(b),assistantMessage:u,onRequestCompletion:l,actionData:{type:"deny",target_message_id:me},clientThreadId:o}),An(k.id,Fn.ConnectorPromptReject,En({clientThreadId:ee!=null?ee:o})),ee&&Bn({conversationId:ee,messageId:u.id,connectorId:k.id,eventType:"dismiss"}),(Z=k==null?void 0:k.branding)!=null&&Z.is_discoverable_app&&go.safePost("/system_hints/suggestion_cooldown",{requestBody:{system_hint:"connector:".concat(k.id)}});return}}}})}),Xe&&t.jsx(ga,{messages:s,isLastMessageInTurn:r,clientThreadId:o,onRequestCompletion:l})]}):t.jsxs(t.Fragment,{children:[t.jsx(wi,{debugMessages:h}),!Bs&&!0&&t.jsx("span",{className:"group/tool-message",children:t.jsx($n,{highlightedCommand:cs,status:Oe,showWorkUserSetting:!1,accessory:St,labelPrefix:ot,forceExpanded:p===N.UserConfirmation,children:Ft?L!=null&&L.namespace.startsWith("api_tool")?De?null:t.jsx(fa,{isWrite:p===N.UserConfirmation,functionName:(Be=u.recipient)!=null?Be:Te,params:Le,result:lt,toolCallSafetySummary:Et,messages:s,clientThreadId:o,jitPluginData:m!=null?m:{},onRequestCompletion:l,rememberForThisConversation:Y,conversationOrigin:se}):t.jsx(ki,{privacyPolicyUrl:At,name:(Qe=u.recipient)!=null?Qe:Te,params:Le,result:lt,isPromptingForPermission:Oe===Ct.Paused}):null})}),t.jsx("div",{className:"mt-1 flex flex-wrap gap-2 empty:hidden",children:O==null?void 0:O.map(Di)}),V&&p!==N.Denied&&t.jsx(bi,{clientThreadId:o,messages:s,isLastMessageInTurn:r,onRequestCompletion:l}),!De&&rt]})}function Di(a){return t.jsx(ia,{file:a.name,fileId:a.id,width:"wide",alwaysShowData:!0,showDownloadButton:!0,downloadLink:a.download_url,contextConnectorInfo:ho(a.context_connector_info)},a.id)}function Ui(){}function qi(){}function Hi(a){const[e,s]=a;return[e,String(s)]}function Gi(a){return t.jsx("div",{className:"text-xs",children:a})}function Ki(a){return t.jsxs("div",{className:"inline-flex items-center gap-1 text-sm",children:[a,t.jsx(oa,{className:"icon-sm"})]})}function Vi(a){return a.delete("link_success"),a.delete("oauth_success"),a}function Ji(a){return a.delete("oauth_success"),a}export{pl as JITPluginMessage};
//# sourceMappingURL=crwi6jdel6v7mlsn.js.map
