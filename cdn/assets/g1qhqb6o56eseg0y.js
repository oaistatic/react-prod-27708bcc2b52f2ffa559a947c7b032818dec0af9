const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cytm66rgyn54zc1g.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/k65njl5wlgspihfr.js","assets/conversation-small-332fs9rk.css","assets/c3n1o8jzfcramdfc.js"])))=>i.map(i=>d[i]);
var ve=Object.defineProperty,we=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var me=(i,e,s)=>e in i?ve(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s,ne=(i,e)=>{for(var s in e||(e={}))Oe.call(e,s)&&me(i,s,e[s]);if(ce)for(var s of ce(e))_e.call(e,s)&&me(i,s,e[s]);return i},fe=(i,e)=>we(i,ke(e));import{c as je,e as Ne,r as oe,u as ue,f as Ce,j as a,M as ge,_ as Pe}from"./fg33krlcm0qyi6yw.js";import{m as Se,b as Fe,c0 as Le,bh as Ae,p as pe,R as Ve,z as Be,cU as Re,a9 as he,C as Ie}from"./mtk1qztvnb31pw5r.js";import{fS as qe,ds as ze}from"./k65njl5wlgspihfr.js";import{h as We}from"./ikhecou4geu140tb.js";import{c as De,m as o,b as Te}from"./c3n1o8jzfcramdfc.js";const d=Ce({title:{id:"settingsModal.addEmailOtp.title",defaultMessage:"Add email"},instruction:{id:"settingsModal.addEmailOtp.instruction",defaultMessage:"Enter the 6-digit code we just sent to {email}{lineBreak}to verify your mail."},codePlaceholder:{id:"settingsModal.addEmailOtp.codePlaceholder",defaultMessage:"Enter code"},resendPrompt:{id:"settingsModal.addEmailOtp.resendPrompt",defaultMessage:"Didn't get an email?"},resendLink:{id:"settingsModal.addEmailOtp.resendLink",defaultMessage:"Send again"},backLabel:{id:"settingsModal.addEmailOtp.back",defaultMessage:"Back"},verifyLabel:{id:"settingsModal.addEmailOtp.verify",defaultMessage:"Verify"},logoutWarning:{id:"settingsModal.addEmailOtp.logoutWarning",defaultMessage:"Verifying this email will sign you out on all devices so we can finish updating your account. You'll need to sign back in afterward."}}),de=Ae(()=>Pe(()=>import("./cytm66rgyn54zc1g.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(i=>i.AddEmailModal));class xe extends Error{constructor(e){super(e),this.name="OtpValidationError"}}const Ue=(i,e)=>e.length!==6||Number.isNaN(Number(e))?i.formatMessage(o.verifyOtpFailureInvalidFormat):null,$e=(i,e,s)=>{switch(s.status){case 403:throw new Error(i.formatMessage(o.verifyOtpFailureEmailAlreadyLinked,{branch:e?"email":"other",emailValue:e}));case 429:throw new Error(i.formatMessage(o.verifyOtpFailureRateLimited));case 401:case 422:throw new Error(i.formatMessage(o.verifyOtpFailureInvalidOtp));default:return}};function Ze(i){"use forget";const e=je.c(97),{onClose:s,email:r}=i,te=Fe(),t=Ne(),se=Se(),[c,ye]=oe.useState(""),[ae,u]=oe.useState(null);let T;e[0]===Symbol.for("react.memo_cache_sentinel")?(T=[],e[0]=T):T=e[0],oe.useEffect(Ye,T);let g;e[1]!==r||e[2]!==t?(g=async()=>{try{await De(r)}catch(l){const f=l;throw f instanceof pe&&We(t,r,f),new Error(t.formatMessage(o.sendEmailFailure))}},e[1]=r,e[2]=t,e[3]=g):g=e[3];let U,$;e[4]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{u(null)},$=l=>{u(l.message)},e[4]=U,e[5]=$):(U=e[4],$=e[5]);let Y;e[6]!==g?(Y={mutationFn:g,onSuccess:U,onError:$},e[6]=g,e[7]=Y):Y=e[7];const n=ue(Y);let p;e[8]!==c||e[9]!==r||e[10]!==t?(p=async()=>{const l=c.trim(),f=Ue(t,l);if(f)throw new xe(f);try{await Te(r,l)}catch(W){const D=W;throw D instanceof pe&&$e(t,r,D),new Error(t.formatMessage(o.verifyOtpFailure))}try{const W={requestBody:{revoke_authapi_refresh_tokens:!0}};await Ve.safePost("/accounts/logout_all",W)}catch(W){const D=W;throw D instanceof Error?new Error(t.formatMessage(o.verifyOtpFailure)):D}},e[8]=c,e[9]=r,e[10]=t,e[11]=p):p=e[11];let h;e[12]!==t||e[13]!==s||e[14]!==se?(h=()=>{se.success(t.formatMessage(o.verifyOtpSuccess)),s(),Be()},e[12]=t,e[13]=s,e[14]=se,e[15]=h):h=e[15];let x;e[16]!==t?(x=l=>{if(l instanceof xe){u(l.message);return}l instanceof Error?u(l.message):u(t.formatMessage(o.verifyOtpFailure))},e[16]=t,e[17]=x):x=e[17];let G;e[18]!==p||e[19]!==h||e[20]!==x?(G={mutationFn:p,onSuccess:h,onError:x},e[18]=p,e[19]=h,e[20]=x,e[21]=G):G=e[21];const m=ue(G);let H;e[22]===Symbol.for("react.memo_cache_sentinel")?(H=l=>{const f=l.target.value.replace(/\D/g,"").slice(0,6);u(null),ye(f)},e[22]=H):H=e[22];const be=H;let J;e[23]!==te||e[24]!==s?(J=()=>{de.prefetch().then(()=>{Re(te,de),s()})},e[23]=te,e[24]=s,e[25]=J):J=e[25];const ie=J;let K;e[26]===Symbol.for("react.memo_cache_sentinel")?(K={borderBottom:"1px solid var(--border-default, rgba(13, 13, 13, 0.10))"},e[26]=K):K=e[26];let y;e[27]!==t?(y=t.formatMessage(d.title),e[27]=t,e[28]=y):y=e[28];let b;e[29]!==y?(b=a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx("span",{className:"text-token-text-primary text-[20px] leading-[25px] font-medium tracking-tight",children:y})}),e[29]=y,e[30]=b):b=e[30];let M;e[31]!==t?(M=t.formatMessage({id:"settingsModal.addEmailOtp.close",defaultMessage:"Close add email verification modal"}),e[31]=t,e[32]=M):M=e[32];let Q;e[33]===Symbol.for("react.memo_cache_sentinel")?(Q=a.jsx(qe,{className:"h-5 w-5"}),e[33]=Q):Q=e[33];let E;e[34]!==s||e[35]!==M?(E=a.jsx("button",{type:"button",onClick:s,"aria-label":M,className:"text-token-interactive-icon-tertiary-default flex h-5 w-5 items-center justify-center",children:Q}),e[34]=s,e[35]=M,e[36]=E):E=e[36];let v;e[37]!==b||e[38]!==E?(v=a.jsx("div",{className:"border-b",style:K,children:a.jsxs("div",{className:"flex w-full items-start justify-between gap-4 px-6 py-6",children:[b,E]})}),e[37]=b,e[38]=E,e[39]=v):v=e[39];let X;e[40]===Symbol.for("react.memo_cache_sentinel")?(X=a.jsx("br",{}),e[40]=X):X=e[40];let w;e[41]!==r?(w=a.jsx("p",{className:"text-token-text-primary text-[14px] leading-5 font-medium",children:a.jsx(ge,fe(ne({},d.instruction),{values:{email:r,lineBreak:X}}))}),e[41]=r,e[42]=w):w=e[42];let Z;e[43]===Symbol.for("react.memo_cache_sentinel")?(Z=a.jsx("div",{className:"border-token-border-warning bg-token-background-warning text-token-text-warning rounded-lg border px-3 py-2 text-[13px] leading-4",children:a.jsx(ge,ne({},d.logoutWarning))}),e[43]=Z):Z=e[43];let k;e[44]!==t?(k=t.formatMessage({id:"settingsModal.addEmailOtp.codeAria",defaultMessage:"Verification code"}),e[44]=t,e[45]=k):k=e[45];let O;e[46]!==t?(O=t.formatMessage(d.codePlaceholder),e[46]=t,e[47]=O):O=e[47];const le=ae!=null?ae:void 0;let _;e[48]!==c||e[49]!==k||e[50]!==O||e[51]!==le?(_=a.jsx(ze,{ariaLabel:k,name:"verification_code",type:"text",value:c,onChange:be,placeholder:O,className:"bg-primary w-[240px]",inputClassName:"bg-transparent",error:le,autoComplete:"one-time-code",maxLength:6}),e[48]=c,e[49]=k,e[50]=O,e[51]=le,e[52]=_):_=e[52];let j;e[53]!==t?(j=t.formatMessage(d.resendPrompt),e[53]=t,e[54]=j):j=e[54];let N;e[55]!==j?(N=a.jsxs("span",{children:[j," "]}),e[55]=j,e[56]=N):N=e[56];let C;e[57]!==n?(C=()=>n.mutate(),e[57]=n,e[58]=C):C=e[58];const Me=n.isPending;let P;e[59]!==t?(P=t.formatMessage(d.resendLink),e[59]=t,e[60]=P):P=e[60];let S;e[61]!==n.isPending?(S=n.isPending?a.jsx(Le,{className:"text-token-text-accent ms-1 h-3.5 w-3.5"}):null,e[61]=n.isPending,e[62]=S):S=e[62];let F;e[63]!==n.isPending||e[64]!==C||e[65]!==P||e[66]!==S?(F=a.jsxs("button",{type:"button",className:"text-token-text-accent inline-flex items-center hover:underline",onClick:C,disabled:Me,children:[P,S]}),e[63]=n.isPending,e[64]=C,e[65]=P,e[66]=S,e[67]=F):F=e[67];let L;e[68]!==N||e[69]!==F?(L=a.jsxs("div",{className:"text-light-primary text-[14px] leading-5 font-normal",children:[N,F]}),e[68]=N,e[69]=F,e[70]=L):L=e[70];let A;e[71]!==w||e[72]!==_||e[73]!==L?(A=a.jsxs("div",{className:"flex flex-col gap-4 px-6 py-6",children:[w,Z,_,L]}),e[71]=w,e[72]=_,e[73]=L,e[74]=A):A=e[74];let V;e[75]!==t?(V=t.formatMessage(d.backLabel),e[75]=t,e[76]=V):V=e[76];let B;e[77]!==ie||e[78]!==V?(B=a.jsx(he,{color:"secondary",size:"medium",className:"font-normal",type:"button",onClick:ie,children:V}),e[77]=ie,e[78]=V,e[79]=B):B=e[79];let R;e[80]!==m?(R=()=>m.mutate(),e[80]=m,e[81]=R):R=e[81];const Ee=m.isPending,re=m.isPending||c.length!==6;let I;e[82]!==t?(I=t.formatMessage(d.verifyLabel),e[82]=t,e[83]=I):I=e[83];let q;e[84]!==R||e[85]!==re||e[86]!==I||e[87]!==m.isPending?(q=a.jsx(he,{size:"medium",className:"font-normal",type:"button",onClick:R,loading:Ee,disabled:re,children:I}),e[84]=R,e[85]=re,e[86]=I,e[87]=m.isPending,e[88]=q):q=e[88];let z;e[89]!==B||e[90]!==q?(z=a.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-6",children:[B,q]}),e[89]=B,e[90]=q,e[91]=z):z=e[91];let ee;return e[92]!==s||e[93]!==v||e[94]!==A||e[95]!==z?(ee=a.jsxs(Ie,{isOpen:!0,onClose:s,testId:"modal-add-email-otp",showCloseButton:!1,hasSeparator:!1,className:"border-token-border-light bg-token-bg-primary shadow-elevation-03 w-[432px] max-w-full rounded-2xl border",noPadding:!0,modalActionsClassName:"!mt-0",children:[v,A,z]}),e[92]=s,e[93]=v,e[94]=A,e[95]=z,e[96]=ee):ee=e[96],ee}function Ye(){de.prefetch()}export{Ze as AddEmailOtpModal};
//# sourceMappingURL=g1qhqb6o56eseg0y.js.map
