import{E as S,e as B,r as L,j as e,M as r}from"./fg33krlcm0qyi6yw.js";import{H as E,m as D,Z as M,S as N,_ as v,C as I,M as k,b4 as T,a9 as _,T as A,bX as U,b as R}from"./mtk1qztvnb31pw5r.js";import{e6 as F,db as H,dc as z,e7 as K,B as W}from"./k65njl5wlgspihfr.js";import{c as q}from"./n0ab5m1z76n8mazm.js";import"./sy1xvqwioh9ks4z8.js";import"./kzbknm4lxuyoq9wi.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./f5ep9o7usovyn4vf.js";import"./ly75bs3d14n5v622.js";import"./hu1bt0oauegdhua6.js";const G="https://help.openai.com/en/articles/11481834",re=({onClose:o})=>{var j;const[i,u]=S.useState(!1),{prepareCheckoutSession:s,navigateToCheckout:m}=F(),h=R(),t=E(),{country:p}=H(),a=z({country:p,currentAccount:t,location:"CodexCreditPurchaseModal",shouldUsePaidSubscriptionBillingCurrency:!0}),d=(j=t==null?void 0:t.mustGetSubscriptionBillingCurrency("CreditPurchaseModal"))!=null?j:"USD",{data:l,isLoading:x,error:g}=K({ctx:h,currency:d});let n=null;!x&&!g&&l&&(n=l.currencyConfig.amount_per_credit);const f=D(),y=B(),w=L.useCallback(async()=>{if(!i){u(!0);try{const c=t==null?void 0:t.id;if(!c)throw new Error("No account_id found");M.setItem(N.CreditCheckoutRedirectPath,"/codex/settings/usage");const b={credit_purchase_data:{quantity:1e3,unit:"credit",account_id:c},billing_details:a!=null?a:null},P=await s(b);await m(P,{checkoutPayload:b})}catch(c){M.removeItem(N.CreditCheckoutRedirectPath),v.addError(c),f.warning(y.formatMessage({id:"components.business.CreditPurchaseModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."}),{hasCloseButton:!0})}finally{u(!1)}}},[a,y,i,m,s,f,t]);if(a)return e.jsxs(I,{isOpen:!0,onClose:o,type:"success",size:"custom",noPadding:!0,className:"max-w-xl p-6! pt-3!",showCloseButton:!0,testId:"modal-credit-purchase-modal",children:[e.jsx(k.Header,{className:"p-0! pb-4",title:e.jsx(r,{id:"wham.usageDashboard.metric.creditsAddCredits",defaultMessage:"Buy more messages"})}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(r,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription",defaultMessage:"Use Codex beyond rate limits. Add credits to instantly boost your plan. <u>Learn more</u>",values:{u:c=>e.jsx(T,{href:G,openNewTab:!0,children:c})}})}),e.jsx("div",{className:"flex flex-col",children:n&&e.jsx("div",{className:"mt-6",children:e.jsx(O,{numCredits:1e3,amountPerCredit:n,currency:d})})}),e.jsx(k.Actions,{secondaryButton:e.jsx(_,{disabled:i,onClick:o,color:"secondary",children:e.jsx(r,{id:"components.business.CreditPurchaseModal.cancel",defaultMessage:"Cancel"})}),primaryButton:e.jsx(_,{loading:i,onClick:()=>w(),color:"primary",children:e.jsx(r,{id:"components.business.CreditPurchaseModal.next",defaultMessage:"Next"})})})]})};function O({numCredits:o,amountPerCredit:C,currency:i}){var t,p,a,d,l,x,g,n;const u=Math.round(o*C*100)/100,{data:s,isLoading:m,isError:h}=q(o);return e.jsx("div",{className:"flex w-full flex-col",children:e.jsxs("div",{className:"flex w-full items-center justify-between gap-3 rounded-lg border border-gray-200 p-4 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(r,{id:"components.business.CreditPurchaseModal.numCredits",defaultMessage:"{numCredits, plural, one {# credit} other {# credits}}",values:{numCredits:o}})}),e.jsx("span",{className:"flex items-center gap-1",children:h?null:m?e.jsx(W,{className:"h-4 w-48"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.jsx(r,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2",defaultMessage:"{messagesLowerBound}-{messagesUpperBound} CLI or Extension messages",values:{messagesLowerBound:(p=(t=s==null?void 0:s.approx_local_messages)==null?void 0:t[0])!=null?p:0,messagesUpperBound:(d=(a=s==null?void 0:s.approx_local_messages)==null?void 0:a[1])!=null?d:0}})}),e.jsx(A,{label:e.jsxs("div",{className:"text-token-text-primary flex flex-col items-start text-xs",children:[e.jsx("p",{children:e.jsx(r,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2Tooltip1",defaultMessage:"Usage varies by type"})}),e.jsx("p",{children:e.jsx(r,{id:"wham.usageDashboard.metric.creditsAddCreditsDescription2Tooltip2",defaultMessage:"Cloud tasks: {messagesLowerBound}-{messagesUpperBound} messages",values:{messagesLowerBound:(x=(l=s==null?void 0:s.approx_cloud_messages)==null?void 0:l[0])!=null?x:0,messagesUpperBound:(n=(g=s==null?void 0:s.approx_cloud_messages)==null?void 0:g[1])!=null?n:0}})})]}),children:e.jsx(U,{className:"icon-sm text-token-text-tertiary"})})]})})]}),e.jsx("p",{className:"text-token-text-secondary font-medium",children:u.toLocaleString("en-US",{style:"currency",currency:i,maximumFractionDigits:2})})]})})}export{re as CodexCreditPurchaseModal,O as CreditSelectorButtons};
//# sourceMappingURL=efs968cnpzrakhqs.js.map
