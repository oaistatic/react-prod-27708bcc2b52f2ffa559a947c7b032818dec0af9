var O=Object.defineProperty,T=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var f=(e,t,a)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,u=(e,t)=>{for(var a in t||(t={}))U.call(t,a)&&f(e,a,t[a]);if(d)for(var a of d(t))w.call(t,a)&&f(e,a,t[a]);return e},_=(e,t)=>T(e,b(t));import{a0 as A,a1 as C,i as I,r as l,j as L}from"./fg33krlcm0qyi6yw.js";import{m as $,ko as m,kp as R,R as x}from"./mtk1qztvnb31pw5r.js";import{a as P}from"./ci57adu98ddr6ebh.js";const S="chatgpt://oauth_complete";async function y(e,t,a,i){const s=await x.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:e},query:u({code:t,redirect_uri:a},i!=null?{state:i}:{})}});return _(u({},s),{redirect_path:P(s.redirect_path).toString()})}const D=A(function(){const{pluginId:t,code:a,state:i,error:s,errorDesc:c}=C(),o=I(),p=l.useRef(!1);l.useEffect(()=>{if(p.current===!0)return;p.current=!0;async function E(){var g;const k="https://chat.openai.com/aip/".concat(t,"/oauth/callback");try{const r=await y(t,a,k,i);if(r.success)if(r.redirect_path===S)window.location.href=S;else{const n=new URL(m(R.OAUTH_SUCCESS,r.redirect_path),location.origin);n.searchParams.set("oauth_success","true"),o(n.pathname+n.search+n.hash)}else o(m(R.CUSTOM_ERROR,r.redirect_path,(g=r.error)!=null?g:r.message))}catch(r){o({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:t,loginSuccess:"false"}).toString()})}}E()},[t,a,i,o]);const h=$();return l.useEffect(()=>{s&&h.danger("".concat(s).concat(c?": ".concat(c):""),{duration:5,toastId:"oauth_callback: AIPOauth",loggingTitle:s,loggingDescription:c!=null?c:""})},[s,c,h]),L.jsx("div",{})});export{D as default};
//# sourceMappingURL=fekjvcvt7f5u6o27.js.map
