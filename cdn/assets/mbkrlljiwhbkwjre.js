var N=Object.defineProperty;var g=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var p=(a,t,e)=>t in a?N(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,y=(a,t)=>{for(var e in t||(t={}))w.call(t,e)&&p(a,e,t[e]);if(g)for(var e of g(t))P.call(t,e)&&p(a,e,t[e]);return a};import{e as T,r as f,a as k,j as s,M as _}from"./fg33krlcm0qyi6yw.js";import{rZ as B,m as O,r_ as h,gC as o,gE as S,M as m,ix as F,C as A,l as q,r$ as G,T as H,i7 as L,ga as Q}from"./mtk1qztvnb31pw5r.js";function Z({onClose:a,gizmo:t}){var x;const e=T(),[n,M]=f.useState(((x=t==null?void 0:t.gizmo)==null?void 0:x.instructions)||""),r=B(),C=O(),l=k(),d=[];(n==null?void 0:n.length)>h&&d.push(e.formatMessage(o.instructionsTooLong,{length:h})),f.useEffect(()=>{l.invalidateQueries({queryKey:S(l,t.gizmo.id).queryKey})},[t.gizmo.id,l]);const j=i=>{M(i.target.value)},v=()=>{a()},I=async()=>{try{await r.mutateAsync({update:{instructions:n!=null?n:""},id:t.gizmo.id}),a()}catch(i){const u=Q(i);C.danger(u!=null?u:"Error",{duration:2,toastId:"custom_instructions_modal_save_error"})}},b=s.jsx(m.Button,{title:e.formatMessage(o.save),color:"primary",onClick:I,loading:r.isPending,disabled:d.length>0}),E=s.jsx(m.Button,{title:e.formatMessage(o.cancel),color:"secondary",onClick:v,disabled:r.isPending}),{canEdit:c}=F(t);return s.jsx(A,{testId:"modal-project-custom-instructions",className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!r.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:s.jsx("div",{className:"h-8",children:e.formatMessage(o.editCustomInstructionsTitle)}),onClose:()=>{r.isPending||a()},headerAccessory:!c&&s.jsx(H,{label:e.formatMessage(o.viewOnlyCustomInstructionsModalHeaderTooltip),side:"left",align:"center",children:s.jsxs("div",{className:"text-token-text-tertiary flex flex-row items-center gap-1.5 text-sm",children:[s.jsx(L,{className:"icon"}),s.jsx(_,y({},o.viewOnlyCustomInstructionsModalHeaderLabel))]})}),children:s.jsxs("div",{className:"flex h-full flex-col px-4 pt-0 pb-4",children:[s.jsx("div",{className:"text-sm font-medium",children:e.formatMessage(c?o.editCustomInstructionsSubtitle:o.readOnlyCustomInstructionsTitle)}),s.jsx("div",{className:"text-token-text-secondary text-sm",children:e.formatMessage(o.editCustomInstructionsDescription)}),s.jsx("textarea",{autoFocus:!0,placeholder:e.formatMessage(o.projectInstructionsPlaceholder),className:q("focus:ring-token-text-primary border-heavy mt-4 mb-1 min-h-24 w-full grow resize-none overflow-x-clip overflow-y-auto rounded-lg border px-3 py-2 focus:ring-1",c?"bg-transparent":"bg-token-bg-tertiary"),name:"instructions",onChange:j,value:n,disabled:r.isPending||!c}),d.map(i=>s.jsx(G,{className:"mt-1",children:i},i)),c&&s.jsx(m.Actions,{primaryButton:b,secondaryButton:E})]})})}export{Z as CustomInstructionsModal};
//# sourceMappingURL=mbkrlljiwhbkwjre.js.map
