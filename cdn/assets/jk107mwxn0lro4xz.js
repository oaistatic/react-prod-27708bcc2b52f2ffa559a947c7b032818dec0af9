import{r as v,c as S,e as I,j as x}from"./fg33krlcm0qyi6yw.js";import{b as T,r as k}from"./ej6tlexkw0sv7caa.js";import{l as N}from"./mtk1qztvnb31pw5r.js";import{e as j}from"./fmwvxydiodjqi0t8.js";import{C as w}from"./nb22pb07i8ebbv0i.js";function $(s){return v.useMemo(()=>T(s),[s])}function E({selectionRect:s,sheet:e,getRowByVisualIndex:n}){const[l,r]=v.useState(null);return v.useEffect(()=>{if(!s){r(null);return}if(s.r1===s.r2&&s.c1===s.c2){r(null);return}const o=setTimeout(()=>{const{r1:a,c1:t,r2:i,c2:c}=s;let u=0,p=0,m=0,f=!1;for(let d=a;d<=i;d+=1){const b=n(d);for(let h=t;h<=c;h+=1){const g=b==null?void 0:b.cells.find(y=>j(y.address)===h);if(!g||g.value===""||g.value==null)continue;u++;const C=Number(g.value);!Number.isNaN(C)&&g.dataType!==w.CELL_DATA_TYPE_STRING?(m++,p+=C):f=!0}}r({count:u,avg:f||m===0?null:p/m,sum:f||m===0?null:p})},1e3);return()=>clearTimeout(o)},[s,e,n]),l}function A(s){"use forget";const e=S.c(11),{selectionRect:n,sheet:l,getRowByVisualIndex:r}=s,o=I();let a;e[0]!==r||e[1]!==n||e[2]!==l?(a={selectionRect:n,sheet:l,getRowByVisualIndex:r},e[0]=r,e[1]=n,e[2]=l,e[3]=a):a=e[3],E(a);const t=null;let i,c;e[4]!==o||e[5]!==t?(i="text-token-text-secondary ms-3 text-xs whitespace-nowrap",c=t,e[4]=o,e[5]=t,e[6]=i,e[7]=c):(i=e[6],c=e[7]);let u;return e[8]!==i||e[9]!==c?(u=x.jsx("div",{className:i,children:c}),e[8]=i,e[9]=c,e[10]=u):u=e[10],u}function V(s){"use forget";const e=S.c(20),{workbook:n,activeSheetIdx:l,onSheetClick:r,accentStroke:o,selectionRect:a,sheet:t,getRowByVisualIndex:i}=s,c=$(n.theme);let u;if(e[0]!==o||e[1]!==l||e[2]!==r||e[3]!==c||e[4]!==n.sheets){let d;e[6]!==o||e[7]!==l||e[8]!==r||e[9]!==c?(d=(b,h)=>x.jsx(M,{idx:h,sheet:b,accentStroke:o,activeSheetIdx:l,onSheetClick:r,themeMap:c},b.name),e[6]=o,e[7]=l,e[8]=r,e[9]=c,e[10]=d):d=e[10],u=n.sheets.map(d),e[0]=o,e[1]=l,e[2]=r,e[3]=c,e[4]=n.sheets,e[5]=u}else u=e[5];let p;e[11]!==u?(p=x.jsx("div",{className:"flex-1 overflow-x-auto",children:x.jsx("div",{className:"flex flex-row",children:u})}),e[11]=u,e[12]=p):p=e[12];let m;e[13]!==i||e[14]!==a||e[15]!==t?(m=i&&x.jsx(A,{selectionRect:a,sheet:t,getRowByVisualIndex:i}),e[13]=i,e[14]=a,e[15]=t,e[16]=m):m=e[16];let f;return e[17]!==p||e[18]!==m?(f=x.jsxs("div",{className:"bg-token-bg-tertiary border-token-border-heavy flex flex-row items-center border-t p-2 ps-12 pt-0 pb-0",children:[p,m]}),e[17]=p,e[18]=m,e[19]=f):f=e[19],f}function M({idx:s,sheet:e,accentStroke:n,activeSheetIdx:l,onSheetClick:r,themeMap:o}){const a=e.tabColor&&o?k(e.tabColor,o,"transparent"):void 0,t=a!==void 0&&a!=="transparent";return x.jsxs("button",{onClick:()=>r(s),className:N("flex items-center gap-2 border-t-2 px-3 pt-2 pb-3 text-xs font-medium whitespace-nowrap",s===l?"text-token-text-primary font-bold":"text-token-text-secondary hover:text-token-text-primary border-transparent"),style:s===l?{borderTopColor:n}:void 0,children:[t&&x.jsx("span",{"aria-hidden":"true",className:"h-1.5 w-1.5 rounded-[2px]",style:{backgroundColor:a}}),e.name]})}function F(){return v.useMemo(()=>{var l;const s=r=>{const o=r.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\)$/i);if(o)return[parseInt(o[1],10),parseInt(o[2],10),parseInt(o[3],10)];const a=r.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);if(a){const t=a[1];if(t.length===3){const p=parseInt(t[0]+t[0],16),m=parseInt(t[1]+t[1],16),f=parseInt(t[2]+t[2],16);return[p,m,f]}const i=parseInt(t.slice(0,2),16),c=parseInt(t.slice(2,4),16),u=parseInt(t.slice(4,6),16);return[i,c,u]}return null},e=typeof document<"u"?getComputedStyle(document.documentElement).getPropertyValue("--theme-submit-btn-bg").trim():"",n=(l=s(e))!=null?l:[175,82,222];return{accentFill:"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 0.15)"),accentStroke:"rgba(".concat(n[0],", ").concat(n[1],", ").concat(n[2],", 1)")}},[])}export{V as S,$ as a,F as u};
//# sourceMappingURL=jk107mwxn0lro4xz.js.map
