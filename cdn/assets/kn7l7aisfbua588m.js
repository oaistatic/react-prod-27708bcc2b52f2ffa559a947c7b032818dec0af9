var Fs=Object.defineProperty,Ts=Object.defineProperties;var Es=Object.getOwnPropertyDescriptors;var Gt=Object.getOwnPropertySymbols;var Is=Object.prototype.hasOwnProperty,Os=Object.prototype.propertyIsEnumerable;var Yt=(e,t,a)=>t in e?Fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,I=(e,t)=>{for(var a in t||(t={}))Is.call(t,a)&&Yt(e,a,t[a]);if(Gt)for(var a of Gt(t))Os.call(t,a)&&Yt(e,a,t[a]);return e},Z=(e,t)=>Ts(e,Es(t));import{r as P,e as oe,j as s,m as $e,i as ye,b as $s,c as W,M as N,f as ve,aq as at,L as rs,ar as zs,F as Ds,a0 as Bs}from"./fg33krlcm0qyi6yw.js";import{e8 as ls,A as Us,cw as St,ib as Hs,kS as Vs,ab as Ws,ac as Qs,c$ as qs,d4 as Xt,az as Ks,de as Gs,dr as Ys,bq as Xs,uO as Js}from"./k65njl5wlgspihfr.js";import{r as Nt,f as Zs,c as rt,e as is,d as lt,h as ns,i as os,j as it,k as nt,g as _t,l as cs,A as ot,N as Jt,t as ds,m as ms,n as fs}from"./4p7fk9xlp4aux1yu.js";import{E as Oe,i as us,b as ea,g as ta,S as hs,j as sa,k as Mt,h as aa,e as gs,l as ra}from"./dp77n34mztiej9w9.js";import{m as qe,ag as xs,ij as la,l as T,fA as ia,eD as na,ik as oa,H as ca,a9 as He,P as wt,zE as da,zF as ma,c0 as ct,gK as fa,g2 as bt,hA as ua,T as st,aS as ps,zG as ha,hv as ga,kW as xa,b as pa}from"./mtk1qztvnb31pw5r.js";import{i as ya}from"./npp0xpas090zc0qr.js";import{m as va,A as ba}from"./ocjy2hqri2k6d7gs.js";import{T as O}from"./hcn3kohxpjzaoxwc.js";import{A as ka}from"./dcp7peq4y6a4kabz.js";import"./jcfo2542d2wvunuv.js";import"./sy1xvqwioh9ks4z8.js";import"./kzbknm4lxuyoq9wi.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./f5ep9o7usovyn4vf.js";import"./ly75bs3d14n5v622.js";import"./hu1bt0oauegdhua6.js";import"./j37p94g6trtb4j3z.js";import"./lad8yx56mqsdspc9.js";import"./fc76377xmf89lezj.js";import"./bhm7utdivrybcfbl.js";import"./ohquqctluwabmb5i.js";import"./efooahjtdr85x1lo.js";import"./km71i01x6ma5r62b.js";import"./c2cj1dlcffke3f7m.js";import"./hb1mva1gmw4bcs8w.js";import"./mivow98b53y1taf8.js";import"./krwszi9u3lj63i9v.js";import"./e5ksk0bbujs0ac88.js";function Ee(e,t){const r=new URLSearchParams(e).get(t);return!r||r.trim()===""?[]:r.split(",").map(l=>l.trim()).filter(Boolean)}function ja(){const e=$e(),t=ye(),a=xs(),r=a==null?void 0:a.email,{data:l,isLoading:i,error:n}=us(),c=P.useMemo(()=>{const u=la(l==null?void 0:l.items,o=>o.canonical_url);return va(u,o=>Z(I({},o),{label:Nt(o.canonical_url)}))},[l]);return P.useEffect(()=>{const u=new URLSearchParams(e.search);let o=!1;if(!u.size&&!i){const f=(r==null?void 0:r.endsWith("@openai.com"))?["https://github.com/openai/openai"]:[],p=(c!=null?c:[]).map(y=>{var S;return String((S=y.canonical_url)!=null?S:"").trim()}).filter(Boolean),v=ya(f,p);v.length>0&&(u.set("repo",v.join(",")),o=!0)}u.has("recommended")||(u.set("recommended","true"),o=!0),u.has("sort")||(u.set("sort","sev_desc"),o=!0),o&&t({search:"?".concat(u.toString())},{replace:!0})},[e.search,t,r,c,i]),{filters:P.useMemo(()=>{var B,z;const u=new URLSearchParams(e.search),o=new Set(Ee(e.search,"status")),d=new Set(Ee(e.search,"criticality")),f=Ee(e.search,"repo"),p=Ee(e.search,"assignee"),v=Ee(e.search,"path_prefix"),y=(z=(B=u.get("q"))==null?void 0:B.trim())!=null?z:"",S=u.get("validated"),g=u.get("has_patch"),b=S==="true"?"validated":S==="false"?"unvalidated":"all",x=g==="true"?"with_patch":g==="false"?"without_patch":"all",k=u.get("recommended"),_=k===null?!0:k==="true",M=new Set(Array.from(o)),C=new Set(Array.from(d)),j=new Set(f),w=j.size===1?Array.from(j)[0]:"all",A=new Set(p),F=Ee(e.search,"author"),E=new Set(F),H=new Set(v);return{selectedCriticalities:C,securityOnly:!1,privacyOnly:!1,selectedStatuses:M,selectedRepo:w,selectedRepos:j,selectedPathPrefixes:H,keywordQuery:y,recommendedOnly:_,existsInHeadOnly:!1,validationFilter:b,patchFilter:x,selectedAssignees:A,selectedAuthors:E}},[e.search]),onChangeFilters:u=>{const o=new URLSearchParams(e.search),d=u;d.recommendedOnly?o.set("recommended","true"):o.set("recommended","false"),d.selectedRepos&&d.selectedRepos.size>0?o.set("repo",Array.from(d.selectedRepos).join(",")):o.delete("repo"),d.selectedCriticalities&&d.selectedCriticalities.size>0?o.set("criticality",Array.from(d.selectedCriticalities).join(",")):o.delete("criticality"),d.selectedStatuses&&d.selectedStatuses.size>0?o.set("status",Array.from(d.selectedStatuses).join(",")):o.delete("status"),d.validationFilter==="validated"?o.set("validated","true"):d.validationFilter==="unvalidated"?o.set("validated","false"):o.delete("validated"),d.patchFilter==="with_patch"?o.set("has_patch","true"):d.patchFilter==="without_patch"?o.set("has_patch","false"):o.delete("has_patch"),d.selectedAssignees&&d.selectedAssignees.size>0?o.set("assignee",Array.from(d.selectedAssignees).join(",")):o.delete("assignee"),d.selectedAuthors&&d.selectedAuthors.size>0?o.set("author",Array.from(d.selectedAuthors).join(",")):o.delete("author"),d.selectedPathPrefixes&&d.selectedPathPrefixes.size>0?o.set("path_prefix",Array.from(d.selectedPathPrefixes).join(",")):o.delete("path_prefix");const f=d.keywordQuery.trim();f?o.set("q",f):o.delete("q"),t({search:"?".concat(o.toString())},{replace:!0})},accessibleRepos:c,accessibleReposLoading:i,accessibleReposError:n}}const ys=P.createContext(null);function Ma({children:e}){const{filters:t,onChangeFilters:a,accessibleRepos:r,accessibleReposLoading:l,accessibleReposError:i}=ja(),n=qe(),c=oe();return P.useEffect(()=>{if(!i)return;const m=c.formatMessage(Oe.accessibleReposLoad,{details:i.message});n.danger(m)},[i,c,n]),s.jsx(ys.Provider,{value:{filters:t,onChangeFilters:a,accessibleRepos:r,accessibleReposLoading:l,accessibleReposError:i},children:e})}function ze(){const e=P.useContext(ys);if(!e)throw new Error("useAardvarkFiltersContext must be used within AardvarkFiltersProvider");return e}const wa=e=>{const t=e.split(/[\n,]/g).map(a=>a.trim()).filter(Boolean);return Array.from(new Set(t)).join("\n")};function Sa({intl:e,label:t,placeholder:a,helper:r,clearMessage:l,value:i,onChange:n}){const[c,m]=P.useState(i),h=P.useRef(i);P.useEffect(()=>{i!==h.current&&(h.current=i,m(i))},[i]);const u=d=>{const f=d.target.value;m(f);const p=wa(f);h.current=p,n(p)},o=()=>{h.current="",m(""),n("")};return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("textarea",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong min-h-[96px] rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c,onChange:u,placeholder:e.formatMessage(a)}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(r)}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:o,children:e.formatMessage(l)})]})]})}function Na({intl:e,label:t,options:a,selectedValues:r,onToggle:l}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(i=>{const n=r.has(i.value);return s.jsxs("label",{className:T("flex cursor-pointer items-center justify-between px-3 py-2 text-sm transition-colors",n?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsx("span",{className:"flex items-center gap-3",children:i.label}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:n,onChange:()=>l(i.value)})]},i.value)})})]})}function _a(e,t,a=50,r=!0){const l=String(t!=null?t:"").trim(),i=Math.max(1,Math.min(a,500));return $s({queryKey:["aardvark","authors",e||null,l||null,i],queryFn:async()=>{const n=new ea(ia),c={limit:String(i)};e&&e.size>0&&(c.repo=Array.from(e).join(",")),l&&(c.q=l);const m=await n.get("/aardvark/scan-findings/list-authors",{headers:na(),query:c});if(m.status!==200)throw ta(m.status,m.data);return m.data},staleTime:3e4,refetchOnWindowFocus:!0,enabled:r})}function vs({intl:e,label:t,placeholder:a,loadingMessage:r,emptyMessage:l,clearMessage:i,fieldState:n}){const c=n;return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:c.query,onChange:m=>c.setQuery(m.target.value),placeholder:e.formatMessage(a)}),s.jsx("div",{className:"border-token-border-light max-h-48 overflow-y-auto rounded-md border",children:c.isLoading?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:e.formatMessage(r)}):c.options.length===0?s.jsx("div",{className:"text-token-text-tertiary px-3 py-2 text-xs",children:e.formatMessage(l)}):c.options.map(({email:m,label:h,subtitle:u})=>s.jsxs("label",{className:T("border-token-border-subtle flex cursor-pointer items-center justify-between gap-2 border-b px-3 py-2 text-sm last:border-b-0",c.selection.has(m)?"bg-token-main-surface-secondary/60 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col",children:[s.jsx("span",{children:h||m}),u?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:u}):null]}),s.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:c.selection.has(m),onChange:()=>c.toggle(m)})]},m))}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{type:"button",className:"text-token-text-tertiary text-xs underline",onClick:c.clear,children:e.formatMessage(i)})})]})}const Zt=e=>(e!=null?e:"").trim().toLowerCase(),Ca=(e,t)=>{const a=t.trim().toLowerCase();return a?e.filter(({label:r,email:l,subtitle:i})=>"".concat(r," ").concat(l," ").concat(i!=null?i:"").toLowerCase().includes(a)):e};function bs({ctx:e,factory:t,items:a,isFetching:r}){var m;const l=xs(),i=(m=l==null?void 0:l.email)!=null?m:"",n=Zt(i);return{options:P.useMemo(()=>{const h=[];i&&t.selfOptionMessage&&h.push({email:i,label:e.intl.formatMessage(t.selfOptionMessage),subtitle:i});const u=oa(Zs(a.map(o=>{var v,y;const d=(v=o.email)!=null?v:void 0,f=Zt(d);if(!d||!f||f===n)return null;const p=(y=o.name)!=null?y:void 0;return{email:d,label:p||d,subtitle:p?d:void 0,_norm:f}}),Boolean),"_norm");return h.push(...u),h},[e.intl,t.selfOptionMessage,a,i,n]),isLoading:r}}const Aa=(e,t,a)=>{var i;const{data:r,isFetching:l}=_a(e.filters.selectedRepos,t,100,!0);return bs({ctx:e,factory:a,items:(i=r==null?void 0:r.items)!=null?i:[],isFetching:l})},Pa=(e,t,a)=>{var i,n;const{data:r,isFetching:l}=Us((i=e.workspaceId)!=null?i:void 0,0,t,100);return bs({ctx:e,factory:a,items:(n=r==null?void 0:r.items)!=null?n:[],isFetching:l})};function ks({ctx:e,section:t,query:a,setQuery:r,options:l,isLoading:i}){return{query:a,setQuery:r,options:Ca(l,a),isLoading:i,clear:()=>e.setField(t.field,new Set),selection:e.draft[t.field],toggle:n=>e.toggleSetValue(t.field,n)}}function Ra(e){"use forget";const t=W.c(14),{section:a,ctx:r}=e,[l,i]=P.useState(""),n=ls(l,300),{options:c,isLoading:m}=Aa(r,n,a);let h;t[0]!==r||t[1]!==m||t[2]!==c||t[3]!==l||t[4]!==a?(h=ks({ctx:r,section:a,query:l,setQuery:i,options:c,isLoading:m}),t[0]=r,t[1]=m,t[2]=c,t[3]=l,t[4]=a,t[5]=h):h=t[5];const u=h;let o;return t[6]!==r.intl||t[7]!==u||t[8]!==a.clearMessage||t[9]!==a.emptyMessage||t[10]!==a.label||t[11]!==a.loadingMessage||t[12]!==a.placeholder?(o=s.jsx(vs,{intl:r.intl,label:a.label,placeholder:a.placeholder,loadingMessage:a.loadingMessage,emptyMessage:a.emptyMessage,clearMessage:a.clearMessage,fieldState:u}),t[6]=r.intl,t[7]=u,t[8]=a.clearMessage,t[9]=a.emptyMessage,t[10]=a.label,t[11]=a.loadingMessage,t[12]=a.placeholder,t[13]=o):o=t[13],o}function La(e){"use forget";const t=W.c(14),{section:a,ctx:r}=e,[l,i]=P.useState(""),n=ls(l,300),{options:c,isLoading:m}=Pa(r,n,a);let h;t[0]!==r||t[1]!==m||t[2]!==c||t[3]!==l||t[4]!==a?(h=ks({ctx:r,section:a,query:l,setQuery:i,options:c,isLoading:m}),t[0]=r,t[1]=m,t[2]=c,t[3]=l,t[4]=a,t[5]=h):h=t[5];const u=h;let o;return t[6]!==r.intl||t[7]!==u||t[8]!==a.clearMessage||t[9]!==a.emptyMessage||t[10]!==a.label||t[11]!==a.loadingMessage||t[12]!==a.placeholder?(o=s.jsx(vs,{intl:r.intl,label:a.label,placeholder:a.placeholder,loadingMessage:a.loadingMessage,emptyMessage:a.emptyMessage,clearMessage:a.clearMessage,fieldState:u}),t[6]=r.intl,t[7]=u,t[8]=a.clearMessage,t[9]=a.emptyMessage,t[10]=a.label,t[11]=a.loadingMessage,t[12]=a.placeholder,t[13]=o):o=t[13],o}function Fa({intl:e,label:t,options:a,selectedValue:r,onSelect:l}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("div",{className:"border-token-border-light divide-token-border-light mt-3 overflow-hidden rounded-lg border",children:a.map(i=>{const n=r===i.value;return s.jsxs("label",{className:T("flex cursor-pointer items-center justify-between gap-3 px-3 py-2 text-sm transition-colors",n?"bg-token-main-surface-secondary/70 text-token-text-primary":"hover:bg-token-bg-secondary"),children:[s.jsxs("span",{className:"flex flex-col gap-1",children:[s.jsx("span",{className:"font-medium",children:s.jsx(N,I({},i.label))}),i.helper?s.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(i.helper)}):null]}),s.jsx("span",{className:T("flex h-4 w-4 shrink-0 items-center justify-center rounded-full border-2",n?"border-token-text-primary bg-token-text-primary":"border-token-border-light bg-transparent"),"aria-hidden":!0,children:n?s.jsx("span",{className:"bg-token-bg-primary block h-2 w-2 rounded-full"}):null}),s.jsx("input",{type:"radio",className:"sr-only",checked:n,onChange:()=>l(i.value)})]},i.value)})})]})}function Ta({intl:e,label:t,placeholder:a,helper:r,value:l,onChange:i}){return s.jsxs("section",{className:"flex flex-col gap-2",children:[s.jsx("label",{className:"text-token-text-secondary text-sm font-medium",children:e.formatMessage(t)}),s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:l,onChange:n=>i(n.target.value),placeholder:e.formatMessage(a)}),s.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.formatMessage(r)})]})}const dt="text",mt="comma-text",Ve="multiselect",We="singleselect",Qe="searchable-multiselect",Ea=e=>Array.from(e).join("\n");function Ia(e,t){switch(e.kind){case dt:return t[e.field].trim().length>0;case mt:case Qe:case Ve:return t[e.field].size>0;case We:return e.inactiveValue!==void 0?t[e.field]!==e.inactiveValue:!0;default:return!1}}function Oa(e,t,a){switch(e.kind){case dt:{const r=t[e.field].trim();return r?r.length>24?"".concat(r.slice(0,24),"…"):r:null}case mt:case Qe:case Ve:{const r=t[e.field].size;return r===0?null:a.formatMessage(e.summaryMessage,{count:r})}case We:{const r=e.options.find(l=>l.value===t[e.field]);return r?a.formatMessage(r.label):null}default:return null}}function $a(e){"use forget";const t=W.c(44),{section:a,ctx:r}=e;switch(a.kind){case dt:{const l=r.draft[a.field];let i;t[0]!==r||t[1]!==a.field?(i=c=>r.setField(a.field,c),t[0]=r,t[1]=a.field,t[2]=i):i=t[2];let n;return t[3]!==r.intl||t[4]!==a.helper||t[5]!==a.label||t[6]!==a.placeholder||t[7]!==l||t[8]!==i?(n=s.jsx(Ta,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,value:l,onChange:i}),t[3]=r.intl,t[4]=a.helper,t[5]=a.label,t[6]=a.placeholder,t[7]=l,t[8]=i,t[9]=n):n=t[9],n}case mt:{const l=r.draft[a.field];let i;t[10]!==l?(i=Ea(l),t[10]=l,t[11]=i):i=t[11];const n=i;let c;t[12]!==r||t[13]!==a.field?(c=h=>{const u=h?h.split("\n"):[];r.setField(a.field,new Set(u))},t[12]=r,t[13]=a.field,t[14]=c):c=t[14];let m;return t[15]!==r.intl||t[16]!==n||t[17]!==a.clearMessage||t[18]!==a.helper||t[19]!==a.label||t[20]!==a.placeholder||t[21]!==c?(m=s.jsx(Sa,{intl:r.intl,label:a.label,placeholder:a.placeholder,helper:a.helper,clearMessage:a.clearMessage,value:n,onChange:c}),t[15]=r.intl,t[16]=n,t[17]=a.clearMessage,t[18]=a.helper,t[19]=a.label,t[20]=a.placeholder,t[21]=c,t[22]=m):m=t[22],m}case Qe:{let l;return t[23]!==r||t[24]!==a?(l=a.field==="selectedAuthors"?s.jsx(Ra,{section:a,ctx:r}):s.jsx(La,{section:a,ctx:r}),t[23]=r,t[24]=a,t[25]=l):l=t[25],l}case Ve:{const l=r.draft[a.field];let i;t[26]!==r||t[27]!==a.field?(i=c=>{r.toggleSetValue(a.field,c)},t[26]=r,t[27]=a.field,t[28]=i):i=t[28];let n;return t[29]!==r.intl||t[30]!==a.label||t[31]!==a.options||t[32]!==l||t[33]!==i?(n=s.jsx(Na,{intl:r.intl,label:a.label,options:a.options,selectedValues:l,onToggle:i}),t[29]=r.intl,t[30]=a.label,t[31]=a.options,t[32]=l,t[33]=i,t[34]=n):n=t[34],n}case We:{const l=r.draft[a.field];let i;t[35]!==r||t[36]!==a.field?(i=c=>r.setField(a.field,c),t[35]=r,t[36]=a.field,t[37]=i):i=t[37];let n;return t[38]!==r.intl||t[39]!==a.label||t[40]!==a.options||t[41]!==l||t[42]!==i?(n=s.jsx(Fa,{intl:r.intl,label:a.label,options:a.options,selectedValue:l,onSelect:i}),t[38]=r.intl,t[39]=a.label,t[40]=a.options,t[41]=l,t[42]=i,t[43]=n):n=t[43],n}default:return null}}const za=["new","triaged","in_progress","fixed","wontfix","duplicate"],Da=["critical","high","medium","low"],Ba=["all","validated","unvalidated"],Ua=["all","with_patch","without_patch"],es=e=>{const t=e.keywordQuery.trim().length;return{selectedAuthorsCount:e.selectedAuthors.size,selectedAssigneesCount:e.selectedAssignees.size,selectedStatusesCount:e.selectedStatuses.size,selectedCriticalitiesCount:e.selectedCriticalities.size,selectedPathPrefixesCount:e.selectedPathPrefixes.size,keywordLength:t>0?t:void 0,validationFilter:e.validationFilter,patchFilter:e.patchFilter}},L=ve({keywordLabel:{id:"aardvark.filtersPopover.keyword",defaultMessage:"Keyword"},keywordHint:{id:"aardvark.filtersPopover.keyword.hint",defaultMessage:"Matches title, summary, vulnerability text, and analysis details."},keywordPlaceholder:{id:"aardvark.filtersPopover.keyword.placeholder",defaultMessage:"Search vulnerability details…"},navSearchPlaceholder:{id:"aardvark.filtersPopover.nav.search",defaultMessage:"Search filters"},navEmpty:{id:"aardvark.filtersPopover.nav.empty",defaultMessage:"No filters match your search."},navPlaceholder:{id:"aardvark.filtersPopover.nav.placeholder",defaultMessage:"Select a filter from the list to configure it."},directoriesLabel:{id:"aardvark.filtersPopover.directories",defaultMessage:"Directories"},directoriesHint:{id:"aardvark.filtersPopover.directories.hint",defaultMessage:"Separate prefixes with commas or new lines and prefix a value with ! to exclude it. Example: services/auth/, !web/app/"},directoriesPlaceholder:{id:"aardvark.filtersPopover.directories.placeholder",defaultMessage:"services/auth/, web/app/, shared/utils/"},pathsSummary:{id:"aardvark.filtersPopover.directories.summary",defaultMessage:"{count} paths"},clearDirectories:{id:"aardvark.filtersPopover.directories.clear",defaultMessage:"Clear directories"},authorsLabel:{id:"aardvark.filtersPopover.authors",defaultMessage:"Authors"},authorsPlaceholder:{id:"aardvark.filtersPopover.authors.placeholder",defaultMessage:"Search by author email…"},authorsLoading:{id:"aardvark.filtersPopover.authors.loading",defaultMessage:"Loading authors…"},authorsEmpty:{id:"aardvark.filtersPopover.authors.empty",defaultMessage:"No matching authors"},clearAuthors:{id:"aardvark.filtersPopover.authors.clear",defaultMessage:"Clear authors"},authoredByMe:{id:"aardvark.filtersPopover.authors.me",defaultMessage:"Authored by me"},assigneesLabel:{id:"aardvark.filtersPopover.assignees",defaultMessage:"Assignees"},assigneePlaceholder:{id:"aardvark.filtersPopover.assignees.placeholder",defaultMessage:"Search assignees…"},assigneesLoading:{id:"aardvark.filtersPopover.assignees.loading",defaultMessage:"Loading assignees…"},assigneesEmpty:{id:"aardvark.filtersPopover.assignees.empty",defaultMessage:"No matching assignees"},countSummary:{id:"aardvark.filtersPopover.countSummary",defaultMessage:"{count} selected"},clearAssignees:{id:"aardvark.filtersPopover.assignees.clear",defaultMessage:"Clear assignees"},assignedToMe:{id:"aardvark.filtersPopover.assignees.me",defaultMessage:"Assigned to me"},criticalityLabel:{id:"aardvark.filtersPopover.criticality",defaultMessage:"Criticality"},statusLabel:{id:"aardvark.filtersPopover.status",defaultMessage:"Status"},validationLabel:{id:"aardvark.filtersPopover.validation",defaultMessage:"Validation"},validationValidatedDetail:{id:"aardvark.filtersPopover.validation.validated.detail",defaultMessage:"Aardvark was able to trigger the exploit in an isolated sandbox to confirm it’s real."},patchLabel:{id:"aardvark.filtersPopover.patch",defaultMessage:"Patch availability"},patchGeneratedDetail:{id:"aardvark.filtersPopover.patch.generated.detail",defaultMessage:"Shows only findings where Aardvark successfully generated a proposed patch for review."},patchAllOption:{id:"aardvark.filtersPopover.patch.all",defaultMessage:"All findings"},patchWithOption:{id:"aardvark.filtersPopover.patch.with",defaultMessage:"Patch generated"},patchWithoutOption:{id:"aardvark.filtersPopover.patch.without",defaultMessage:"No patch yet"},applyButton:{id:"aardvark.filtersPopover.apply",defaultMessage:"Apply filters"},cancelButton:{id:"aardvark.filtersPopover.cancel",defaultMessage:"Cancel"},clearFiltersButton:{id:"aardvark.filtersPopover.clear",defaultMessage:"Clear filters"}}),Ha={all:{id:"aardvark.filtersPopover.validation.all",defaultMessage:"All findings",description:"Radio label that keeps the validation filter unset so all findings appear."},validated:{id:"aardvark.filtersPopover.validation.validated",defaultMessage:"Validated only",description:"Radio label that filters the list to validated findings only."},unvalidated:{id:"aardvark.filtersPopover.validation.unvalidated",defaultMessage:"Unvalidated only",description:"Radio label that filters the list to unvalidated findings only."}},Va={all:L.patchAllOption,with_patch:L.patchWithOption,without_patch:L.patchWithoutOption},kt=[{kind:dt,id:"keyword",label:L.keywordLabel,field:"keywordQuery",placeholder:L.keywordPlaceholder,helper:L.keywordHint},{kind:mt,id:"directories",label:L.directoriesLabel,field:"selectedPathPrefixes",placeholder:L.directoriesPlaceholder,helper:L.directoriesHint,clearMessage:L.clearDirectories,summaryMessage:L.pathsSummary},{kind:Qe,id:"authors",label:L.authorsLabel,field:"selectedAuthors",placeholder:L.authorsPlaceholder,loadingMessage:L.authorsLoading,emptyMessage:L.authorsEmpty,clearMessage:L.clearAuthors,selfOptionMessage:L.authoredByMe,summaryMessage:L.countSummary},{kind:Qe,id:"assignees",label:L.assigneesLabel,field:"selectedAssignees",placeholder:L.assigneePlaceholder,loadingMessage:L.assigneesLoading,emptyMessage:L.assigneesEmpty,clearMessage:L.clearAssignees,selfOptionMessage:L.assignedToMe,summaryMessage:L.countSummary},{kind:Ve,id:"criticalities",label:L.criticalityLabel,field:"selectedCriticalities",options:Da.map(e=>({value:e,label:s.jsx(rt,{level:e})})),summaryMessage:L.countSummary},{kind:Ve,id:"statuses",label:L.statusLabel,field:"selectedStatuses",options:za.map(e=>({value:e,label:s.jsx(N,I({},hs[e]))})),summaryMessage:L.countSummary},{kind:We,id:"validation",label:L.validationLabel,field:"validationFilter",options:Ba.map(e=>({value:e,label:Ha[e],helper:e==="validated"?L.validationValidatedDetail:void 0})),inactiveValue:"all"},{kind:We,id:"patches",label:L.patchLabel,field:"patchFilter",options:Ua.map(e=>({value:e,label:Va[e],helper:e==="with_patch"?L.patchGeneratedDetail:void 0})),inactiveValue:"all"}];function Wa({isOpen:e,onClose:t}){var M,C;const a=oe(),{filters:r,onChangeFilters:l}=ze(),i=ca(),n=i==null?void 0:i.getWorkspaceId(),c=P.useCallback(()=>{var j,w;return{keywordQuery:(j=r.keywordQuery)!=null?j:"",selectedPathPrefixes:new Set((w=r.selectedPathPrefixes)!=null?w:[]),selectedAuthors:new Set(r.selectedAuthors),selectedAssignees:new Set(r.selectedAssignees),selectedStatuses:new Set(r.selectedStatuses),selectedCriticalities:new Set(r.selectedCriticalities),validationFilter:r.validationFilter,patchFilter:r.patchFilter}},[r]),m=P.useCallback(()=>({keywordQuery:"",selectedPathPrefixes:new Set,selectedAuthors:new Set,selectedAssignees:new Set,selectedStatuses:new Set,selectedCriticalities:new Set,validationFilter:"all",patchFilter:"all"}),[]),[h,u]=P.useState(c),[o,d]=P.useState(""),[f,p]=P.useState((C=(M=kt[0])==null?void 0:M.id)!=null?C:"");P.useEffect(()=>{e&&(u(c()),d(""))},[c,e]);const v=P.useMemo(()=>{const j=o.trim().toLowerCase();return j?kt.filter(w=>a.formatMessage(w.label).toLowerCase().includes(j)):kt},[a,o]);P.useEffect(()=>{var j,w;if(v.length===0){f!==""&&p("");return}v.some(A=>A.id===f)||p((w=(j=v[0])==null?void 0:j.id)!=null?w:"")},[v,f]);const y=P.useMemo(()=>{var j,w;return(w=(j=v.find(A=>A.id===f))!=null?j:v[0])!=null?w:null},[v,f]),S=P.useCallback((j,w)=>{u(A=>Z(I({},A),{[j]:w}))},[]),g=P.useCallback((j,w)=>{u(A=>{const F=new Set(A[j]);return F.has(w)?F.delete(w):F.add(w),Z(I({},A),{[j]:F})})},[]),b=()=>{wt.logStructuredEvent(ma,es(h)),l(I(I({},r),h)),t()},x=()=>{u(c()),d(""),t()},k=()=>{wt.logStructuredEvent(da,es(h)),u(m())},_={draft:h,filters:r,workspaceId:n,setField:S,toggleSetValue:g,intl:a};return s.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:[s.jsxs("div",{className:"border-token-border-subtle w-full shrink-0 border-b pe-0 pb-2 md:w-60 md:border-e md:border-b-0 md:pe-3 md:pb-0",children:[s.jsx("input",{className:"bg-token-bg-secondary text-token-text-primary border-token-border-light focus:border-token-border-strong mb-2 w-full rounded-md border px-3 py-2 text-sm focus:outline-hidden",value:o,onChange:j=>d(j.target.value),placeholder:a.formatMessage(L.navSearchPlaceholder),"aria-label":a.formatMessage(L.navSearchPlaceholder)}),s.jsx("div",{className:"flex max-h-[420px] flex-col gap-1 overflow-y-auto pe-1",children:v.length===0?s.jsx("div",{className:"text-token-text-tertiary rounded-md px-3 py-4 text-xs",children:a.formatMessage(L.navEmpty)}):v.map(j=>{const w=a.formatMessage(j.label),A=j.id===(y==null?void 0:y.id),F=Oa(j,h,a),E=Ia(j,h);return s.jsx("button",{type:"button",className:T("text-token-text-secondary flex flex-col rounded-md px-3 py-2 text-start text-sm transition-colors",A?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"hover:bg-token-bg-secondary"),onClick:()=>p(j.id),children:s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("span",{className:"truncate",children:w}),s.jsxs("div",{className:"flex items-center gap-2",children:[F?s.jsx("span",{className:"text-token-text-tertiary text-[11px]",children:F}):null,E?s.jsx("span",{className:"bg-token-text-secondary inline-block h-2.5 w-2.5 rounded-full","aria-hidden":!0}):null]})]})},j.id)})})]}),s.jsxs("div",{className:"flex min-h-[320px] flex-1 flex-col gap-4",children:[s.jsx("div",{className:"flex-1 overflow-y-auto pe-1",children:y?s.jsx($a,{section:y,ctx:_}):s.jsx("div",{className:"text-token-text-tertiary text-sm",children:a.formatMessage(L.navPlaceholder)})}),s.jsxs("div",{className:"border-token-border-light flex items-center justify-end gap-3 border-t pt-3",children:[s.jsx(He,{color:"ghost",type:"button",onClick:k,children:a.formatMessage(L.clearFiltersButton)}),s.jsx(He,{color:"secondary",type:"button",onClick:x,children:a.formatMessage(L.cancelButton)}),s.jsx(He,{type:"button",onClick:b,children:a.formatMessage(L.applyButton)})]})]})]})}const fe=ve({keyword:{id:"aardvark.filter.summary.keyword",defaultMessage:'contains "{value}"'},directories:{id:"aardvark.filter.summary.directories",defaultMessage:"{count, plural, one {# path} other {# paths}}"},authors:{id:"aardvark.filter.summary.authors",defaultMessage:"is {value}"},assignees:{id:"aardvark.filter.summary.assignees",defaultMessage:"is {value}"},statuses:{id:"aardvark.filter.summary.statuses",defaultMessage:"is {value}"},criticalities:{id:"aardvark.filter.summary.criticalities",defaultMessage:"is {value}"},validation:{id:"aardvark.filter.summary.validation",defaultMessage:"is {value}"},clearAria:{id:"aardvark.filter.summary.clear",defaultMessage:'Clear "{label}" filter chip'},clearIcon:{id:"aardvark.filter.summary.clearIcon",defaultMessage:"×"}}),xe=ve({keyword:{id:"aardvark.filter.summary.title.keyword",defaultMessage:"Keyword"},directories:{id:"aardvark.filter.summary.title.directories",defaultMessage:"Paths"},authors:{id:"aardvark.filter.summary.title.authors",defaultMessage:"Author"},assignees:{id:"aardvark.filter.summary.title.assignees",defaultMessage:"Assignee"},statuses:{id:"aardvark.filter.summary.title.statuses",defaultMessage:"Status"},criticalities:{id:"aardvark.filter.summary.title.criticalities",defaultMessage:"Criticality"},validation:{id:"aardvark.filter.summary.title.validation",defaultMessage:"Validation"},patch:{id:"aardvark.filter.summary.title.patch",defaultMessage:"Patch"}}),Qa=ve({all:{id:"aardvark.filter.summary.validation.all",defaultMessage:"All findings"},validated:{id:"aardvark.filter.summary.validation.validated",defaultMessage:"Validated only"},unvalidated:{id:"aardvark.filter.summary.validation.unvalidated",defaultMessage:"Unvalidated only"}}),qa=ve({all:{id:"aardvark.filter.summary.patch.all",defaultMessage:"All findings"},with_patch:{id:"aardvark.filter.summary.patch.with_patch",defaultMessage:"With patch generated only"},without_patch:{id:"aardvark.filter.summary.patch.without_patch",defaultMessage:"Without patch generated only"}}),Ka=(e,t=30)=>e.length>t?"".concat(e.slice(0,t),"…"):e,tt=e=>e.join(", "),Ga=e=>e.charAt(0).toUpperCase()+e.slice(1);function Ya({renderLayout:e}={}){var d;const t=oe(),{filters:a,onChangeFilters:r}=ze(),[l,i]=P.useState(!1),n=((d=a.keywordQuery)!=null?d:"").trim(),c=P.useMemo(()=>{var p,v,y,S,g,b,x,k,_,M;let f=0;return f+=(v=(p=a.selectedAuthors)==null?void 0:p.size)!=null?v:0,f+=(S=(y=a.selectedAssignees)==null?void 0:y.size)!=null?S:0,f+=(b=(g=a.selectedStatuses)==null?void 0:g.size)!=null?b:0,f+=(k=(x=a.selectedCriticalities)==null?void 0:x.size)!=null?k:0,f+=(M=(_=a.selectedPathPrefixes)==null?void 0:_.size)!=null?M:0,f+=n?1:0,f+=a.existsInHeadOnly?1:0,f+=a.validationFilter!=="all"?1:0,f+=a.patchFilter!=="all"?1:0,f+=a.recommendedOnly?1:0,f},[a,n]),m=P.useMemo(()=>{var x,k,_,M,C,j;const f=[],p=((x=a.keywordQuery)!=null?x:"").trim();p&&f.push({id:"keyword",title:t.formatMessage(xe.keyword),value:t.formatMessage(fe.keyword,{value:Ka(p)}),onClear:()=>r(Z(I({},a),{keywordQuery:""}))});const v=Array.from((k=a.selectedPathPrefixes)!=null?k:[]);v.length>0&&f.push({id:"directories",title:t.formatMessage(xe.directories),value:t.formatMessage(fe.directories,{count:v.length}),onClear:()=>r(Z(I({},a),{selectedPathPrefixes:new Set}))});const y=Array.from((_=a.selectedAuthors)!=null?_:[]);y.length>0&&f.push({id:"authors",title:t.formatMessage(xe.authors),value:t.formatMessage(fe.authors,{value:tt(y)}),onClear:()=>r(Z(I({},a),{selectedAuthors:new Set}))});const S=Array.from((M=a.selectedAssignees)!=null?M:[]);S.length>0&&f.push({id:"assignees",title:t.formatMessage(xe.assignees),value:t.formatMessage(fe.assignees,{value:tt(S)}),onClear:()=>r(Z(I({},a),{selectedAssignees:new Set}))});const g=Array.from((C=a.selectedStatuses)!=null?C:[]);if(g.length>0){const w=g.map(A=>t.formatMessage(hs[A]));f.push({id:"statuses",title:t.formatMessage(xe.statuses),value:t.formatMessage(fe.statuses,{value:tt(w)}),onClear:()=>r(Z(I({},a),{selectedStatuses:new Set}))})}const b=Array.from((j=a.selectedCriticalities)!=null?j:[]);if(b.length>0){const w=b.map(Ga);f.push({id:"criticalities",title:t.formatMessage(xe.criticalities),value:t.formatMessage(fe.criticalities,{value:tt(w)}),onClear:()=>r(Z(I({},a),{selectedCriticalities:new Set}))})}return a.validationFilter!=="all"&&f.push({id:"validation",title:t.formatMessage(xe.validation),value:t.formatMessage(fe.validation,{value:t.formatMessage(Qa[a.validationFilter])}),onClear:()=>r(Z(I({},a),{validationFilter:"all"}))}),a.patchFilter!=="all"&&f.push({id:"patch",title:t.formatMessage(xe.patch),value:t.formatMessage(qa[a.patchFilter]),onClear:()=>r(Z(I({},a),{patchFilter:"all"}))}),f},[a,t,r]),h=s.jsxs(Hs,{open:l,onOpenChange:i,children:[s.jsx(Vs,{asChild:!0,children:s.jsxs("button",{type:"button",className:T("border-token-border-light inline-flex h-9 items-center gap-2 rounded-md border px-3 text-sm font-medium transition-colors",c>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),"aria-label":t.formatMessage({id:"aardvark.filter.dropdown.trigger",defaultMessage:"Filter findings"}),children:[s.jsx("span",{children:t.formatMessage({id:"aardvark.filter.dropdown.label",defaultMessage:"Filter"})}),c>0?s.jsx("span",{className:"bg-token-main-surface-primary/70 text-token-text-primary inline-flex items-center rounded-full px-2 text-xs font-medium",children:t.formatMessage({id:"aardvark.filter.dropdown.count",defaultMessage:"{count}"},{count:c})}):null,s.jsx(St,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]})}),s.jsx(Ws,{children:s.jsx(Qs,{side:"bottom",align:"end",sideOffset:8,collisionPadding:16,className:"border-token-border-light bg-token-bg-primary z-30 max-h-[85vh] w-[min(720px,calc(100vw-16px))] overflow-y-auto rounded-lg border p-4 shadow-2xl sm:max-h-[80vh] sm:w-[min(720px,calc(100vw-32px))]",children:s.jsx(Wa,{isOpen:l,onClose:()=>i(!1)})})})]}),u=m.length>0?s.jsx("div",{className:"flex flex-wrap items-center gap-2",children:m.map(f=>s.jsxs("div",{className:"border-token-border-light bg-token-bg-secondary/80 text-token-text-primary inline-flex items-center gap-2 rounded-full border px-2 py-1 text-xs shadow-sm",children:[s.jsx("span",{className:"text-token-text-tertiary text-[10px] font-semibold tracking-wide uppercase",children:f.title}),s.jsx("span",{className:"text-token-text-primary text-xs",children:f.value}),s.jsx("button",{type:"button",className:"text-token-text-tertiary text-sm",onClick:f.onClear,"aria-label":t.formatMessage(fe.clearAria,{label:"".concat(f.title," ").concat(f.value)}),children:s.jsx("span",{"aria-hidden":"true",children:s.jsx(N,I({},fe.clearIcon))})})]},f.id))}):null,o=u?s.jsx("div",{className:"mt-3",children:u}):null;return e?s.jsx(s.Fragment,{children:e({trigger:h,chips:o})}):s.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-col gap-2 rounded-lg px-2 py-2",children:[s.jsx("div",{className:"flex justify-end",children:h}),o]})}function Xa({variant:e="stacked"}={}){var S;const t=oe(),{filters:a,onChangeFilters:r,accessibleRepos:l,accessibleReposLoading:i}=ze(),[n,c]=P.useState(""),m=e==="inline",h=T("flex items-center text-sm",m?"flex-wrap justify-center gap-2":"mt-4 w-full flex-col items-center gap-3"),u="flex flex-wrap items-center justify-center gap-2",d=(S=P.useMemo(()=>{var g;return Array.from((g=a.selectedRepos)!=null?g:[])},[a.selectedRepos])[0])!=null?S:"",f=P.useMemo(()=>{var b;if(!d)return"";const g=l==null?void 0:l.find(x=>x.canonical_url===d);return(b=g==null?void 0:g.label)!=null?b:d},[d,l]),p=P.useMemo(()=>{var g,b,x,k,_;if(a.recommendedOnly){if(f)return f;const M=(g=l==null?void 0:l[0])==null?void 0:g.label;return M&&M.trim().length>0?M:t.formatMessage({id:"aardvark.filter.recommended.selectRepo",defaultMessage:"Choose a repository"})}return a.selectedRepos&&a.selectedRepos.size>0?a.selectedRepos.size===1?f||t.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(x=(b=a.selectedRepos)==null?void 0:b.size)!=null?x:0}):t.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(_=(k=a.selectedRepos)==null?void 0:k.size)!=null?_:0}):t.formatMessage({id:"aardvark.filter.allRepos.label",defaultMessage:"All repos"})},[a.recommendedOnly,a.selectedRepos,t,f,l]),v=P.useMemo(()=>a.recommendedOnly?t.formatMessage({id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repository"}):t.formatMessage({id:"aardvark.filter.all.repoLabel",defaultMessage:"Repositories"}),[t,a.recommendedOnly]),y=m?s.jsx("span",{className:"sr-only",children:v}):s.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:v});return(l==null?void 0:l.length)===0?s.jsx("div",{className:h,children:s.jsxs("div",{className:u,children:[y,s.jsx("span",{className:"border-token-border-light text-token-text-tertiary inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm",children:i?s.jsxs(s.Fragment,{children:[s.jsx(ct,{className:"text-token-text-tertiary h-4 w-4"}),s.jsx(N,{id:"aardvark.filter.repos.loading",defaultMessage:"Loading repositories..."})]}):s.jsx(N,{id:"aardvark.filter.repos.empty",defaultMessage:"No repositories available"})})]})}):s.jsx("div",{className:h,children:s.jsxs("div",{className:u,children:[y,s.jsxs(fa,{triggerButton:s.jsxs("button",{type:"button",className:T("border-token-border-light inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm transition-colors",m?"min-w-[6rem] px-2.5":"min-w-[11rem]",a.selectedRepos&&a.selectedRepos.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary",m?"shadow-none":null),children:[s.jsx("span",{children:p}),s.jsx(St,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[s.jsx("div",{className:"p-2.5",children:s.jsx(bt.InputItem,{autoFocus:!0,holdFocus:!0,value:n,onChange:g=>c(g.target.value),placeholder:t.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"}),"aria-label":t.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"})})}),a.recommendedOnly?null:s.jsx(bt.MultiSelectCheckboxItem,{checked:!(a.selectedRepos&&a.selectedRepos.size>0),onCheckedChange:()=>r(Z(I({},a),{selectedRepos:new Set,selectedRepo:"all"})),children:t.formatMessage({id:"aardvark.filter.allRepos",defaultMessage:"All repos"})}),(l!=null?l:[]).filter(g=>n?"".concat(g.label," ").concat(g.canonical_url).toLowerCase().includes(n.toLowerCase()):!0).map(g=>{var b;return s.jsx(bt.MultiSelectCheckboxItem,{checked:!!((b=a.selectedRepos)!=null&&b.has(g.canonical_url)),onCheckedChange:()=>{var k,_;const x=new Set(a.selectedRepos);if(x.has(g.canonical_url)?x.delete(g.canonical_url):(a.recommendedOnly&&x.clear(),x.add(g.canonical_url)),a.recommendedOnly){if(x.size===0){const M=(_=(k=l==null?void 0:l[0])==null?void 0:k.canonical_url)!=null?_:"";M&&x.add(M)}else if(x.size>1){const[M]=Array.from(x);x.clear(),M&&x.add(M)}}r(Z(I({},a),{selectedRepos:x,selectedRepo:x.size===1?Array.from(x)[0]:"all"}))},children:g.label},g.canonical_url)})]})]})})}function js({title:e,body:t,tone:a="panel"}){const r=a==="table";return s.jsx("div",{className:T("flex w-full justify-center",!r&&"border-token-border-light bg-token-main-surface-primary ring-token-border-light/60 overflow-hidden rounded-lg border p-4 shadow ring-1 shadow-black/20 md:p-5 dark:shadow-black/60 dark:ring-white/10"),children:s.jsxs("div",{className:T("flex flex-col items-center text-center",r?"gap-2":"gap-3"),children:[s.jsx("div",{className:T("bg-token-main-surface-tertiary/70 text-token-text-tertiary flex items-center justify-center rounded-full",r?"h-10 w-10":"h-12 w-12"),children:s.jsx(ua,{className:"icon","aria-hidden":!0})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-token-text-primary text-base font-semibold",children:e}),s.jsx("p",{className:"text-token-text-secondary text-sm leading-6",children:t})]})]})})}const ne="items-center min-h-16 px-3 py-3",ue="text-token-text-tertiary text-sm font-semibold",ts="break-all",ss=2,jt=ve({copyLink:{id:"aardvark.findings.copyLink",defaultMessage:"Copy link"},copyLinkSuccess:{id:"aardvark.findings.copyLinkSuccess",defaultMessage:"Link copied"}});function Ja(){"use forget";var Ct,At,Pt,Rt,Lt,Ft;const e=W.c(114),t=oe(),a=qe(),r=ye(),l=$e();let i;e[0]!==l.search?(i=new URLSearchParams(l.search),e[0]=l.search,e[1]=i):i=e[1];const n=i;let c;e[2]!==n?(c=((Ct=n.get("limit"))!=null?Ct:"").toLowerCase(),e[2]=n,e[3]=c):c=e[3];const m=c;let h;e[4]!==n?(h=n.get("cursor"),e[4]=n,e[5]=h):h=e[5];const u=h,o=new Set(["10","20","50","100"]),d=Number(m);let f;e[6]!==m||e[7]!==d?(f=o.has(m)&&Number.isFinite(d)?d:50,e[6]=m,e[7]=d,e[8]=f):f=e[8];const p=f,v=u?Number(u):NaN;let y;e[9]!==v?(y=Number.isFinite(v)?Math.max(0,v):0,e[9]=v,e[10]=y):y=e[10];const S=y,g=p;let b;e[11]!==S||e[12]!==p?(b={limit:p,cursor:S},e[11]=S,e[12]=p,e[13]=b):b=e[13];const x=sa(l.search,b);let k,_;e[14]!==x.error||e[15]!==t||e[16]!==a?(k=()=>{if(x.error){const $=t.formatMessage(Oe.findingsLoad,{details:x.error.message});a.danger($)}},_=[x.error,t,a],e[14]=x.error,e[15]=t,e[16]=a,e[17]=k,e[18]=_):(k=e[17],_=e[18]),P.useEffect(k,_);let M;e[19]!==((At=x.data)==null?void 0:At.items)?(M=(Rt=(Pt=x.data)==null?void 0:Pt.items)!=null?Rt:[],e[19]=(Lt=x.data)==null?void 0:Lt.items,e[20]=M):M=e[20];const C=M,j=(Ft=x.data)==null?void 0:Ft.total,w=typeof j=="number"?j:C.length,A=S,F=x.isLoading,E=Math.max(1,Math.ceil(w/g)),H=Math.min(Math.max(1,Math.floor(A/g)+1),E);let V;e[21]!==C?(V=C.some(rr),e[21]=C,e[22]=V):V=e[22];const B=V,z=B?9:8;let ee;e[23]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx(Ya,{renderLayout:ar}),e[23]=ee):ee=e[23];let he;e[24]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(O.HeaderCell,{className:T("w-10 px-4 py-3 pe-2 text-start",ue),children:s.jsx(N,{id:"aardvark.findings.number",defaultMessage:"#"})}),e[24]=he):he=e[24];let ie;e[25]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx(O.HeaderCell,{className:T("max-w-100 px-4 py-3 ps-2 text-start",ue),children:s.jsx(N,{id:"aardvark.table.repoAndPathsHeader",defaultMessage:"Repository & paths"})}),e[25]=ie):ie=e[25];let ae;e[26]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(N,{id:"aardvark.table.criticality",defaultMessage:"Criticality"})}),e[26]=ae):ae=e[26];let q;e[27]!==B||e[28]!==t?(q=B&&s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(st,{label:t.formatMessage({id:"aardvark.table.adjustedCriticality.tooltip",defaultMessage:"Criticality after attack-path analysis and policy adjustments, when available."}),children:s.jsx("span",{children:s.jsx(N,{id:"aardvark.table.adjustedCriticality",defaultMessage:"Adjusted criticality"})})})}),e[27]=B,e[28]=t,e[29]=q):q=e[29];let te;e[30]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(N,{id:"aardvark.table.vulnerability",defaultMessage:"Vulnerability"})}),e[30]=te):te=e[30];let Q;e[31]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(N,{id:"aardvark.table.statusHeader",defaultMessage:"Status"})}),e[31]=Q):Q=e[31];let K;e[32]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(N,{id:"aardvark.table.assigneeHeader",defaultMessage:"Assignee"})}),e[32]=K):K=e[32];let G;e[33]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue),children:s.jsx(N,{id:"aardvark.table.timestampsHeader",defaultMessage:"Timestamps"})}),e[33]=G):G=e[33];let Y;e[34]===Symbol.for("react.memo_cache_sentinel")?(Y=s.jsx(O.HeaderCell,{className:T("px-4 py-3",ue)}),e[34]=Y):Y=e[34];let X;e[35]!==q?(X=s.jsxs(O.Header,{children:[he,ie,ae,q,te,Q,K,G,Y]}),e[35]=q,e[36]=X):X=e[36];let re;e[37]!==z||e[38]!==B||e[39]!==t||e[40]!==F||e[41]!==l.search||e[42]!==r||e[43]!==C||e[44]!==A||e[45]!==a?(re=F?s.jsx(O.Row,{children:s.jsx(O.Cell,{colSpan:z,divClassName:ne,children:s.jsx("div",{className:"flex h-full w-full items-center justify-center",children:s.jsx(ct,{className:"text-token-text-tertiary h-6 w-6"})})})}):C.length===0?s.jsx(O.Row,{children:s.jsx(O.Cell,{colSpan:z,divClassName:T(ne,"py-6"),children:s.jsx(js,{tone:"table",title:s.jsx(N,{id:"aardvark.table.emptyFindings",defaultMessage:"No findings to show"}),body:s.jsx(N,{id:"aardvark.table.emptyFindings.details",defaultMessage:"When we detect potential issues in your code, they'll appear here. Try adjusting your filters or check back later."})})})}):C.map(($,se)=>{var $t,zt,Dt,Bt,Ut,Ht,Vt,Wt,Qt,qt,Kt;const de=(zt=($t=$.hid)!=null?$t:$.id)!=null?zt:"",Ze=is($),Ss=Ze.slice(0,ss),Ns=Ze.length>ss,Tt=lt(ns($)),Et=lt(os($)),gt=it(Tt),xt=it(Et),pt=nt(t,Tt),yt=nt(t,Et),_s=Ze.length>0,Cs=_t($),As=cs({intl:t,signals:Cs,badgeSize:"sm"}),It=(Ht=(Ut=(Dt=$.commit_analysis)==null?void 0:Dt.title)!=null?Ut:(Bt=$.commit_analysis)==null?void 0:Bt.description)!=null?Ht:"",Te=$.commit_analysis,Ot=(Qt=(Wt=Te==null?void 0:Te.attack_path_final_criticality)!=null?Wt:(Vt=Te==null?void 0:Te.attack_path_analysis)==null?void 0:Vt.adjusted_criticality_final)!=null?Qt:null,Be=de?"/aardvark/findings/".concat(encodeURIComponent(de)):null,pe=Be?"".concat(Be).concat(l.search||""):null,Ps=()=>{pe&&window.open(pe,"_blank","noopener,noreferrer")},Rs=me=>{var et,vt;if(!pe)return;const Ue=me.metaKey||me.ctrlKey;if(wt.logStructuredEvent(ha,{findingId:de||void 0,status:(et=$.status)!=null?et:void 0,criticality:(vt=$.criticality)!=null?vt:void 0,openInNewTab:Ue}),Ue){me.preventDefault(),Ps();return}r(pe)},Ls=async me=>{if(me.stopPropagation(),!Be)return;const Ue=typeof window<"u"?window.location.origin:"",et=Ue?"".concat(Ue).concat(Be):Be;try{await ga(et,a,me),a.successNeutral(t.formatMessage(jt.copyLinkSuccess),{duration:3})}catch(vt){}};return s.jsxs(O.Row,{className:"group/row hover:bg-token-bg-secondary/60 border-token-border-light min-h-14 cursor-pointer border-b text-sm transition-colors last:border-b-0",onClick:Rs,children:[s.jsx(O.Cell,{divClassName:T(ne,"text-start pe-2 text-token-text-tertiary tabular-nums"),children:A+se+1}),s.jsx(O.Cell,{divClassName:T(ne,"text-start max-w-100"),children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("span",{className:"text-token-text-primary font-medium",children:Nt((qt=$.repo_url)!=null?qt:"")||t.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})}),s.jsx("div",{children:_s?s.jsx(st,{label:Ze.join("\n"),children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[Ss.map(me=>s.jsx(ot,{variant:"neutral",size:"sm",className:ts,children:me},"".concat(me.toLowerCase(),"-").concat(se))),Ns&&s.jsx(ot,{variant:"neutral",size:"sm",className:ts,children:s.jsx(N,{id:"aardvark.table.more",defaultMessage:"..."})})]})}):s.jsx("span",{className:"text-token-text-tertiary mt-1 inline-block text-xs",children:s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})})]})}),s.jsx(O.Cell,{divClassName:ne,children:s.jsx(rt,{level:$.criticality})}),B&&s.jsx(O.Cell,{divClassName:ne,children:Jt(Ot)?s.jsx(rt,{level:(Kt=Jt(Ot))!=null?Kt:"low"}):s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})}),s.jsx(O.Cell,{divClassName:T(ne,"max-w-100"),children:s.jsxs("div",{className:"flex flex-col gap-2 text-start",children:[s.jsx("span",{className:"text-token-text-primary font-medium",title:It,children:ds(It,140)}),As]})}),s.jsx(O.Cell,{divClassName:T(ne,"text-start"),children:s.jsx("div",{onClick:sr,children:s.jsx(ms,{finding:$})})}),s.jsx(O.Cell,{divClassName:T(ne,"text-start"),children:s.jsx("div",{onClick:tr,children:s.jsx(fs,{finding:$})})}),s.jsx(O.Cell,{divClassName:T(ne,"text-start"),children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("div",{className:"flex flex-row gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-sm font-semibold",children:s.jsx(N,I({},Mt.committedHeader))}),s.jsx("span",{className:"text-token-text-primary text-sm",title:pt!=null?pt:void 0,children:gt?s.jsx(at,{value:gt.value,unit:gt.unit,numeric:"auto"}):s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})]}),s.jsxs("div",{className:"flex flex-row gap-2",children:[s.jsx("span",{className:"text-token-text-tertiary text-sm font-semibold",children:s.jsx(N,I({},Mt.detectedHeader))}),s.jsx("span",{className:"text-token-text-primary text-sm",title:yt!=null?yt:void 0,children:xt?s.jsx(at,{value:xt.value,unit:xt.unit,numeric:"auto"}):s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})]})]})}),s.jsx(O.Cell,{divClassName:ne,children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(st,{label:t.formatMessage(jt.copyLink),sideOffset:8,children:s.jsx("button",{type:"button",onClick:Ls,className:T("inline-flex h-9 w-9 items-center justify-center rounded-full transition-colors",de?"text-token-text-primary hover:bg-token-main-surface-secondary":"text-token-text-tertiary pointer-events-none"),"aria-label":t.formatMessage(jt.copyLink),children:s.jsx(qs,{className:"icon-sm","aria-hidden":!0})})}),s.jsxs(rs,{to:pe!=null?pe:"#",onClick:er,className:T("inline-flex h-9 w-9 items-center justify-center rounded-full text-sm transition-colors",de?"text-token-text-primary hover:bg-token-main-surface-secondary":"text-token-text-tertiary pointer-events-none"),children:[s.jsx("span",{className:"sr-only",children:s.jsx(N,{id:"aardvark.table.viewButton",defaultMessage:"View"})}),s.jsx(ps,{className:"icon-sm","aria-hidden":!0})]})]})})]},"".concat(de||"finding","-").concat(se))}),e[37]=z,e[38]=B,e[39]=t,e[40]=F,e[41]=l.search,e[42]=r,e[43]=C,e[44]=A,e[45]=a,e[46]=re):re=e[46];let le;e[47]!==re?(le=s.jsx(O.Body,{children:re}),e[47]=re,e[48]=le):le=e[48];let J;e[49]!==X||e[50]!==le?(J=s.jsxs(O.Root,{className:"overflow-x-auto",disableScroll:!0,children:[X,le]}),e[49]=X,e[50]=le,e[51]=J):J=e[51];const ce="border-token-border-light flex items-center justify-between border-t px-4 py-3 ".concat(F?"animate-pulse blur-[1px]":""),R=C.length===0?0:A+1,U=C.length===0?0:Math.min(A+C.length,w);let D;e[52]!==R||e[53]!==U||e[54]!==w?(D=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(N,{id:"aardvark.findings.range",defaultMessage:"{from}-{to} of {total} results",values:{from:R,to:U,total:w}})}),e[52]=R,e[53]=U,e[54]=w,e[55]=D):D=e[55];let ge;e[56]===Symbol.for("react.memo_cache_sentinel")?(ge=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"rows-per-page",children:s.jsx(N,{id:"aardvark.pagination.rowsPerPage",defaultMessage:"Rows per page"})}),e[56]=ge):ge=e[56];const De=String(g);let be;e[57]!==l.search||e[58]!==r?(be=$=>{const se=new URLSearchParams(l.search);se.set("limit",$),se.set("cursor","0"),r({search:"?".concat(se.toString())},{replace:!0})},e[57]=l.search,e[58]=r,e[59]=be):be=e[59];let Ke;e[60]===Symbol.for("react.memo_cache_sentinel")?(Ke=[{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],e[60]=Ke):Ke=e[60];let ke;e[61]!==De||e[62]!==be?(ke=s.jsx(Xt,{triggerId:"rows-per-page",triggerClassName:"min-w-[84px]",contentClassName:"!min-w-[84px]",value:De,onValueChange:be,options:Ke}),e[61]=De,e[62]=be,e[63]=ke):ke=e[63];let Ge;e[64]===Symbol.for("react.memo_cache_sentinel")?(Ge=s.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"page-select",children:s.jsx(N,{id:"aardvark.pagination.page",defaultMessage:"Page"})}),e[64]=Ge):Ge=e[64];const ft=String(H);let je;e[65]!==l.search||e[66]!==r||e[67]!==E||e[68]!==g?(je=$=>{const se=Math.min(Math.max(1,Number($)),E),de=new URLSearchParams(l.search);de.set("cursor",String((se-1)*g)),r({search:"?".concat(de.toString())},{replace:!0})},e[65]=l.search,e[66]=r,e[67]=E,e[68]=g,e[69]=je):je=e[69];let Me;e[70]!==E?(Me=Array.from({length:E},Za),e[70]=E,e[71]=Me):Me=e[71];let we;e[72]!==ft||e[73]!==je||e[74]!==Me?(we=s.jsx(Xt,{triggerId:"page-select",triggerClassName:"min-w-[72px]",contentClassName:"!min-w-[72px]",value:ft,onValueChange:je,options:Me}),e[72]=ft,e[73]=je,e[74]=Me,e[75]=we):we=e[75];let Se;e[76]!==E?(Se=s.jsx("span",{className:"text-token-text-tertiary text-xs",children:s.jsx(N,{id:"aardvark.pagination.of",defaultMessage:"of {count}",values:{count:E}})}),e[76]=E,e[77]=Se):Se=e[77];let Ne;e[78]!==we||e[79]!==Se?(Ne=s.jsxs(s.Fragment,{children:[Ge,we,Se]}),e[78]=we,e[79]=Se,e[80]=Ne):Ne=e[80];const ut=F||H<=1;let _e;e[81]!==l.search||e[82]!==r||e[83]!==g||e[84]!==H?(_e=()=>{const $=Math.max(1,H-1),se=new URLSearchParams(l.search);se.set("cursor",String(($-1)*g)),r({search:"?".concat(se.toString())},{replace:!0})},e[81]=l.search,e[82]=r,e[83]=g,e[84]=H,e[85]=_e):_e=e[85];let Ye;e[86]===Symbol.for("react.memo_cache_sentinel")?(Ye=s.jsx(N,{id:"aardvark.pagination.prev",defaultMessage:"Previous"}),e[86]=Ye):Ye=e[86];let Ce;e[87]!==ut||e[88]!==_e?(Ce=s.jsx(He,{as:"button",size:"small",color:"secondary",disabled:ut,onClick:_e,children:Ye}),e[87]=ut,e[88]=_e,e[89]=Ce):Ce=e[89];const ht=F||H>=E;let Ae;e[90]!==l.search||e[91]!==r||e[92]!==E||e[93]!==g||e[94]!==H?(Ae=()=>{const $=Math.min(E,H+1),se=new URLSearchParams(l.search);se.set("cursor",String(($-1)*g)),r({search:"?".concat(se.toString())},{replace:!0})},e[90]=l.search,e[91]=r,e[92]=E,e[93]=g,e[94]=H,e[95]=Ae):Ae=e[95];let Xe;e[96]===Symbol.for("react.memo_cache_sentinel")?(Xe=s.jsx(N,{id:"aardvark.pagination.next",defaultMessage:"Next"}),e[96]=Xe):Xe=e[96];let Pe;e[97]!==ht||e[98]!==Ae?(Pe=s.jsx(He,{as:"button",size:"small",color:"secondary",disabled:ht,onClick:Ae,children:Xe}),e[97]=ht,e[98]=Ae,e[99]=Pe):Pe=e[99];let Re;e[100]!==Ce||e[101]!==Pe?(Re=s.jsxs("div",{className:"flex items-center gap-2",children:[Ce,Pe]}),e[100]=Ce,e[101]=Pe,e[102]=Re):Re=e[102];let Le;e[103]!==ke||e[104]!==Ne||e[105]!==Re?(Le=s.jsxs("div",{className:"flex items-center gap-3",children:[ge,ke,Ne,Re]}),e[103]=ke,e[104]=Ne,e[105]=Re,e[106]=Le):Le=e[106];let Fe;e[107]!==ce||e[108]!==D||e[109]!==Le?(Fe=s.jsxs("div",{className:ce,children:[D,Le]}),e[107]=ce,e[108]=D,e[109]=Le,e[110]=Fe):Fe=e[110];let Je;return e[111]!==J||e[112]!==Fe?(Je=s.jsxs("div",{className:"mx-auto w-full",children:[ee,s.jsxs("div",{className:"border-token-border-light bg-token-main-surface-primary overflow-hidden rounded-2xl border",children:[J,Fe]})]}),e[111]=J,e[112]=Fe,e[113]=Je):Je=e[113],Je}function Za(e,t){return{label:String(t+1),value:String(t+1)}}function er(e){return e.stopPropagation()}function tr(e){return e.stopPropagation()}function sr(e){return e.stopPropagation()}function ar(e){const{trigger:t,chips:a}=e;return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"mb-5",children:[s.jsxs("div",{className:"mb-3 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsx(lr,{}),s.jsx("div",{className:"flex justify-end",children:t})]}),a]})})}function rr(e){const{hasAttackPath:t}=_t(e);return t}function lr(){"use forget";var y,S,g,b,x;const e=W.c(28),t=oe(),a=ye(),r=$e();let l,i,n,c,m,h,u;if(e[0]!==t||e[1]!==r.search||e[2]!==a){const M=((y=new URLSearchParams(r.search).get("sort"))!=null?y:"sev_desc,date_desc").split(",").map(dr).filter(Boolean),C=(S=M[0])!=null?S:"sev_desc",j=(g=M.find(cr))!=null?g:"sev_desc",w=(b=M.find(or))!=null?b:"commit_date_desc",A=(x=M.find(nr))!=null?x:"date_desc";let F;e[10]!==r.search||e[11]!==a?(F=(B,z)=>{const ee=new URLSearchParams(r.search);ee.set("sort","".concat(B,",").concat(z)),a({search:"?".concat(ee.toString())},{replace:!0})},e[10]=r.search,e[11]=a,e[12]=F):F=e[12];const E=F,H=()=>{const z=C.startsWith("sev")&&j==="sev_desc"?"sev_asc":"sev_desc";E(z,"date_desc")},V=()=>{const z=C.startsWith("commit_date")&&w==="commit_date_desc"?"commit_date_asc":"commit_date_desc";E(z,"sev_desc")};u=()=>{const z=C.startsWith("date")&&A==="date_desc"?"date_asc":"date_desc";E(z,"sev_desc")},m={id:"severity",label:t.formatMessage({id:"aardvark.table.criticality",defaultMessage:"Criticality"}),isActive:C.startsWith("sev"),direction:j.endsWith("_asc")?"asc":"desc",onClick:H},h={id:"commit_date",label:t.formatMessage({id:"aardvark.table.committedDateHeader",defaultMessage:"Committed date"}),isActive:C.startsWith("commit_date"),direction:w.endsWith("_asc")?"asc":"desc",onClick:V},l="detected_date",e[13]!==t?(i=t.formatMessage({id:"aardvark.table.detectedDateHeader",defaultMessage:"Detected date"}),e[13]=t,e[14]=i):i=e[14],n=C.startsWith("date"),c=A.endsWith("_asc")?"asc":"desc",e[0]=t,e[1]=r.search,e[2]=a,e[3]=l,e[4]=i,e[5]=n,e[6]=c,e[7]=m,e[8]=h,e[9]=u}else l=e[3],i=e[4],n=e[5],c=e[6],m=e[7],h=e[8],u=e[9];let o;e[15]!==l||e[16]!==i||e[17]!==n||e[18]!==c||e[19]!==u?(o={id:l,label:i,isActive:n,direction:c,onClick:u},e[15]=l,e[16]=i,e[17]=n,e[18]=c,e[19]=u,e[20]=o):o=e[20];let d;e[21]!==m||e[22]!==h||e[23]!==o?(d=[m,h,o],e[21]=m,e[22]=h,e[23]=o,e[24]=d):d=e[24];const f=d;let p;e[25]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx("span",{children:s.jsx(N,{id:"aardvark.table.sortByLabel",defaultMessage:"Sort by"})}),e[25]=p):p=e[25];let v;return e[26]!==f?(v=s.jsxs("div",{className:"text-token-text-tertiary flex flex-wrap items-center gap-3 text-sm font-semibold",children:[p,s.jsx("div",{className:"flex flex-wrap gap-2 text-sm normal-case",children:f.map(ir)})]}),e[26]=f,e[27]=v):v=e[27],v}function ir(e){return s.jsx(mr,I({},e),e.id)}function nr(e){return e.startsWith("date")}function or(e){return e.startsWith("commit_date")}function cr(e){return e.startsWith("sev")}function dr(e){return e.trim()}function mr(e){"use forget";const t=W.c(13),{label:a,isActive:r,direction:l,onClick:i}=e,n=r?"border-token-border-strong bg-token-main-surface-secondary text-token-text-primary shadow-sm":"border-token-border-light text-token-text-tertiary hover:text-token-text-primary";let c;t[0]!==n?(c=T("inline-flex items-center gap-1 rounded-full border px-3 py-1 text-sm font-medium transition-colors",n),t[0]=n,t[1]=c):c=t[1];let m;t[2]!==a?(m=s.jsx("span",{children:a}),t[2]=a,t[3]=m):m=t[3];const h=l==="asc"&&"rotate-180";let u;t[4]!==h?(u=T("icon-xs transition-transform",h),t[4]=h,t[5]=u):u=t[5];let o;t[6]!==u?(o=s.jsx(St,{className:u,"aria-hidden":!0}),t[6]=u,t[7]=o):o=t[7];let d;return t[8]!==i||t[9]!==c||t[10]!==m||t[11]!==o?(d=s.jsxs("button",{type:"button",className:c,onClick:i,children:[m,o]}),t[8]=i,t[9]=c,t[10]=m,t[11]=o,t[12]=d):d=t[12],d}const Ie=ve({title:{id:"aardvark.findings.accessibleRepos.refresh.title",defaultMessage:"Only showing findings from repositories you have connected. Refresh to see recently connected repositories in the dropdown."},refresh:{id:"aardvark.findings.accessibleRepos.refresh.cta",defaultMessage:"Refresh"},refreshing:{id:"aardvark.findings.accessibleRepos.refresh.loading",defaultMessage:"Refreshing..."},success:{id:"aardvark.findings.accessibleRepos.refresh.success",defaultMessage:"Refreshed repository dropdown with latest connected repositories."},error:{id:"aardvark.findings.accessibleRepos.refresh.error",defaultMessage:"Failed to refresh repositories: {details}"},manageRepos:{id:"aardvark.findings.accessibleRepos.refresh.manage",defaultMessage:"Manage connected repos"}});function fr(e){"use forget";const t=W.c(21),{className:a}=e,r=oe(),l=qe(),i=aa(),[n,c]=P.useState(!1);let m;t[0]!==r||t[1]!==n||t[2]!==i||t[3]!==l?(m=async()=>{if(!n){c(!0);try{await i(!0),l.success(r.formatMessage(Ie.success)),c(!1)}catch(S){const b=gs(S);l.danger(r.formatMessage(Ie.error,{details:b})),c(!1)}}},t[0]=r,t[1]=n,t[2]=i,t[3]=l,t[4]=m):m=t[4];const h=m;let u;t[5]!==a?(u=T("flex w-full flex-col items-center text-center",a),t[5]=a,t[6]=u):u=t[6];let o;t[7]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(ur,{}),t[7]=o):o=t[7];let d;t[8]!==r||t[9]!==n?(d=r.formatMessage(n?Ie.refreshing:Ie.refresh),t[8]=r,t[9]=n,t[10]=d):d=t[10];let f;t[11]!==h||t[12]!==n||t[13]!==d?(f=s.jsx(hr,{label:d,onClick:h,disabled:n}),t[11]=h,t[12]=n,t[13]=d,t[14]=f):f=t[14];let p;t[15]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx(gr,{}),t[15]=p):p=t[15];let v;t[16]!==f?(v=s.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[f,p]}),t[16]=f,t[17]=v):v=t[17];let y;return t[18]!==u||t[19]!==v?(y=s.jsxs("div",{className:u,children:[o,v]}),t[18]=u,t[19]=v,t[20]=y):y=t[20],y}function ur(){return s.jsxs("div",{className:"text-token-text-secondary flex items-center justify-center gap-2 text-sm leading-5",children:[s.jsx(Ks,{className:"icon","aria-hidden":!0}),s.jsx(N,I({},Ie.title))]})}const Ms="text-token-text-primary hover:text-token-text-secondary disabled:text-token-text-tertiary inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold disabled:cursor-not-allowed";function hr({label:e,onClick:t,disabled:a}){return s.jsxs("button",{type:"button",onClick:t,disabled:a,className:Ms,children:[s.jsx(ka,{className:"icon","aria-hidden":!0}),e]})}function gr(){return s.jsxs("a",{href:"/aardvark/scans#connected-repos",target:"_blank",rel:"noreferrer",className:Ms,children:[s.jsx(N,I({},Ie.manageRepos)),s.jsx(Gs,{className:"icon","aria-hidden":!0})]})}const as=2,ws="break-all";function xr(){"use forget";var re,le,J,ce;const e=W.c(58),t=oe(),{filters:a,accessibleRepos:r,accessibleReposLoading:l}=ze(),i=qe(),n=$e(),c=ye();let m,h;e[0]!==n.search||e[1]!==c?(m=()=>{const R=new URLSearchParams(n.search);let U=!1;if(R.has("cursor")&&(R.delete("cursor"),U=!0),R.has("limit")&&(R.delete("limit"),U=!0),!U)return;const D=R.toString();c({search:D?"?".concat(D):""},{replace:!0})},h=[n.search,c],e[0]=n.search,e[1]=c,e[2]=m,e[3]=h):(m=e[2],h=e[3]),P.useEffect(m,h);let u;e[4]!==a.selectedRepos?(u=a.selectedRepos&&a.selectedRepos.size>0?Array.from(a.selectedRepos)[0]:null,e[4]=a.selectedRepos,e[5]=u):u=e[5];const o=u;let d;e[6]!==r||e[7]!==o?(d=o&&(le=(re=r==null?void 0:r.find(R=>R.canonical_url===o))==null?void 0:re.scan_id)!=null?le:null,e[6]=r,e[7]=o,e[8]=d):d=e[8];const f=d,{data:p,isLoading:v,error:y}=ra(f);let S,g;e[9]!==t||e[10]!==y||e[11]!==i?(S=()=>{if(y){const R=t.formatMessage(Oe.recommendedLoad,{details:y.message});i.danger(R)}},g=[t,y,i],e[9]=t,e[10]=y,e[11]=i,e[12]=S,e[13]=g):(S=e[12],g=e[13]),P.useEffect(S,g);const b=p==null?void 0:p.items;let x;e[14]!==b?(x=b!=null?b:[],e[14]=b,e[15]=x):x=e[15];const k=x,_=p==null?void 0:p.total,M=!l&&!!o&&!f;let C,j;e[16]!==t||e[17]!==M||e[18]!==i?(C=()=>{M&&i.danger(t.formatMessage(Oe.recommendedMissingScanToast))},j=[t,M,i],e[16]=t,e[17]=M,e[18]=i,e[19]=C,e[20]=j):(C=e[19],j=e[20]),P.useEffect(C,j);let w=null;if(e[21]!==k||e[22]!==w){for(const R of k){const U=R.ranking_end_time,D=typeof U=="number"?U:typeof U=="string"?Number(U):null;D==null||!Number.isFinite(D)||(w==null||D>w)&&(w=D)}e[21]=k,e[22]=w,e[23]=w}else w=e[23];const A=w;let F;e:{if(A==null){F=null;break e}const R=A*1e3;if(!Number.isFinite(R)){F=null;break e}let U,D;if(e[24]!==R?(U=new Date(R),D=Number.isNaN(U.getTime()),e[24]=R,e[25]=U,e[26]=D):(U=e[25],D=e[26]),D){F=null;break e}F=U}const E=F;let H;e:{let R;e[27]!==a.selectedRepos?(R=Array.from((J=a.selectedRepos)!=null?J:[]),e[27]=a.selectedRepos,e[28]=R):R=e[28];const[U]=R;if(!U){H="";break e}let D;e[29]!==r||e[30]!==U?(D=r==null?void 0:r.find(De=>De.canonical_url===U),e[29]=r,e[30]=U,e[31]=D):D=e[31];const ge=D;H=(ce=ge==null?void 0:ge.label)!=null?ce:""}const V=H;let B;e[32]!==k?(B=k.slice(0,10),e[32]=k,e[33]=B):B=e[33];const z=B;let ee;e[34]!==t?(ee=t.formatMessage({id:"aardvark.recommended.heading.targetAll",defaultMessage:"all repositories"}),e[34]=t,e[35]=ee):ee=e[35];const ie=V||ee,ae=z.length;if(M){let R;return e[36]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:s.jsx(N,I({},Oe.recommendedMissingScan))})}),e[36]=R):R=e[36],R}if(l||v){let R;return e[37]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx("div",{className:"border-token-border-light bg-token-bg-primary flex min-h-[240px] items-center justify-center rounded-2xl border",children:s.jsx(ct,{className:"text-token-text-tertiary h-6 w-6"})})}),e[37]=R):R=e[37],R}if(z.length===0){let R;return e[38]===Symbol.for("react.memo_cache_sentinel")?(R=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsx(js,{title:s.jsx(N,{id:"aardvark.recommended.empty",defaultMessage:"No recommended findings to show"}),body:s.jsx(N,{id:"aardvark.recommended.empty.help",defaultMessage:"When we generate recommended findings for your code, they'll appear here. Check back later or switch to 'All findings' to see everything."})})}),e[38]=R):R=e[38],R}let q;e[39]!==ie?(q=s.jsx("div",{className:"space-y-2",children:s.jsx("h3",{className:"text-token-text-primary text-xl leading-7 font-semibold",children:s.jsx(N,{id:"aardvark.recommended.heading.top",defaultMessage:"Aardvark Top {count} for {repo}",values:{count:10,repo:ie}})})}),e[39]=ie,e[40]=q):q=e[40];let te;e[41]!==E?(te=E?s.jsx("div",{className:"text-token-text-tertiary text-xs sm:text-sm",children:s.jsx(N,{id:"aardvark.recommended.updated",defaultMessage:"Updated {date} at {time}",values:{date:s.jsx(Ds,{value:E,year:"numeric",month:"long",day:"numeric"}),time:s.jsx(zs,{value:E,hour:"numeric",minute:"2-digit"})}})}):null,e[41]=E,e[42]=te):te=e[42];let Q;e[43]!==q||e[44]!==te?(Q=s.jsxs("header",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-center",children:[q,te]}),e[43]=q,e[44]=te,e[45]=Q):Q=e[45];let K;e[46]!==z?(K=z.map(pr),e[46]=z,e[47]=K):K=e[47];let G;e[48]!==K?(G=s.jsx("ol",{className:"flex flex-col gap-4",children:K}),e[48]=K,e[49]=G):G=e[49];let Y;e[50]!==_||e[51]!==V||e[52]!==ae?(Y=s.jsx("div",{className:"text-token-text-tertiary text-xs",children:_?V?s.jsx(N,{id:"aardvark.recommended.range.forRepo",defaultMessage:"Showing top {count} findings for {repo}",values:{count:ae,repo:V}}):s.jsx(N,{id:"aardvark.recommended.range",defaultMessage:"Showing top {count} recommended findings",values:{count:ae}}):V?s.jsx(N,{id:"aardvark.recommended.range.forRepo.noTotal",defaultMessage:"Showing top {count} findings for {repo}",values:{count:ae,repo:V}}):s.jsx(N,{id:"aardvark.recommended.range.noTotal",defaultMessage:"Showing top {count} recommended findings",values:{count:ae}})}),e[50]=_,e[51]=V,e[52]=ae,e[53]=Y):Y=e[53];let X;return e[54]!==Q||e[55]!==G||e[56]!==Y?(X=s.jsx("div",{className:"mx-auto w-full max-w-7xl px-6",children:s.jsxs("div",{className:"flex flex-col gap-5",children:[Q,G,Y]})}),e[54]=Q,e[55]=G,e[56]=Y,e[57]=X):X=e[57],X}function pr(e,t){return s.jsx(yr,{finding:e,index:t,baseIndex:0},"".concat(e.hid,"-").concat(t))}function yr(e){"use forget";var H,V,B,z,ee,he,ie,ae,q;const t=W.c(70),{finding:a,index:r,baseIndex:l}=e,i=oe(),n=ye(),c=$e(),m=(V=(H=a.hid)!=null?H:a.id)!=null?V:"";let h;t[0]!==a.repo_url||t[1]!==i?(h=Nt((B=a.repo_url)!=null?B:"")||i.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"}),t[0]=a.repo_url,t[1]=i,t[2]=h):h=t[2];const u=h;let o,d,f,p,v,y,S,g,b,x,k,_,M,C,j;if(t[3]!==l||t[4]!==m||t[5]!==a||t[6]!==r||t[7]!==i||t[8]!==c.search||t[9]!==n){j=(ie=(he=(z=a.commit_analysis)==null?void 0:z.title)!=null?he:(ee=a.commit_analysis)==null?void 0:ee.description)!=null?ie:i.formatMessage({id:"aardvark.recommended.missingTitle",defaultMessage:"Untitled finding"});const te=(q=(ae=a.commit_analysis)==null?void 0:ae.description)!=null?q:"",Q=typeof a.ranking_reason=="string"?a.ranking_reason:void 0;let K;t[25]!==te||t[26]!==Q?(K=Q&&Q.trim().length>0?Q:te,t[25]=te,t[26]=Q,t[27]=K):K=t[27],k=K;let G;t[28]!==a?(G=is(a),t[28]=a,t[29]=G):G=t[29],S=G;let Y;if(t[30]!==a||t[31]!==i){const J=lt(ns(a)),ce=lt(os(a));o=it(J),f=it(ce),d=nt(i,J),Y=nt(i,ce),t[30]=a,t[31]=i,t[32]=o,t[33]=d,t[34]=f,t[35]=Y}else o=t[32],d=t[33],f=t[34],Y=t[35];p=Y,g=l+r+1;let X;t[36]!==a?(X=_t(a),t[36]=a,t[37]=X):X=t[37],x=X;let re;t[38]!==m||t[39]!==c.search||t[40]!==n?(re=()=>{m&&n("/aardvark/findings/".concat(encodeURIComponent(m)).concat(c.search||""))},t[38]=m,t[39]=c.search,t[40]=n,t[41]=re):re=t[41],y=re;let le;t[42]!==y?(le=J=>{(J.key==="Enter"||J.key===" ")&&(J.preventDefault(),y())},t[42]=y,t[43]=le):le=t[43],v=le,b=c.search||"",_="button",M=0,C=i.formatMessage({id:"aardvark.recommended.card.ariaLabel",defaultMessage:"View details for {title}"},{title:j}),t[3]=l,t[4]=m,t[5]=a,t[6]=r,t[7]=i,t[8]=c.search,t[9]=n,t[10]=o,t[11]=d,t[12]=f,t[13]=p,t[14]=v,t[15]=y,t[16]=S,t[17]=g,t[18]=b,t[19]=x,t[20]=k,t[21]=_,t[22]=M,t[23]=C,t[24]=j}else o=t[10],d=t[11],f=t[12],p=t[13],v=t[14],y=t[15],S=t[16],g=t[17],b=t[18],x=t[19],k=t[20],_=t[21],M=t[22],C=t[23],j=t[24];let w;t[44]!==o||t[45]!==d||t[46]!==f||t[47]!==p||t[48]!==a.criticality||t[49]!==S||t[50]!==g||t[51]!==u||t[52]!==x||t[53]!==k||t[54]!==j?(w=s.jsx(vr,{rank:g,title:j,summary:k,repoName:u,criticality:a.criticality,pathPrefixes:S,committedRelative:o,committedTooltip:d,detectedRelative:f,detectedTooltip:p,signals:x}),t[44]=o,t[45]=d,t[46]=f,t[47]=p,t[48]=a.criticality,t[49]=S,t[50]=g,t[51]=u,t[52]=x,t[53]=k,t[54]=j,t[55]=w):w=t[55];let A;t[56]!==m||t[57]!==a||t[58]!==b?(A=s.jsx(jr,{finding:a,detailId:m,search:b}),t[56]=m,t[57]=a,t[58]=b,t[59]=A):A=t[59];let F;t[60]!==w||t[61]!==A?(F=s.jsxs("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-start",children:[w,A]}),t[60]=w,t[61]=A,t[62]=F):F=t[62];let E;return t[63]!==v||t[64]!==y||t[65]!==_||t[66]!==M||t[67]!==C||t[68]!==F?(E=s.jsx("li",{children:s.jsx("article",{role:_,tabIndex:M,"aria-label":C,onClick:y,onKeyDown:v,className:"border-token-border-light/70 bg-token-main-surface-secondary/40 hover:border-token-border-strong hover:bg-token-main-surface-tertiary focus-visible:border-token-border-strong focus-visible:ring-token-border-strong dark:bg-token-main-surface-secondary/70 group/card flex cursor-pointer flex-col gap-4 rounded-2xl border px-4 py-4 shadow-md transition-all hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:outline-none",children:F})}),t[63]=v,t[64]=y,t[65]=_,t[66]=M,t[67]=C,t[68]=F,t[69]=E):E=t[69],E}function vr(e){"use forget";const t=W.c(29),{rank:a,title:r,summary:l,repoName:i,criticality:n,pathPrefixes:c,committedRelative:m,committedTooltip:h,detectedRelative:u,detectedTooltip:o,signals:d}=e,f=oe();let p;t[0]!==f||t[1]!==d?(p=cs({intl:f,signals:d,badgeSize:"sm"}),t[0]=f,t[1]=d,t[2]=p):p=t[2];const v=p;let y;t[3]!==a?(y=s.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-primary border-token-border-light flex h-9 w-9 shrink-0 items-center justify-center rounded-full border text-sm font-semibold",children:a}),t[3]=a,t[4]=y):y=t[4];let S;t[5]!==n?(S=s.jsx(rt,{level:n}),t[5]=n,t[6]=S):S=t[6];let g;t[7]!==r?(g=s.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:r}),t[7]=r,t[8]=g):g=t[8];let b;t[9]!==S||t[10]!==g?(b=s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[S,g]}),t[9]=S,t[10]=g,t[11]=b):b=t[11];let x;t[12]!==l?(x=l?s.jsx("p",{className:"text-token-text-secondary text-sm leading-6",children:ds(l,260)}):null,t[12]=l,t[13]=x):x=t[13];let k;t[14]!==m||t[15]!==h||t[16]!==u||t[17]!==o||t[18]!==c||t[19]!==i?(k=s.jsx(br,{repoName:i,pathPrefixes:c,committedRelative:m,committedTooltip:h,detectedRelative:u,detectedTooltip:o}),t[14]=m,t[15]=h,t[16]=u,t[17]=o,t[18]=c,t[19]=i,t[20]=k):k=t[20];let _;t[21]!==v||t[22]!==b||t[23]!==x||t[24]!==k?(_=s.jsxs("div",{className:"min-w-0 flex-1 space-y-3",children:[b,x,k,v]}),t[21]=v,t[22]=b,t[23]=x,t[24]=k,t[25]=_):_=t[25];let M;return t[26]!==y||t[27]!==_?(M=s.jsxs("div",{className:"flex flex-1 gap-4",children:[y,_]}),t[26]=y,t[27]=_,t[28]=M):M=t[28],M}function br(e){"use forget";const t=W.c(37),{repoName:a,pathPrefixes:r,committedRelative:l,committedTooltip:i,detectedRelative:n,detectedTooltip:c}=e;let m,h,u,o,d,f;if(t[0]!==r||t[1]!==a){const j=r.slice(0,as),w=r.length>as,A=r.length>0;d="mt-1 flex flex-wrap items-center gap-x-6 gap-y-2 align-middle text-xs";let F;t[8]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(N,{id:"aardvark.recommended.meta.repo",defaultMessage:"Repository"})}),t[8]=F):F=t[8],t[9]!==a?(f=s.jsxs("div",{className:"flex gap-1",children:[F,s.jsx("dd",{className:"text-token-text-primary",children:a})]}),t[9]=a,t[10]=f):f=t[10],u="flex items-center gap-1 align-middle",t[11]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(N,{id:"aardvark.recommended.meta.paths",defaultMessage:"Paths"})}),t[11]=o):o=t[11],m="text-token-text-primary",h=A?s.jsx(st,{label:r.join("\n"),children:s.jsxs("div",{className:"flex flex-wrap gap-2",children:[j.map(kr),w?s.jsx(ot,{variant:"neutral",size:"sm",className:ws,children:s.jsx(N,{id:"aardvark.table.more",defaultMessage:"..."})}):null]})}):s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),t[0]=r,t[1]=a,t[2]=m,t[3]=h,t[4]=u,t[5]=o,t[6]=d,t[7]=f}else m=t[2],h=t[3],u=t[4],o=t[5],d=t[6],f=t[7];let p;t[12]!==m||t[13]!==h?(p=s.jsx("dd",{className:m,children:h}),t[12]=m,t[13]=h,t[14]=p):p=t[14];let v;t[15]!==u||t[16]!==o||t[17]!==p?(v=s.jsxs("div",{className:u,children:[o,p]}),t[15]=u,t[16]=o,t[17]=p,t[18]=v):v=t[18];let y;t[19]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(N,I({},Mt.committedHeader))}),t[19]=y):y=t[19];const S=i!=null?i:void 0;let g;t[20]!==l?(g=l?s.jsx(at,{value:l.value,unit:l.unit,numeric:"auto"}):s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),t[20]=l,t[21]=g):g=t[21];let b;t[22]!==S||t[23]!==g?(b=s.jsxs("div",{className:"flex gap-1",children:[y,s.jsx("dd",{className:"text-token-text-primary",title:S,children:g})]}),t[22]=S,t[23]=g,t[24]=b):b=t[24];let x;t[25]===Symbol.for("react.memo_cache_sentinel")?(x=s.jsx("dt",{className:"text-token-text-tertiary",children:s.jsx(N,{id:"aardvark.recommended.meta.detected",defaultMessage:"Detected"})}),t[25]=x):x=t[25];const k=c!=null?c:void 0;let _;t[26]!==n?(_=n?s.jsx(at,{value:n.value,unit:n.unit,numeric:"auto"}):s.jsx(N,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),t[26]=n,t[27]=_):_=t[27];let M;t[28]!==k||t[29]!==_?(M=s.jsxs("div",{className:"flex gap-1",children:[x,s.jsx("dd",{className:"text-token-text-primary",title:k,children:_})]}),t[28]=k,t[29]=_,t[30]=M):M=t[30];let C;return t[31]!==b||t[32]!==M||t[33]!==d||t[34]!==f||t[35]!==v?(C=s.jsxs("dl",{className:d,children:[f,v,b,M]}),t[31]=b,t[32]=M,t[33]=d,t[34]=f,t[35]=v,t[36]=C):C=t[36],C}function kr(e,t){return s.jsx(ot,{variant:"neutral",size:"sm",className:ws,children:e},"".concat(e.toLowerCase(),"-").concat(t))}function jr(e){"use forget";const t=W.c(15),{finding:a,detailId:r,search:l}=e;let i;t[0]!==a?(i=s.jsx("div",{onClick:Sr,children:s.jsx(ms,{finding:a})}),t[0]=a,t[1]=i):i=t[1];let n;t[2]!==a?(n=s.jsx("div",{onClick:wr,children:s.jsx(fs,{finding:a})}),t[2]=a,t[3]=n):n=t[3];let c;t[4]!==i||t[5]!==n?(c=s.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:[i,n]}),t[4]=i,t[5]=n,t[6]=c):c=t[6];const m=r?"/aardvark/findings/".concat(encodeURIComponent(r)).concat(l):"#",h="inline-flex h-9 w-9 items-center justify-center rounded-full text-sm transition-colors ".concat(r?"text-token-text-primary hover:bg-token-main-surface-secondary":"text-token-text-tertiary pointer-events-none");let u,o;t[7]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx("span",{className:"sr-only",children:s.jsx(N,{id:"aardvark.table.viewButton",defaultMessage:"View"})}),o=s.jsx(ps,{className:"icon-sm","aria-hidden":!0}),t[7]=u,t[8]=o):(u=t[7],o=t[8]);let d;t[9]!==m||t[10]!==h?(d=s.jsx("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:s.jsxs(rs,{to:m,onClick:Mr,className:h,children:[u,o]})}),t[9]=m,t[10]=h,t[11]=d):d=t[11];let f;return t[12]!==c||t[13]!==d?(f=s.jsxs("div",{className:"flex w-full flex-col gap-3 lg:max-w-[260px] lg:items-end",children:[c,d]}),t[12]=c,t[13]=d,t[14]=f):f=t[14],f}function Mr(e){return e.stopPropagation()}function wr(e){return e.stopPropagation()}function Sr(e){return e.stopPropagation()}function Nr(){"use forget";var S;const e=W.c(19),t=$e(),a=ye();let r;e[0]!==t.search?(r=new URLSearchParams(t.search),e[0]=t.search,e[1]=r):r=e[1];const l=r;let i;e[2]!==l?(i=l.get("recommended"),e[2]=l,e[3]=i):i=e[3];const n=i,c=n===null?!0:n==="true";let m;if(e[4]!==t.search){const g=new URLSearchParams(t.search),b=["repo","status","criticality","assignee","author","validated","path_prefix","q"],x={};for(const k of b)x[k]=(S=g.get(k))!=null?S:"";m=JSON.stringify(x),e[4]=t.search,e[5]=m}else m=e[5];const h=m,u=P.useRef(h);let o,d;e[6]!==h||e[7]!==t.search||e[8]!==a||e[9]!==l?(o=()=>{if(u.current!==h){const g=new URLSearchParams(t.search);g.set("cursor","0"),g.toString()!==l.toString()&&a({search:"?".concat(g.toString())},{replace:!0})}u.current=h},d=[h,a,t.search,l],e[6]=h,e[7]=t.search,e[8]=a,e[9]=l,e[10]=o,e[11]=d):(o=e[10],d=e[11]),P.useEffect(o,d);let f,p;e[12]!==t.search||e[13]!==a?(f=()=>{const g=new URLSearchParams(t.search),b=g.get("finding");if(!b)return;g.delete("finding");const x=g.toString(),k=x?"?".concat(x):"";a("/aardvark/findings/".concat(encodeURIComponent(b)).concat(k),{replace:!0})},p=[t.search,a],e[12]=t.search,e[13]=a,e[14]=f,e[15]=p):(f=e[14],p=e[15]),P.useEffect(f,p);let v;e[16]===Symbol.for("react.memo_cache_sentinel")?(v=s.jsxs("div",{className:"mb-8 flex flex-col items-center gap-4",children:[s.jsx(_r,{}),s.jsx(fr,{className:"w-full max-w-5xl"})]}),e[16]=v):v=e[16];let y;return e[17]!==c?(y=s.jsx("div",{children:s.jsx(Ma,{children:s.jsxs("div",{className:"mx-auto w-full",children:[v,s.jsx("div",{children:c?s.jsx(xr,{}):s.jsx(Ja,{})})]})})}),e[17]=c,e[18]=y):y=e[18],y}function _r(){"use forget";const e=W.c(6),{filters:t}=ze();let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(Cr,{}),e[0]=a):a=e[0];const r=t.recommendedOnly?"recommended":"other";let l;e[1]!==r?(l=s.jsx("span",{className:"flex items-center gap-1 font-medium whitespace-nowrap",children:s.jsx(N,{id:"aardvark.findings.inlineRepoLabel",defaultMessage:"{mode, select, recommended {for repository} other {for repositories}}",values:{mode:r}})}),e[1]=r,e[2]=l):l=e[2];let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(Xa,{variant:"inline"}),e[3]=i):i=e[3];let n;return e[4]!==l?(n=s.jsxs("div",{className:"flex w-full flex-wrap items-center justify-center gap-3",children:[a,s.jsxs("div",{className:"text-token-text-secondary bg-token-bg-primary inline-flex flex-wrap items-center gap-2 py-2 text-sm",children:[l,i]})]}),e[4]=l,e[5]=n):n=e[5],n}function Cr(){"use forget";const e=W.c(25),{filters:t,onChangeFilters:a,accessibleRepos:r}=ze();let l;e[0]!==r||e[1]!==t||e[2]!==a?(l=x=>{var M,C;if(x===t.recommendedOnly)return;let k=new Set(t.selectedRepos);if(x){const j=(C=(M=r==null?void 0:r[0])==null?void 0:M.canonical_url)!=null?C:"";if(k.size===0)j&&(k=new Set([j]));else if(k.size>1){const[w]=Array.from(k),A=w&&w.trim().length>0?w:j;k=A&&A.trim().length>0?new Set([A]):new Set}else{const[w]=Array.from(k);w&&!(r!=null&&r.some(A=>A.canonical_url===w))&&j&&(k=new Set([j]))}}const _=x?Z(I({},t),{selectedCriticalities:new Set,selectedStatuses:new Set,selectedPathPrefixes:new Set,selectedAssignees:new Set,selectedAuthors:new Set,keywordQuery:"",validationFilter:"all"}):t;a(Z(I({},_),{recommendedOnly:x,selectedRepos:k,selectedRepo:k.size===1?Array.from(k)[0]:"all"}))},e[0]=r,e[1]=t,e[2]=a,e[3]=l):l=e[3];const i=l,n=t.recommendedOnly?"bg-token-main-surface-secondary text-token-text-primary":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary hover:text-token-text-primary";let c;e[4]!==n?(c=T("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg border border-token-border-light px-5 py-2 text-sm font-medium ring-1 ring-token-border-light/60 shadow shadow-black/20 transition-colors transition-shadow focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-token-outline-primary dark:ring-white/10 dark:shadow-black/60",n),e[4]=n,e[5]=c):c=e[5];const m=c,h=t.recommendedOnly?"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary hover:text-token-text-primary":"bg-token-main-surface-secondary text-token-text-primary";let u;e[6]!==h?(u=T("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg border border-token-border-light px-5 py-2 text-sm font-medium ring-1 ring-token-border-light/60 shadow shadow-black/20 transition-colors transition-shadow focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-token-outline-primary dark:ring-white/10 dark:shadow-black/60",h),e[6]=h,e[7]=u):u=e[7];const o=u;let d;e[8]!==i?(d=()=>i(!0),e[8]=i,e[9]=d):d=e[9];let f;e[10]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(N,{id:"aardvark.filter.recommended",defaultMessage:"Recommended findings"}),e[10]=f):f=e[10];let p;e[11]!==t.recommendedOnly||e[12]!==m||e[13]!==d?(p=s.jsx("button",{type:"button","aria-pressed":t.recommendedOnly,className:m,onClick:d,children:f}),e[11]=t.recommendedOnly,e[12]=m,e[13]=d,e[14]=p):p=e[14];const v=!t.recommendedOnly;let y;e[15]!==i?(y=()=>i(!1),e[15]=i,e[16]=y):y=e[16];let S;e[17]===Symbol.for("react.memo_cache_sentinel")?(S=s.jsx(N,{id:"aardvark.filter.allFindings",defaultMessage:"All findings"}),e[17]=S):S=e[17];let g;e[18]!==o||e[19]!==v||e[20]!==y?(g=s.jsx("button",{type:"button","aria-pressed":v,className:o,onClick:y,children:S}),e[18]=o,e[19]=v,e[20]=y,e[21]=g):g=e[21];let b;return e[22]!==g||e[23]!==p?(b=s.jsxs("div",{className:"inline-flex items-center gap-2",children:[p,g]}),e[22]=g,e[23]=p,e[24]=b):b=e[24],b}function Ar(){"use forget";const e=W.c(12),t=ye(),a=oe(),r=qe(),{error:l}=us(),{eligible:i,isLoading:n}=Ys(Xs.hasSeenAardvarkOnboarding);let c,m;e[0]!==l||e[1]!==a||e[2]!==r?(c=()=>{if(!l)return;const d=gs(l),f=a.formatMessage(Oe.accessibleReposLoad,{details:d});r.danger(f)},m=[l,a,r],e[0]=l,e[1]=a,e[2]=r,e[3]=c,e[4]=m):(c=e[3],m=e[4]),P.useEffect(c,m);let h,u;if(e[5]!==n||e[6]!==t||e[7]!==i?(h=()=>{n||!i||t("/aardvark/scans",{replace:!0})},u=[n,t,i],e[5]=n,e[6]=t,e[7]=i,e[8]=h,e[9]=u):(h=e[8],u=e[9]),P.useEffect(h,u),n||i){let d;return e[10]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("div",{className:"flex h-40 items-center justify-center",children:s.jsx(ct,{className:"text-token-text-tertiary h-6 w-6"})}),e[10]=d):d=e[10],d}let o;return e[11]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx("div",{className:"w-full px-4 pb-6",children:s.jsx(Nr,{})}),e[11]=o):o=e[11],o}function Pr(){"use forget";const e=W.c(2),t=pa(),a=Js(t),r=xa();if(!a)return null;let l;return e[0]!==r?(l=s.jsx(Rr,I({},r)),e[0]=r,e[1]=l):l=e[1],l}function Rr(e){"use forget";const t=W.c(1);let a;return t[0]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(ba,{children:s.jsx(Ar,{})}),t[0]=a):a=t[0],a}const ol=Bs(function(){return s.jsx(Pr,{})});export{ol as default};
//# sourceMappingURL=kn7l7aisfbua588m.js.map
