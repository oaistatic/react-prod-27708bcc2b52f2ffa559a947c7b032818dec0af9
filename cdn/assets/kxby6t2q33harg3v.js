const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/k65njl5wlgspihfr.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/conversation-small-332fs9rk.css"])))=>i.map(i=>d[i]);
import{e as E,j as r,M as B,i as K,r as p,_ as U,a0 as D,a1 as $}from"./fg33krlcm0qyi6yw.js";import{a9 as q,cQ as R,l as Q,v1 as V,o as H,b as T,kQ as N,qx as J,bh as X,cU as Y,P as Z,b2 as tt,lp as A,ee as O,eh as et,gd as rt}from"./mtk1qztvnb31pw5r.js";import{m as k}from"./k88wtkcfx7tdyi6n.js";import{R as ot}from"./n30lfugazpsc3n5e.js";import{P as nt}from"./b8edwljjzslk6t4c.js";import{nb as st,nc as at,dU as it,cD as b,cE as I}from"./k65njl5wlgspihfr.js";import{C as F}from"./oaquzawhv3ahbo2l.js";import{a as mt}from"./ifrwee0bgh9e2but.js";import{a as ct}from"./nnfqr8jkm9161q4d.js";import{b as pt,g as dt,T as lt,W as ut,c as ht}from"./dalowvhac5so9p7u.js";import{u as gt}from"./bbzlu7xqes2h12wz.js";import{useSetupBaseWhamKeyboardActions as ft}from"./iqonnsay2vmalfwk.js";import{b as xt}from"./sy1xvqwioh9ks4z8.js";import{h as M}from"./n0ab5m1z76n8mazm.js";import"./kgrrqncjl71482vi.js";import"./i5jw6wfkpao2rx5t.js";import"./krwszi9u3lj63i9v.js";import"./jsvb554xldjovidb.js";import"./eb2ntjcgqhqizd13.js";import"./hots192vdjsjmkwr.js";import"./efooahjtdr85x1lo.js";import"./km71i01x6ma5r62b.js";import"./f9jzes5xr4mq3zrh.js";import"./j6htuwwuulo7h0p6.js";import"./czn39vd97sciq42g.js";import"./tkv1g3prhmmeuid6.js";import"./mbql81gwv5du9dtu.js";import"./k43gn7pl526u53kc.js";import"./dg5jraediw4l39ow.js";import"./hb1mva1gmw4bcs8w.js";import"./mivow98b53y1taf8.js";import"./mce0eiesimdmeqmr.js";import"./ohquqctluwabmb5i.js";import"./c2cj1dlcffke3f7m.js";import"./ix2fhlx43kf51eht.js";import"./onvzxgfezo210ugv.js";import"./o0e5tlgxm1k8ubzl.js";import"./iupestt9odrsfzg9.js";import"./ei2dcm731f3fuz8o.js";import"./btb1r2uxm2m1lsr5.js";import"./bhm7utdivrybcfbl.js";import"./j413w2y09mrdcb4m.js";import"./gqx9i5tb3deqoo5z.js";import"./d0444mle8cdypjta.js";import"./klzrztgvm2c9gs50.js";import"./zqbip2ya77i1mx4s.js";import"./kg0cp341m64rddpv.js";import"./lbbnz7rb7sd2lk50.js";import"./ck1u9icgxosmytry.js";import"./dq5a57hcb44a83mi.js";import"./cmaobpdpreyiep8p.js";import"./bes67zhi4fr5gq8i.js";import"./lptwpbjabrvjmhsj.js";import"./ose6175gtasqnfv0.js";import"./o51gjyxad96i2yey.js";import"./cv3wsu6uenrjij6h.js";import"./lbq5605sor1ah5hb.js";import"./n0qmvbt3dffalvvl.js";import"./jcfo2542d2wvunuv.js";import"./j37p94g6trtb4j3z.js";import"./lad8yx56mqsdspc9.js";import"./fznnr8l9owxbou6l.js";import"./haneze5lyzwaewf8.js";import"./j4u691tk1tplayl2.js";import"./j0vhwkpwiqu2ejer.js";import"./l09h2qppleubii6l.js";import"./eqi3xjytwhmszqqa.js";import"./bm9dehzwm3r2l9jr.js";import"./dm7q440f2oraxz29.js";import"./j3x02iqqi345yx57.js";import"./mmn9462oogkapcg8.js";import"./blmsijdyv0yxybpw.js";import"./npp0xpas090zc0qr.js";import"./0hruh9i7xt25bbur.js";import"./bgx9m29b5moow7ak.js";import"./kpobiwwkg2o2u14w.js";import"./ir7nzwbolrsm3ds2.js";import"./btdpwmi6j9nv6qc2.js";import"./mg1nwivo9tzc7m2p.js";import"./cnrdqaihcmlb57i1.js";import"./j7vr3wxxnh5g6uxz.js";import"./kzbknm4lxuyoq9wi.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./f5ep9o7usovyn4vf.js";import"./ly75bs3d14n5v622.js";import"./hu1bt0oauegdhua6.js";const kt=({title:e})=>{const t=E().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return r.jsxs("div",{className:"flex justify-between print:hidden",children:[r.jsxs("div",{className:"flex flex-col justify-start",children:[r.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:e}),r.jsx("div",{className:"text-token-text-tertiary text-sm",children:r.jsx(B,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:n=>r.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:n})}})})]}),r.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[r.jsx(nt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),r.jsx(q,{className:Q("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:R,label:t,children:t})]})]})};function Tt({postWithProfile:e,title:o,children:t}){return r.jsx(st.Provider,{value:{postId:e.post.id},children:r.jsx(V,{children:r.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:r.jsxs("div",{className:"mx-auto max-w-3xl",children:[r.jsx("div",{className:"px-2 py-6",children:!!o&&r.jsx(kt,{title:o})}),r.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:r.jsxs("div",{className:"p-14 pt-8",children:[r.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:r.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[r.jsx(R,{className:"text-token-text-primary h-8 w-8"}),r.jsx(at,{})]})}),t]})})]})})})})}function Pt(e){if(e.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const o=e.post.attachments[0];return{task:o.task,fetchedTurns:o.turns,current_user_turn:o.current_user_turn,current_assistant_turn:o.current_assistant_turn,current_diff_task_turn:o.current_diff_task_turn,exampleTaskInfo:o.example_task_info}}function yt({postWithProfile:e}){var _;ft();const o=M(u=>u.addTurnToTaskMap),{task:t,fetchedTurns:n,current_user_turn:s,current_assistant_turn:a,current_diff_task_turn:m,exampleTaskInfo:d}=Pt(e),h=T(),i=E(),c=K(),l=it.useCurrentImage()!=null,P=H(h,"2818336692"),[x,y]=p.useState([]),v=p.useCallback(()=>{y([])},[]),{focusedAssistantTurn:g,setFocusedAssistantTurnId:C}=pt({taskId:t.id,task:t,currentUserTurn:s!=null?s:null,currentAssistantTurn:a!=null?a:null}),j=p.useMemo(()=>xt(g),[g]),G=p.useMemo(()=>({comments:x,setComments:y,clearComments:v,readonlyComments:j}),[x,y,v,j]),f=M(({getTurnsForTask:u})=>t?u(t.id):[]),w=p.useMemo(()=>{var u;return dt({focusedAssistantTurn:g,pastTurns:f,currentDiffTaskTurnId:(u=m==null?void 0:m.id)!=null?u:null})},[g,m==null?void 0:m.id,f]),z=p.useMemo(()=>({setFocusedAssistantTurnId:C,focusedAssistantTurn:g,currentDiffTaskTurn:w,taskId:t==null?void 0:t.id,task:t,pastTurns:f,canFollowUp:!1}),[g,w,t,f,C]);return p.useEffect(()=>{var u;Object.values((u=n==null?void 0:n.turn_mapping)!=null?u:{}).forEach(L=>{var S;o((S=t==null?void 0:t.id)!=null?S:"",L.turn)})},[n,o,t]),gt([{key:"newTask",action:()=>{c("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:I.Chat,keyboardBinding:[b.Mod,b.Shift,"o"]},{key:"closeTask",action:()=>{c("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:I.Chat,keyboardBinding:[b.Escape],enabled:!l}]),!t||!f?null:r.jsx(N.Provider,{value:{postWithProfile:e,setIsReportModalOpen:()=>{}},children:r.jsx(J,{children:r.jsx(lt,{value:G,children:r.jsx(ut,{value:z,children:r.jsx(ht,{permissions:"read",turnId:(_=a==null?void 0:a.id)!=null?_:"",showForkButton:P,loadingTurnMapping:!1,isSharedExampleTask:!!d})})})})})}const bt=X(()=>U(()=>import("./k65njl5wlgspihfr.js").then(e=>e.Fd),__vite__mapDeps([0,1,2,3,4])).then(e=>e.PostSharingErrorModal)),ir=D(function(){const o=$();return o.kind==="forbidden"?r.jsx(wt,{reason:"workspace"}):r.jsx(vt,{loaderData:o})});function vt({loaderData:e}){var a,m,d,h;const o=T();p.useEffect(()=>{var i,c;Z.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:e.postWithProfile.post.id,primary_attachment_type:(c=(i=e.postWithProfile.post.attachments)==null?void 0:i[0])==null?void 0:c.kind,referrer:e.referrer})},[e]);const{session:t}=tt(o),n=p.useMemo(()=>{var c,l;const i=A(o);return O.initThread({clientThreadId:i.id,conversationMode:{kind:et.PrimaryAssistant},userId:(c=t==null?void 0:t.user)==null?void 0:c.id,accountId:(l=t==null?void 0:t.account)==null?void 0:l.id}),i},[o,(a=t==null?void 0:t.account)==null?void 0:a.id,(m=t==null?void 0:t.user)==null?void 0:m.id]),s=(d=e.postWithProfile.post.attachments)==null?void 0:d[0];if(s.kind==="deep_research"){const i=s.messages,c=rt(i),l=(h=c==null?void 0:c.metadata)==null?void 0:h.async_task_title;return c?r.jsx(Tt,{postWithProfile:e.postWithProfile,title:l,children:r.jsx(ot,{messages:i,conversation:n})}):null}return s.kind==="codex"?r.jsx(yt,{postWithProfile:e.postWithProfile}):r.jsx(_t,{postWithProfile:e.postWithProfile})}function W(e){return{url:"https://ogimg.chatgpt.com/?postId=".concat(e),size:[1200,630]}}function Ct(e,o){var n,s,a,m,d,h,i;if(!e.attachments||e.attachments.length===0)return{url:k.src};const t=e.attachments[0];switch(t.kind){case"media_generation":{const c=(s=(n=t.encodings)==null?void 0:n.md)!=null&&s.path?{url:t.encodings.md.path,size:[t.width,t.height]}:void 0,l=(m=(a=t.encodings)==null?void 0:a.unfurl)!=null&&m.path?{url:t.encodings.unfurl.path,size:[1200,630]}:void 0,P=(h=(d=t.encodings)==null?void 0:d.thumbnail)!=null&&h.path?{url:t.encodings.thumbnail.path}:void 0,x={url:t.url,size:[t.width,t.height]};return o&&c!=null?c:(i=l!=null?l:P)!=null?i:x}case"message_slice":return W(e.id);default:return{url:k.src}}}function jt(e){var n,s,a;const o=(n=e.text)==null?void 0:n.trim();if(o)return o;const t=(s=e.attachments)==null?void 0:s[0];return(t==null?void 0:t.kind)==="media_generation"&&((a=t.title)!=null&&a.trim())?t.title.trim():"Shared Content"}const mr=({data:e})=>{const o=e,t={name:"robots",content:"noindex,nofollow"};if(!o||o.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:k.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:k.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:n}=o.postWithProfile,s=o.enforceRenderedOgImg?W(n.id):Ct(n,o.preferIntrinsicAspectRatioForOgImage),a=jt(n),m=n.permalink,d=new Date(n.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:m},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:s.url},{property:"og:image:secure_url",content:s.url},...s.size?[{property:"og:image:width",content:s.size[0]},{property:"og:image:height",content:s.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:d},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:s.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function wt({reason:e}){const o=T();return p.useEffect(()=>{Y(o,bt,{reason:e})},[]),r.jsx(F,{})}function _t({postWithProfile:e}){const o=T(),[t,n]=p.useState(!1),[s]=p.useState(()=>A(o)),a=s.id,m=ct(e.post.attachments);if(m){const{threadResponse:d}=m;O.updateThreadFromServer(a,d,{skipIfExisting:!0,continuingFromSharedPostId:e.post.id,forkFromSharedPost:!0})}return r.jsxs(N.Provider,{value:{postWithProfile:e,setIsReportModalOpen:n},children:[t&&r.jsx(mt,{post:e.post,onClose:()=>n(!1)}),r.jsx(F,{clientThreadId:a})]})}export{ir as default,mr as meta};
//# sourceMappingURL=kxby6t2q33harg3v.js.map
