import{d as L}from"./goc4414xjv43pin0.js";import{E as T,b as v}from"./ej6tlexkw0sv7caa.js";import{F as A,c as H,p as g,a as S,b as D,d as F}from"./fmwvxydiodjqi0t8.js";function y(o=0){return o>0?o:self.devicePixelRatio||1}async function B(o,P,R=404,p=0){const n=y(p),a=o.widthEmu*T,s=o.heightEmu*T,e=Math.min(1,R/Math.max(a,s)),d=Math.round(a*e*n),f=Math.round(s*e*n),m=new OffscreenCanvas(d,f),c=m.getContext("2d");if(!c)throw new Error("Failed to create 2D context");c.scale(n*e,n*e),await L(o,P,c,[]);const u=await m.convertToBlob({type:"image/png"});return new Promise(i=>{const w=new FileReader;w.onload=()=>{var l,b;return i((b=(l=w.result)==null?void 0:l.toString())!=null?b:"")},w.readAsDataURL(u)})}async function U(o,P=20,R=10,p=0,n,a,s){const e=y(p),d=a!=null?a:800,f=s!=null?s:400,m=Math.max(1,Math.round(d*e)),c=Math.max(1,Math.round(f*e)),u=new OffscreenCanvas(m,c),i=u.getContext("2d");if(!i)return Promise.resolve("");i.scale(e,e);const l=Array(50).fill(A);for(const t of o.columns){const h=!!t.hidden?0:H(t.width);for(let r=t.min-1;r<t.max;r++)l[r]=h}const M=Array(50).fill(g(o.defaultRowHeight||S));for(const t of o.rows)t.customHeight&&(M[t.index-1]=g(t.height)),t.hidden&&(M[t.index-1]=0);const C=D(n);F(i,o,l,M,0,0,d,f,null,null,1,C,{},new Set,new Set,!1,n,v({colorScheme:{name:"default",colors:[]},lineStyleList:[],effectStyleList:[]}),!1);const _=await u.convertToBlob({type:"image/png"});return new Promise(t=>{const x=new FileReader;x.onload=()=>{var h,r;return t((r=(h=x.result)==null?void 0:h.toString())!=null?r:"")},x.readAsDataURL(_)})}export{U as a,B as s};
//# sourceMappingURL=mw40q7txi1y5m4dq.js.map
