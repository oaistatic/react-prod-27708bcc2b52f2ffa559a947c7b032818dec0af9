var wt=Object.defineProperty,Ct=Object.defineProperties;var St=Object.getOwnPropertyDescriptors;var $e=Object.getOwnPropertySymbols;var pt=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable;var gt=(a,e,i)=>e in a?wt(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,O=(a,e)=>{for(var i in e||(e={}))pt.call(e,i)&&gt(a,i,e[i]);if($e)for(var i of $e(e))ht.call(e,i)&&gt(a,i,e[i]);return a},Ne=(a,e)=>Ct(a,St(e));var vt=(a,e)=>{var i={};for(var s in a)pt.call(a,s)&&e.indexOf(s)<0&&(i[s]=a[s]);if(a!=null&&$e)for(var s of $e(a))e.indexOf(s)<0&&ht.call(a,s)&&(i[s]=a[s]);return i};import{c as q,e as I,j as t,M as T,r as qe,f as At,E as Pe,m as Et,i as $t,a0 as Dt,a9 as Ft}from"./fg33krlcm0qyi6yw.js";import{P as Rt,u as Lt,E as He}from"./dp77n34mztiej9w9.js";import{cw as Tt,uN as It,uO as Vt}from"./k65njl5wlgspihfr.js";import{S as G,A as Bt,f as bt,a as Ot,b as Gt,p as _t,c as kt,N as qt,g as Ht,F as Ut}from"./4p7fk9xlp4aux1yu.js";import{l as Se,m as Mt,hv as yt,R as zt,_ as jt,a9 as Wt,c0 as Kt,kW as Jt,b as Qt}from"./mtk1qztvnb31pw5r.js";import{M as Fe}from"./he7oe7s4xa3cph5y.js";import{r as Ue}from"./ojve869uwykk95at.js";import{A as Xt,P as Yt,D as Zt,C as es}from"./d0444mle8cdypjta.js";import{p as ts}from"./jcfo2542d2wvunuv.js";import{d as ss}from"./sy1xvqwioh9ks4z8.js";import{g as Re}from"./cv3wsu6uenrjij6h.js";import{m as as,A as is}from"./ocjy2hqri2k6d7gs.js";import{S as rs}from"./cvkeviyu3ufw6i7c.js";import{C as ns}from"./blg6blmyt2kk8gl7.js";import{C as ls}from"./d13unqbcq58nb3bi.js";import"./fc76377xmf89lezj.js";import"./gy1lpvuoewmzh42c.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./nfccle6oyncifphl.js";import"./hu1bt0oauegdhua6.js";import"./ly75bs3d14n5v622.js";import"./klzrztgvm2c9gs50.js";import"./zqbip2ya77i1mx4s.js";import"./kg0cp341m64rddpv.js";import"./lbbnz7rb7sd2lk50.js";import"./ck1u9icgxosmytry.js";import"./dq5a57hcb44a83mi.js";import"./cmaobpdpreyiep8p.js";import"./bes67zhi4fr5gq8i.js";import"./n0ab5m1z76n8mazm.js";import"./lptwpbjabrvjmhsj.js";import"./ose6175gtasqnfv0.js";import"./o51gjyxad96i2yey.js";import"./lbq5605sor1ah5hb.js";import"./n0qmvbt3dffalvvl.js";import"./fznnr8l9owxbou6l.js";import"./haneze5lyzwaewf8.js";import"./j4u691tk1tplayl2.js";import"./j0vhwkpwiqu2ejer.js";import"./j37p94g6trtb4j3z.js";import"./lad8yx56mqsdspc9.js";import"./kzbknm4lxuyoq9wi.js";import"./f5ep9o7usovyn4vf.js";import"./bhm7utdivrybcfbl.js";import"./ohquqctluwabmb5i.js";import"./efooahjtdr85x1lo.js";import"./km71i01x6ma5r62b.js";import"./c2cj1dlcffke3f7m.js";import"./hb1mva1gmw4bcs8w.js";import"./mivow98b53y1taf8.js";import"./krwszi9u3lj63i9v.js";import"./e5ksk0bbujs0ac88.js";function os(a){"use forget";var ze,We,Ke,Je,Qe,Xe,Ye,Ze,et,tt,st,at,it,rt,nt,lt,ot,ct,dt,mt,ft,ut,xt;const e=q.c(129),{finding:i}=a,s=I(),g=i.commit_analysis,m=g.attack_path_analysis;if(!m)return null;const{adjustment_decider:d,matrix_severity:k,policy_adjusted_criticality:y,adjusted_criticality_final:j,adjustment_reason:p,likelihood:r,impact:v,assumptions:u,attack_path:l,evidence:h,narrative:o,controls:c,blindspots:x,identity:f,facts:n}=m,b=j||g.attack_path_final_criticality||m.severity||m.original_severity||"unknown",S=d||"—",D=k||"—",A=y||"—",P=v&&(v.level||v.why)?"".concat((ze=v.level)!=null?ze:"unknown").concat(v.why?" — ".concat(v.why):""):"—",N=r&&(r.level||r.why)?"".concat((We=r.level)!=null?We:"unknown").concat(r.why?" — ".concat(r.why):""):"—",F=!!(l!=null&&l.entry)||!!(l!=null&&l.pivot)||!!(l!=null&&l.impact)||!!(l!=null&&l.ascii);let E;e[0]!==u?(E=u!=null?u:[],e[0]=u,e[1]=E):E=e[1];let R;e[2]!==((Ke=n==null?void 0:n.precondition)==null?void 0:Ke.requires)?(R=(Qe=(Je=n==null?void 0:n.precondition)==null?void 0:Je.requires)!=null?Qe:[],e[2]=(Xe=n==null?void 0:n.precondition)==null?void 0:Xe.requires,e[3]=R):R=e[3];let _;e[4]!==E||e[5]!==R?(_=[...E,...R],e[4]=E,e[5]=R,e[6]=_):_=e[6];const M=_,$=h&&h.length>0,C=c&&c.length>0,L=x&&x.length>0;let V;e[7]!==o?(V=o&&o.trim().length>0,e[7]=o,e[8]=V):V=e[8];const we=!!V,Ce=(Ye=n==null?void 0:n.category)!=null?Ye:"—",H=(et=(Ze=n==null?void 0:n.vector)==null?void 0:Ze.network_scope)!=null?et:"unknown",Le=(st=(tt=n==null?void 0:n.scope)==null?void 0:tt.auth)!=null?st:"unknown",Te=(it=(at=n==null?void 0:n.precondition)==null?void 0:at.achievability)!=null?it:"unknown",Ie=(nt=(rt=n==null?void 0:n.input)==null?void 0:rt.attacker_controlled)!=null?nt:"unknown",Ve=(ot=(lt=n==null?void 0:n.evidence)==null?void 0:lt.poc)!=null?ot:"unknown",Be=(dt=(ct=n==null?void 0:n.target)==null?void 0:ct.reach)!=null?dt:"unknown",Ae=(ft=(mt=n==null?void 0:n.cross_boundary)==null?void 0:mt.description)!=null?ft:"",Oe=((ut=n==null?void 0:n.cross_boundary)==null?void 0:ut.verified)===!0?"verified":((xt=n==null?void 0:n.cross_boundary)==null?void 0:xt.verified)===!1?"unverified":"unknown";let U;e[9]!==s?(U=s.formatMessage({id:"aardvark.attackPath.title",defaultMessage:"Attack-path analysis"}),e[9]=s,e[10]=U):U=e[10];let z;e[11]!==s?(z=s.formatMessage({id:"aardvark.attackPath.policyDecision",defaultMessage:"Policy decision"}),e[11]=s,e[12]=z):z=e[12];let W;e[13]!==z?(W=t.jsx("h3",{className:"text-token-text-secondary mb-3 text-xs font-semibold tracking-wide uppercase",children:z}),e[13]=z,e[14]=W):W=e[14];let K;e[15]!==s?(K=s.formatMessage({id:"aardvark.attackPath.decider",defaultMessage:"Decider"}),e[15]=s,e[16]=K):K=e[16];let J;e[17]!==S||e[18]!==K?(J=t.jsx(w,{label:K,value:S}),e[17]=S,e[18]=K,e[19]=J):J=e[19];let Q;e[20]!==s?(Q=s.formatMessage({id:"aardvark.attackPath.matrixSeverity",defaultMessage:"Matrix severity"}),e[20]=s,e[21]=Q):Q=e[21];let X;e[22]!==D||e[23]!==Q?(X=t.jsx(w,{label:Q,value:D}),e[22]=D,e[23]=Q,e[24]=X):X=e[24];let Y;e[25]!==s?(Y=s.formatMessage({id:"aardvark.attackPath.policyAdjusted",defaultMessage:"Policy adjusted"}),e[25]=s,e[26]=Y):Y=e[26];let Z;e[27]!==A||e[28]!==Y?(Z=t.jsx(w,{label:Y,value:A}),e[27]=A,e[28]=Y,e[29]=Z):Z=e[29];let ee;e[30]!==s?(ee=s.formatMessage({id:"aardvark.attackPath.finalVerdict",defaultMessage:"Final verdict"}),e[30]=s,e[31]=ee):ee=e[31];let te;e[32]!==b||e[33]!==ee?(te=t.jsx(w,{label:ee,value:b}),e[32]=b,e[33]=ee,e[34]=te):te=e[34];let se;e[35]!==X||e[36]!==Z||e[37]!==te||e[38]!==J?(se=t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[J,X,Z,te]}),e[35]=X,e[36]=Z,e[37]=te,e[38]=J,e[39]=se):se=e[39];let ae;e[40]!==p||e[41]!==s?(ae=p&&t.jsx("p",{className:"text-token-text-secondary mt-3 text-xs md:text-sm",children:t.jsx("span",{className:"font-semibold",children:s.formatMessage({id:"aardvark.attackPath.adjustmentRationale",defaultMessage:"Adjustment rationale: {rationale}"},{rationale:p})})}),e[40]=p,e[41]=s,e[42]=ae):ae=e[42];let ie;e[43]!==se||e[44]!==ae||e[45]!==W?(ie=t.jsxs("div",{children:[W,se,ae]}),e[43]=se,e[44]=ae,e[45]=W,e[46]=ie):ie=e[46];let re;e[47]!==s?(re=s.formatMessage({id:"aardvark.attackPath.decisionReasoning",defaultMessage:"Decision reasoning"}),e[47]=s,e[48]=re):re=e[48];let ne;e[49]!==re?(ne=t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:re}),e[49]=re,e[50]=ne):ne=e[50];let le;e[51]!==s?(le=s.formatMessage({id:"aardvark.attackPath.decisionReasoning.finalVerdict",defaultMessage:"Final verdict"}),e[51]=s,e[52]=le):le=e[52];const Ge=b==="—"?"—":"".concat(b).concat(S!=="—"?" (decider: ".concat(S,")"):"");let oe;e[53]!==le||e[54]!==Ge?(oe=t.jsx(w,{label:le,value:Ge}),e[53]=le,e[54]=Ge,e[55]=oe):oe=e[55];let ce;e[56]!==s?(ce=s.formatMessage({id:"aardvark.attackPath.impact",defaultMessage:"Impact"}),e[56]=s,e[57]=ce):ce=e[57];let de;e[58]!==P||e[59]!==ce?(de=t.jsx(w,{label:ce,value:P}),e[58]=P,e[59]=ce,e[60]=de):de=e[60];let me;e[61]!==s?(me=s.formatMessage({id:"aardvark.attackPath.likelihood",defaultMessage:"Likelihood"}),e[61]=s,e[62]=me):me=e[62];let fe;e[63]!==N||e[64]!==me?(fe=t.jsx(w,{label:me,value:N}),e[63]=N,e[64]=me,e[65]=fe):fe=e[65];let ue;e[66]!==oe||e[67]!==de||e[68]!==fe?(ue=t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[oe,de,fe]}),e[66]=oe,e[67]=de,e[68]=fe,e[69]=ue):ue=e[69];let xe;e[70]!==M||e[71]!==s?(xe=M.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"text-token-text-tertiary mb-1 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.keyAssumptions",defaultMessage:"Key assumptions"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:M.map(fs)})]}),e[70]=M,e[71]=s,e[72]=xe):xe=e[72];let ge;e[73]!==ne||e[74]!==ue||e[75]!==xe?(ge=t.jsxs("div",{children:[ne,ue,xe]}),e[73]=ne,e[74]=ue,e[75]=xe,e[76]=ge):ge=e[76];let pe;e[77]!==l||e[78]!==F||e[79]!==s?(pe=F&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.attackPath",defaultMessage:"Attack path"})}),t.jsxs("div",{className:"space-y-2",children:[(l==null?void 0:l.entry)&&t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.entry",defaultMessage:"Entry"}),value:l.entry}),(l==null?void 0:l.pivot)&&t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.pivot",defaultMessage:"Pivot"}),value:l.pivot}),(l==null?void 0:l.impact)&&t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.impactNode",defaultMessage:"Impact"}),value:l.impact}),(l==null?void 0:l.ascii)&&l.ascii.trim().length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"text-token-text-tertiary mb-1 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.diagram",defaultMessage:"Diagram"})}),t.jsx("pre",{className:"bg-token-main-surface-primary/40 text-token-text-secondary rounded-md p-3 font-mono text-xs whitespace-pre-wrap",children:l.ascii})]})]})]}),e[77]=l,e[78]=F,e[79]=s,e[80]=pe):pe=e[80];let he;e[81]!==M||e[82]!==s?(he=M.length>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.assumptions",defaultMessage:"Assumptions"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:M.map(ms)})]}),e[81]=M,e[82]=s,e[83]=he):he=e[83];let ve;e[84]!==h||e[85]!==$||e[86]!==s?(ve=$&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.evidence",defaultMessage:"Evidence"})}),t.jsx("ul",{className:"space-y-2",children:h.map((B,Pt)=>t.jsxs("li",{className:"bg-token-main-surface-primary/40 rounded-md p-2",children:[t.jsx("div",{className:"text-token-text-tertiary font-mono text-xs break-all",children:s.formatMessage({id:"aardvark.attackPath.evidence.location",defaultMessage:"{file}:{start}-{end}"},{file:B.file,start:B.line_start,end:B.line_end})}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:B.why})]},"".concat(B.file,":").concat(B.line_start,"-").concat(B.line_end,"-").concat(Pt)))})]}),e[84]=h,e[85]=$,e[86]=s,e[87]=ve):ve=e[87];let ke;e[88]!==we||e[89]!==s||e[90]!==o?(ke=we&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.narrative",defaultMessage:"Narrative"})}),t.jsx("div",{className:Se("prose prose-sm text-token-text-secondary max-w-none text-sm","prose-p:my-1 prose-ul:my-1 prose-ol:my-1"),children:t.jsx(Fe,{remarkPlugins:[Ue],children:o})})]}),e[88]=we,e[89]=s,e[90]=o,e[91]=ke):ke=e[91];let ye;e[92]!==c||e[93]!==C||e[94]!==s?(ye=C&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.controls",defaultMessage:"Controls"})}),t.jsx("ul",{className:"flex flex-wrap gap-2",children:c.map(ds)})]}),e[92]=c,e[93]=C,e[94]=s,e[95]=ye):ye=e[95];let je;e[96]!==x||e[97]!==L||e[98]!==s?(je=L&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.blindspots",defaultMessage:"Residual risks / blind spots"})}),t.jsx("ul",{className:"list-disc space-y-1 ps-5",children:x.map(cs)})]}),e[96]=x,e[97]=L,e[98]=s,e[99]=je):je=e[99];let be;e[100]!==f||e[101]!==s?(be=((f==null?void 0:f.service_account)||(f==null?void 0:f.managed_identity)||(f==null?void 0:f.privileges)&&f.privileges.length>0)&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.identity",defaultMessage:"Identity"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.identity.serviceAccount",defaultMessage:"Service account"}),value:(f==null?void 0:f.service_account)||"—"}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.identity.managedIdentity",defaultMessage:"Managed identity"}),value:(f==null?void 0:f.managed_identity)||"—"}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.identity.privileges",defaultMessage:"Privileges"}),value:f!=null&&f.privileges&&f.privileges.length>0?f.privileges.join(", "):"—"})]})]}),e[100]=f,e[101]=s,e[102]=be):be=e[102];let _e;e[103]!==n||e[104]!==Ce||e[105]!==Ae||e[106]!==Oe||e[107]!==Ve||e[108]!==Ie||e[109]!==Te||e[110]!==Le||e[111]!==Be||e[112]!==H||e[113]!==s?(_e=n&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-token-text-secondary mb-2 text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.facts",defaultMessage:"Facts (context / rules)"})}),t.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.category",defaultMessage:"Category"}),value:Ce}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.vector",defaultMessage:"Vector"}),value:H}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.scope",defaultMessage:"Scope"}),value:Le}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.precondition",defaultMessage:"Precondition achievability"}),value:Te}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.input",defaultMessage:"Attacker control"}),value:Ie}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.evidenceType",defaultMessage:"Evidence type"}),value:Ve}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.targetReach",defaultMessage:"Target reach"}),value:Be}),t.jsx(w,{label:s.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryVerified",defaultMessage:"Cross-boundary"}),value:Oe})]}),Ae&&t.jsxs("div",{className:"text-token-text-secondary mt-2 text-sm",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:s.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryDescription",defaultMessage:"Cross-boundary path:"})}),t.jsx("div",{children:s.formatMessage({id:"aardvark.attackPath.facts.crossBoundaryDescription.body",defaultMessage:"{description}"},{description:Ae})})]})]}),e[103]=n,e[104]=Ce,e[105]=Ae,e[106]=Oe,e[107]=Ve,e[108]=Ie,e[109]=Te,e[110]=Le,e[111]=Be,e[112]=H,e[113]=s,e[114]=_e):_e=e[114];let Me;e[115]!==ie||e[116]!==ge||e[117]!==pe||e[118]!==he||e[119]!==ve||e[120]!==ke||e[121]!==ye||e[122]!==je||e[123]!==be||e[124]!==_e?(Me=t.jsxs("div",{className:"flex flex-col gap-6 text-sm leading-6",children:[ie,ge,pe,he,ve,ke,ye,je,be,_e]}),e[115]=ie,e[116]=ge,e[117]=pe,e[118]=he,e[119]=ve,e[120]=ke,e[121]=ye,e[122]=je,e[123]=be,e[124]=_e,e[125]=Me):Me=e[125];let Ee;return e[126]!==Me||e[127]!==U?(Ee=t.jsx(G,{title:U,children:Me}),e[126]=Me,e[127]=U,e[128]=Ee):Ee=e[128],Ee}function cs(a,e){return t.jsx("li",{className:"text-token-text-secondary",children:a},e)}function ds(a,e){return t.jsx("li",{className:"bg-token-main-surface-primary/60 text-token-text-secondary rounded-full px-3 py-1 text-xs",children:a},"".concat(a,"-").concat(e))}function ms(a,e){return t.jsx("li",{className:"text-token-text-secondary",children:a},e)}function fs(a,e){return t.jsx("li",{className:"text-token-text-secondary",children:a},e)}function w({label:a,value:e}){const s=I().formatMessage({id:"aardvark.attackPath.placeholder",defaultMessage:"—"});return t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:a}),t.jsx("div",{className:"text-token-text-primary text-sm",children:e!=null?e:s})]})}const us={pending:"muted",running:"warning",failed:"danger",success:"success",unknown:"muted"},xs=a=>a.status=="created"?"pending":a.status=="patch_generation_running"?"running":a.status=="patch_generation_failed"?"failed":a.patch_generation_success?"success":"unknown",gs=a=>a.status=="created"?"pending":a.status=="awaiting_validation"?"running":a.status=="failed_validation"?"failed":a.status=="validated"?"success":"unknown";function Nt(a){"use forget";const e=q.c(9),{task:i,mode:s}=a,g=I();let m;e[0]!==s||e[1]!==i?(m=s=="generation"?xs(i):gs(i),e[0]=s,e[1]=i,e[2]=m):m=e[2];const d=m,k=us[d];let y;e[3]!==g||e[4]!==d?(y=g.formatMessage(Rt[d]),e[3]=g,e[4]=d,e[5]=y):y=e[5];const j=y;let p;return e[6]!==j||e[7]!==k?(p=t.jsx(Bt,{variant:k,children:j}),e[6]=j,e[7]=k,e[8]=p):p=e[8],p}function ps(a){"use forget";var D,A;const e=q.c(34),{latestTask:i,turn:s,formatStepTime:g}=a,m=i==null?void 0:i.patch_generation_submitted_at,d=(A=(D=s==null?void 0:s.latest_event)==null?void 0:D.created)!=null?A:null;let k;if(e[0]!==s){const P=s&&Array.isArray(s.output_items)?bt(Re(s,"output_items",[]),ys):[],N=as(P,vs);k=s?Ne(O({},s),{output_items:[...N]}):null,e[0]=s,e[1]=k}else k=e[1];const y=k;let j;e[2]!==g||e[3]!==m?(j=m?g(m):null,e[2]=g,e[3]=m,e[4]=j):j=e[4];const p=j;let r;e[5]!==g||e[6]!==d?(r=d?g(d):null,e[5]=g,e[6]=d,e[7]=r):r=e[7];const v=r;let u;if(e[8]!==v||e[9]!==p){if(u=[],p){let P;e[11]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.startedLabel",defaultMessage:"Started"}),e[11]=P):P=e[11];let N;e[12]!==p?(N={key:"started",label:P,value:p},e[12]=p,e[13]=N):N=e[13],u.push(N)}if(v){let P;e[14]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.finishedLabel",defaultMessage:"Completed"}),e[14]=P):P=e[14];let N;e[15]!==v?(N={key:"finished",label:P,value:v},e[15]=v,e[16]=N):N=e[16],u.push(N)}e[8]=v,e[9]=p,e[10]=u}else u=e[10];let l;e[17]!==s?(l=s?ss(s):"",e[17]=s,e[18]=l):l=e[18];const h=l;let o,c;e[19]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.title",defaultMessage:"Patch generation"})}),c=Se("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[19]=o,e[20]=c):(o=e[19],c=e[20]);let x;e[21]!==u?(x=u.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:u.map(hs)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(T,{id:"aardvark.proposedPatch.patchGeneration.noTiming",defaultMessage:"Timing details will appear once generation starts."})}),e[21]=u,e[22]=x):x=e[22];let f;e[23]!==i?(f=i&&t.jsx("div",{className:"sm:ms-4 sm:flex sm:min-w-[120px] sm:justify-end",children:t.jsx(Nt,{task:i,mode:"generation"})}),e[23]=i,e[24]=f):f=e[24];let n;e[25]!==x||e[26]!==f?(n=t.jsxs("div",{className:c,children:[x,f]}),e[25]=x,e[26]=f,e[27]=n):n=e[27];let b;e[28]!==h||e[29]!==y?(b=y&&t.jsx(Xt,{assistantTurn:y,outputText:h,className:"text-token-text-secondary text-sm leading-6"}),e[28]=h,e[29]=y,e[30]=b):b=e[30];let S;return e[31]!==b||e[32]!==n?(S=t.jsxs(t.Fragment,{children:[o,n,b]}),e[31]=b,e[32]=n,e[33]=S):S=e[33],S}function hs(a){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:a.label}),t.jsx("span",{className:"text-token-text-secondary",children:a.value})]},a.key)}function vs(a){return Ne(O({},a),{content:bt(Re(a,"content",[]),ks)})}function ks(a){return Re(a,"content_type")==="text"}function ys(a){return Re(a,"type")==="message"}function js(a){"use forget";var f;const e=q.c(29),{latestTask:i,formatStepTime:s}=a,g=i==null?void 0:i.fix_checker_started_at,m=i==null?void 0:i.fix_checker_finished_at,d=(f=i==null?void 0:i.fix_checker_rubric)!=null?f:"";let k;e[0]!==s||e[1]!==g?(k=g?s(g):null,e[0]=s,e[1]=g,e[2]=k):k=e[2];const y=k;let j;e[3]!==s||e[4]!==m?(j=m?s(m):null,e[3]=s,e[4]=m,e[5]=j):j=e[5];const p=j;let r;if(e[6]!==p||e[7]!==y){if(r=[],y){let n;e[9]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.startedLabel",defaultMessage:"Started"}),e[9]=n):n=e[9];let b;e[10]!==y?(b={key:"started",label:n,value:y},e[10]=y,e[11]=b):b=e[11],r.push(b)}if(p){let n;e[12]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.finishedLabel",defaultMessage:"Completed"}),e[12]=n):n=e[12];let b;e[13]!==p?(b={key:"finished",label:n,value:p},e[13]=p,e[14]=b):b=e[14],r.push(b)}e[6]=p,e[7]=y,e[8]=r}else r=e[8];let v,u;e[15]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("div",{className:"text-token-text-tertiary mt-4 text-xs font-semibold tracking-wide uppercase",children:t.jsx("span",{children:t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.title",defaultMessage:"Patch validation"})})}),u=Se("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[15]=v,e[16]=u):(v=e[15],u=e[16]);let l;e[17]!==r?(l=r.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:r.map(bs)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(T,{id:"aardvark.proposedPatch.patchValidation.noTiming",defaultMessage:"Validation timeline will populate once checks begin."})}),e[17]=r,e[18]=l):l=e[18];let h;e[19]!==i?(h=t.jsx(Nt,{task:i,mode:"validation"}),e[19]=i,e[20]=h):h=e[20];let o;e[21]!==l||e[22]!==h?(o=t.jsxs("div",{className:u,children:[l,h]}),e[21]=l,e[22]=h,e[23]=o):o=e[23];let c;e[24]!==d?(c=d&&t.jsx("div",{className:"prose prose-sm text-token-text-secondary mb-4 max-w-none",children:t.jsx(Fe,{children:d})}),e[24]=d,e[25]=c):c=e[25];let x;return e[26]!==o||e[27]!==c?(x=t.jsxs(t.Fragment,{children:[v,o,c]}),e[26]=o,e[27]=c,e[28]=x):x=e[28],x}function bs(a){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:a.label}),t.jsx("span",{className:"text-token-text-secondary",children:a.value})]},a.key)}function _s(a){return typeof a!="object"||a==null||!("role"in a)||!("output_items"in a)?!1:a.role==="assistant"&&Array.isArray(a.output_items)}function Ms(a){"use forget";const e=q.c(45),{proposed_patch:i,findingId:s,refetchFinding:g}=a,m=I(),d=Mt(),[k,y]=qe.useState(!1),[j,p]=qe.useState(!1),r=i==null?void 0:i.latest_task;if(!i||!r)return null;const v=r.codex_task_turn,u=_s(v==null?void 0:v.turn)?v.turn:null;let l;if(e[0]!==u||e[1]!==s||e[2]!==m||e[3]!==j||e[4]!==r||e[5]!==(i==null?void 0:i.id)||e[6]!==g||e[7]!==d||e[8]!==k){const h=u?ts({assistantTurn:u}):[],o=h.map(ws).join("\n\n"),c=async()=>{try{await yt(o,d),d.successNeutral(m.formatMessage(De.copyPatchSuccess),{duration:5,hasCloseButton:!0})}catch(_){}};let x;e[10]!==o||e[11]!==m||e[12]!==d?(x=async()=>{try{await yt("git apply - <<PATCH\n"+o+"\nPATCH",d),d.successNeutral(m.formatMessage(De.copyApplySuccess),{duration:5,hasCloseButton:!0})}catch(_){}},e[10]=o,e[11]=m,e[12]=d,e[13]=x):x=e[13];const f=x;let n;e[14]!==s||e[15]!==m||e[16]!==j||e[17]!==r.codex_task_id||e[18]!==r.codex_task_turn_id||e[19]!==g||e[20]!==d?(n=async _=>{if(!(r!=null&&r.codex_task_id)||!(r!=null&&r.codex_task_turn_id)||!s||j)return;p(!0);const M={parameters:{path:{id:s}},requestBody:{}};_!==void 0&&(M.requestBody.mode=_);try{if(await zt.safePost("/aardvark/scan-findings/{id}/pr",M),g)try{await g()}catch($){const C=$;let L;C instanceof Error?L=C.message:L=String(C),jt.addError("aardvark.proposedPatch.refetchFindingError",{findingId:s,message:L})}d.successNeutral(m.formatMessage(De.createPrSuccess),{duration:3,hasCloseButton:!0})}catch($){const C=$;jt.addError("aardvark.proposedPatch.createPrError",{findingId:s,taskId:r.codex_task_id,taskTurnId:r.codex_task_turn_id,mode:_!=null?_:null,message:C instanceof Error?C.message:String(C)}),d.danger(m.formatMessage(De.createPrError),{duration:3,hasCloseButton:!0}),p(!1);return}p(!1)},e[14]=s,e[15]=m,e[16]=j,e[17]=r.codex_task_id,e[18]=r.codex_task_turn_id,e[19]=g,e[20]=d,e[21]=n):n=e[21];const b=n,S=!!(r!=null&&r.codex_task_id)&&!!(r!=null&&r.codex_task_turn_id)&&!!s,D=!!(r!=null&&r.fix_checker_success);let A;e[22]===Symbol.for("react.memo_cache_sentinel")?(A=function(M){return M?typeof M=="string"?Ot(M):Gt(M):null},e[22]=A):A=e[22];const P=A;let N;e[23]!==m?(N=m.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[23]=m,e[24]=N):N=e[24];let F;e[25]!==u||e[26]!==r?(F=t.jsx(ps,{latestTask:r,turn:u,formatStepTime:P}),e[25]=u,e[26]=r,e[27]=F):F=e[27];let E;e[28]!==r||e[29]!==D?(E=D&&t.jsx(js,{latestTask:r,formatStepTime:P}),e[28]=r,e[29]=D,e[30]=E):E=e[30];let R;if(h.length>0){let _;e[31]!==k?(_=t.jsx(Zt,{unifiedDiff:k,setUnifiedDiff:y,showFullDiff:!1,setShowFullDiff:Ps}),e[31]=k,e[32]=_):_=e[32];const M=t.jsxs("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[_,t.jsx(Yt,{copyApplyToClipboard:f,copyPatchToClipboard:c,createPr:b,navigateToCreatingPrPage:Ns,updateBranch:void 0,canCreatePr:S,isCreatingPr:j,permissions:"write",assistantTurn:u,showOnlyViewPr:!1})]});let $;e[33]!==M?($=t.jsx("div",{className:"mb-2 flex w-full flex-col gap-2",children:M}),e[33]=M,e[34]=$):$=e[34];let C;e[35]!==(i==null?void 0:i.id)||e[36]!==k?(C=(we,Ce)=>{var H;return t.jsx(es,{diff:we,viewType:k?"unified":"split",stickyHeader:!1},"".concat((H=i==null?void 0:i.id)!=null?H:"diff","-canonical-").concat(Ce))},e[35]=i==null?void 0:i.id,e[36]=k,e[37]=C):C=e[37];const L=t.jsx("div",{className:"flex flex-col gap-4",children:h.map(C)});let V;e[38]!==$||e[39]!==L?(V=t.jsxs(t.Fragment,{children:[$,L]}),e[38]=$,e[39]=L,e[40]=V):V=e[40],R=V}else if((r==null?void 0:r.patch_generation_success)===!0&&(r==null?void 0:r.fix_checker_success)===!0){let _;e[41]!==m?(_=m.formatMessage({id:"aardvark.proposedPatch.noDiffsInHead",defaultMessage:"No diffs because the issue no longer exists in HEAD."}),e[41]=m,e[42]=_):_=e[42];let M;e[43]!==_?(M=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:_}),e[43]=_,e[44]=M):M=e[44],R=M}else R=null;l=t.jsxs(G,{title:N,children:[F,E,R]}),e[0]=u,e[1]=s,e[2]=m,e[3]=j,e[4]=r,e[5]=i==null?void 0:i.id,e[6]=g,e[7]=d,e[8]=k,e[9]=l}else l=e[9];return l}function Ns(){}function Ps(){}function ws(a){var e;return(e=a.hunksText)!=null?e:""}const De=At({createPrSuccess:{id:"aardvark.proposedPatch.createPrSuccess",defaultMessage:"Pull request created"},createPrError:{id:"aardvark.proposedPatch.createPrErrorToast",defaultMessage:"Failed to create pull request"},copyPatchSuccess:{id:"aardvark.proposedPatch.copyPatchSuccess",defaultMessage:"Patch copied"},copyApplySuccess:{id:"aardvark.proposedPatch.copyApplySuccess",defaultMessage:"Command copied"}});function Cs({content:a,start:e,className:i=""}){const s=Pe.useMemo(()=>a.trimEnd().split("\n"),[a]),g=typeof e=="number"?e:1;return t.jsx("div",{className:"bg-token-bg-elevated-secondary overflow-auto rounded ".concat(i),style:{maxHeight:400},children:t.jsx("table",{className:"w-full border-separate border-spacing-0",children:t.jsx("tbody",{children:s.map((m,d)=>t.jsxs("tr",{className:"align-top",children:[t.jsx("td",{className:"text-token-text-tertiary py-0.5 ps-3 pe-3 text-end align-top text-[11px] whitespace-nowrap select-none",children:g+d}),t.jsx("td",{className:"py-0.5 pe-3 font-mono text-sm whitespace-pre",children:m===""?" ":m})]},d))})})})}function Ss({finding:a}){var k,y,j,p;const e=I();let i=(y=(k=a.commit_analysis)==null?void 0:k.relevant_lines)!=null?y:[],s=Array.isArray(i)&&i.length>0;const g=(j=a.commit_analysis)==null?void 0:j.proposed_patch,m=typeof g=="string"&&g.trim().length>0;if(!s){const r=_t(g);i=(p=r==null?void 0:r.relevant_lines)!=null?p:[],s=Array.isArray(i)&&i.length>0}if(!s){if(m)return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.detailsTitle",defaultMessage:"Details"}),children:t.jsx("div",{className:"p-2",children:g})});if(!m)return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.evidence",defaultMessage:"Evidence"}),children:t.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.formatMessage({id:"aardvark.findings.noEvidence",defaultMessage:"No evidence available."})})})}const d=(()=>{var v,u,l,h;const r=new Map;for(const o of i){const c=o.path||(o==null?void 0:o.file_path)||"(unknown)",x=(v=o.start_line_number)!=null?v:0,f=(l=(u=o.end_line_number)!=null?u:o.start_line_number)!=null?l:0,n="".concat(c,"|").concat(x,"-").concat(f),b=(h=r.get(n))!=null?h:[];b.push(o),r.set(n,b)}return Array.from(r.entries()).sort((o,c)=>o[0].localeCompare(c[0]))})();return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.relevantLinesTitle",defaultMessage:"Relevant lines"}),children:t.jsx("div",{className:"space-y-3",children:d.map(([r,v])=>{const[u,l]=r.split("|");return t.jsxs("details",{open:!0,className:"group ring-token-border-light bg-token-main-surface-primary rounded-lg ring-1",children:[t.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium select-none",children:[t.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[t.jsx(Tt,{className:"icon-sm text-token-text-tertiary transition-transform group-open:rotate-180","aria-hidden":!0}),t.jsx("span",{className:"truncate",children:u})]}),t.jsx("span",{className:"text-token-text-tertiary ms-2 text-xs whitespace-nowrap",children:e.formatMessage({id:"aardvark.findings.lineRange",defaultMessage:"L{range}"},{range:l==null?void 0:l.replace("-","–")})})]}),t.jsx("div",{children:v.map((h,o)=>t.jsxs("div",{className:"space-y-2",children:[h.comment&&t.jsx("p",{className:"text-token-text-secondary mb-0 bg-yellow-50/60 px-3 py-3 text-sm dark:bg-yellow-900/30",children:h.comment}),h.content&&t.jsx(Cs,{content:h.content,start:h.start_line_number,className:"mb-0"})]},"".concat(r,"-").concat(o)))})]},r)})})})}function As({finding:a}){var p,r,v,u,l,h;const e=I(),i=a,s=Pe.useMemo(()=>{var o;return _t((o=i.commit_analysis)==null?void 0:o.proposed_patch)},[(p=i.commit_analysis)==null?void 0:p.proposed_patch]),g=Pe.useMemo(()=>{var o,c,x;return(x=(c=s==null?void 0:s.cvss_score)!=null?c:(o=i.commit_analysis)==null?void 0:o.cvss_score)!=null?x:null},[s,i.commit_analysis]),m=Pe.useMemo(()=>{var o,c,x;return(x=(c=s==null?void 0:s.criticality_cvss_reason)!=null?c:(o=i.commit_analysis)==null?void 0:o.criticality_cvss_score_reason)!=null?x:null},[s,i.commit_analysis]),d=Pe.useMemo(()=>{var x,f,n,b,S,D,A,P,N,F,E;const o=(x=i.commit_analysis)!=null?x:{},c=(f=o.attack_path_analysis)!=null?f:null;return{originalCrit:(b=(n=c==null?void 0:c.original_severity)!=null?n:o.criticality)!=null?b:null,matrixSeverity:(S=c==null?void 0:c.matrix_severity)!=null?S:null,policyAdjusted:(D=c==null?void 0:c.policy_adjusted_criticality)!=null?D:null,finalCrit:(P=(A=c==null?void 0:c.adjusted_criticality_final)!=null?A:o.attack_path_final_criticality)!=null?P:null,decider:(N=c==null?void 0:c.adjustment_decider)!=null?N:null,rationale:(E=(F=c==null?void 0:c.adjustment_reason)!=null?F:o.attack_path_adjustment_reason)!=null?E:null}},[i.commit_analysis]),k=d.originalCrit&&d.finalCrit&&d.originalCrit!==d.finalCrit,y=d.rationale,j=o=>{if(!o)return"unknown";const c=String(o).toLowerCase();return c.charAt(0).toUpperCase()+c.slice(1)};return t.jsxs(G,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[((r=i.commit_analysis)==null?void 0:r.title)||e.formatMessage({id:"aardvark.findings.vulnerability",defaultMessage:"Vulnerability"}),t.jsx(kt,{level:i.criticality})]}),children:[t.jsx("div",{children:((v=i.commit_analysis)==null?void 0:v.bugs_found_or_fixed)&&t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(u=i.commit_analysis)==null?void 0:u.bugs_found_or_fixed})}),g!=null&&t.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-token-text-secondary flex items-center gap-1",children:t.jsx("div",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.cvssLabel",defaultMessage:"CVSS"})})}),t.jsxs("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-yellow-500 ring-amber-500/20",style:{backgroundColor:"rgba(245, 158, 11, 0.12)"},title:e.formatMessage({id:"aardvark.findings.cvssScore",defaultMessage:"CVSS score"}),children:[t.jsx(rs,{className:"me-1 h-[14px] w-[14px]","aria-hidden":!0}),g]})]}),m&&t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:m&&t.jsx("p",{className:"mb-2",children:m})}),t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:(l=i.commit_analysis)==null?void 0:l.description}),(k||y)&&t.jsxs("div",{className:"mt-3 text-sm leading-6",children:[t.jsxs("div",{className:"text-token-text-secondary mb-1 flex items-center gap-2",children:[t.jsx("span",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.attackPathDecisionLabel",defaultMessage:"Attack-path analysis:"})}),d.finalCrit&&t.jsx(kt,{level:(h=qt(d.finalCrit))!=null?h:"low"}),d.decider&&t.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.formatMessage({id:"aardvark.findings.attackPathDecider",defaultMessage:"(adjusted by {decider})"},{decider:d.decider})})]}),k&&t.jsx("div",{className:"text-token-text-tertiary mb-1",children:e.formatMessage({id:"aardvark.findings.attackPathChangeLine",defaultMessage:"Criticality changed from {original} to {final}."},{original:j(d.originalCrit),final:j(d.finalCrit)})}),y&&t.jsx("div",{className:"text-token-text-tertiary",children:t.jsx("p",{className:"mb-2",children:y})})]})]})}function Es({finding:a}){var y,j,p;const e=I(),[i,s]=Pe.useState(!1),g=(y=a.commit_analysis)==null?void 0:y.validation_report,m=(j=a.commit_analysis)==null?void 0:j.validation_rubric,d=String(g||((p=a==null?void 0:a.commit_analysis)==null?void 0:p.validation_str)||"");if(!d&&!m)return null;const k=m&&d?2:1;return t.jsx(G,{title:e.formatMessage({id:"aardvark.findings.validation",defaultMessage:"Validation"}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-".concat(k),children:[m&&t.jsx("div",{className:"lg:col-span-1",children:t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:t.jsx(Fe,{remarkPlugins:[Ue],components:{code(l){var h=l,{inline:r,children:v}=h,u=vt(h,["inline","children"]);const o=String(v!=null?v:"");if(r)return t.jsx("code",Ne(O({className:"bg-token-bg-primary rounded px-1 py-0.5 text-[12px]"},u),{children:o}));const c=String((u==null?void 0:u.className)||""),x=/language-([\w-]+)/.exec(c),f=x==null?void 0:x[1];return t.jsx(It,{content:o,language:f,wrapperClassName:"mt-1",showActionBar:!1,codeContainerClassName:"p-3"})},input(r){return(r==null?void 0:r.type)!=="checkbox"?t.jsx("input",O({},r)):!!r.checked?t.jsx(ns,{className:"mt-0.5 h-4 w-4 shrink-0 text-emerald-600"}):t.jsx(ls,{className:"text-token-text-quaternary mt-0.5 h-4 w-4 shrink-0 opacity-70"})},li({children:r}){return t.jsx("li",{className:"hover:bg-token-bg-elevated-secondary/40 flex items-start gap-2 rounded-lg p-2",children:r})}},children:m})})}),d&&d.trim().length>0&&t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs font-semibold tracking-wide uppercase",children:e.formatMessage({id:"aardvark.findings.validationReportLabel",defaultMessage:"Validation report"})}),t.jsxs("div",{className:Se("relative rounded-md p-3 text-sm leading-6","bg-token-main-surface-primary/40"),children:[t.jsx("div",{className:Se("prose prose-sm text-foreground max-w-none",i?"max-h-none":"max-h-36 overflow-hidden"),children:t.jsx(Fe,{remarkPlugins:[Ue],children:d})}),!i&&t.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t"})]}),t.jsx("div",{className:"mt-2 flex items-center justify-end",children:t.jsx("button",{type:"button",className:"hover:bg-token-bg-elevated-secondary inline-flex h-8 items-center justify-center rounded px-2 text-xs",onClick:()=>s(r=>!r),children:i?e.formatMessage({id:"aardvark.findings.collapse",defaultMessage:"Collapse"}):e.formatMessage({id:"aardvark.findings.expand",defaultMessage:"Expand"})})})]})]})})}function $s({finding:a,refetchFinding:e}){var s;I();const{hasAttackPath:i}=Ht(a);return t.jsx("div",{className:"relative mx-auto w-full max-w-[1200px]",children:t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3 md:gap-6",children:[t.jsx("div",{className:"flex flex-col gap-4 md:col-span-2",children:t.jsx(As,{finding:a})}),t.jsx("div",{className:"flex h-fit flex-col gap-4 self-start",children:t.jsx(Ut,{finding:a})}),a.proposed_patch?t.jsx("div",{className:"md:col-span-3",children:t.jsx(Ms,{proposed_patch:a.proposed_patch,findingId:(s=a.hid)!=null?s:a.id,refetchFinding:e})}):null,t.jsx("div",{className:"md:col-span-3",children:t.jsx(Ss,{finding:a})}),t.jsx("div",{className:"md:col-span-3",children:t.jsx(Es,{finding:a})}),i?t.jsx("div",{className:"md:col-span-3",children:t.jsx(os,{finding:a})}):null]})})})}function Ds(a){"use forget";const e=q.c(24),{findingId:i}=a,s=I(),g=Et(),m=$t(),d=Mt();let k;e[0]!==g.search||e[1]!==m?(k=()=>t.jsx("div",{className:"mx-auto mb-4 w-full max-w-[1200px]",children:t.jsx(Wt,{as:"button",size:"small",color:"secondary",onClick:()=>{m("/aardvark"+(g.search||""))},children:t.jsx(T,{id:"aardvark.details.back",defaultMessage:"Back to findings"})})}),e[0]=g.search,e[1]=m,e[2]=k):k=e[2];const y=k;let j;e[3]!==y?(j=n=>t.jsxs("div",{className:"w-full px-4 pb-6",children:[y(),t.jsx("div",{className:"border-token-border-light text-token-text-secondary mx-auto w-full max-w-[1200px] rounded-lg border px-4 py-6 text-center",children:t.jsx(T,Ne(O({},He.findingLoad),{values:{details:n.message}}))})]}),e[3]=y,e[4]=j):j=e[4];const p=j,{data:r,isLoading:v,refetch:u,error:l}=Lt(i);let h,o;if(e[5]!==l||e[6]!==s||e[7]!==d?(h=()=>{if(!l)return;const n=s.formatMessage(He.findingLoad,{details:l.message});d.danger(n)},o=[l,s,d],e[5]=l,e[6]=s,e[7]=d,e[8]=h,e[9]=o):(h=e[8],o=e[9]),qe.useEffect(h,o),v){let n;return e[10]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx("div",{className:"w-full px-4 pb-6",children:t.jsx("div",{className:"flex h-[60vh] w-full items-center justify-center",children:t.jsx(Kt,{})})}),e[10]=n):n=e[10],n}if(l||!r){let n;e[11]!==l?(n=l!=null?l:new Error("Unknown error loading finding"),e[11]=l,e[12]=n):n=e[12];let b;return e[13]!==p||e[14]!==n?(b=p(n),e[13]=p,e[14]=n,e[15]=b):b=e[15],b}let c;e[16]!==y?(c=y(),e[16]=y,e[17]=c):c=e[17];let x;e[18]!==r||e[19]!==u?(x=t.jsx($s,{finding:r,refetchFinding:u}),e[18]=r,e[19]=u,e[20]=x):x=e[20];let f;return e[21]!==c||e[22]!==x?(f=t.jsxs("div",{className:"w-full px-4 pb-6",children:[c,x]}),e[21]=c,e[22]=x,e[23]=f):f=e[23],f}function Fs({findingId:a}){const e=Qt(),i=Vt(e),s=Jt();return i?t.jsx(Rs,Ne(O({},s),{findingId:a})):null}function Rs(a){"use forget";const e=q.c(2),{findingId:i}=a;let s;return e[0]!==i?(s=t.jsx(is,{children:t.jsx(Ds,{findingId:i})}),e[0]=i,e[1]=s):s=e[1],s}const La=Dt(function(){const e=Ft(),i=I();if(!e.id){const s=i.formatMessage(He.findingNotFound);return t.jsx("div",{children:s})}return t.jsx(Fs,{findingId:e.id})});export{La as default};
//# sourceMappingURL=ifi9aurt4b11rqu7.js.map
