const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/icf0sb4kitdajoka.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css"])))=>i.map(i=>d[i]);
var pa=Object.freeze,xa=Object.defineProperty,ts=Object.defineProperties;var ns=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var ha=Object.prototype.hasOwnProperty,ya=Object.prototype.propertyIsEnumerable;var fa=(s,a,t)=>a in s?xa(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,u=(s,a)=>{for(var t in a||(a={}))ha.call(a,t)&&fa(s,t,a[t]);if(Qe)for(var t of Qe(a))ya.call(a,t)&&fa(s,t,a[t]);return s},ee=(s,a)=>ts(s,ns(a));var Ae=(s,a)=>{var t={};for(var n in s)ha.call(s,n)&&a.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&Qe)for(var n of Qe(s))a.indexOf(n)<0&&ya.call(s,n)&&(t[n]=s[n]);return t};var ba=(s,a)=>pa(xa(s,"raw",{value:pa(a||s.slice())}));import{b as ve,e as ye,r as y,f as pe,j as e,M as f,_ as is,L as os,h as rs,c as ls,a0 as cs}from"./fg33krlcm0qyi6yw.js";import{P as O,c0 as je,T as Me,bX as Fe,l as X,R as me,zV as Ee,zW as Ea,a9 as ce,py as ds,lc as ne,v6 as Ve,v2 as ms,zX as us,zY as ra,zO as ze,qi as Oe,bg as Da,n as gs,zZ as Aa,C as Pa,z_ as Ne,z$ as Ke,A0 as Xe,A1 as aa,v3 as Je,A2 as ka,A3 as za,A4 as ps,A5 as Oa,fe as fs,hA as xs,j8 as hs,cj as ys,c2 as Ba,b as la,N as bs,A6 as ks,o as Ms,F as vs,H as _s,iK as ws}from"./mtk1qztvnb31pw5r.js";import{u as js,V as Cs,O as Pe}from"./ha43hfhn8zonl98y.js";import{T as ae}from"./hcn3kohxpjzaoxwc.js";import{f as Y,p as Ia}from"./oc29jc50rrvtu7z8.js";import{R as Ts,B as Us,X as Ns,Y as Ss,T as Ls,t as Es,S as Ye,d as Ma}from"./e5dt5h62tjqfeb7c.js";import{fx as Ds,d4 as As,jQ as ke,jq as Ra,cw as Ps,Af as Wa,z as zs,rK as Os,de as Fa,e8 as Bs,ky as Is,nd as Rs,cI as Ws}from"./k65njl5wlgspihfr.js";import{r as Fs}from"./msonzcs4uubp6vdq.js";import{S as Gs}from"./ht7pa4q84q7i97x2.js";import{d as qs}from"./o4m46p2hmbpmbw32.js";import{L as $s}from"./fjgzmzg0f3112atg.js";import{A as Ks}from"./mr025ud04jb4rh0r.js";import{A as Hs}from"./jkdx73dfg7n0gxrn.js";import{G as Qs}from"./en6zlt3w5f6cxktv.js";import{e as Vs,M as na}from"./ki4km9ptw66l47xq.js";import{B as Ga}from"./c8z528kkh87wsmtm.js";import{a as qa,c as Ys}from"./jex6ulz50fkc86ct.js";import{F as Zs}from"./j6lb21vbnpzhe1mm.js";import{u as Xs,b as Js}from"./qomjt47lfw1l209u.js";import"./e7t9iekjqjn15qm6.js";import"./cv3wsu6uenrjij6h.js";import"./galyil7vygq0i5a6.js";import"./hwa6pbq6i57ntwuh.js";import"./du98r2zhw5p0hoto.js";import"./e5ksk0bbujs0ac88.js";import"./n7q15cptibmmhebw.js";import"./fc76377xmf89lezj.js";import"./llove4bcy7api840.js";import"./c2cj1dlcffke3f7m.js";import"./ohquqctluwabmb5i.js";import"./efooahjtdr85x1lo.js";import"./km71i01x6ma5r62b.js";import"./hb1mva1gmw4bcs8w.js";import"./i1tex5l6gt3gdz3c.js";import"./mcmrxiy9039fw9r6.js";import"./bhm7utdivrybcfbl.js";import"./mivow98b53y1taf8.js";import"./krwszi9u3lj63i9v.js";function $a(s){if(!s)return null;const a=s instanceof Date?Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()):(()=>{const[o,d,m]=s.split("-").map(Number);return!o||!d||!m?null:Date.UTC(o,d-1,m)})();if(a==null)return null;const t=new Date,n=Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),i=Math.floor((n-a)/864e5);return i<0?0:i}const de=(s,{toastId:a="chatgpt.usageAnalytics.defaultErrorToastId",message:t}={})=>js(s,{toastId:a,message:t}),sa="--",V=pe({tableWorkspaceColumn:{id:"workspaceUsage.benchmark.tableWorkspaceColumn",defaultMessage:"{workspaceName}"},tableMetricColumn:{id:"workspaceUsage.benchmark.tableMetricColumn",defaultMessage:"Metric"},tableIndustryColumn:{id:"workspaceUsage.benchmark.tableIndustryColumn",defaultMessage:"Industry median"},tableIndustryColumnNamed:{id:"workspaceUsage.benchmark.tableIndustryColumnNamed",defaultMessage:"Industry median{lineBreak}({industry})"},legendIndustryMedian:{id:"workspaceUsage.benchmark.legendIndustryMedian",defaultMessage:"Industry median ({industry})"},industryMedianTooltip:{id:"workspaceUsage.benchmark.industryMedianTooltip",defaultMessage:"Based on previous 7 days of data"},tableDifferenceColumn:{id:"workspaceUsage.benchmark.tableDifferenceColumn",defaultMessage:"Difference"},activationRate:{id:"workspaceUsage.benchmark.activationRate",defaultMessage:"User activation rate"},wauPerActivatedUser:{id:"workspaceUsage.benchmark.wauPerActivatedUser",defaultMessage:"Weekly active users per activated user"},activationRateTooltip:{id:"workspaceUsage.benchmark.activationRateTooltip",defaultMessage:"Total number of users who joined the workspace and sent at least 1 message as percentage of total number of seats purchased."},weeklyMessagesPerWau:{id:"workspaceUsage.benchmark.weeklyMessagesPerWau",defaultMessage:"Weekly messages per weekly active user"},noData:{id:"workspaceUsage.benchmark.noData",defaultMessage:"No benchmark data available"},workspaceModelChartTitle:{id:"workspaceUsage.benchmark.workspaceModelChartTitle",defaultMessage:"Messages by model"},workspaceToolChartTitle:{id:"workspaceUsage.benchmark.workspaceToolChartTitle",defaultMessage:"Messages by tool"},workspaceConnectorChartTitle:{id:"workspaceUsage.benchmark.workspaceConnectorChartTitle",defaultMessage:"Messages by connector"}}),et=new Intl.NumberFormat(void 0,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0}),at=new Intl.NumberFormat(void 0,{maximumFractionDigits:0}),st=new Intl.NumberFormat(void 0,{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0,signDisplay:"exceptZero"}),tt=new Intl.NumberFormat(void 0,{maximumFractionDigits:0,signDisplay:"exceptZero"});function va(s){return s==null?sa:et.format(s)}function nt(s){return s==null?sa:at.format(s)}function it(s){return s==null?sa:st.format(s)}function ot(s){return s==null?sa:tt.format(s)}function Ka(s,a,t){var n;return ve({queryKey:["workspace-analytics-benchmark",{workspaceId:s,startDate:a}],queryFn:de(({queryKey:[i,o]})=>me.safeGet("/accounts/{account_id}/analytics/benchmark",{parameters:{path:{account_id:o.workspaceId},query:{start_date:o.startDate}}})),enabled:(n=t==null?void 0:t.enabled)!=null?n:!0})}const rt=[{key:"activation_rate",label:"activationRate",formatter:va},{key:"wau_per_activated_user",label:"wauPerActivatedUser",formatter:va},{key:"total_messages_per_wau",label:"weeklyMessagesPerWau",formatter:nt}];function Ha({currentWorkspaceId:s,startDate:a,workspaceName:t,showUiPolish:n}){var P,M,T,D,v,j,z,q,$;const i=ye(),o=Y(a),d=Ka(s,o),m=y.useRef(null),r=d.data,g=(P=r==null?void 0:r.workspace_metrics)!=null?P:null,c=(M=r==null?void 0:r.industry_benchmark_metrics)!=null?M:null,w=(T=g==null?void 0:g.industry)!=null?T:null,b=(D=r==null?void 0:r.workspace_by_model_metrics)!=null?D:null,U=(v=r==null?void 0:r.workspace_by_tool_metrics)!=null?v:null,x=(j=r==null?void 0:r.workspace_by_connector_metrics)!=null?j:null,_=(z=r==null?void 0:r.industry_by_model_metrics)!=null?z:null,C=(q=r==null?void 0:r.industry_by_tool_metrics)!=null?q:null,k=($=r==null?void 0:r.industry_by_connector_metrics)!=null?$:null,h=d.data?rt.map(({key:l,label:B,formatter:G})=>{const Q=g==null?void 0:g[l],R=c==null?void 0:c[l],E=Q!=null&&R!=null?Q-R:null;return{key:l,label:B,workspaceDisplay:G(Q),industryDisplay:G(R),differenceDisplay:l==="total_messages_per_wau"?ot(E):it(E),differenceValue:E}}):[],p=t!=null?t:i.formatMessage(V.tableWorkspaceColumn,{workspaceName:s}),N=w?e.jsx(f,ee(u({},V.tableIndustryColumnNamed),{values:{industry:w,lineBreak:e.jsx("br",{})}})):e.jsx(f,u({},V.tableIndustryColumn));return y.useEffect(()=>{var G,Q,R,E;if(!d.isSuccess||!g||h.length===0)return;const l="".concat((G=g.partition_date)!=null?G:"unknown","|").concat((Q=g.industry)!=null?Q:"unknown");if(m.current===l)return;const B=$a(g.partition_date);O.logEvent("Workspace Usage: Benchmark Table Rendered",{metric_partition_date:(R=g.partition_date)!=null?R:null,industry_average_date:(E=c==null?void 0:c.partition_date)!=null?E:null,industry:w,data_days_stale:B,activation_rate_metric_displayed:g.activation_rate!=null,activation_rate_industry_average_displayed:(c==null?void 0:c.activation_rate)!=null,wau_per_activated_user_metric_displayed:g.wau_per_activated_user!=null,wau_per_activated_user_industry_average_displayed:(c==null?void 0:c.wau_per_activated_user)!=null,total_messages_per_wau_metric_displayed:g.total_messages_per_wau!=null,total_messages_per_wau_industry_average_displayed:(c==null?void 0:c.total_messages_per_wau)!=null}),m.current=l},[d.isSuccess,c,w,h.length,g]),d.isLoading?e.jsx("div",{className:"flex min-h-[240px] items-center justify-center",children:e.jsx(je,{})}):e.jsx("div",{className:"mt-6",children:h.length===0?e.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.jsx(f,u({},V.noData))}):e.jsxs(e.Fragment,{children:[e.jsxs(ae.Root,{className:"border-token-border-medium border-b-[0.5px]",children:[e.jsxs(ae.Header,{children:[e.jsx(ae.HeaderCell,{className:"text-[13px] font-medium text-nowrap",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,u({},V.tableMetricColumn)),e.jsx(Me,{label:i.formatMessage(V.industryMedianTooltip),side:"top",sideOffset:4,className:"text-token-text-tertiary",children:e.jsx(Fe,{className:"h-4 w-4"})})]})}),e.jsx(ae.HeaderCell,{textAlign:"center",className:"text-[13px] font-medium text-nowrap",children:e.jsx(f,ee(u({},V.tableWorkspaceColumn),{values:{workspaceName:p}}))}),e.jsx(ae.HeaderCell,{textAlign:"center",className:"text-[13px] font-medium text-nowrap",children:N}),e.jsx(ae.HeaderCell,{textAlign:"center",className:"text-[13px] font-medium text-nowrap",children:e.jsx(f,u({},V.tableDifferenceColumn))})]}),e.jsx(ae.Body,{children:h.map(l=>e.jsxs(ae.Row,{children:[e.jsx(ae.Cell,{className:"font-normal",children:e.jsx("div",{className:"leading-tight",children:l.key==="activation_rate"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,u({},V[l.label])),e.jsx(Me,{label:i.formatMessage(V.activationRateTooltip),side:"top",sideOffset:4,className:"text-token-text-tertiary",children:e.jsx(Fe,{className:"h-4 w-4"})})]}):e.jsx(f,u({},V[l.label]))})}),e.jsx(ae.Cell,{textAlign:"center",className:"font-normal",children:l.workspaceDisplay}),e.jsx(ae.Cell,{textAlign:"center",className:"font-normal",children:l.industryDisplay}),e.jsx(ae.Cell,{textAlign:"center",className:X("font-normal",typeof l.differenceValue=="number"&&(l.differenceValue>0?"text-green-600":l.differenceValue<0?"text-red-600":"text-token-text-primary")),children:l.differenceDisplay})]},l.key))})]}),e.jsx(lt,{workspaceModel:b,industryModel:_,workspaceTool:U,industryTool:C,workspaceConnector:x,industryConnector:k,workspaceName:p,industryName:w,showUiPolish:n})]})})}function lt({workspaceModel:s,industryModel:a,workspaceTool:t,industryTool:n,workspaceConnector:i,industryConnector:o,workspaceName:d,industryName:m,showUiPolish:r}){const g=ye(),c=y.useRef(null),w=y.useRef(null),b=y.useRef(null),U=y.useMemo(()=>(p,N)=>{const P=q=>{var l;if(!q)return{};const $=q.total;return $?Object.fromEntries(Object.entries((l=q.map)!=null?l:{}).map(([B,G])=>[B,$>0?G/$*100:0])):{}},M=P(p),T=P(N),D=new Set([...Object.keys(M),...Object.keys(T)]),v=Array.from(D).map(q=>{var B,G;const $=(B=M[q])!=null?B:0,l=(G=T[q])!=null?G:0;return{name:q,workspace:$,industry:l,combined:$+l}});if(v.sort((q,$)=>$.combined-q.combined),v.length<=10)return v;const j=v.slice(0,9),z=v.slice(9).reduce((q,$)=>({name:"other",workspace:q.workspace+$.workspace,industry:q.industry+$.industry,combined:0}),{name:"other",workspace:0,industry:0,combined:0});return[...j,z]},[]),x=U(s,a),_=U(t,n),C=U(i,o),k=d,h=m!=null?m:g.formatMessage(V.tableIndustryColumn);return y.useEffect(()=>{var M,T,D,v,j,z;if(x.length===0)return;const p=!!s&&Object.keys((M=s.map)!=null?M:{}).length>0,N=!!a&&Object.keys((T=a.map)!=null?T:{}).length>0,P="model|".concat((D=s==null?void 0:s.day)!=null?D:"unknown","|").concat((v=a==null?void 0:a.day)!=null?v:"unknown","|").concat(p,"|").concat(N,"|").concat(x.length);c.current!==P&&(O.logEvent("Workspace Usage: Benchmark Model Chart Rendered",{workspace_metric_day:(j=s==null?void 0:s.day)!=null?j:null,industry_metric_day:(z=a==null?void 0:a.day)!=null?z:null,industry:m,workspace_model_metric_displayed:p,industry_model_metric_displayed:N,model_category_count_displayed:x.length}),c.current=P)},[a,m,x.length,s]),y.useEffect(()=>{var M,T,D,v,j,z;if(_.length===0)return;const p=!!t&&Object.keys((M=t.map)!=null?M:{}).length>0,N=!!n&&Object.keys((T=n.map)!=null?T:{}).length>0,P="tool|".concat((D=t==null?void 0:t.day)!=null?D:"unknown","|").concat((v=n==null?void 0:n.day)!=null?v:"unknown","|").concat(p,"|").concat(N,"|").concat(_.length);w.current!==P&&(O.logEvent("Workspace Usage: Benchmark Tool Chart Rendered",{workspace_metric_day:(j=t==null?void 0:t.day)!=null?j:null,industry_metric_day:(z=n==null?void 0:n.day)!=null?z:null,industry:m,workspace_tool_metric_displayed:p,industry_tool_metric_displayed:N,tool_category_count_displayed:_.length}),w.current=P)},[m,n,_.length,t]),y.useEffect(()=>{var M,T,D,v,j,z;if(C.length===0)return;const p=!!i&&Object.keys((M=i.map)!=null?M:{}).length>0,N=!!o&&Object.keys((T=o.map)!=null?T:{}).length>0,P="connector|".concat((D=i==null?void 0:i.day)!=null?D:"unknown","|").concat((v=o==null?void 0:o.day)!=null?v:"unknown","|").concat(p,"|").concat(N,"|").concat(C.length);b.current!==P&&(O.logEvent("Workspace Usage: Benchmark Connector Chart Rendered",{workspace_metric_day:(j=i==null?void 0:i.day)!=null?j:null,industry_metric_day:(z=o==null?void 0:o.day)!=null?z:null,industry:m,workspace_connector_metric_displayed:p,industry_connector_metric_displayed:N,connector_category_count_displayed:C.length}),b.current=P)},[C.length,o,m,i]),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("div",{className:"text-token-text-primary text-[15px] font-semibold",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,u({},V.workspaceModelChartTitle)),e.jsx(Me,{label:g.formatMessage(V.industryMedianTooltip),side:"top",sideOffset:4,className:"text-token-text-tertiary",children:e.jsx(Fe,{className:"h-4 w-4"})})]})}),e.jsx(ia,{data:x,workspaceLabel:k,industryLabel:h}),e.jsx("div",{className:"text-token-text-primary text-[15px] font-semibold",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,u({},V.workspaceToolChartTitle)),e.jsx(Me,{label:g.formatMessage(V.industryMedianTooltip),side:"top",sideOffset:4,className:"text-token-text-tertiary",children:e.jsx(Fe,{className:"h-4 w-4"})})]})}),e.jsx(ia,{data:_,workspaceLabel:k,industryLabel:h}),r?e.jsx("div",{className:"text-token-text-primary text-[15px] font-semibold",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,u({},V.workspaceConnectorChartTitle)),e.jsx(Me,{label:g.formatMessage(V.industryMedianTooltip),side:"top",sideOffset:4,className:"text-token-text-tertiary",children:e.jsx(Fe,{className:"h-4 w-4"})})]})}):e.jsx("div",{}),r?e.jsx(ia,{data:C,workspaceLabel:k,industryLabel:h}):e.jsx("div",{})]})}function ia({data:s,workspaceLabel:a,industryLabel:t}){const n=ye();return e.jsx("div",{className:"border-token-border-default flex min-h-[250px] flex-col gap-2 rounded-lg border p-4",children:s.length===0?e.jsx("div",{className:"text-token-text-tertiary text-sm",children:n.formatMessage(V.noData)}):e.jsx("div",{className:"h-80",children:e.jsx(Ts,{children:e.jsxs(Us,{data:s,margin:{top:8,right:16,left:8,bottom:8},children:[e.jsx(Ns,{dataKey:"name",tickLine:!1,axisLine:!1,interval:0,angle:45,textAnchor:"start",tick:{fontSize:12},tickMargin:16}),e.jsx(Ss,{tickLine:!1,axisLine:!1,tickFormatter:i=>"".concat(i,"%")}),e.jsx(Ls,{formatter:(i,o,d)=>{const m=(d==null?void 0:d.dataKey)==="workspace"||o===a;return["".concat(i.toFixed(1),"%"),m?a:t]},labelStyle:{fontWeight:600}}),e.jsx(Es,{wrapperStyle:{paddingTop:100},payload:[{value:a,type:"square",color:Ye[0]},{value:t?n.formatMessage(V.legendIndustryMedian,{industry:t}):n.formatMessage(V.tableIndustryColumn),type:"square",color:Ye[1]}]}),e.jsx(Ma,{dataKey:"workspace",name:a,fill:Ye[0],radius:[4,4,0,0]}),e.jsx(Ma,{dataKey:"industry",name:t,fill:Ye[1],radius:[4,4,0,0]})]})})})})}const Ce=Ee(Ea(new Date,1)),Le=new Date;function ta({onLeft:s,leftDisabled:a,onRight:t,rightDisabled:n,children:i,className:o,borderLess:d=!1,surpressChildrenWrapper:m=!1}){return e.jsxs("div",{className:X("flex items-stretch",o),children:[e.jsx(ce,{className:X("disabled:text-token-text-quaternary pe-1",!d&&"border-token-border-medium rounded-e-none border-e-0 disabled:opacity-100"),color:d?"ghost":"secondary",size:"small",onClick:s,disabled:a,icon:ds}),m?i:e.jsx("span",{className:X("flex grow items-center justify-center px-1 text-sm",!d&&"border-token-border-medium border-t border-b"),children:i}),e.jsx(ce,{className:X("disabled:text-token-text-quaternary ps-1",!d&&"border-token-border-medium rounded-s-none border-s-0 disabled:opacity-100"),color:d?"ghost":"secondary",size:"small",onClick:t,disabled:n,icon:Ds})]})}const ct=Fs(12);function Qa({referenceDate:s,setReferenceDate:a,earliestValidDate:t,latestValidDate:n,motionLayoutId:i}){return e.jsxs(e.Fragment,{children:[e.jsx(ta,{className:"mb-2 w-full",borderLess:!0,onLeft:()=>a(Ea(s,1),"subYear"),onRight:()=>a(ms(s,1),"addYear"),leftDisabled:Ve(new Date)>=Ve(s)+1,rightDisabled:Ve(new Date)<=Ve(s),children:ne(s,"y")}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:ct.map(o=>{const d=Ee(us(s,o)),m=ra(d,s),r=ze(d,t)||Oe(d,n);return e.jsxs("button",{disabled:r,onClick:()=>a(d,"select"),className:X("relative h-8 w-full rounded-md",!r&&"hover:bg-token-surface-hover"),children:[m&&e.jsx(Da.div,{layoutId:i,className:"bg-token-main-surface-primary-inverse absolute inset-0 rounded-md",transition:{duration:.15}}),e.jsx("span",{className:X("relative z-10 transition-colors duration-75",m&&"text-token-main-surface-primary delay-75",!m&&"text-token-text-primary delay-0",r&&"text-token-text-quaternary"),children:ne(d,"MMM")})]},o)})})]})}function dt({currentWorkspaceId:s,currentTab:a,onClose:t}){var _;const n=ye(),[i,o]=y.useState(!1),[d,m]=y.useState(a==="gptsTab"?"gpt":"user"),[r,g]=y.useState("thisMonth"),[c,w]=y.useState(),b=(_=gs(C=>{var k;return(k=C.currentWorkspace)==null?void 0:k.name}))!=null?_:s,U=new Date,x=Aa(new Date,1);return e.jsxs(Pa,{testId:"modal-export",isOpen:!0,onClose:()=>{t(),O.logEvent("Workspace Usage: Export Modal Closed Without Generation")},type:"success",title:e.jsx(f,u({},se.title)),showCloseButton:!0,primaryButton:e.jsx(ce,{loading:i,onClick:async()=>{var C,k;o(!0);try{const h=r==="customRange"?{period:(C=c==null?void 0:c.period)!=null?C:$e.period,period_start:Y((k=c==null?void 0:c.referenceDate)!=null?k:$e.referenceDate)}:gt(r);O.logEvent("Workspace Usage: Export Generate CSV Clicked",{reportType:d,dateRangeType:r,period:h.period,periodStart:h.period_start});const p=await me.safeGet("/accounts/{account_id}/reporting",{parameters:{path:{account_id:s},query:ee(u({},h),{report_type:d})}});qs({data:p.csv_content,mimeType:"text/csv",filename:n.formatMessage(se.filename,{workspaceName:b,period:h.period,reportType:d,date:h.period_start})})}finally{o(!1)}t()},children:e.jsx(f,u({},se.generateCsvButton))}),children:[e.jsxs($s,{className:"font-medium",children:[e.jsx(f,u({},se.dataTypeDropdownLabel)),e.jsx(As,{triggerClassName:"flex mt-2 border border-token-border-default text-base focus-visible:border-token-border-default w-full justify-between",value:d,onValueChange:C=>m(C),options:[{label:n.formatMessage(se.dataTypeDropdownUsers),value:"user"},{label:n.formatMessage(se.dataTypeDropdownGpts),value:"gpt"}]})]}),e.jsx("div",{className:"mt-6 mb-2 font-medium",children:e.jsx(f,u({},se.dateRangeLabel))}),e.jsxs(ke.Root,{className:"flex flex-col gap-3",value:r,onValueChange:C=>{g(C),O.logEvent("Workspace Usage: Export Date Range Type Changed",{dateRangeType:C})},children:[e.jsx(ke.Item,{value:"thisMonth",label:e.jsx(f,ee(u({},se.thisMonthLabel),{values:{date:ne(U,"MMMM y")}})),children:e.jsx(ke.Indicator,{})}),e.jsx(ke.Item,{value:"lastMonth",label:e.jsx(f,ee(u({},se.lastMonthLabel),{values:{date:ne(Ne(U,1),"MMMM y")}})),children:e.jsx(ke.Indicator,{})}),e.jsx(ke.Item,{value:"thisWeek",label:e.jsx(f,ee(u({},se.thisWeekLabel),{values:{date:"".concat(ne(Ke(U),"MMM d")," – ").concat(ne(Xe(U),"MMM d"))}})),children:e.jsx(ke.Indicator,{})}),e.jsx(ke.Item,{value:"lastWeek",label:e.jsx(f,ee(u({},se.lastWeekLabel),{values:{date:"".concat(ne(Ke(x),"MMM d")," – ").concat(ne(Xe(x),"MMM d"))}})),children:e.jsx(ke.Indicator,{})}),e.jsx(ke.Item,{value:"customRange",label:e.jsx(mt,{customRange:c,setCustomRange:w,onClick:()=>g("customRange")}),children:e.jsx(ke.Indicator,{})})]})]})}const $e={period:"monthly",referenceDate:new Date};function mt({customRange:s,setCustomRange:a,onClick:t}){const n=ye(),i=(s!=null?s:$e).period,o=(s!=null?s:$e).referenceDate,d=i==="monthly"?aa(o):Xe(o),m=({period:r,referenceDate:g})=>a((c=$e)=>{const w=r!=null?r:c.period,b=g!=null?g:c.referenceDate,U=w==="monthly"?Ee:Ke,x=Oe(b,Le)?Le:ze(b,Ce)?Ce:b;return{period:w,referenceDate:U(x)}});return e.jsx(Ra,{className:"z-50",alignAgainstAnchor:"start",triggerButton:e.jsxs(ce,{size:"small",color:"secondary",contentsFullWidth:!0,onClick:t,children:[s?e.jsx(f,ee(u({},se.customRangeDisplay),{values:{start:ka(s.referenceDate),end:ka(d)}})):e.jsx(f,u({},se.chooseMonthOrWeekButton)),e.jsx("div",{className:"grow"}),e.jsx(Ps,{})]}),children:e.jsxs("div",{className:"w-[210px] p-1 text-xs",children:[e.jsx(Gs,{className:"mb-4 rounded-md",value:i,onChange:r=>{m({period:r}),O.logEvent("Workspace Usage: Export Custom Period Changed",{period:r})},ariaLabel:n.formatMessage(se.customRangePeriodToggleAria),leftItem:{className:"rounded-md",ariaLabel:n.formatMessage(se.chooseDateMonthlyLabel),label:n.formatMessage(se.chooseDateMonthlyLabel),value:"monthly"},rightItem:{className:"rounded-md",ariaLabel:n.formatMessage(se.chooseDateWeeklyLabel),label:n.formatMessage(se.chooseDateWeeklyLabel),value:"weekly"}}),i==="monthly"?e.jsx(Qa,{referenceDate:o,setReferenceDate:(r,g)=>{m({referenceDate:r}),O.logEvent("Workspace Usage: Export Custom Reference Date Changed",{period:"monthly",change:g})},earliestValidDate:Ce,latestValidDate:Le,motionLayoutId:"workspaceUsage.exportModal.customRange.monthHighlight"}):e.jsxs(e.Fragment,{children:[e.jsx(ta,{className:"mb-2 w-full",borderLess:!0,onLeft:()=>{m({referenceDate:Ne(o,1)}),O.logEvent("Workspace Usage: Export Custom Reference Date Changed",{period:"weekly",change:"subMonth"})},onRight:()=>{m({referenceDate:Je(o,1)}),O.logEvent("Workspace Usage: Export Custom Reference Date Changed",{period:"weekly",change:"addMonth"})},leftDisabled:ze(Ne(o,1),Ce),rightDisabled:Oe(Je(o,1),Le),children:ne(o,"MMMM y")}),e.jsx(ut,{referenceDate:o,setReferenceDate:r=>m({referenceDate:r})})]})]})})}const ut=({referenceDate:s,setReferenceDate:a})=>{const t=Ee(s),n=za({start:t,end:aa(s)});return e.jsx("div",{className:"flex flex-col gap-1",children:n.map(i=>{const o=ps(i,s),d=ze(i,Ce)||Oe(i,new Date);return e.jsxs("button",{disabled:d,onClick:()=>{a(i),O.logEvent("Workspace Usage: Export Custom Reference Date Changed",{period:"weekly",change:"select"})},className:X("relative h-8 w-full rounded-full",!d&&"hover:bg-token-surface-hover"),children:[o&&e.jsx(Da.div,{layoutId:"workspaceUsage.exportModal.customRange.weekHighlight.".concat(t.toISOString()),className:"bg-token-main-surface-primary-inverse absolute inset-0 rounded-full",transition:{duration:.15}}),e.jsx("div",{className:X("relative z-10 flex w-full justify-around transition-colors duration-75",o&&"text-token-main-surface-primary delay-75",!o&&"text-token-text-primary delay-0"),children:Oa({start:i,end:Xe(i)}).map(m=>e.jsx("div",{className:X("w-0 grow",{"text-token-text-quaternary":!ra(m,s)||Oe(m,new Date)||ze(m,Ce)}),children:ne(m,"d")},m.toISOString()))})]},i.toISOString())})})};function gt(s){const a=new Date;return s==="thisWeek"||s==="lastWeek"?{period:"weekly",period_start:Y(Ke(s==="thisWeek"?a:Aa(a,1)))}:{period:"monthly",period_start:Y(Ee(s==="thisMonth"?a:Ne(a,1)))}}const se=pe({title:{id:"workspaceUsage.exportModal.title",defaultMessage:"Export data"},dataTypeDropdownLabel:{id:"workspaceUsage.exportModal.dataTypeDropdownLabel",defaultMessage:"Data type"},dataTypeDropdownUsers:{id:"workspaceUsage.exportModal.dataTypeDropdownUsers",defaultMessage:"Users"},dataTypeDropdownGpts:{id:"workspaceUsage.exportModal.dataTypeDropdownGpts",defaultMessage:"GPTs"},dateRangeLabel:{id:"workspaceUsage.exportModal.dateRangeLabel",defaultMessage:"Date range"},thisMonthLabel:{id:"workspaceUsage.exportModal.thisMonthLabel",defaultMessage:"This month ({date})"},lastMonthLabel:{id:"workspaceUsage.exportModal.lastMonthLabel",defaultMessage:"Last month ({date})"},thisWeekLabel:{id:"workspaceUsage.exportModal.thisWeekLabel",defaultMessage:"This week ({date})"},lastWeekLabel:{id:"workspaceUsage.exportModal.lastWeekLabel",defaultMessage:"Last week ({date})"},chooseMonthOrWeekButton:{id:"workspaceUsage.exportModal.chooseMonthOrWeekButton",defaultMessage:"Choose month or week"},customRangeDisplay:{id:"workspaceUsage.exportModal.customRangeDisplay",defaultMessage:"{start} – {end}"},generateCsvButton:{id:"workspaceUsage.exportModal.generateCsvButton",defaultMessage:"Generate CSV"},customRangePeriodToggleAria:{id:"workspaceUsage.exportModal.customRangePeriodToggleAria",defaultMessage:"Date range period choice"},chooseDateMonthlyLabel:{id:"workspaceUsage.exportModal.chooseDateMonthlyLabel",defaultMessage:"Monthly"},chooseDateWeeklyLabel:{id:"workspaceUsage.exportModal.chooseDateWeeklyLabel",defaultMessage:"Weekly"},filename:{id:"workspaceUsage.exportModal.filename",defaultMessage:"{workspaceName} {period} {reportType} report {date}.csv"}});function ca({startDate:s,statsSpec:a,data:t,previousData:n}){return e.jsx("div",{className:"border-token-border-default my-6 flex min-h-[80px] w-full rounded-lg border px-2 py-4",children:a.map(({dataKey:i,label:o,helpText:d})=>{const m=t==null?"loading":t[i],r=n==null?"loading":n[i];return e.jsxs("div",{className:"border-token-border-default flex w-0 grow flex-col justify-between border-e px-4 last:me-0 last:border-e-0",children:[e.jsxs("div",{className:"text-token-text-secondary text-sm",children:[e.jsx(f,u({},o)),e.jsx(Wa,{}),d&&e.jsx(Me,{label:e.jsx("span",{className:"text-token-main-surface-primary font-normal",children:e.jsx(f,u({},d))}),side:"top",customBackgroundColorClassName:"bg-token-main-surface-primary-inverse",children:e.jsx(Fe,{className:"icon-sm inline"})})]}),e.jsx(Cs,{value:m,previousValue:r,hideTrend:ra(s,new Date),className:"h-[28px]"})]},i)})})}function da({handleSearch:s,clientEventSource:a,className:t}){const i=ye().formatMessage(pt.filterListInputLabel),o=y.useCallback(fs(d=>{s(d),O.logEvent("Workspace Usage: Filter Searched",{queryLength:d.length,trigger:"debouncedTyping",source:a})},250),[]);return e.jsx(zs,{className:X("max-w-[300px]",t),ariaLabel:i,placeholder:i,type:"text",name:"search",icon:xs,iconPosition:"left",saveOnBlur:!0,value:"",onChange:d=>o(d.target.value.trim()),onPressEnter:d=>{var r;const m=(r=d==null?void 0:d.trim())!=null?r:"";s(m),O.logEvent("Workspace Usage: Filter Searched",{queryLength:m.length,trigger:"enterKey",source:a})}})}const pt=pe({filterListInputLabel:{id:"workspaceUsage.filterListInputLabel",defaultMessage:"Search"}}),_a=20,wa=[{cursor:void 0,queryId:void 0}];function ma({getQueryKey:s,loader:a,initialSortDirection:t,spec:n,getData:i,clientEventSource:o}){var N,P;const[d,m]=y.useState(t),[r,g]=y.useState(wa),[c,w]=y.useState(0),[b,U]=y.useState(),x=ve({queryKey:s({order_by_field:d.metric,order_by_direction:d.direction,cursor:(N=r[c])==null?void 0:N.cursor,query_id:(P=r[c])==null?void 0:P.queryId,page_size:_a}),queryFn:({queryKey:M})=>a(M)}),_=x.data?i(x.data):"loading",C=Os(_),k=_==="loading"&&C.current!=="loading",h=k?C.current:_;y.useEffect(()=>{var M,T;(M=x.data)!=null&&M.next_cursor&&((T=x.data)!=null&&T.query_id)&&r.length===c+1&&g(D=>{var v,j;return[...D,{cursor:(v=x.data)==null?void 0:v.next_cursor,queryId:(j=x.data)==null?void 0:j.query_id}]})},[x.data,r,c]),y.useEffect(()=>{b==null&&x.data&&(x.data.total_count!=null?U(Math.ceil(x.data.total_count/_a)):U(1))},[x.data,r,b]);const p=d.direction==="ASC"?Hs:Ks;return e.jsxs("div",{className:"mt-4",children:[e.jsxs(ae.Root,{className:"border-token-border-medium mb-4 border-b-[0.5px]",children:[e.jsx(ae.Header,{children:n.map(({metric:M,label:T,defaultSortDirection:D="ASC"})=>e.jsxs(ae.HeaderCell,{className:"text-[13px] font-medium text-nowrap",onClick:()=>{w(0),g(wa),m(v=>{let j;return M===v.metric?j=v.direction==="ASC"?"DESC":"ASC":j=D,O.logEvent("Workspace Usage: Table Sort Clicked",{metric:M,direction:j,source:o}),{direction:j,metric:M}})},children:[T,d.metric===M&&e.jsx(p,{className:"icon text-token-icon-secondary ms-1 inline"})]},M))}),e.jsx(ae.Body,{children:h&&h!=="loading"&&h.map((M,T)=>e.jsx(ae.Row,{children:n.map(({metric:D,render:v},j)=>e.jsx(ae.Cell,{className:X(k&&"pt-0 pb-0 [&]:border-0"),divClassName:X("items-center",j>0&&"text-token-text-secondary",!k&&"min-h-[40px]",k&&"h-0 overflow-hidden"),children:v(M[D],M)},D))},T))})]}),_==="loading"&&e.jsx("div",{className:"flex h-[860px] items-center justify-center",children:e.jsx(je,{})}),_!=="loading"&&_.length===0&&e.jsx("div",{className:"flex h-[100px] items-center justify-center",children:e.jsx(f,u({},ft.zeroStateMessage))}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(ta,{onLeft:()=>{w(M=>{const T=M-1;return O.logEvent("Workspace Usage: Pagination Clicked",{direction:"left",pageIndex:T,source:o}),T})},leftDisabled:c<=0,onRight:()=>{w(M=>{const T=M+1;return O.logEvent("Workspace Usage: Pagination Clicked",{direction:"right",pageIndex:T,source:o}),T})},rightDisabled:r[c+1]==null,children:[c+1,"/",b!=null?b:e.jsx(je,{})]})})]})}const ft=pe({zeroStateMessage:{id:"workspaceUsage.table.zeroStateMessage",defaultMessage:"No results found"}});function ea(s,a,t){return ve({queryKey:["workspace-analytics-gizmo-stats",{workspaceId:s,startDate:a,gizmoType:t!=null?t:null}],queryFn:de(({queryKey:[n,i]})=>{const o={start_date:i.startDate};return i.gizmoType&&(o.gizmo_type=i.gizmoType),me.safeGet("/accounts/{account_id}/analytics/gizmo_stats",{parameters:{query:o,path:{account_id:i.workspaceId}}})})})}async function Va(n){var[s,i]=n,o=i,{workspaceId:a}=o,t=Ae(o,["workspaceId"]);return me.safeGet("/accounts/{account_id}/analytics/gizmo_list",{parameters:{path:{account_id:a},query:t}})}const Ya={direction:"DESC",metric:"active_users"};function xt({currentWorkspaceId:s,startDate:a}){const[t,n]=y.useState(""),i=Y(a),o=y.useCallback(c=>["workspace-analytics-gizmos-list",u({workspaceId:s,start_date:i,filter_query:t,gizmo_type:"gpt"},c)],[i,t,s]),d=ea(s,i,"gpt"),m=Y(Ne(a,1)),r=ea(s,m,"gpt"),g=de(Va);return e.jsxs("div",{className:"mb-8",children:[e.jsx(ca,{startDate:a,data:d.data,previousData:r.data,statsSpec:yt}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(da,{className:"grow",handleSearch:n,clientEventSource:"gizmoList"}),e.jsx(ce,{as:"link",to:"/admin/gpts",size:"small",color:"secondary",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(f,u({},le.manageGPTs)),e.jsx(Fa,{className:"icon-sm"})]})})]}),e.jsx(ma,{getQueryKey:o,loader:g,getData:c=>c.gizmos,spec:Za,initialSortDirection:Ya,clientEventSource:"gizmoList"},"".concat(s,".gpt.").concat(i,".").concat(t))]})}function ht({currentWorkspaceId:s,startDate:a}){const[t,n]=y.useState(""),i=Y(a),o=y.useCallback(c=>["workspace-analytics-gizmos-list",u({workspaceId:s,start_date:i,filter_query:t,gizmo_type:"project"},c)],[i,t,s]),d=ea(s,i,"project"),m=Y(Ne(a,1)),r=ea(s,m,"project"),g=de(Va);return e.jsxs("div",{className:"mb-8",children:[e.jsx(ca,{startDate:a,data:d.data,previousData:r.data,statsSpec:bt}),e.jsx("div",{className:"flex justify-between",children:e.jsx(da,{className:"grow",handleSearch:n,clientEventSource:"projectList"})}),e.jsx(ma,{getQueryKey:o,loader:g,getData:c=>c.gizmos,spec:Za,initialSortDirection:Ya,clientEventSource:"projectList"},"".concat(s,".project.").concat(i,".").concat(t))]})}const le=pe({totalGpts:{id:"workspaceUsage.gizmoList.stats.totalGpts",defaultMessage:"Total GPTs"},gptsCreatedThisMonth:{id:"workspaceUsage.gizmoList.stats.gptsCreatedThisMonth",defaultMessage:"GPTs Created This Month"},gptsActive:{id:"workspaceUsage.gizmoList.stats.gptsActive",defaultMessage:"GPTs active"},gptsActiveHelpText:{id:"workspaceUsage.gizmoList.stats.gptsActiveHelpText",defaultMessage:"GPTs that have sent at lease one message during this month"},nameColumnLabel:{id:"workspaceUsage.gizmoList.tableHeader.name",defaultMessage:"Name"},messagesColumnLabel:{id:"workspaceUsage.gizmoList.tableHeader.messages",defaultMessage:"Total Messages"},creatorNameColumnLabel:{id:"workspaceUsage.gizmoList.tableHeader.creatorName",defaultMessage:"Creator Name"},activeUsersColumnLabel:{id:"workspaceUsage.gizmoList.tableHeader.activeUsersColumnLabel",defaultMessage:"Active Users"},draftFlag:{id:"workspaceUsage.gizmoList.draftFlag",defaultMessage:"Draft"},manageGPTs:{id:"workspaceUsage.gizmoList.manageGPTs",defaultMessage:"Manage GPTs"},totalProjects:{id:"workspaceUsage.gizmoList.stats.totalProjects",defaultMessage:"Total Projects"},projectsCreatedThisMonth:{id:"workspaceUsage.gizmoList.stats.projectsCreatedThisMonth",defaultMessage:"Projects Created This Month"},projectsActive:{id:"workspaceUsage.gizmoList.stats.projectsActive",defaultMessage:"Projects active"},projectsActiveHelpText:{id:"workspaceUsage.gizmoList.stats.projectsActiveHelpText",defaultMessage:"Projects with at least one message during this month"}}),yt=[{dataKey:"total_gpt_count",label:le.totalGpts},{dataKey:"gpt_created",label:le.gptsCreatedThisMonth},{dataKey:"active_gpt_count",label:le.gptsActive,helpText:le.gptsActiveHelpText}],bt=[{dataKey:"total_gpt_count",label:le.totalProjects},{dataKey:"gpt_created",label:le.projectsCreatedThisMonth},{dataKey:"active_gpt_count",label:le.projectsActive,helpText:le.projectsActiveHelpText}],kt=new Intl.NumberFormat(void 0,{notation:"compact",maximumSignificantDigits:3});function ja(s){return typeof s=="number"?kt.format(s):null}const Za=[{metric:"gpt_name",label:e.jsx(f,u({},le.nameColumnLabel)),render:(s,{config_type:a})=>e.jsxs("div",{className:"flex grow items-center justify-between",children:[e.jsx("span",{children:s}),a==="draft"&&e.jsx("span",{className:"text-token-text-secondary text-xs",children:e.jsx(f,u({},le.draftFlag))})]})},{label:e.jsx(f,u({},le.creatorNameColumnLabel)),metric:"creator_name",render:s=>s},{metric:"messages",label:e.jsx(f,u({},le.messagesColumnLabel)),render:ja,defaultSortDirection:"DESC"},{metric:"active_users",label:e.jsx(f,u({},le.activeUsersColumnLabel)),render:ja,defaultSortDirection:"DESC"}];function Mt({startDate:s,setStartDate:a}){return e.jsx(ta,{onLeft:()=>{a(t=>{const n=Ne(t,1);return O.logEvent("Workspace Usage: Month Changed",{direction:"left",startDate:Y(n)}),n})},leftDisabled:ze(Ne(s,1),Ce),onRight:()=>{a(t=>{const n=Je(t,1);return O.logEvent("Workspace Usage: Month Changed",{direction:"right",startDate:Y(n)}),n})},rightDisabled:Oe(Je(s,1),Le),surpressChildrenWrapper:!0,children:e.jsx(vt,{startDate:s,setStartDate:a})})}function vt({startDate:s,setStartDate:a}){return e.jsx(Ra,{triggerButton:e.jsx(ce,{size:"small",color:"secondary",className:"rounded-none border-x-0 border-e-0 px-1",children:ne(s,"MMM y")}),children:e.jsx("div",{className:"w-[210px] p-1 text-xs",children:e.jsx(Qa,{referenceDate:s,setReferenceDate:(t,n)=>{const i=Ee(Oe(t,Le)?Le:ze(t,Ce)?Ce:t);a(i),O.logEvent("Workspace Usage: Month Changed",{direction:n,startDate:Y(i)})},earliestValidDate:Ce,latestValidDate:Le,motionLayoutId:"workspaceUsage.monthSelector.monthHighlight"})})})}const Ca=["#1D4ED8","#2563EB","#3B82F6","#60A5FA","#93C5FD","#BFDBFE","#DBEAFE","#E0E7FF","#C7D2FE","#A5B4FC","#818CF8","#6366F1","#4F46E5","#4338CA","#3730A3","#312E81"];function Xa(s,a,t){var n;return ve({queryKey:["workspace-classification",{workspaceId:s,startDate:a}],queryFn:de(({queryKey:[i,o]})=>me.safeGet("/accounts/{account_id}/analytics/classification",{parameters:{path:{account_id:o.workspaceId},query:{start_date:o.startDate}}})),enabled:(n=t==null?void 0:t.enabled)!=null?n:!0})}const F=pe({explainConceptsName:{id:"workspaceUsage.classification.taskType.explainConcepts.name",defaultMessage:"Explain concepts"},explainConceptsExample:{id:"workspaceUsage.classification.taskType.explainConcepts.example",defaultMessage:"Explain technical topics, simplify for executives, clarify jargon"},factualLookupName:{id:"workspaceUsage.classification.taskType.factualLookup.name",defaultMessage:"Factual lookup"},factualLookupExample:{id:"workspaceUsage.classification.taskType.factualLookup.example",defaultMessage:"Retrieve facts, check current figures, verify statistics"},howToGuidanceName:{id:"workspaceUsage.classification.taskType.howToGuidance.name",defaultMessage:"How-to guidance"},howToGuidanceExample:{id:"workspaceUsage.classification.taskType.howToGuidance.example",defaultMessage:"Step-by-step instructions, process walkthroughs, troubleshooting"},researchName:{id:"workspaceUsage.classification.taskType.research.name",defaultMessage:"Research"},researchExample:{id:"workspaceUsage.classification.taskType.research.example",defaultMessage:"Market intelligence, literature search, policy research, competitor scan"},summarizeName:{id:"workspaceUsage.classification.taskType.summarize.name",defaultMessage:"Summarize"},summarizeExample:{id:"workspaceUsage.classification.taskType.summarize.example",defaultMessage:"Meeting notes, article summaries, condense long reports"},communicateName:{id:"workspaceUsage.classification.taskType.communicate.name",defaultMessage:"Communicate"},communicateExample:{id:"workspaceUsage.classification.taskType.communicate.example",defaultMessage:"Draft briefs, write memos, prepare reports, internal updates"},translateLocalizeName:{id:"workspaceUsage.classification.taskType.translateLocalize.name",defaultMessage:"Translate/localize"},translateLocalizeExample:{id:"workspaceUsage.classification.taskType.translateLocalize.example",defaultMessage:"Language translation, adapt content to local context, cultural adaptation"},ideateName:{id:"workspaceUsage.classification.taskType.ideate.name",defaultMessage:"Ideate"},ideateExample:{id:"workspaceUsage.classification.taskType.ideate.example",defaultMessage:"Brainstorming, product ideas, naming options, creative variants"},createMediaName:{id:"workspaceUsage.classification.taskType.createMedia.name",defaultMessage:"Create media"},createMediaExample:{id:"workspaceUsage.classification.taskType.createMedia.example",defaultMessage:"Generate images, video, audio"},analyzeDataName:{id:"workspaceUsage.classification.taskType.analyzeData.name",defaultMessage:"Analyze data"},analyzeDataExample:{id:"workspaceUsage.classification.taskType.analyzeData.example",defaultMessage:"Data extraction & structuring, spreadsheet analysis, KPI tracking, forecasting, scenario modelling, trend analysis"},visualizeReportDataName:{id:"workspaceUsage.classification.taskType.visualizeReportData.name",defaultMessage:"Visualize & report on data"},visualizeReportDataExample:{id:"workspaceUsage.classification.taskType.visualizeReportData.example",defaultMessage:"Dashboards, heatmaps, distributions, stakeholder reports"},codingAutomationName:{id:"workspaceUsage.classification.taskType.codingAutomation.name",defaultMessage:"Coding & automation"},codingAutomationExample:{id:"workspaceUsage.classification.taskType.codingAutomation.example",defaultMessage:"Code generation, debugging, API usage, scripts, tool orchestration"},strategicPlanningName:{id:"workspaceUsage.classification.taskType.strategicPlanning.name",defaultMessage:"Strategic planning & decision support"},strategicPlanningExample:{id:"workspaceUsage.classification.taskType.strategicPlanning.example",defaultMessage:"Scenario planning, option comparison, risk assessment, prioritization"},otherTaskTypeName:{id:"workspaceUsage.classification.taskType.other.name",defaultMessage:"Other"},otherTaskTypeExample:{id:"workspaceUsage.classification.taskType.other.example",defaultMessage:"Tasks that are unclear, personal, casual, or don’t fit into any category"}}),I=pe({leadershipManagementName:{id:"workspaceUsage.classification.businessContext.leadershipManagement.name",defaultMessage:"Leadership & management"},leadershipManagementExample:{id:"workspaceUsage.classification.businessContext.leadershipManagement.example",defaultMessage:"Strategic decision-making, board prep, goal-setting, team oversight, milestone tracking, stakeholder persuasion, conflict resolution"},financeName:{id:"workspaceUsage.classification.businessContext.finance.name",defaultMessage:"Finance"},financeExample:{id:"workspaceUsage.classification.businessContext.finance.example",defaultMessage:"Investment research, budgeting, financial modelling, cost-benefit analysis, reconciliations, audit prep, reporting templates, variance analysis"},legalName:{id:"workspaceUsage.classification.businessContext.legal.name",defaultMessage:"Legal"},legalExample:{id:"workspaceUsage.classification.businessContext.legal.example",defaultMessage:"Contract review, regulatory monitoring, compliance training"},publicAffairsName:{id:"workspaceUsage.classification.businessContext.publicAffairs.name",defaultMessage:"Public affairs & government"},publicAffairsExample:{id:"workspaceUsage.classification.businessContext.publicAffairs.example",defaultMessage:"Policy briefings, legislative tracking, advocacy material"},marketingName:{id:"workspaceUsage.classification.businessContext.marketing.name",defaultMessage:"Marketing"},marketingExample:{id:"workspaceUsage.classification.businessContext.marketing.example",defaultMessage:"Campaign ideas, SEO optimisation, ad copy, brand messaging"},salesName:{id:"workspaceUsage.classification.businessContext.sales.name",defaultMessage:"Sales"},salesExample:{id:"workspaceUsage.classification.businessContext.sales.example",defaultMessage:"Proposal writing, pitch decks, objection handling, prospect research, revops"},customerSupportName:{id:"workspaceUsage.classification.businessContext.customerSupport.name",defaultMessage:"Customer support"},customerSupportExample:{id:"workspaceUsage.classification.businessContext.customerSupport.example",defaultMessage:"Response guides, troubleshooting scripts, escalation summaries"},operationsInfrastructureName:{id:"workspaceUsage.classification.businessContext.operationsInfrastructure.name",defaultMessage:"Operations & infrastructure"},operationsInfrastructureExample:{id:"workspaceUsage.classification.businessContext.operationsInfrastructure.example",defaultMessage:"Supply chain analysis, process mapping, resource allocation, vendor comparison, RFP drafting, contract negotiation, workplace policies"},peopleCultureName:{id:"workspaceUsage.classification.businessContext.peopleCulture.name",defaultMessage:"People & culture"},peopleCultureExample:{id:"workspaceUsage.classification.businessContext.peopleCulture.example",defaultMessage:"Hiring guides, onboarding materials, role definitions, performance feedback, wellbeing initiatives, culture-building activities, employee engagement"},trainingTeachingName:{id:"workspaceUsage.classification.businessContext.trainingTeaching.name",defaultMessage:"Training & teaching"},trainingTeachingExample:{id:"workspaceUsage.classification.businessContext.trainingTeaching.example",defaultMessage:"Training curriculum, lesson planning, upskilling, learning & development"},itSecurityName:{id:"workspaceUsage.classification.businessContext.itSecurity.name",defaultMessage:"IT & security"},itSecurityExample:{id:"workspaceUsage.classification.businessContext.itSecurity.example",defaultMessage:"Sysadmin fixes, cloud identity management, endpoint/device troubleshooting, enterprise app integration, incident reports, data privacy compliance"},softwareDevelopmentName:{id:"workspaceUsage.classification.businessContext.softwareDevelopment.name",defaultMessage:"Software development"},softwareDevelopmentExample:{id:"workspaceUsage.classification.businessContext.softwareDevelopment.example",defaultMessage:"System design, API architecture, frontend/backend coding, debugging, code reviews, requirements gathering, user story drafting, roadmap summaries"},scienceEngineeringName:{id:"workspaceUsage.classification.businessContext.scienceEngineering.name",defaultMessage:"Science, engineering & technical (non-software)"},scienceEngineeringExample:{id:"workspaceUsage.classification.businessContext.scienceEngineering.example",defaultMessage:"Mechanical, electrical, civil, chemical engineering; technical documentation; scientific literature reviews, research methodologies, grant applications"},dataScienceEngineeringName:{id:"workspaceUsage.classification.businessContext.dataScienceEngineering.name",defaultMessage:"Data science & data engineering"},dataScienceEngineeringExample:{id:"workspaceUsage.classification.businessContext.dataScienceEngineering.example",defaultMessage:"Data pipelines, feature engineering, forecasting models, SQL/ETL workflows"},aiName:{id:"workspaceUsage.classification.businessContext.ai.name",defaultMessage:"AI"},aiExample:{id:"workspaceUsage.classification.businessContext.ai.example",defaultMessage:"Prompt engineering, model performance / evaluation, AI adoption strategy, ChatGPT applications, OpenAI API questions"},otherBusinessContextName:{id:"workspaceUsage.classification.businessContext.other.name",defaultMessage:"Other"},otherBusinessContextExample:{id:"workspaceUsage.classification.businessContext.other.example",defaultMessage:"Off-topic / business context not fitting above"}}),_t=[{key:"explain_concepts",nameMessage:F.explainConceptsName,exampleMessage:F.explainConceptsExample},{key:"factual_lookup",nameMessage:F.factualLookupName,exampleMessage:F.factualLookupExample},{key:"how_to_guidance",nameMessage:F.howToGuidanceName,exampleMessage:F.howToGuidanceExample},{key:"research",nameMessage:F.researchName,exampleMessage:F.researchExample},{key:"summarize",nameMessage:F.summarizeName,exampleMessage:F.summarizeExample},{key:"communicate",nameMessage:F.communicateName,exampleMessage:F.communicateExample},{key:"translate_localize",nameMessage:F.translateLocalizeName,exampleMessage:F.translateLocalizeExample},{key:"ideate",nameMessage:F.ideateName,exampleMessage:F.ideateExample},{key:"create_media",nameMessage:F.createMediaName,exampleMessage:F.createMediaExample},{key:"analyze_data",nameMessage:F.analyzeDataName,exampleMessage:F.analyzeDataExample},{key:"visualize_report_data",nameMessage:F.visualizeReportDataName,exampleMessage:F.visualizeReportDataExample},{key:"coding_automation",nameMessage:F.codingAutomationName,exampleMessage:F.codingAutomationExample},{key:"strategic_planning_decision_support",nameMessage:F.strategicPlanningName,exampleMessage:F.strategicPlanningExample},{key:"other",nameMessage:F.otherTaskTypeName,exampleMessage:F.otherTaskTypeExample}],wt=[{key:"leadership_management",nameMessage:I.leadershipManagementName,exampleMessage:I.leadershipManagementExample},{key:"finance",nameMessage:I.financeName,exampleMessage:I.financeExample},{key:"legal",nameMessage:I.legalName,exampleMessage:I.legalExample},{key:"public_affairs_government",nameMessage:I.publicAffairsName,exampleMessage:I.publicAffairsExample},{key:"marketing",nameMessage:I.marketingName,exampleMessage:I.marketingExample},{key:"sales",nameMessage:I.salesName,exampleMessage:I.salesExample},{key:"customer_support",nameMessage:I.customerSupportName,exampleMessage:I.customerSupportExample},{key:"operations_infrastructure",nameMessage:I.operationsInfrastructureName,exampleMessage:I.operationsInfrastructureExample},{key:"people_culture",nameMessage:I.peopleCultureName,exampleMessage:I.peopleCultureExample},{key:"training_teaching",nameMessage:I.trainingTeachingName,exampleMessage:I.trainingTeachingExample},{key:"it_security",nameMessage:I.itSecurityName,exampleMessage:I.itSecurityExample},{key:"software_development",nameMessage:I.softwareDevelopmentName,exampleMessage:I.softwareDevelopmentExample},{key:"science_engineering_technical_non_software",nameMessage:I.scienceEngineeringName,exampleMessage:I.scienceEngineeringExample},{key:"data_science_engineering",nameMessage:I.dataScienceEngineeringName,exampleMessage:I.dataScienceEngineeringExample},{key:"ai",nameMessage:I.aiName,exampleMessage:I.aiExample},{key:"other",nameMessage:I.otherBusinessContextName,exampleMessage:I.otherBusinessContextExample}];function Ja({currentWorkspaceId:s,startDate:a}){var z,q,$;const t=ye(),[n,i]=y.useState(null),o=y.useRef(null),d=l=>l.length>30?t.formatMessage(Ue.truncatedLabel,{label:l.slice(0,30)}):l;y.useEffect(()=>{typeof window>"u"||is(()=>import("./icf0sb4kitdajoka.js").then(l=>l.r),__vite__mapDeps([0,1,2,3])).then(l=>{i(()=>{var B;return(B=l.default)!=null?B:l})})},[]);const m=Xa(s,Y(a)),{taskTypes:r,businessContexts:g,taskTypeNameByKey:c,businessContextNameByKey:w,taskExamplesByName:b,businessContextExamplesByName:U}=y.useMemo(()=>{const l=_t.map(S=>({key:S.key,name:t.formatMessage(S.nameMessage),example:t.formatMessage(S.exampleMessage)})),B=wt.map(S=>({key:S.key,name:t.formatMessage(S.nameMessage),example:t.formatMessage(S.exampleMessage)})),G={},Q={},R={},E={};return l.forEach(S=>{G[S.key]=S.name,R[S.name]=S.example}),B.forEach(S=>{Q[S.key]=S.name,E[S.name]=S.example}),{taskTypes:l,businessContexts:B,taskTypeNameByKey:G,businessContextNameByKey:Q,taskExamplesByName:R,businessContextExamplesByName:E}},[t]),x=(q=(z=m.data)==null?void 0:z.workspace_classifier_metrics)!=null?q:void 0,{businessContextPie:_,taskTypePie:C}=y.useMemo(()=>{var Q;const l={},B={};((Q=x==null?void 0:x.metrics)!=null?Q:[]).forEach(R=>{var ie,H,Z,fe,xe,ue,_e;const E=(H=c[(ie=R.task_type)!=null?ie:""])!=null?H:R.task_type,S=(fe=w[(Z=R.business_context)!=null?Z:""])!=null?fe:R.business_context,K=(xe=R.value)!=null?xe:0;E&&(l[E]=((ue=l[E])!=null?ue:0)+K),S&&(B[S]=((_e=B[S])!=null?_e:0)+K)});const G=(R,E)=>{const S=R.map(H=>{var Z;return{name:H.name,value:(Z=E[H.name])!=null?Z:0}}).filter(H=>H.value>0);S.sort((H,Z)=>Z.value-H.value);const K=S.reduce((H,Z)=>H+Z.value,0);return{entries:S.map((H,Z)=>ee(u({},H),{color:Ca[Z%Ca.length],percentLabel:K>0?t.formatNumber(H.value/K,{style:"percent",maximumFractionDigits:1}):t.formatNumber(0,{style:"percent",maximumFractionDigits:1})})),total:K}};return{taskTypePie:G(r,l),businessContextPie:G(g,B)}},[w,g,t,x,c,r]),{xLabels:k,yLabels:h,zMatrix:p}=y.useMemo(()=>{var R;const l=new Map;((R=x==null?void 0:x.metrics)!=null?R:[]).forEach(E=>{var H,Z,fe,xe,ue;const S=(Z=c[(H=E.task_type)!=null?H:""])!=null?Z:E.task_type,K=(xe=w[(fe=E.business_context)!=null?fe:""])!=null?xe:E.business_context;if(!S||!K)return;const ie="".concat(S,"__").concat(K);l.set(ie,(ue=E.value)!=null?ue:0)});const B=r.map(E=>E.name),G=g.map(E=>E.name),Q=G.map(E=>B.map(S=>{var K;return(K=l.get("".concat(S,"__").concat(E)))!=null?K:0}));return{xLabels:B,yLabels:G,zMatrix:Q}},[w,g,x,c,r]);if(y.useEffect(()=>{var R,E,S;const l=(R=x==null?void 0:x.metrics)!=null?R:[];if(!n||!x||l.length===0||k.length===0||h.length===0)return;const B="".concat((E=x.date_partition)!=null?E:"unknown","|").concat(l.length,"|").concat(k.length,"|").concat(h.length);if(o.current===B)return;const G=l.filter(K=>{var ie;return((ie=K.value)!=null?ie:0)>0}).length,Q=$a(x.date_partition);O.logEvent("Workspace Usage: Classification Heatmap Rendered",{metric_partition_date:(S=x.date_partition)!=null?S:null,data_days_stale:Q,total_metrics_displayed:l.length,task_type_count_displayed:k.length,business_context_count_displayed:h.length,non_zero_metrics_displayed:G}),o.current=B},[n,x,k.length,h.length]),m.isLoading)return e.jsx("div",{className:"flex min-h-[200px] items-center justify-center",children:e.jsx(je,{})});if(!x||(($=x.metrics)!=null?$:[]).length===0)return e.jsx("div",{className:"text-token-text-secondary border-token-border-light rounded-md border p-4",children:e.jsx(f,u({},Ue.noData))});const N=35,P=35,M=k.length*N,T=h.length*P,D=180,j={gridTemplateColumns:"".concat(D,"px ").concat(M,"px"),gridTemplateRows:"".concat(180,"px ").concat(T,"px")};return e.jsxs("div",{className:"border-token-border-light mt-4 space-y-3 rounded-md border p-4",children:[e.jsx("div",{className:"text-token-text-primary text-[15px] font-semibold",children:e.jsx(f,u({},Ue.heading))}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.jsx(f,ee(u({},Ue.classificationDisclaimer),{values:{lineBreak:e.jsx("br",{})}}))}),e.jsxs("div",{className:"mt-6 grid gap-8 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-token-text-primary text-base font-semibold",children:e.jsx(f,u({},Ue.businessContextPieTitle))}),e.jsx("div",{className:"mt-3 w-full max-w-[420px]",children:n?e.jsx(n,{data:[{type:"pie",labels:_.entries.map(l=>l.name),values:_.entries.map(l=>l.value),marker:{colors:_.entries.map(l=>l.color)},textinfo:"percent",textposition:"outside",sort:!1,automargin:!0,hovertemplate:"<b>%{label}</b><br>%{percent}<br>Messages: %{value}<extra></extra>",showlegend:!1}],layout:{autosize:!0,margin:{l:0,r:0,t:10,b:10}},style:{width:"100%",height:320},config:{displayModeBar:!1,scrollZoom:!1,doubleClick:!1}}):e.jsx("div",{className:"flex min-h-[200px] items-center justify-center",children:e.jsx(je,{})})}),e.jsx("div",{className:"mt-4 grid w-full max-w-[520px] grid-cols-1 gap-x-6 gap-y-2 text-xs sm:grid-cols-2",children:_.entries.map(l=>e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex h-2 w-2 rounded-full",style:{backgroundColor:l.color}}),e.jsx(Me,{label:U[l.name]?e.jsxs("div",{className:"text-start",children:[e.jsx("div",{className:"font-semibold",children:l.name}),e.jsx("div",{className:"text-token-text-tertiary font-normal",children:U[l.name]})]}):l.name,labelTextAlign:"left",side:"top",children:e.jsx("span",{className:"text-token-text-primary",children:l.name})})]}),e.jsx("span",{className:"text-token-text-tertiary tabular-nums",children:l.percentLabel})]},l.name))})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-token-text-primary text-base font-semibold",children:e.jsx(f,u({},Ue.taskTypePieTitle))}),e.jsx("div",{className:"mt-3 w-full max-w-[420px]",children:n?e.jsx(n,{data:[{type:"pie",labels:C.entries.map(l=>l.name),values:C.entries.map(l=>l.value),marker:{colors:C.entries.map(l=>l.color)},textinfo:"percent",textposition:"outside",sort:!1,automargin:!0,hovertemplate:"<b>%{label}</b><br>%{percent}<br>Messages: %{value}<extra></extra>",showlegend:!1}],layout:{autosize:!0,margin:{l:0,r:0,t:10,b:10}},style:{width:"100%",height:320},config:{displayModeBar:!1,scrollZoom:!1,doubleClick:!1}}):e.jsx("div",{className:"flex min-h-[200px] items-center justify-center",children:e.jsx(je,{})})}),e.jsx("div",{className:"mt-4 grid w-full max-w-[520px] grid-cols-1 gap-x-6 gap-y-2 text-xs sm:grid-cols-2",children:C.entries.map(l=>e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex h-2 w-2 rounded-full",style:{backgroundColor:l.color}}),e.jsx(Me,{label:b[l.name]?e.jsxs("div",{className:"text-start",children:[e.jsx("div",{className:"font-semibold",children:l.name}),e.jsx("div",{className:"text-token-text-tertiary font-normal",children:b[l.name]})]}):l.name,labelTextAlign:"left",side:"top",children:e.jsx("span",{className:"text-token-text-primary",children:l.name})})]}),e.jsx("span",{className:"text-token-text-tertiary tabular-nums",children:l.percentLabel})]},l.name))})]})]}),k.length===0||h.length===0?e.jsx("div",{className:"text-token-text-secondary",children:e.jsx(f,u({},Ue.noData))}):n?e.jsxs("div",{className:"grid gap-x-4",style:j,children:[e.jsx("div",{}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"text-token-text-primary absolute start-1/2 top-3 -translate-x-1/2 text-base font-semibold",children:e.jsx(f,u({},Ue.taskTypesAxisLabel))}),e.jsx("div",{className:"text-token-text-primary relative z-10 grid h-full items-end justify-items-start ps-5 pb-2 text-xs font-normal",style:{gridTemplateColumns:"repeat(".concat(k.length,", ").concat(N,"px)"),width:M},children:k.map(l=>e.jsx("div",{className:"flex items-end justify-start",children:e.jsx(Me,{label:b[l]?e.jsxs("div",{className:"text-start",children:[e.jsx("div",{className:"font-semibold",children:l}),e.jsx("div",{className:"text-token-text-tertiary font-normal",children:b[l]})]}):l,labelTextAlign:"left",side:"top",children:e.jsx("span",{className:"block -rotate-45 transform whitespace-nowrap",style:{transformOrigin:"left bottom"},children:d(l)})})},l))})]}),e.jsxs("div",{className:"relative",style:{width:D},children:[e.jsx("div",{className:"text-token-text-primary absolute -start-20 top-1/2 origin-center -translate-y-1/2 -rotate-90 text-base font-semibold",children:e.jsx(f,u({},Ue.businessContextAxisLabel))}),e.jsx("div",{className:"text-token-text-primary grid items-center justify-items-end ps-5 text-end text-xs font-normal",style:{gridTemplateRows:"repeat(".concat(h.length,", ").concat(P,"px)"),width:D},children:h.map(l=>e.jsx("div",{className:"flex items-center justify-end truncate",children:e.jsx(Me,{label:U[l]?e.jsxs("div",{className:"text-start",children:[e.jsx("div",{className:"font-semibold",children:l}),e.jsx("div",{className:"text-token-text-tertiary font-normal",children:U[l]})]}):l,labelTextAlign:"left",side:"left",children:e.jsx("span",{children:d(l)})})},l))})]}),e.jsx(n,{data:[{type:"heatmap",x:k,y:h,z:p,colorscale:[[0,"rgb(0,0,255)"],[.1,"rgb(30,30,255)"],[.2,"rgb(60,60,255)"],[.3,"rgb(80,80,255)"],[.4,"rgb(100,100,255)"],[.5,"rgb(120,120,255)"],[.6,"rgb(140,140,255)"],[.7,"rgb(160,160,255)"],[.8,"rgb(180,180,255)"],[.9,"rgb(200,200,255)"],[.925,"rgb(210,210,255)"],[.95,"rgb(220,220,255)"],[.975,"rgb(230,230,255)"],[.987,"rgb(240,240,255)"],[1,"rgb(250,250,255)"]],reversescale:!0,hovertemplate:"<b>%{y} x %{x}<br>Messages: %{z}<extra></extra>",showscale:!1}],layout:{autosize:!0,margin:{l:0,r:0,t:0,b:0},xaxis:{showticklabels:!1,ticks:""},yaxis:{showticklabels:!1,ticks:"",autorange:"reversed"},dragmode:!1},style:{width:M,height:T},config:{displayModeBar:!1,scrollZoom:!1,doubleClick:!1}})]}):e.jsx("div",{className:"flex min-h-[200px] items-center justify-center",children:e.jsx(je,{})})]})}const Ue=pe({noData:{id:"workspaceUsage.classification.noData",defaultMessage:"No classification data available yet."},heading:{id:"workspaceUsage.classification.heading",defaultMessage:"Workspace message classification by Business Context and Task Type"},taskTypesAxisLabel:{id:"workspaceUsage.classification.axis.taskTypes",defaultMessage:"Task Types"},businessContextAxisLabel:{id:"workspaceUsage.classification.axis.businessContext",defaultMessage:"Business Context"},businessContextPieTitle:{id:"workspaceUsage.classification.pie.businessContext",defaultMessage:"Business Context"},taskTypePieTitle:{id:"workspaceUsage.classification.pie.taskType",defaultMessage:"Task Type"},truncatedLabel:{id:"workspaceUsage.classification.truncatedLabel",defaultMessage:"{label}..."},classificationDisclaimer:{id:"workspaceUsage.classification.disclaimer",defaultMessage:"This table displays an aggregated, workspace-level view of how ChatGPT is used within your organization, based on automated classification of messages into broad task types and business context categories. The classifiers are general-purpose and assign high-level labels only; they do not expose message content, uploaded files, other business data, or individual user data. By default, we do not use Enterprise business data to train our models. {lineBreak}Hover over headers for more information."}});function jt({currentWorkspaceId:s,selectedGroup:a,onSelect:t,onClose:n}){var k;const i=ye(),[o,d]=y.useState(""),m=Bs(o,300),[r,g]=y.useState(0),{groups:c,isLoading:w,isPlaceholderData:b}=Vs({workspaceId:s,currPage:r,groupFilter:m}),U=((k=c==null?void 0:c.items)!=null?k:[]).filter(h=>!h.system_use_case),x=c&&c.total>0?Math.ceil(c.total/na):1;y.useEffect(()=>{if(!c)return;const h=c.total>0?Math.ceil(c.total/na):1,p=Math.max(h-1,0);g(N=>N>p?p:N)},[c]);const _=h=>{var p;t(h),O.logEvent("Workspace Usage: Group Modal Selection",{groupId:(p=h==null?void 0:h.id)!=null?p:null})},C=w&&!c;return e.jsx(Pa,{testId:"modal-group-selection",isOpen:!0,onClose:()=>n(),showCloseButton:!0,title:e.jsx(f,u({},he.title)),description:e.jsx(f,ee(u({},he.description),{values:{br:e.jsx("br",{})}})),footerContent:e.jsxs("div",{className:"mt-4 flex w-full flex-col gap-3 sm:mt-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(ce,{as:"link",to:"/admin/groups",color:"secondary",size:"small",className:"self-start sm:self-auto",onClick:()=>{O.logEvent("Workspace Usage: Group Modal Manage Groups Clicked"),n()},children:e.jsx(f,u({},he.manageGroupsCta))}),e.jsxs("div",{className:"flex items-center gap-2",children:[a&&e.jsx(ce,{color:"ghost",size:"small",onClick:()=>_(null),children:e.jsx(f,u({},he.clearSelection))}),e.jsx(ce,{color:"secondary",size:"small",onClick:()=>n(),children:e.jsx(f,u({},he.closeButton))})]})]}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(Is,{value:o,onChange:h=>{const p=h.target.value;d(p),g(0),O.logEvent("Workspace Usage: Group Modal Search Updated",{queryLength:p.length})},placeholder:i.formatMessage(he.searchPlaceholder),inputClassName:"w-full rounded-full! text-sm"}),e.jsx("div",{className:X("border-token-border-subtle max-h-[360px] min-h-[180px] overflow-y-auto rounded-lg border"),children:C?e.jsx("div",{className:"flex h-full items-center justify-center p-6",children:e.jsx(je,{})}):U.length===0?e.jsxs("div",{className:"flex h-full flex-col items-center justify-center gap-2 p-6 text-center",children:[e.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:e.jsx(f,u({},he.emptyStateTitle))}),e.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,u({},he.emptyStateSubtitle))})]}):e.jsx("ul",{className:X("divide-token-border-subtle divide-y",b&&"opacity-50"),children:U.map(h=>{var M;const p=(a==null?void 0:a.id)===h.id,N=Number((M=h.num_members)!=null?M:0),P=Number.isFinite(N)?N:0;return e.jsxs("li",{className:X("flex flex-col gap-3 p-4 sm:flex-row sm:items-center sm:justify-between",p&&"bg-token-main-surface-secondary"),children:[e.jsxs("div",{className:"flex flex-1 items-start gap-3",children:[e.jsx(Qs,{group:h}),e.jsxs("div",{children:[e.jsx(os,{to:"/admin/groups/".concat(h.id),className:"text-token-text-primary text-sm font-medium hover:underline focus:outline-none focus-visible:underline",onClick:()=>{O.logEvent("Workspace Usage: Group Modal View Group Clicked",{groupId:h.id})},children:h.name}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,ee(u({},he.memberCount),{values:{count:P}}))})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(ce,{color:p?"primary":"secondary",size:"small",onClick:()=>_({id:h.id,name:h.name}),children:p?e.jsx(f,u({},he.selectedLabel)):e.jsx(f,u({},he.selectLabel))})})]},h.id)})})}),c&&c.total>na&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,ee(u({},he.paginationSummary),{values:{page:r+1,totalPages:x}}))}),e.jsx(Rs,{currentPage:r,onChangeIndex:h=>g(h),length:x})]})]})})}const he=pe({title:{id:"workspaceUsage.groupModal.title",defaultMessage:"Select a group"},description:{id:"workspaceUsage.groupModal.description",defaultMessage:"Filter analytics for members within a workspace group."},searchPlaceholder:{id:"workspaceUsage.groupModal.searchPlaceholder",defaultMessage:"Search groups"},emptyStateTitle:{id:"workspaceUsage.groupModal.emptyStateTitle",defaultMessage:"No groups found"},emptyStateSubtitle:{id:"workspaceUsage.groupModal.emptyStateSubtitle",defaultMessage:"Try a different search or create a new group from settings."},memberCount:{id:"workspaceUsage.groupModal.memberCount",defaultMessage:"{count, plural, one {# member} other {# members}}"},selectLabel:{id:"workspaceUsage.groupModal.selectLabel",defaultMessage:"Select"},selectedLabel:{id:"workspaceUsage.groupModal.selectedLabel",defaultMessage:"Selected"},paginationSummary:{id:"workspaceUsage.groupModal.paginationSummary",defaultMessage:"Page {page} of {totalPages}"},manageGroupsCta:{id:"workspaceUsage.groupModal.manageGroupsCta",defaultMessage:"Manage groups"},clearSelection:{id:"workspaceUsage.groupModal.clearSelection",defaultMessage:"Clear selection"},closeButton:{id:"workspaceUsage.groupModal.closeButton",defaultMessage:"Close"}});var oa,Ta;function Ct(){if(Ta)return oa;Ta=1;var s=hs(),a=ys(),t=a(function(n,i,o){s(n,o,i)});return oa=t,oa}var Tt=Ct();const Ut=rs(Tt);async function Nt({queryKey:[s,{workspaceId:a,startDate:t,groupId:n}]}){return me.safeGet("/accounts/{account_id}/analytics/overview",{parameters:{path:{account_id:a},query:{start_date:t,group_id:n!=null?n:void 0}}})}function St(s,a,t){return ve({queryKey:["workspace-analytics-overview",{workspaceId:s,startDate:a,groupId:t}],queryFn:de(Nt)})}async function Lt({queryKey:[s,{workspaceId:a,startDate:t,groupId:n}]}){return me.safeGet("/accounts/{account_id}/analytics/gizmo_overview",{parameters:{path:{account_id:a},query:{start_date:t,group_id:n!=null?n:void 0}}})}function Et(s,a,t){return ve({queryKey:["workspace-analytics-gizmo-overview",{workspaceId:s,startDate:a,groupId:t}],queryFn:de(Lt)})}async function Dt({queryKey:[s,{workspaceId:a,startDate:t,groupId:n}]}){return me.safeGet("/accounts/{account_id}/analytics/tool_overview",{parameters:{path:{account_id:a},query:{start_date:t,group_id:n!=null?n:void 0}}})}function At(s,a,t){return ve({queryKey:["workspace-analytics-tool-overview",{workspaceId:s,startDate:a,groupId:t}],queryFn:de(Dt)})}async function Pt({queryKey:[s,{workspaceId:a,startDate:t,groupId:n}]}){return me.safeGet("/accounts/{account_id}/analytics/project_overview",{parameters:{query:{start_date:t,group_id:n!=null?n:void 0},path:{account_id:a}}})}function zt(s,a,t){return ve({queryKey:["workspace-analytics-project-overview",{workspaceId:s,startDate:a,groupId:t}],queryFn:de(Pt)})}async function Ot({queryKey:[s,{workspaceId:a,startDate:t,groupId:n}]}){return me.safeGet("/accounts/{account_id}/analytics/connector_overview",{parameters:{path:{account_id:a},query:{start_date:t,group_id:n!=null?n:void 0}}})}function Bt(s,a,t){return ve({queryKey:["workspace-analytics-connector-overview",{workspaceId:s,startDate:a,groupId:t}],queryFn:de(Ot)})}function Re(s,a,t){return y.useMemo(()=>{if(!a)return;const n=Ut(a,"date");return Oa({start:s,end:aa(s)}).map(i=>{var m;const o=Y(i),d=n[o];return d&&d.total>0?{date:d.date,total:d.total,values:(m=d[t])!=null?m:{}}:{date:o,blank:0}})},[s,a,t])}function It(s,a,t){var z,q,$,l,B,G,Q,R,E,S,K,ie,H,Z,fe,xe,ue,_e,Te,be,Be,De;const n=Y(a),i=St(s,n,t),o=y.useMemo(()=>{var A,W;return(W=(A=i.data)==null?void 0:A.active_user_data)==null?void 0:W.daily_data.map(({date:ge,active_users:oe})=>({date:ge,total:oe,values:{active_users:oe}}))},[(q=(z=i.data)==null?void 0:z.active_user_data)==null?void 0:q.daily_data]),d=Re(a,o,"values"),m=Re(a,(l=($=i.data)==null?void 0:$.messages_data)==null?void 0:l.daily_data,"messages_by_model"),r=Et(s,n,t),g=Re(a,(B=r.data)==null?void 0:B.daily_gizmo_messages_data,"messages_by_gpt"),c=At(s,n,t),w=Re(a,(G=c.data)==null?void 0:G.daily_tool_messages_data,"messages_by_tool"),b=zt(s,n,t),U=y.useMemo(()=>{var A,W;return(W=(A=b.data)==null?void 0:A.project_names)!=null?W:null},[b.data]),x=Re(a,(Q=b.data)==null?void 0:Q.daily_project_messages_data,"messages_by_project"),_=Bt(s,n,t),C=Re(a,(R=_.data)==null?void 0:R.daily_connector_messages_data,"messages_by_connector"),k=ye(),h=y.useMemo(()=>{var A;return d&&((A=i.data)!=null&&A.active_user_data)?{data:d,metrics:{active_users:{displayName:k.formatMessage(Ua.activeUsers)}},monthOverMonth:i.data.active_user_data.month_to_month_data}:"loading"},[d,k,(E=i.data)==null?void 0:E.active_user_data]),p=y.useMemo(()=>{var A;return m&&((A=i.data)!=null&&A.messages_data)?{data:m,metrics:Ze(i.data.messages_data.models),monthOverMonth:i.data.messages_data.month_to_month_data}:"loading"},[m,(S=i.data)==null?void 0:S.messages_data]),N=y.useMemo(()=>{var Ge,qe;const A=(qe=(Ge=i.data)==null?void 0:Ge.active_user_data)==null?void 0:qe.weekly_data;if(!A)return;const W=new Map,ge=(()=>{if(A.length>0){const J=Ia(A[0].period_start_date).getDay();if(J>=0&&J<=6)return J}return 0})(),oe=za({start:Ke(a,{weekStartsOn:ge}),end:aa(a)},{weekStartsOn:ge}),Ie=new Set(oe.map(J=>Y(J)));return oe.forEach(J=>{const we=Y(J);W.set(we,{date:we,blank:0})}),A.forEach(({period_start_date:J,active_users:we})=>{Ie.has(J)&&W.set(J,{date:J,total:we,values:{active_users:we}})}),Array.from(W.entries()).sort(([J],[we])=>J.localeCompare(we)).map(([,J])=>J)},[(ie=(K=i.data)==null?void 0:K.active_user_data)==null?void 0:ie.weekly_data,a]),P=(Z=(H=i.data)==null?void 0:H.active_user_data)==null?void 0:Z.month_to_month_data,M=y.useMemo(()=>N&&P?{data:N,metrics:{active_users:{displayName:k.formatMessage(Ua.weeklyActiveUsers)}},monthOverMonth:P}:"loading",[k,N,P]),T=y.useMemo(()=>{var A,W;return g&&((A=r.data)!=null&&A.metrics)&&((W=r.data)!=null&&W.month_to_month_data)?{data:g,metrics:Object.fromEntries(Object.entries(r.data.metrics).map(([ge,oe])=>[ge,{displayName:oe}])),monthOverMonth:r.data.month_to_month_data}:"loading"},[g,(fe=r.data)==null?void 0:fe.metrics,(xe=r.data)==null?void 0:xe.month_to_month_data]),D=y.useMemo(()=>{var A,W;return x&&((A=b.data)!=null&&A.project_list)&&((W=b.data)!=null&&W.month_to_month_data)?{data:x,metrics:Ze(b.data.project_list,U),monthOverMonth:b.data.month_to_month_data}:"loading"},[x,(ue=b.data)==null?void 0:ue.month_to_month_data,(_e=b.data)==null?void 0:_e.project_list,U]),v=y.useMemo(()=>{var A,W;return w&&((A=c.data)!=null&&A.tool_list)&&((W=c.data)!=null&&W.month_to_month_data)?{data:w,metrics:Ze(c.data.tool_list),monthOverMonth:c.data.month_to_month_data}:"loading"},[w,(Te=c.data)==null?void 0:Te.month_to_month_data,(be=c.data)==null?void 0:be.tool_list]),j=y.useMemo(()=>{var A,W;return C&&((A=_.data)!=null&&A.connector_list)&&((W=_.data)!=null&&W.month_to_month_data)?{data:C,metrics:Ze(_.data.connector_list),monthOverMonth:_.data.month_to_month_data}:"loading"},[C,(Be=_.data)==null?void 0:Be.connector_list,(De=_.data)==null?void 0:De.month_to_month_data]);return{dailyActiveUsers:h,weeklyActiveUsers:M,dailyMessages:p,dailyProjectMessages:D,dailyGizmoMessages:T,dailyConnectorMessages:j,dailyToolMessages:v}}function Ze(s,a){return Object.entries(s).sort(([,t],[,n])=>t-n).reduce((t,[n,i])=>{var o;return i>0&&(t[n]={displayName:(o=a==null?void 0:a[n])!=null?o:n,total:i}),t},{})}const Ua=pe({activeUsers:{id:"workspaceUsage.activeUsersMetric",defaultMessage:"Daily unique active users"},weeklyActiveUsers:{id:"workspaceUsage.weeklyActiveUsersMetric",defaultMessage:"Weekly unique active users"}}),Rt=3;function Wt(s,a){const t=s.trim().split(/\s+/);return t.length<=a?s:"".concat(t.slice(0,a).join(" "),"...")}function es({currentWorkspaceId:s,startDate:a,selectedGroup:t,setSelectedGroup:n,showGroupFilter:i}){var h;const o=ye(),d=la(),[m,r]=y.useState(!1),g=(h=t==null?void 0:t.id)!=null?h:null,c=It(s,a,g),w=(t==null?void 0:t.name)&&Wt(t.name,Rt);y.useEffect(()=>{i||r(!1)},[i]);const b=Ba(d,"3528236309"),U=b.get("show_weekly_active_users_chart",!1),x=b.get("show_connector_overview_chart",!1),_=b.get("show_project_overview_chart",!1),C=y.useCallback(p=>{const N=Ia(p),P=bs(N,6),M=N.getMonth()===P.getMonth(),T=ne(N,"MMM d"),D=M?ne(P,"d"):ne(P,"MMM d");return"".concat(T," – ").concat(D)},[]),k=!ks(a,Ee(new Date));return e.jsxs("div",{className:"mt-5",children:[i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx(ce,{className:X(t&&"max-w-[240px]"),color:"secondary",size:"small",title:t==null?void 0:t.name,onClick:()=>{r(!0),O.logEvent("Workspace Usage: Group Modal Opened")},children:t?e.jsx("span",{className:"truncate",children:e.jsx(f,ee(u({},re.groupButtonSelected),{values:{groupName:w}}))}):e.jsx(f,u({},re.groupButton))})}),m&&e.jsx(jt,{currentWorkspaceId:s,selectedGroup:t,onSelect:p=>{var N;n(p),r(!1),O.logEvent("Workspace Usage: Group Selected",{groupId:(N=p==null?void 0:p.id)!=null?N:null})},onClose:()=>{r(!1),O.logEvent("Workspace Usage: Group Modal Closed")}})]}),e.jsx(Pe,{title:re.activeUsersChartTitle,data:c.dailyActiveUsers,displayMoM:k,clientEventSource:"activeUsers",hideLegend:!0}),U&&e.jsx(Pe,{title:re.weeklyActiveUsersChartTitle,data:c.weeklyActiveUsers,displayMoM:!1,clientEventSource:"weeklyActiveUsers",hideLegend:!0,hideTopValue:!0,tooltipLabelFormatter:C}),e.jsx(Pe,{title:re.messagesChartTitle,data:c.dailyMessages,otherGroupLabel:o.formatMessage(re.otherModels),displayMoM:k,clientEventSource:"totalMessages"}),e.jsx(Pe,{title:re.gptMessagesChartTitle,data:c.dailyGizmoMessages,otherGroupLabel:o.formatMessage(re.otherGizmos),displayMoM:k,clientEventSource:"gizmoMessages"}),e.jsx(Pe,{title:re.toolMessagesChartTitle,data:c.dailyToolMessages,otherGroupLabel:o.formatMessage(re.otherTools),displayMoM:k,clientEventSource:"toolMessages"}),_&&e.jsx(Pe,{title:re.projectMessagesChartTitle,data:c.dailyProjectMessages,otherGroupLabel:o.formatMessage(re.otherProjects),displayMoM:k,clientEventSource:"projectMessages"}),x&&e.jsx(Pe,{title:re.connectorMessagesChartTitle,data:c.dailyConnectorMessages,otherGroupLabel:o.formatMessage(re.otherConnectors),displayMoM:k,clientEventSource:"connectorMessages"})]})}const re=pe({activeUsersChartTitle:{id:"workspaceUsage.overview.activeUsersChartTitle",defaultMessage:"Daily unique active users"},weeklyActiveUsersChartTitle:{id:"workspaceUsage.overview.weeklyActiveUsersChartTitle",defaultMessage:"Weekly unique active users"},messagesChartTitle:{id:"workspaceUsage.overview.messagesChartTitle",defaultMessage:"Total messages sent"},gptMessagesChartTitle:{id:"workspaceUsage.overview.gptMessagesChartTitle",defaultMessage:"GPT messages sent"},projectMessagesChartTitle:{id:"workspaceUsage.overview.projectMessagesChartTitle",defaultMessage:"Project messages sent"},connectorMessagesChartTitle:{id:"workspaceUsage.overview.connectorMessagesChartTitle",defaultMessage:"Connector messages received"},toolMessagesChartTitle:{id:"workspaceUsage.overview.toolMessagesChartTitle",defaultMessage:"Tool messages received"},otherModels:{id:"workspaceUsage.overview.otherModels",defaultMessage:"Other models"},otherGizmos:{id:"workspaceUsage.overview.otherGizmos",defaultMessage:"Other GPTs"},otherProjects:{id:"workspaceUsage.overview.otherProjects",defaultMessage:"Other Projects"},otherConnectors:{id:"workspaceUsage.overview.otherConnectors",defaultMessage:"Other Connectors"},otherTools:{id:"workspaceUsage.overview.otherTools",defaultMessage:"Other Tools"},groupButton:{id:"workspaceUsage.groupButton",defaultMessage:"Filter by Group"},groupButtonSelected:{id:"workspaceUsage.groupButtonSelected",defaultMessage:"Group: {groupName}"}});function Ft(t){var n=t,{className:s}=n,a=Ae(n,["className"]);return e.jsx(Ga,ee(u({},a),{className:s}))}function Na(s,a){return ve({queryKey:["workspace-analytics-user-stats",{workspaceId:s,startDate:a}],queryFn:de(({queryKey:[t,n]})=>me.safeGet("/accounts/{account_id}/analytics/user_stats",{parameters:{query:{start_date:n.startDate},path:{account_id:n.workspaceId}}}))})}async function Gt(n){var[s,i]=n,o=i,{workspaceId:a}=o,t=Ae(o,["workspaceId"]);const g=t,{view_mode:d,limit:m}=g,r=Ae(g,["view_mode","limit"]);return me.safeGet("/accounts/{account_id}/analytics/user_list",{parameters:{path:{account_id:a},query:r}})}const qt={direction:"DESC",metric:"messages"};async function $t(n){var[s,i]=n,o=i,{workspaceId:a}=o,t=Ae(o,["workspaceId"]);const b=t,{page_size:d,cursor:m,query_id:r,limit:g,view_mode:c}=b,w=Ae(b,["page_size","cursor","query_id","limit","view_mode"]);return me.safeGet("/accounts/{account_id}/analytics/user_list/power_users",{parameters:{path:{account_id:a},query:u({},w)}})}function as({currentWorkspaceId:s,startDate:a,showAiChampionsButton:t,showConnectorProjectColumns:n}){const i=ye(),[o,d]=y.useState(""),[m,r]=y.useState(!1),g=t&&m;y.useEffect(()=>{!t&&m&&r(!1)},[t,m]);const c=la(),w=Ms(c,"2861925050"),b=y.useCallback((v,j)=>{const z=v!=null?v:j.email;return e.jsxs("div",{className:"group flex items-center gap-2",children:[g&&e.jsx(Ga,{className:"icon-sm"}),e.jsx("span",{children:z})]})},[g]),U=y.useMemo(()=>{const v=w?[...Sa,{label:e.jsx(f,u({},te.creditsUsedColumnLabel)),metric:"credits_used",render:We,defaultSortDirection:"DESC"}]:Sa;return(n?v:v.filter(z=>z.metric!=="project_messages"&&z.metric!=="connector_messages")).map(z=>z.metric==="name"?ee(u({},z),{render:b}):z)},[w,b,n]),x=Y(a),_=y.useCallback(v=>["workspace-analytics-users-list",ee(u({workspaceId:s,start_date:x,filter_query:o},v),{view_mode:g?"power":"default"})],[x,o,s,g]),C=Na(s,x),k=Y(Ne(a,1)),h=Na(s,k),p=de(Gt),N=de($t),P=y.useCallback(v=>g?N(v):p(v),[g,p,N]),M=y.useCallback(()=>{t&&r(v=>{const j=!v;return O.logEvent("Workspace Usage: AI Champions Clicked",{source:"userList",state:j?"enabled":"disabled"}),j})},[t]),T=y.useMemo(()=>"".concat(s,".").concat(x,".").concat(o,".").concat(g?"champions":"default"),[g,s,o,x]),D=g?Qt:qt;return e.jsxs("div",{className:"mb-8",children:[e.jsx(ca,{startDate:a,data:C.data,previousData:h.data,statsSpec:Kt}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[e.jsx(da,{className:"grow md:max-w-xs",handleSearch:d,clientEventSource:"userList"}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(Me,{label:i.formatMessage(te.aiChampionsButtonTooltip),side:"top",children:e.jsx(ce,{size:"small",color:m?"primary":"secondary",icon:Ft,onClick:M,"aria-pressed":m,className:"group transition-colors",iconClassName:"icon-sm",children:e.jsx(f,u({},te.aiChampionsButtonLabel))})}),e.jsx(ce,{as:"link",to:"/admin/members",size:"small",color:"secondary",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(f,u({},te.manageUsersLink)),e.jsx(Fa,{className:"icon-sm"})]})})]})]}),e.jsx(ma,{getQueryKey:_,loader:P,getData:v=>v.users,spec:U,initialSortDirection:D,clientEventSource:"userList"},T)]})}const te=pe({purchasedSeats:{id:"workspaceUsage.userList.stats.purchasedSeats",defaultMessage:"Seats purchased"},claimedSeats:{id:"workspaceUsage.userList.stats.claimedSeats",defaultMessage:"Seats enabled"},claimedSeatsHelpText:{id:"workspaceUsage.userList.stats.claimedSeatsHelpText",defaultMessage:"Users who have accepted their invite and logged in"},activeUsers:{id:"workspaceUsage.userList.stats.activeUsers",defaultMessage:"Active users"},activeUsersHelpText:{id:"workspaceUsage.userList.stats.activeUsersHelpText",defaultMessage:"Users who have sent at least one message during this time period"},pendingInvites:{id:"workspaceUsage.userList.stats.pendingInvites",defaultMessage:"Pending invites"},nameColumnLabel:{id:"workspaceUsage.userList.tableHeader.name",defaultMessage:"Name"},emailColumnLabel:{id:"workspaceUsage.userList.tableHeader.email",defaultMessage:"Email"},messagesColumnLabel:{id:"workspaceUsage.userList.tableHeader.messages",defaultMessage:"Total Messages"},gptMessagesColumnLabel:{id:"workspaceUsage.userList.tableHeader.gptMessages",defaultMessage:"GPT Messages"},toolMessagesColumnLabel:{id:"workspaceUsage.userList.tableHeader.toolMessages",defaultMessage:"Tool Messages"},projectMessagesColumnLabel:{id:"workspaceUsage.userList.tableHeader.projectMessages",defaultMessage:"Project Messages"},connectorMessagesColumnLabel:{id:"workspaceUsage.userList.tableHeader.connectorMessages",defaultMessage:"Connector Messages"},creditsUsedColumnLabel:{id:"workspaceUsage.userList.tableHeader.creditsUsed",defaultMessage:"Credits Used"},manageUsersLink:{id:"workspaceUsage.userList.tableHeader.manageUsersLink",defaultMessage:"Manage users"},aiChampionsButtonLabel:{id:"workspaceUsage.userList.aiChampions.buttonLabel",defaultMessage:"Show AI power users"},aiChampionsButtonTooltip:{id:"workspaceUsage.userList.aiChampions.buttonTooltip",defaultMessage:"Your most engaged users: top 20% message senders with 75+ messages per week and 3+ different tools used per month."}}),Kt=[{dataKey:"purchased_seats",label:te.purchasedSeats},{dataKey:"claimed_seat",label:te.claimedSeats,helpText:te.claimedSeatsHelpText},{dataKey:"active_users",label:te.activeUsers,helpText:te.activeUsersHelpText},{dataKey:"pending_invites",label:te.pendingInvites}],Ht=new Intl.NumberFormat(void 0,{notation:"compact",maximumSignificantDigits:3});function We(s){return typeof s=="number"?Ht.format(s):null}const Sa=[{metric:"name",label:e.jsx(f,u({},te.nameColumnLabel)),render:s=>s},{metric:"email",label:e.jsx(f,u({},te.emailColumnLabel)),render:s=>s},{metric:"messages",label:e.jsx(f,u({},te.messagesColumnLabel)),render:We,defaultSortDirection:"DESC"},{label:e.jsx(f,u({},te.gptMessagesColumnLabel)),metric:"gpt_messages",render:We,defaultSortDirection:"DESC"},{label:e.jsx(f,u({},te.toolMessagesColumnLabel)),metric:"tool_messages",render:We,defaultSortDirection:"DESC"},{label:e.jsx(f,u({},te.projectMessagesColumnLabel)),metric:"project_messages",render:We,defaultSortDirection:"DESC"},{label:e.jsx(f,u({},te.connectorMessagesColumnLabel)),metric:"connector_messages",render:We,defaultSortDirection:"DESC"}],Qt={direction:"DESC",metric:"messages"};function Vt(s){return Object.keys(s)}var La;const Yt=vs.div(La||(La=ba(["flex space-x-4"]))),ss={overviewTab:es,usersTab:as,gptsTab:xt,projectsTab:ht,benchmarkTab:Ha,classificationTab:Ja};function Zt(s){return ve({queryKey:["workspace-analytics-last-updated",{workspaceId:s}],queryFn:de(({queryKey:[a,t]})=>me.safeGet("/accounts/{account_id}/analytics/last_updated_time",{parameters:{path:{account_id:t.workspaceId}}}))})}const Xt=Vt(ss);function Jt(s){if(!s)return null;const a=s.split("T")[0],[t,n,i]=a.split("-").map(o=>Number(o));return!t||!n||!i?a:ne(new Date(t,n-1,i),"MMM d, yyyy")}function en({currentWorkspaceId:s,startDate:a,setStartDate:t,currentTab:n,setTab:i,tabs:o,dataUpdatedDateOverride:d,isDataUpdatedOverrideLoading:m,showDatePicker:r=!0}){var _,C;const g=Zt(s),[c,w]=y.useState(!1),b=d!==void 0,U=b?d:(C=(_=g.data)==null?void 0:_.last_updated_time)!=null?C:null,x=b?m:g.isLoading;return e.jsx(qa,{title:e.jsx(f,u({},Se.title)),actions:e.jsxs(e.Fragment,{children:[r&&e.jsx(Mt,{startDate:a,setStartDate:t}),e.jsx(ce,{className:X(r&&"ms-2"),color:"secondary",size:"small",onClick:()=>{w(!0),O.logEvent("Workspace Usage: Export Modal Opened")},children:e.jsx(f,u({},Se.exportButton))}),c&&e.jsx(dt,{currentWorkspaceId:s,currentTab:n,onClose:()=>w(!1)})]}),tabsHeader:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Yt,{children:o.map(k=>e.jsx("a",{className:X("pb-2",n===k?"border-token-text-secondary text-token-text-primary border-b font-medium":"text-token-text-tertiary cursor-pointer font-normal"),onClick:()=>{i(k),O.logEvent("Workspace Usage: Tab Clicked",{tab:k})},children:e.jsx(f,u({},Se[k]))},k))}),e.jsxs("div",{className:"text-token-text-tertiary flex items-center gap-1 text-xs",children:[x?e.jsx(je,{}):e.jsxs("span",{children:[e.jsx(f,u({},Se.dataLastUpdatedLabel)),e.jsx(Wa,{}),U?Jt(U):e.jsx(f,u({},Se.dataLastUpdatedUnknown))]}),"·",e.jsx(ws,{href:"https://help.openai.com/en/articles/10875114-user-analytics-for-chatgpt-enterprise",className:"hover:text-token-link-hover underline",children:e.jsx(f,u({},Se.helpCenterLinkText))})]})]})})}function an(s){"use forget";var Ge,qe,J,we,ua,ga;const a=ls.c(75),{currentWorkspaceId:t}=s,n=ye(),i=la(),o=_s();let d;a[0]!==o?(d=o==null?void 0:o.isFreeWorkspace(),a[0]=o,a[1]=d):d=a[1];const m=!!d;let r,g,c,w,b,U,x;if(a[2]!==i){const L=Ba(i,"3528236309");b=L.get("show_group_filter",!1),U=L.get("show_project_tab",!1),r=L.get("show_ai_champions_button",!1),w=L.get("show_connector_project_cols",!1),g=L.get("show_benchmark_tab",!1),c=L.get("show_classification_tab",!1),x=L.get("show_ui_polish",!1),a[2]=i,a[3]=r,a[4]=g,a[5]=c,a[6]=w,a[7]=b,a[8]=U,a[9]=x}else r=a[3],g=a[4],c=a[5],w=a[6],b=a[7],U=a[8],x=a[9];const _=x,[C,k]=y.useState("overviewTab");let h;a[10]===Symbol.for("react.memo_cache_sentinel")?(h=Ee(new Date),a[10]=h):h=a[10];const[p,N]=y.useState(h),[P,M]=y.useState(null);let T;a[11]!==g||a[12]!==c||a[13]!==U?(T=Xt.filter(L=>L==="projectsTab"?U:L==="benchmarkTab"?g:L==="classificationTab"?c:!0),a[11]=g,a[12]=c,a[13]=U,a[14]=T):T=a[14];const D=T;let v;a[15]!==D||a[16]!==C?(v=D.includes(C)?C:"overviewTab",a[15]=D,a[16]=C,a[17]=v):v=a[17];const j=v,z=j==="benchmarkTab",q=j==="classificationTab";let $;a[18]!==p?($=Y(p),a[18]=p,a[19]=$):$=a[19];const l=g&&z;let B;a[20]!==l?(B={enabled:l},a[20]=l,a[21]=B):B=a[21];const G=Ka(t,$,B),Q=z?(J=(qe=(Ge=G.data)==null?void 0:Ge.workspace_metrics)==null?void 0:qe.partition_date)!=null?J:null:void 0,R=z?G.isLoading:void 0;let E;a[22]!==p?(E=Y(p),a[22]=p,a[23]=E):E=a[23];const S=c&&q;let K;a[24]!==S?(K={enabled:S},a[24]=S,a[25]=K):K=a[25];const ie=Xa(t,E,K),H=q?(ga=(ua=(we=ie.data)==null?void 0:we.workspace_classifier_metrics)==null?void 0:ua.date_partition)!=null?ga:null:void 0,Z=q?ie.isLoading:void 0,fe=z?Q:H,xe=z?R:Z;let ue,_e;a[26]!==b?(ue=()=>{b||M(null)},_e=[b],a[26]=b,a[27]=ue,a[28]=_e):(ue=a[27],_e=a[28]),y.useEffect(ue,_e);const Te=b?P:null;let be;const Be=ss[j];if(j==="overviewTab"){let L;a[29]!==t||a[30]!==Te||a[31]!==b||a[32]!==p?(L=e.jsx(es,{currentWorkspaceId:t,startDate:p,selectedGroup:Te,setSelectedGroup:M,showGroupFilter:b}),a[29]=t,a[30]=Te,a[31]=b,a[32]=p,a[33]=L):L=a[33],be=L}else if(j==="usersTab"){let L;a[34]!==t||a[35]!==r||a[36]!==w||a[37]!==p?(L=e.jsx(as,{currentWorkspaceId:t,startDate:p,showAiChampionsButton:r,showConnectorProjectColumns:w}),a[34]=t,a[35]=r,a[36]=w,a[37]=p,a[38]=L):L=a[38],be=L}else if(j==="benchmarkTab"){const L=o==null?void 0:o.name;let He;a[39]!==t||a[40]!==_||a[41]!==p||a[42]!==L?(He=e.jsx(Ha,{currentWorkspaceId:t,startDate:p,workspaceName:L,showUiPolish:_}),a[39]=t,a[40]=_,a[41]=p,a[42]=L,a[43]=He):He=a[43],be=He}else if(j==="classificationTab"){let L;a[44]!==t||a[45]!==p?(L=e.jsx(Ja,{currentWorkspaceId:t,startDate:p}),a[44]=t,a[45]=p,a[46]=L):L=a[46],be=L}else{let L;a[47]!==Be||a[48]!==t||a[49]!==Te||a[50]!==_||a[51]!==p?(L=e.jsx(Be,{currentWorkspaceId:t,startDate:p,showAiChampionsButton:!1,selectedGroup:Te,setSelectedGroup:M,showGroupFilter:!1,showConnectorProjectColumns:!1,showUiPolish:_}),a[47]=Be,a[48]=t,a[49]=Te,a[50]=_,a[51]=p,a[52]=L):L=a[52],be=L}let De;if(a[53]===Symbol.for("react.memo_cache_sentinel")?(De=[],a[53]=De):De=a[53],y.useEffect(sn,De),!o){let L;return a[54]===Symbol.for("react.memo_cache_sentinel")?(L=e.jsx("div",{className:"flex min-h-[60vh] items-center justify-center",children:e.jsx(je,{})}),a[54]=L):L=a[54],L}let A;a[55]!==n?(A=n.formatMessage(Se.title),a[55]=n,a[56]=A):A=a[56];let W;a[57]!==A?(W=e.jsx(Ws,{children:e.jsx("title",{children:A})}),a[57]=A,a[58]=W):W=a[58];let ge;a[59]!==D||a[60]!==t||a[61]!==fe||a[62]!==n||a[63]!==xe||a[64]!==j||a[65]!==m||a[66]!==p?(ge=m?e.jsx(qa,{title:n.formatMessage(Se.title)}):e.jsx(en,{currentWorkspaceId:t,startDate:p,setStartDate:N,currentTab:j,setTab:k,tabs:D,dataUpdatedDateOverride:fe,isDataUpdatedOverrideLoading:xe,showDatePicker:!0}),a[59]=D,a[60]=t,a[61]=fe,a[62]=n,a[63]=xe,a[64]=j,a[65]=m,a[66]=p,a[67]=ge):ge=a[67];let oe;a[68]!==m||a[69]!==be?(oe=e.jsx(Ys,{children:m?e.jsx(Zs,{}):be}),a[68]=m,a[69]=be,a[70]=oe):oe=a[70];let Ie;return a[71]!==W||a[72]!==ge||a[73]!==oe?(Ie=e.jsxs(e.Fragment,{children:[W,ge,oe]}),a[71]=W,a[72]=ge,a[73]=oe,a[74]=Ie):Ie=a[74],Ie}function sn(){O.logPageView(),O.logEvent("Workspace Usage: Page Viewed")}const Se=pe({title:{id:"workspaceUsage.title",defaultMessage:"User Analytics"},overviewTab:{id:"workspaceUsage.overviewTab",defaultMessage:"Overview"},usersTab:{id:"workspaceUsage.usersTab",defaultMessage:"Users"},gptsTab:{id:"workspaceUsage.gptsTab",defaultMessage:"GPTs"},projectsTab:{id:"workspaceUsage.projectsTab",defaultMessage:"Projects"},benchmarkTab:{id:"workspaceUsage.benchmarkTab",defaultMessage:"Benchmark"},classificationTab:{id:"workspaceUsage.classificationTab",defaultMessage:"Task Insights"},creditsTab:{id:"workspaceUsage.creditsTab",defaultMessage:"Credits"},exportButton:{id:"workspaceUsage.exportButton",defaultMessage:"Export..."},dataLastUpdatedLabel:{id:"workspaceUsage.dataLastUpdatedLabel",defaultMessage:"Data updated"},dataLastUpdatedUnknown:{id:"workspaceUsage.dataLastUpdatedUnknown",defaultMessage:"Unknown"},helpCenterLinkText:{id:"workspaceUsage.helpCenterLinkText",defaultMessage:"Learn more about analytics"}}),Gn=cs(function(){const a=Xs();return Js(),e.jsx(an,u({},a))});export{Gn as default};
//# sourceMappingURL=etu2b7l6lw8e0bc7.js.map
