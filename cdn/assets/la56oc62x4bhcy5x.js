const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mywcgd06arxjhqos.js","assets/fg33krlcm0qyi6yw.js","assets/k65njl5wlgspihfr.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/conversation-small-332fs9rk.css","assets/efooahjtdr85x1lo.js","assets/km71i01x6ma5r62b.js","assets/hcn3kohxpjzaoxwc.js","assets/m9c0b46t4dp00adi.js","assets/en6zlt3w5f6cxktv.js","assets/llove4bcy7api840.js","assets/cjhotjke5k7dpw0q.js","assets/pfks1t2fx5uviwac.js","assets/jex6ulz50fkc86ct.js","assets/c2cj1dlcffke3f7m.js","assets/ohquqctluwabmb5i.js","assets/hb1mva1gmw4bcs8w.js","assets/i1tex5l6gt3gdz3c.js","assets/mcmrxiy9039fw9r6.js","assets/bhm7utdivrybcfbl.js","assets/mivow98b53y1taf8.js","assets/krwszi9u3lj63i9v.js","assets/qomjt47lfw1l209u.js"])))=>i.map(i=>d[i]);
var De=Object.defineProperty,Te=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var pe=(s,t,a)=>t in s?De(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))je.call(t,a)&&pe(s,a,t[a]);if(se)for(var a of se(t))Me.call(t,a)&&pe(s,a,t[a]);return s},I=(s,t)=>Te(s,Fe(t));var K=(s,t)=>{var a={};for(var r in s)je.call(s,r)&&t.indexOf(r)<0&&(a[r]=s[r]);if(s!=null&&se)for(var r of se(s))t.indexOf(r)<0&&Me.call(s,r)&&(a[r]=s[r]);return a};import{b as Y,e as y,a as Z,u as E,f as q,j as e,i as Ne,r as j,_ as Ce,M,n as Ee,a0 as Le}from"./fg33krlcm0qyi6yw.js";import{m as L,R as U,ih as _e,zy as X,l as ce,wj as Re,b as ee,o as Be,c0 as H,aY as We,io as ve,i6 as Ve,t as V,bh as Pe,de as He,ag as Oe,cU as we,zu as Ge,C as $e,M as be,wz as Ke,g2 as v,gJ as Q,T as Ue,a9 as te,fe as de,H as ke,$ as ze,gK as Qe,aK as Je,du as Ye,nW as Ze}from"./mtk1qztvnb31pw5r.js";import{dx as Xe,gQ as es,eN as ss,d4 as ts,A as as,ne as ye,nd as me,cL as ns,az as rs,ky as ue,ao as is,dw as ls,dv as os,go as cs,cI as ds}from"./k65njl5wlgspihfr.js";import{k as ne,j as re,l as ie,m as ms}from"./efooahjtdr85x1lo.js";import{T as m}from"./hcn3kohxpjzaoxwc.js";import{m as Ie}from"./m9c0b46t4dp00adi.js";import{G as us}from"./en6zlt3w5f6cxktv.js";import{i as gs,R as xs}from"./cjhotjke5k7dpw0q.js";import{a as hs,b as fs}from"./pfks1t2fx5uviwac.js";import{a as ps,c as js}from"./jex6ulz50fkc86ct.js";import{u as Ms}from"./qomjt47lfw1l209u.js";const $=25;function vs(s,t,a){return Y({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await U.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:t,limit:$,query:a}}})})}function Ae(s,t,a){return Y({queryKey:["workspace",s,"invites","requests",t,a],queryFn:()=>U.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:t,limit:$,query:a}}})})}function Se(s){const t=y(),a=L(),r=Z();return E({mutationFn:({inviteId:n,role:i,acceptRequest:l})=>U.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:n}},requestBody:{role:i,accept_request:l}}).catch(o=>{throw a.danger(t.formatMessage(S.updateInviteError,{error:o.message}),{loggingTitle:S.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),o}),onSuccess:(n,i)=>{if(i.acceptRequest)r.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{var d;if(!l)return l;const o=l.items.filter(u=>u.id!==i.inviteId),c=Math.max(0,((d=l.total)!=null?d:0)-1);return I(x({},l),{items:o,total:c})});else if(i.role){const l=i.role;r.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{if(!o)return o;const c=o.items.map(d=>d.id===i.inviteId?I(x({},d),{role:l}):d);return I(x({},o),{items:c})})}}})}function qe(s){const t=y(),a=L(),r=Z();return E({mutationFn:({email:n})=>U.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:n}}).catch(i=>{throw a.danger(t.formatMessage(S.deleteInviteError,{email:n,error:i.message}),{loggingTitle:S.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),i}),onSuccess:(n,{email:i})=>{r.setQueriesData({queryKey:["workspace",s,"invites","requests"]},l=>{var d;if(!l)return l;const o=l.items.filter(u=>u.email_address!==i),c=Math.max(0,((d=l.total)!=null?d:0)-1);return I(x({},l),{items:o,total:c})})}})}function bs(s){const t=y(),a=L(),r=Z();return E({mutationFn:()=>U.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(n=>{throw a.danger(t.formatMessage(S.acceptAllInviteRequestsError,{error:n.message}),{loggingTitle:S.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),n}),onSuccess:()=>{r.setQueriesData({queryKey:["workspace",s,"invites","requests"]},n=>n&&I(x({},n),{items:[],total:0}))}})}function ys(s){const t=y(),a=L(),r=Z();return E({mutationFn:({role:n,email:i})=>U.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[i],role:n,resend_emails:!0}}).then(({account_invites:l,errored_emails:o})=>{if(o.length>0)throw new Error(o[0].error);l.length>0&&a.success(t.formatMessage(S.resendInviteSuccess,{email:i}))}).catch(l=>{a.danger(t.formatMessage(S.resendInviteError,{email:i,error:l.message}),{loggingTitle:S.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{r.invalidateQueries({queryKey:["workspace",s,"invites"]}),r.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const S=q({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),ge=({userName:s,isScimManaged:t,dotted:a=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(_e,{user:{name:s,picture:null},size:"default",dotted:a}),t&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(Xe,{width:10,height:10})})]}),w=q({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}}),Ns=r=>{var n=r,{children:s,ref:t}=n,a=K(n,["children","ref"]);return e.jsx(X.Root,I(x({license:"commercial",sheetRole:"dialog"},a),{ref:t,children:s}))},Cs=i=>{var l=i,{children:s,ref:t,className:a,contentPlacement:r="left"}=l,n=K(l,["children","ref","className","contentPlacement"]);return e.jsx(X.View,I(x({className:ce("z-1",a),contentPlacement:r,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0},n),{ref:t,children:s}))},_s=r=>{var n=r,{className:s,ref:t}=n,a=K(n,["className","ref"]);return e.jsx(X.Backdrop,I(x({className:s},a),{ref:t}))},Rs=n=>{var i=n,{children:s,ref:t,className:a}=i,r=K(i,["children","ref","className"]);return e.jsx(X.Content,I(x({className:ce("bg-token-bg-primary box-border shadow-lg",a)},r),{ref:t,children:s}))},Ps=X.Portal,z={Root:Ns,Portal:Ps,View:Cs,Backdrop:_s,Content:Rs},ws=({workspaceId:s,userId:t})=>Y({queryKey:[s,t,"user-roles"],queryFn:async()=>(await U.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s,consistency:"strong"},path:{workspace_id:s,principal_id:t}}})).roles}),Us=({workspaceId:s,userId:t})=>Y({queryKey:[s,t,"user-groups"],queryFn:async()=>(await U.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:t}}})).items}),ks=({workspaceId:s,userId:t,enabled:a=!0})=>Y({enabled:a,queryKey:[s,t,"user-credit-limit"],queryFn:async()=>await U.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/credit-limit",{parameters:{query:{account_id:s,consistency:"strong"},path:{workspace_id:s,principal_id:t}}})}),Is=({workspaceId:s,user:t,onClose:a})=>{var D;const r=ee(),n=y(),i=Ne(),l=Re(r),o=Be(r,"1261424157"),c=l&&o,{data:d,refetch:u,isFetching:g}=ws({workspaceId:s,userId:t.id}),h=j.useMemo(()=>d==null?void 0:d.filter(f=>!f.predefined_role),[d]),{data:p,refetch:R,isFetching:_}=Us({workspaceId:s,userId:t.account_user_id}),{data:b,isFetching:N,refetch:B}=ks({workspaceId:s,userId:t.id,enabled:c}),W=j.useCallback(async()=>{const f=[];f.push(R()),f.push(u()),c&&f.push(B()),await Promise.allSettled(f)},[c,B,R,u]),T=g||_||c&&N,A=f=>(f==null?void 0:f.limit)==null?n.formatMessage(P.creditLimitNotSet):n.formatMessage(P.creditsPerWeek,{value:n.formatNumber(f.limit)});return e.jsx(z.Root,{presented:!0,defaultPresented:!0,onPresentedChange:a,children:e.jsx(z.Portal,{children:e.jsxs(z.View,{contentPlacement:"right",children:[e.jsx(z.Backdrop,{}),e.jsxs(z.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>void W(),className:"hover:bg-token-surface-hover dark:hover:bg-token-main-surface-tertiary keyboard-focused:bg-token-surface-hover flex h-9 w-9 items-center justify-center rounded-lg disabled:cursor-not-allowed disabled:opacity-60","aria-label":n.formatMessage(P.refresh),title:n.formatMessage(P.refresh),disabled:T,children:T?e.jsx(H,{className:"icon"}):e.jsx(es,{className:"icon"})}),e.jsx(We,{onClick:a,iconSize:"lg",autoFocus:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(_e,{user:{name:(D=t.name)!=null?D:"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:t.name}),e.jsx("div",{children:t.email})]})]}),e.jsx("hr",{className:"my-2.5"}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(P.groups)}),_&&e.jsx(H,{}),!_&&e.jsxs(e.Fragment,{children:[(p==null?void 0:p.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(P.noGroups)}),p==null?void 0:p.map(f=>e.jsx(ve,{className:"mx-0",as:"button",onClick:()=>i("/admin/groups/".concat(f.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(us,{group:f})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:f.name}),gs(f)&&e.jsx(xs,{})]})]})})},f.id))]})]}),e.jsx("hr",{className:"my-2.5"})]}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(P.customRoles)}),g&&e.jsx(H,{}),!g&&e.jsxs(e.Fragment,{children:[(h==null?void 0:h.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(P.noCustomRoles)}),h==null?void 0:h.map(f=>e.jsx(ve,{className:"mx-0",as:"button",onClick:()=>i("/admin/permissions/roles/".concat(f.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:f.predefined_role?e.jsx(ss,{className:"icon"}):e.jsx(Ve,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:f.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:f.description})]})]})})},f.id))]})]})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-2.5"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(P.creditLimit)}),N&&e.jsx(H,{}),!N&&b&&!b.has_credit_limit&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(P.noCreditLimit)}),!N&&(b==null?void 0:b.has_credit_limit)&&e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 italic",children:[e.jsx("span",{className:"text-token-text-tertiary",children:n.formatMessage(P.alertCreditLimit)}),e.jsx("span",{children:A(b.soft_alert_credit_limit)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3 italic",children:[e.jsx("span",{className:"text-token-text-tertiary",children:n.formatMessage(P.hardCapCreditLimit)}),e.jsx("span",{children:A(b.hard_cap_credit_limit)})]})]})]})]})]})]})]})})})},P=q({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"},refresh:{id:"RYOenw",defaultMessage:"Refresh"},creditLimit:{id:"K9xPUM",defaultMessage:"Usage limit"},noCreditLimit:{id:"lQKMD4",defaultMessage:"No credit limit"},alertCreditLimit:{id:"hTB/Lx",defaultMessage:"Alert"},hardCapCreditLimit:{id:"/JWyZZ",defaultMessage:"Hard cap"},creditsPerWeek:{id:"k/1C9U",defaultMessage:"{value} credits/week"},creditLimitNotSet:{id:"UJtBId",defaultMessage:"None"}});function xe({currentRole:s,onUpdateUserRole:t,disabled:a=!1}){const r=ne();return e.jsx(ts,{disabled:a,defaultValue:s,onValueChange:n=>{t(n)},triggerClassName:"text-base",options:[{label:r[V.STANDARD],value:V.STANDARD},{label:r[V.ADMIN],value:V.ADMIN},{label:r[V.OWNER],value:V.OWNER}]})}const As=Pe(()=>Ce(()=>import("./mywcgd06arxjhqos.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(s=>s.ConfirmLogoutModal)),J=He(()=>({confirmModalUserData:null})),ae={openModalForUser:s=>{J.setState({confirmModalUserData:s})},closeModal:()=>{J.setState({confirmModalUserData:null})}};function Ss({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var f;const r=ee(),[n,i]=j.useState(0),l=Oe(),[o,c]=j.useState(),d=Re(r),u=l==null?void 0:l.id,g=re(s),h=ie(s),p=g||h,R=Fs(),_=Ls(s),b=Es(s),{data:N}=as(s,n*ye,t);j.useEffect(()=>{i(0)},[t]);const B=j.useCallback(C=>{ae.openModalForUser(C)},[]),W=j.useCallback(()=>{var k;const C=(k=J.getState().confirmModalUserData)==null?void 0:k.id;C!==void 0&&_.mutate({userId:C}),ae.closeModal(),c(void 0)},[_]),T=j.useCallback((C,k)=>{a||R.mutate({userId:C,value:k,workspaceId:s})},[a,R,s]);if(N===void 0)return e.jsx(he,{});const A=N.items,D=Math.ceil(((f=N.total)!=null?f:0)/ye);return n>=D&&D!==0&&i(Math.max(D-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),p&&e.jsx("col",{className:"w-16"})]}),e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{children:e.jsx(M,x({},w.name))}),e.jsx(m.HeaderCell,{children:e.jsx("span",{className:g?"ps-3":"",children:e.jsx(M,x({},w.accountType))})}),e.jsx(m.HeaderCell,{children:e.jsx(M,x({},w.dateAdded))}),p&&e.jsx(m.HeaderCell,{className:"w-16"})]}),e.jsxs(m.Body,{children:[A.map(C=>e.jsx(Ds,{isCurrentUser:u!==void 0&&C.id===u,user:C,currentUserHasAdminRights:p,isCurrentUserOwner:g,onRemoveUserClick:()=>{var k,fe;return B({id:C.id,name:(k=C.name)!=null?k:"",email:(fe=C.email)!=null?fe:"",created_time:C.created_time})},onUpdateUserRole:T,onLogoutUser:async k=>{await b.mutateAsync({userId:k})},roleEditingDisabled:a,onClick:d?k=>c(k):void 0},C.id)),A.length===0&&e.jsx(m.Row,{className:"[&>td]:py-2",children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(M,x({},w.noResults))})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:D>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(me,{currentPage:n,onChangeIndex:i,length:D})})}),o&&e.jsx(Is,{workspaceId:s,user:o,onClose:()=>c(void 0)}),e.jsx(qs,{onDeleteConfirm:W})]})}function qs({onDeleteConfirm:s}){var n;const t=y(),a=J(i=>i.confirmModalUserData!==null),r=J(i=>i.confirmModalUserData===null?{}:{userId:i.confirmModalUserData.id,email:i.confirmModalUserData.email,name:i.confirmModalUserData.name,dateAdded:Ge(i.confirmModalUserData.created_time)});return e.jsx($e,{testId:"modal-remove-member",isOpen:a,title:t.formatMessage(w.removeMemberModalTitle),onClose:()=>ae.closeModal(),type:"success",primaryButton:e.jsx(be.Button,{title:t.formatMessage(w.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(be.Button,{title:t.formatMessage(w.removeMemberModalCancel),color:"secondary",onClick:()=>ae.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(n=r.name)!=null?n:r.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(M,I(x({},w.dateJoined),{values:{dateAdded:t.formatDate(r.dateAdded,{year:"numeric",month:"long",day:"numeric"})}}))})]})})}function Ds({user:s,currentUserHasAdminRights:t,isCurrentUserOwner:a,isCurrentUser:r,onRemoveUserClick:n,onUpdateUserRole:i,onLogoutUser:l,roleEditingDisabled:o,onClick:c}){var R;const u=ne()[s.role],g=y(),h=(R=s.name)!=null?R:g.formatMessage(w.missingName),p=ee();return e.jsxs(m.Row,{className:ce("[&>td]:py-2"),onClick:c?()=>c==null?void 0:c(s):void 0,children:[e.jsxs(m.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(ge,{userName:h,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[h,r&&e.jsx("span",{className:"ms-1",children:e.jsx(M,x({},w.youSpecifier))})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:s.role,onUpdateUserRole:_=>{i(s.id,_)},disabled:r||o}):u}),e.jsx(m.Cell,{children:g.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),t&&e.jsx(m.Cell,{children:e.jsx(Ts,{userId:s.id,onRemoveUserClick:n,onLogoutUserClick:()=>{we(p,As,{onConfirm:()=>l(s.id)})},isCurrentUser:r,isScimManaged:s.is_scim_managed})})]})}function Ts({isCurrentUser:s,onRemoveUserClick:t,onLogoutUserClick:a,userId:r,isScimManaged:n}){const i=ee(),l=y(),o=Ke(i),c=e.jsx(v.Item,{onClick:n?void 0:d=>{d.stopPropagation(),t(r)},color:"danger",icon:e.jsx(ns,{}),disabled:n,children:e.jsx(M,x({},w.removeMemberModalTitle))});return s?null:e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{className:"-my-2",children:e.jsx(Q,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{size:"small",children:[o&&e.jsx(v.Item,{onClick:d=>{d.stopPropagation(),a(r)},icon:e.jsx(rs,{}),children:e.jsx(M,x({},w.logoutMember))}),n?e.jsx(Ue,{label:l.formatMessage(Ie.managedViaSCIMTooltip),className:"flex",side:"right",children:c}):c]})})]})}function Fs(){const s=L();return E({mutationFn:({userId:t,workspaceId:a,value:r})=>U.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:a,user_id:t}},requestBody:{role:r}}).catch(n=>{s.danger("Unable to update user (".concat(t,") role: ").concat(n.message),{toastId:"user_manager_table"})})})}function Es(s){const t=L();return E({mutationFn:({userId:a})=>U.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:a}}}),onError:(a,r)=>{t.danger("Unable to logout user (".concat(r.userId,") from workspace"),{toastId:"user_manager_table"})},onSuccess:()=>{t.success("User logged out of all sessions",{id:"user_logout_success"})}})}function Ls(s){const t=Z(),a=L();return E({mutationFn:({userId:r})=>U.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:r}}}).catch(n=>{a.danger("Unable to remove user (".concat(r,") from workspace: ").concat(n.message),{toastId:"user_manager_table"})}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s]})}})}function he(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(H,{})})}function Bs({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var h;const[r,n]=j.useState(0),{data:i}=Ae(s,r*$,t),l=re(s),o=ie(s),c=y(),d=l||o;if(i===void 0)return e.jsx(he,{});const u=i.items,g=Math.ceil(((h=i.total)!=null?h:0)/$);return r>=g&&g!==0&&n(Math.max(g-1,0)),e.jsxs("div",{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(M,x({},O.email))}),e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:d?"ps-3":"",children:e.jsx(M,x({},O.role))})}),d&&e.jsx(m.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:c.formatMessage(O.actions)})]}),e.jsxs(m.Body,{children:[u.map(p=>e.jsx(Ws,{workspaceId:s,invite:p,isCurrentUserOwner:l,currentUserHasAdminRights:d,isRoleEditingDisabled:a},p.id)),u.length===0&&e.jsx(m.Row,{children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(M,x({},O.noResults))})})})]})]}),g>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:r,onChangeIndex:n,length:g})})]})}function Ws({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:r,isRoleEditingDisabled:n}){var d;const i=ne(),l=Se(s),o=qe(s),c=y();return e.jsxs(m.Row,{className:"[&>td]:py-2",disabled:l.isPending||o.isPending||o.isPending,children:[e.jsx(m.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(d=t.email_address)!=null?d:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:u=>{n||l.mutate({inviteId:t.id,role:u})},disabled:n}):i[t.role]}),r&&e.jsx(e.Fragment,{children:e.jsx(m.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(te,{color:"secondary",onClick:()=>l.mutate({inviteId:t.id,acceptRequest:!0}),children:c.formatMessage(O.accept)}),e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{disabled:t.is_scim_managed,children:e.jsx(Q,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsx(v.Content,{children:e.jsx(v.Item,{color:"danger",onClick:()=>{var u;return o.mutate({email:(u=t.email_address)!=null?u:""})},children:c.formatMessage(O.reject)})})})]})]})})})]})}const O=q({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),Vs=({workspaceId:s,isRoleEditingDisabled:t=!1})=>{var _,b;const a=y(),r=re(s),n=ie(s),i=r||n,l=bs(s),[o,c]=j.useState(""),[d,u]=j.useState(""),g=j.useMemo(()=>de(N=>u(N),300,{leading:!1,trailing:!0}),[]),{data:h}=Ae(s,0,d),p=(_=h==null?void 0:h.total)!=null?_:0,R=p?a.formatMessage(le.acceptAllWithCount,{count:p}):a.formatMessage(le.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ue,{value:o,onChange:N=>{c(N.target.value),g(N.target.value)},placeholder:a.formatMessage(le.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),i&&e.jsx(te,{loading:l.isPending,disabled:((b=h==null?void 0:h.total)!=null?b:0)===0,onClick:()=>l.mutate(),children:R})]}),e.jsx(Bs,{workspaceId:s,filterInputValue:d,isRoleEditingDisabled:t})]})},le=q({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}});function Hs({workspaceId:s,filterInputValue:t,isRoleEditingDisabled:a=!1}){var g;const[r,n]=j.useState(0),i=re(s),l=ie(s),o=i||l,{data:c}=vs(s,r*$,t);if(c===void 0)return e.jsx(he,{});const d=c.items,u=Math.ceil(((g=c.total)!=null?g:0)/$);return r>=u&&u!==0&&n(Math.max(u-1,0)),e.jsxs("div",{children:[e.jsxs(m.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),o&&e.jsx("col",{className:"w-16"})]}),e.jsxs(m.Header,{children:[e.jsx(m.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(M,x({},G.email))}),e.jsx(m.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(M,x({},G.invitedDate))}),e.jsx(m.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:o?"ps-3":"",children:e.jsx(M,x({},G.role))})}),o&&e.jsx(m.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(m.Body,{children:[d.map(h=>e.jsx(Os,{workspaceId:s,invite:h,isCurrentUserOwner:i,currentUserHasAdminRights:o,isRoleEditingDisabled:a},h.id)),d.length===0&&e.jsx(m.Row,{children:e.jsx(m.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(M,x({},G.noResults))})})})]})]}),u>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:r,onChangeIndex:n,length:u})})]})}function Os({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:r,isRoleEditingDisabled:n}){var u;const i=y(),l=ne(),o=Se(s),c=qe(s),d=ys(s);return e.jsxs(m.Row,{className:"[&>td]:py-2",disabled:o.isPending||c.isPending||c.isSuccess||d.isPending,children:[e.jsx(m.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(u=t.email_address)!=null?u:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(m.Cell,{children:i.formatDate(t.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(m.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:g=>{n||o.mutate({inviteId:t.id,role:g})},disabled:n}):l[t.role]}),r&&e.jsx(e.Fragment,{children:e.jsx(m.Cell,{children:e.jsx(Gs,{onDeleteUser:()=>{var g;c.mutate({email:(g=t.email_address)!=null?g:""})},onResendInvite:()=>{var g,h;d.mutate({email:(g=t.email_address)!=null?g:"",role:(h=t.role)!=null?h:""})},disabled:t.is_scim_managed})})})]})}function Gs({onDeleteUser:s,onResendInvite:t,disabled:a}){const r=y();return e.jsx(e.Fragment,{children:a?e.jsx(v.Root,{children:e.jsx(v.Trigger,{disabled:!0,children:e.jsx(Ue,{label:r.formatMessage(Ie.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(Q,{className:"icon-sm"})})})}):e.jsxs(v.Root,{children:[e.jsx(v.Trigger,{children:e.jsx(Q,{className:"icon-sm"})}),e.jsx(v.Portal,{children:e.jsxs(v.Content,{children:[e.jsx(v.Item,{onClick:t,children:e.jsx(M,x({},G.resendInvite))}),e.jsx(v.Item,{onClick:s,children:e.jsx(M,x({},G.revokeInvite))})]})})]})})}const G=q({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),$s=({workspaceId:s,isRoleEditingDisabled:t=!1})=>{const a=y(),[r,n]=j.useState(""),[i,l]=j.useState(""),o=j.useMemo(()=>de(c=>l(c),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(ue,{value:r,onChange:c=>{n(c.target.value),o(c.target.value)},placeholder:a.formatMessage(Ks.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Hs,{workspaceId:s,filterInputValue:i,isRoleEditingDisabled:t})]})},Ks=q({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}}),zs=Pe(()=>Ce(()=>import("./k65njl5wlgspihfr.js").then(s=>s.F9),__vite__mapDeps([2,1,3,4,5])).then(s=>s.AdminInviteModal));function Qs({workspaceId:s,isRoleEditingDisabled:t=!1}){const a=ee(),r=y(),n=ke(),[i,l]=j.useState(""),[o,c]=j.useState(""),d=j.useMemo(()=>de(p=>c(p),300,{leading:!1,trailing:!0}),[]);if(!n)return null;const u=n==null?void 0:n.isSelfServeBusiness(),g=n.isAdminOfAccount(),h=n.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(ue,{value:i,onChange:p=>{l(p.target.value),d(p.target.value)},placeholder:r.formatMessage(oe.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(g||h||u)&&e.jsx(te,{onClick:()=>{ze.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),we(a,zs,{workspace:n})},icon:is,children:e.jsx(M,x({},oe.inviteMemberButton))}),u?e.jsx(Qe,{triggerButton:e.jsx(te,{color:"secondary",icon:Q}),children:e.jsx(v.Item,{onClick:()=>{n&&Je.setLeaveWorkspaceData(n)},children:e.jsx(M,x({},oe.leaveWorkspace))})}):null]})]}),e.jsx(Ss,{workspaceId:s,filterInputValue:o,isRoleEditingDisabled:t})]})}const oe=q({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"}}),Js=s=>s==="members"||s==="invites"||s==="requests";function Ys({currentWorkspaceId:s}){var W,T;const t=y(),a=ke(),r=(W=a==null?void 0:a.isFreeWorkspace())!=null?W:!1,n=ms(a),{data:i,isLoading:l}=Ye(s),o=j.useMemo(()=>[{key:"members",label:t.formatMessage(F.allMembers),children:e.jsx(Qs,{workspaceId:s,isRoleEditingDisabled:r})},{key:"invites",label:t.formatMessage(F.pendingInvites),children:e.jsx($s,{workspaceId:s,isRoleEditingDisabled:r})},{key:"requests",label:t.formatMessage(F.pendingRequests),children:e.jsx(Vs,{workspaceId:s,isRoleEditingDisabled:r})}],[s,t,r]),c=Ne(),[d]=Ee(),u=d.get("tab"),[g,h]=j.useState(u&&Js(u)?u:o[0].key),p=a!=null?ls(a.data.role):void 0,R=a!=null?os(a.data.role):void 0,_=a==null?void 0:a.isEnterprisey();let b=!1;R||p||!_?b=!0:b=!!((T=i==null?void 0:i.permissions)!=null&&T.includes("chatgpt.workspace.member.role.view"));const{count:N}=cs(b?s:void 0),B=A=>{h(A),c({pathname:window.location.pathname,search:new URLSearchParams({tab:A}).toString()})};return a?l?e.jsx("div",{className:"mt-6 flex min-h-[40vh] items-center justify-center",children:e.jsx(H,{})}):b?e.jsxs(e.Fragment,{children:[e.jsx(ds,{children:e.jsx("title",{children:t.formatMessage(F.adminBrowserPageTitle)})}),e.jsx(ps,{title:t.formatMessage(F.adminPageTitle),subtitle:e.jsx(M,x({values:{totalMembers:N,planName:n}},F.totalMembers)),tabsHeader:e.jsx(hs,{items:o,activeTab:g,onTabChange:B})}),e.jsx(js,{children:e.jsx(fs,{items:o,activeTab:g})})]}):e.jsx("div",{className:"m-6",children:e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-secondary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[e.jsx(Ze,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),e.jsx(M,x({},F.membersPagePermissionDenied))]})}):null}const F=q({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} Â· {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},membersPagePermissionDenied:{id:"adminPage.membersPagePermissionDenied",defaultMessage:"You don't have permission to view this members list. Please contact your workspace admin for access or update the workspace settings."}}),dt=Le(function(){const t=Ms();return e.jsx(Ys,x({},t))});export{dt as a,w as m};
//# sourceMappingURL=la56oc62x4bhcy5x.js.map
