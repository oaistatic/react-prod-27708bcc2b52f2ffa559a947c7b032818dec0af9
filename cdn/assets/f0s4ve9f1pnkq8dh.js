import{e as P,j as r,M as k,r as N,c as z}from"./fg33krlcm0qyi6yw.js";import{c_ as q,rq as A,os as H,rr as K,C as J,a9 as Q,b as L,gK as Y,g2 as Z,gJ as V,l as W,fN as X,o as ee,aY as te}from"./mtk1qztvnb31pw5r.js";import{d0 as se,d1 as oe,d2 as re,dP as ne,Z as ie,bO as U,bP as ae}from"./k65njl5wlgspihfr.js";import{g as le}from"./nxe574t4em7jpfaw.js";import{P as de}from"./nwqhxo974az4xh1l.js";import"./hgk4djqrlco056z6.js";import"./l6gg4oal15ycpbhj.js";import"./27egyxvdbhiyko0z.js";import"./he7oe7s4xa3cph5y.js";import"./gy1lpvuoewmzh42c.js";import"./jed1ux7qibe55pmj.js";import"./h1em0bjkpkjv8ykw.js";import"./nfccle6oyncifphl.js";import"./hu1bt0oauegdhua6.js";import"./ojve869uwykk95at.js";import"./ly75bs3d14n5v622.js";import"./b7abh8aw9icifmym.js";import"./odbvdbv7o06jw7ls.js";import"./l8g4nijn9ow7argx.js";import"./njh1hro7jxhbut4d.js";import"./l09h2qppleubii6l.js";import"./cu0ig3jox4ha1bc5.js";import"./i1g2kxfbotvbgq93.js";import"./qcr0k45a8ay8c0b9.js";function ce({product_id:f,product_title:e,product_url:t,onClose:y}){const u=L(),n=q(),{data:o}=se(u,A.CommerceProduct),l=P(),i=oe(u,l,f,A.CommerceProduct,K.Commerce,{[H.EntityName]:e,[H.EntityUrl]:t});if(o==null)return null;const a="Report ".concat((e==null?void 0:e.length)<=30?e:(e==null?void 0:e.substring(0,27))+"...");return n?r.jsx(re,{reasons:o.reasons,submitReport:i,title:a,onClose:y,header:o.header,subHeader:o.header_explanation}):r.jsx(J,{testId:"modal-report-reason-selection",title:a,onClose:y,isOpen:!0,showCloseButton:!0,type:"success",primaryButton:r.jsx(Q,{color:"primary",onClick:()=>{window.open("https://openai.com/form/report-content","_blank")},children:r.jsx(k,{id:"report.goToForm",defaultMessage:"Go to Form"})}),children:r.jsx("div",{className:"text-sm",children:r.jsx("div",{className:"mb-2",children:r.jsx(k,{id:"report.externalReportFormInstruction",defaultMessage:"Please use this form to report the issue."})})})})}function G({product_id:f,product_title:e,product_url:t,className:y,enableReporting:u}){const n=P(),[o,l]=N.useState(!1),[i,a]=N.useState(!1);return u?r.jsxs(r.Fragment,{children:[r.jsx(Y,{open:o,onOpenChange:d=>{l(d)},side:"bottom",contentAlign:"end",triggerButton:r.jsx(ie,{className:W("keyboard-focused:focus-ring bg-token-main-surface-primary hover:bg-token-main-surface-secondary! pointer-events-auto me-2 h-8! w-8! rounded-full! opacity-80",y),"aria-label":n.formatMessage({id:"G4IkJB",defaultMessage:"Open product options"}),"data-testid":"product-options-button",icon:V}),size:"auto",children:r.jsx(Z.Item,{icon:ne,onClick:()=>{a(!0)},children:r.jsx(k,{id:"thread.reportProduct",defaultMessage:"Report"})})}),i&&r.jsx(ce,{product_id:f,product_title:e,product_url:t,onClose:()=>a(!1)})]}):null}function Ee(f){"use forget";const e=z.c(22),{conversation:t,sidebar:y,type:u}=f,{messageId:n,turnIndex:o,contentReferenceStartIndex:l,productIndex:i}=y,a=u===void 0?"sidebar":u,d=X(t.id,ue);let h;e[0]!==t.id||e[1]!==n||e[2]!==o?(h={clientThreadId:t.id,messageId:n,turnIndex:o},e[0]=t.id,e[1]=n,e[2]=o,e[3]=h):h=e[3];const p=h;let c;e[4]!==l||e[5]!==n||e[6]!==i||e[7]!==d?(c=le({thread:d,messageId:n,contentReferenceStartIndex:l,productIndex:i}),e[4]=l,e[5]=n,e[6]=i,e[7]=d,e[8]=c):c=e[8];const{product:s}=c;if(!s)return null;let I;e[9]!==l||e[10]!==n||e[11]!==i?(I={messageId:n,contentReferenceStartIndex:l,productIndex:i},e[9]=l,e[10]=n,e[11]=i,e[12]=I):I=e[12];let x;e[13]!==t?(x=()=>U(t),e[13]=t,e[14]=x):x=e[14];let j;return e[15]!==p||e[16]!==t.id||e[17]!==s||e[18]!==I||e[19]!==x||e[20]!==a?(j=r.jsx(_,{product:s,sidebar:I,clientThreadId:t.id,analyticsMetadata:p,handleCloseThreadSidebar:x,type:a}),e[15]=p,e[16]=t.id,e[17]=s,e[18]=I,e[19]=x,e[20]=a,e[21]=j):j=e[21],j}function ue(f){return f}function $e(f){"use forget";const e=z.c(16),{conversation:t,sidebar:y,type:u}=f,{messageId:n,product:o,contentReferenceStartIndex:l,productIndex:i}=y,a=u===void 0?"sidebar":u;let d;e[0]!==t.id||e[1]!==n?(d={clientThreadId:t.id,messageId:n,turnIndex:0},e[0]=t.id,e[1]=n,e[2]=d):d=e[2];const h=d;if(!o)return null;let p;e[3]!==l||e[4]!==n||e[5]!==i?(p={messageId:n,contentReferenceStartIndex:l,productIndex:i},e[3]=l,e[4]=n,e[5]=i,e[6]=p):p=e[6];let c;e[7]!==t?(c=()=>U(t),e[7]=t,e[8]=c):c=e[8];let s;return e[9]!==h||e[10]!==t.id||e[11]!==o||e[12]!==p||e[13]!==c||e[14]!==a?(s=r.jsx(_,{product:o,sidebar:p,clientThreadId:t.id,analyticsMetadata:h,handleCloseThreadSidebar:c,type:a}),e[9]=h,e[10]=t.id,e[11]=o,e[12]=p,e[13]=c,e[14]=a,e[15]=s):s=e[15],s}function _(f){"use forget";var E,$,D;const e=z.c(50),{product:t,sidebar:y,clientThreadId:u,analyticsMetadata:n,handleCloseThreadSidebar:o,type:l}=f,{messageId:i,contentReferenceStartIndex:a,productIndex:d}=y,h=l===void 0?"sidebar":l,p=L(),c=P(),[s,I]=N.useState(t);let x,j;if(e[0]!==t?(x=()=>{t&&I(t)},j=[t],e[0]=t,e[1]=x,e[2]=j):(x=e[1],j=e[2]),N.useEffect(x,j),!t)return null;const C="".concat(i,"-").concat(a,"-").concat(d),O=h==="sidebar";let T;e[3]!==n||e[4]!==u||e[5]!==a||e[6]!==i||e[7]!==t||e[8]!==d||e[9]!==O?(T=r.jsx(de,{product:t,setUpdatedProduct:I,clientThreadId:u,messageId:i,contentReferenceStartIndex:a,productIndex:d,analyticsMetadata:n,offsetTopMargin:O}),e[3]=n,e[4]=u,e[5]=a,e[6]=i,e[7]=t,e[8]=d,e[9]=O,e[10]=T):T=e[10];const M=T;let F;e[11]!==t.providers?(F=(E=t.providers)==null?void 0:E.includes("p3"),e[11]=t.providers,e[12]=F):F=e[12];const R=F;let w;e[13]!==p||e[14]!==R?(w=ee(p,"1961970013")&&R,e[13]=p,e[14]=R,e[15]=w):w=e[15];const S=w;switch(h){case"sidebar":{let g;e[16]===Symbol.for("react.memo_cache_sentinel")?(g=r.jsx("div",{className:"flex grow"}),e[16]=g):g=e[16];let m;e[17]!==S||e[18]!==R||e[19]!==t.id||e[20]!==t.title||e[21]!==t.url||e[22]!==(s==null?void 0:s.url)?(m=S&&r.jsx(G,{product_id:t.id,product_title:t.title,product_url:($=s==null?void 0:s.url)!=null?$:t.url,enableReporting:R}),e[17]=S,e[18]=R,e[19]=t.id,e[20]=t.title,e[21]=t.url,e[22]=s==null?void 0:s.url,e[23]=m):m=e[23];let b;e[24]!==m?(b=r.jsxs(r.Fragment,{children:[g,m]}),e[24]=m,e[25]=b):b=e[25];let v;e[26]!==c?(v=c.formatMessage({id:"region.sidebar.product",defaultMessage:"Product details"}),e[26]=c,e[27]=v):v=e[27];let B;return e[28]!==o||e[29]!==C||e[30]!==M||e[31]!==b||e[32]!==v?(B=r.jsx(ae,{handleClose:o,showScrollToBottomButton:!0,leading:b,leadingFullBleed:!0,ariaLabel:v,children:M},C),e[28]=o,e[29]=C,e[30]=M,e[31]=b,e[32]=v,e[33]=B):B=e[33],B}case"modal":{let g;e[34]!==S||e[35]!==R||e[36]!==t.id||e[37]!==t.title||e[38]!==t.url||e[39]!==(s==null?void 0:s.url)?(g=S&&r.jsx(G,{product_id:t.id,product_title:t.title,product_url:(D=s==null?void 0:s.url)!=null?D:t.url,className:"absolute end-8.5 top-1.5 z-10",enableReporting:R}),e[34]=S,e[35]=R,e[36]=t.id,e[37]=t.title,e[38]=t.url,e[39]=s==null?void 0:s.url,e[40]=g):g=e[40];let m;e[41]!==o?(m=r.jsx(te,{className:"absolute end-2.5 top-2.5 z-10",onClick:o}),e[41]=o,e[42]=m):m=e[42];let b;return e[43]!==o||e[44]!==C||e[45]!==t.title||e[46]!==M||e[47]!==m||e[48]!==g?(b=r.jsxs(J,{testId:"modal-chat-screen-product-flyout",className:"relative max-w-md",size:"custom",type:"success",noPadding:!0,title:t.title,visuallyHiddenHeader:!0,isOpen:!0,onClose:o,rootClassName:"z-0",children:[M,g,m]},C),e[43]=o,e[44]=C,e[45]=t.title,e[46]=M,e[47]=m,e[48]=g,e[49]=b):b=e[49],b}}}export{$e as ChatScreenAgentProductFlyout,Ee as ChatScreenProductFlyout,_ as ProductFlyout};
//# sourceMappingURL=f0s4ve9f1pnkq8dh.js.map
