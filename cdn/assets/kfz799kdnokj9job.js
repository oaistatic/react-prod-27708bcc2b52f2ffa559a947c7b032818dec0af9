var j=Object.freeze,_=Object.defineProperty,I=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var S=(a,s,e)=>s in a?_(a,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[s]=e,g=(a,s)=>{for(var e in s||(s={}))U.call(s,e)&&S(a,e,s[e]);if(A)for(var e of A(s))q.call(s,e)&&S(a,e,s[e]);return a},v=(a,s)=>I(a,L(s));var w=(a,s)=>j(_(a,"raw",{value:j(s||a.slice())}));import{e as F,r as E,j as t,f as J,M as y,a as G,u as N}from"./fg33krlcm0qyi6yw.js";import{rU as Q,v as h,C as B,c0 as K,pt as O,pu as V,l as T,pw as H,F as b,a9 as R,i8 as D,R as W}from"./mtk1qztvnb31pw5r.js";import{de as X}from"./k65njl5wlgspihfr.js";function Y(a){const s=G();return N({mutationFn:async({actionId:e,domain:x,settings:l})=>D.upsertUserActionSettings(e,x,l),onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function Z(a){const s=G();return N({mutationFn:async({pluginId:e})=>{await W.safeDelete("/aip/p/{id}/user-settings",{parameters:{path:{id:e}}})},onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const ne=({gizmo:a,onClose:s})=>{const{data:e,isLoading:x}=Q(a.gizmo.id,!0),l=F(),[d,u]=E.useState("actions"),r=e!=null&&e.settings.some(i=>i.oauth_status!=null&&a.tools.some(o=>{var n;return o.type===h.JIT_PLUGIN&&((n=o.metadata)==null?void 0:n.action_id)===i.action_id}));return d==="connected_accounts"&&!r&&u("actions"),t.jsx(B,{testId:"modal-gizmo-privacy-settings",title:l.formatMessage(c.title),isOpen:!0,onClose:s,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:x?t.jsx(K,{}):t.jsxs(O,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:d,onValueChange:i=>{u(i)},children:[r&&t.jsxs(V,{className:T("flex max-w-[200px] min-w-[180px] shrink-0 flex-col gap-2"),children:[t.jsx(z,{value:"actions",message:c.actions}),r&&t.jsx(z,{value:"connected_accounts",message:c.connectedAccounts})]}),t.jsxs("div",{className:"flex-1 text-sm",children:[d==="actions"&&t.jsxs(M,{children:[t.jsx(y,v(g({},c.allowedActionsDesc),{values:{gizmoName:a.gizmo.display.name}})),e==null?void 0:e.settings.map((i,o)=>{var m;const n=(m=a.tools)==null?void 0:m.find(p=>{var f;return p.type===h.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&t.jsx($,{gizmoId:a.gizmo.id,actionSettings:i,actionTool:n},o)})]}),d==="connected_accounts"&&t.jsxs(M,{children:[t.jsx(y,v(g({},c.connectedAccountsDesc),{values:{gizmoName:a.gizmo.display.name}})),t.jsx("div",{children:e==null?void 0:e.settings.map((i,o)=>{var m;const n=(m=a.tools)==null?void 0:m.find(p=>{var f;return p.type===h.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&i.oauth_status&&t.jsx(ee,{gizmoId:a.gizmo.id,actionSettings:i,actionTool:n},o)})})]})]})]})})};function z({value:a,message:s}){return t.jsx(H,{className:"text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary flex rounded-md px-2 py-1.5 text-sm",value:a,children:t.jsx("div",{className:"truncate",children:t.jsx(y,g({},s))})})}function $({gizmoId:a,actionSettings:s,actionTool:e}){var u,r,i;const x=Y(a),l=(u=s.action_settings)==null?void 0:u.all,d=o=>{var n,m;(n=e.metadata)!=null&&n.action_id&&((m=e.metadata)!=null&&m.domain)&&x.mutateAsync({actionId:e.metadata.action_id,domain:e.metadata.domain,settings:{all:o}})};return t.jsx("div",{children:t.jsxs(C,{className:"border-b border-black/10 dark:border-white/10",children:[t.jsxs("div",{className:"flex flex-row space-x-4",children:[t.jsx("div",{className:"font-semibold",children:(r=e.metadata)==null?void 0:r.domain}),t.jsxs("a",{href:(i=e.metadata)==null?void 0:i.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"text-token-text-tertiary hover:text-token-text-secondary flex items-center gap-1 hover:cursor-pointer",children:[t.jsx(y,g({},c.privacyPolicyLink)),t.jsx(X,{className:"icon"})]})]}),t.jsxs("select",{value:l?"always_allow":"unset",onChange:o=>d(o.target.value),className:"bg-token-main-surface-primary rounded-sm border-none text-sm",children:[t.jsx("option",{value:"always_allow",children:t.jsx(y,g({},c.alwaysAllowDropdown))}),t.jsx("option",{value:"unset",children:t.jsx(y,g({},c.askDropdown))})]})]})})}function ee({gizmoId:a,actionSettings:s,actionTool:e}){var d;const x=Z(a),l=s.oauth_status==="valid";return t.jsxs(C,{children:[t.jsx("div",{className:"font-semibold",children:(d=e==null?void 0:e.metadata)==null?void 0:d.domain}),t.jsx(R,{color:"secondary",size:"small",onClick:()=>{var u,r,i,o,n;(u=e.metadata)!=null&&u.action_id&&((r=e.metadata)!=null&&r.domain)&&(l?x.mutateAsync({pluginId:(i=e.metadata)==null?void 0:i.action_id}):D.doOAuthRedirect(a,(o=e.metadata)==null?void 0:o.action_id,(n=e.metadata)==null?void 0:n.domain,window.location.href))},children:t.jsx(y,g({},l?c.logout:c.login))})]})}var P;const M=b.div(P||(P=w(["flex flex-col gap-6"])));var k;const C=b.div(k||(k=w(["flex flex-row justify-between py-3 items-center"]))),c=J({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}});export{ne as default};
//# sourceMappingURL=kfz799kdnokj9job.js.map
