var bt=Object.defineProperty,wt=Object.defineProperties;var Mt=Object.getOwnPropertyDescriptors;var Ve=Object.getOwnPropertySymbols;var jt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;var Je=(a,i,n)=>i in a?bt(a,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[i]=n,x=(a,i)=>{for(var n in i||(i={}))jt.call(i,n)&&Je(a,n,i[n]);if(Ve)for(var n of Ve(i))yt.call(i,n)&&Je(a,n,i[n]);return a},H=(a,i)=>wt(a,Mt(i));import{j as e,M as f,r,f as ot,e as St,i as Et,a as Ct,a0 as Ft,a9 as Lt}from"./fg33krlcm0qyi6yw.js";import{o as Pt,b as pe,I as rt,gK as fe,lp as Qe,eh as Ye,dL as Ze,qx as Nt,ot as _t,bg as Bt,nW as Dt,C as Rt,Y as ze,m as Ut,P as O,vq as et,cU as Tt,e as It,_ as Q,a9 as tt,py as At,g2 as Y,c0 as Ht,gJ as Ot,dv as de,vr as Gt,ga as Wt,qw as qt}from"./mtk1qztvnb31pw5r.js";import{pU as Kt,pV as Xt,nF as $t,cw as Vt,a as Jt,T as Qt,gQ as Yt,ku as z,kv as Zt,Y as zt,fG as es,fH as ts,pW as ss,pX as as,r as is,gu as ls}from"./k65njl5wlgspihfr.js";import{F as st,b as os,c as rs}from"./ibjz9c01f0uy7k53.js";import{T as ns}from"./tkv1g3prhmmeuid6.js";import{a as ce,n as P,g as ue,s as ds,e as me,v as cs,d as us,f as ms,S as fs,i as at,h as ps,F as it,U as xs,u as gs}from"./fwtla2bbxlv5yr7j.js";import{S as hs}from"./jmkoub13urc7hve4.js";import{u as ks}from"./ctbtetl25rmz78uu.js";import"./mbql81gwv5du9dtu.js";import"./k43gn7pl526u53kc.js";import"./dg5jraediw4l39ow.js";import"./hb1mva1gmw4bcs8w.js";import"./efooahjtdr85x1lo.js";import"./km71i01x6ma5r62b.js";import"./mivow98b53y1taf8.js";import"./krwszi9u3lj63i9v.js";import"./i5jw6wfkpao2rx5t.js";import"./mce0eiesimdmeqmr.js";import"./ifrwee0bgh9e2but.js";import"./gqx9i5tb3deqoo5z.js";import"./kgrrqncjl71482vi.js";import"./ohquqctluwabmb5i.js";import"./c2cj1dlcffke3f7m.js";import"./nwdwrv5b1h68xdm5.js";import"./ce3hgmw4iyyhicud.js";import"./bio6zqk7sn9h2l92.js";import"./exm3n162m2u9ltpu.js";import"./og8jhmm6v1nbwzo4.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./jdzosouyvpzu0tpb.js";function vs({conversation:a}){"use no forget";var b;const i=pe(),{modelLabel:n,dropdownSections:h}=Kt(a,!1),E=Pt(i,"1213809372"),j=(b=rt(i))==null?void 0:b.hasPaidFeatures();if(!(E||j))return null;const y=e.jsxs($t,{children:[e.jsx(f,{id:"IhcP1l",defaultMessage:"Model"}),e.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:n}),e.jsx(Vt,{className:"icon-sm text-token-text-tertiary"})]});return e.jsx(fe,{size:"small",alignOffset:-4,triggerButton:y,children:e.jsx(Xt,{sections:h})})}function bs({hazelnutId:a,hasUnsavedChanges:i}){"use no forget";const n=pe(),[h,E]=r.useState(()=>Qe(n)),[j,R]=r.useState(0);Jt(h.id,{kind:Ye.PrimaryAssistant},{disableConversationNavigation:!0}),r.useEffect(()=>{Ze(h.id,b=>{b.mode={kind:Ye.PrimaryAssistant},b.disableConversationNavigation=!0})},[h.id]),r.useEffect(()=>{Ze(h.id,b=>{b.selectedHazelnuts=a?[a]:null})},[h.id,a]);const y=()=>{R(b=>b-360),E(Qe(n))};return e.jsx(Nt,{conversation:h,children:e.jsx(_t,{conversation:h,children:e.jsx(Qt,{clientThreadId:h.id,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex justify-center px-4 pt-3",children:e.jsxs("div",{className:"group flex items-center gap-3 text-lg font-semibold",children:[e.jsx("div",{className:"icon"}),e.jsxs("button",{onClick:y,className:"text-token-text-primary flex items-center gap-2",children:[e.jsx(f,{id:"2u/6Ja",defaultMessage:"Preview"}),e.jsx(Bt.div,{className:"text-token-text-primary",animate:{rotate:j},transition:{duration:.3},children:e.jsx(Yt,{className:"icon invisible group-hover:visible"})})]}),e.jsx(vs,{conversation:h})]})}),i&&e.jsx("div",{className:"px-4 pt-2",children:e.jsxs("div",{className:"flex items-center gap-2 rounded-md border border-yellow-200 bg-yellow-50 px-3 py-2 text-xs text-yellow-700 dark:border-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",children:[e.jsx(Dt,{className:"icon text-yellow-600 dark:text-yellow-300"}),e.jsx("span",{children:e.jsx(f,{id:"JGC47w",defaultMessage:"Save your skill before you can test with the latest change"})})]})}),e.jsx("div",{className:"flex grow flex-col overflow-y-auto px-2 pb-2 contain-paint",children:e.jsx(ns,{conversation:h})})]})})})})}function ws({handleCreateSkill:a,anyValidationError:i,isSaving:n}){"use no forget";return e.jsx("div",{className:"flex h-full items-center justify-center rounded-2xl px-6 text-center",children:e.jsxs("div",{className:"max-w-md space-y-3",children:[e.jsx("p",{className:"text-token-text-primary text-lg font-semibold",children:e.jsx(f,x({},Z.emptyRightPaneTitle))}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(f,x({},Z.emptyRightPaneDescription))}),e.jsx("div",{className:"pt-2",children:e.jsx(z,{onClick:a,disabled:i||n,color:"primary",className:"mx-auto",children:n?e.jsx(f,x({},Z.saveDraftLoading)):e.jsx(f,x({},Z.createDraft))})})]})})}const Z=ot({emptyRightPaneTitle:{id:"4Kf1a2",defaultMessage:"Create your first skill"},emptyRightPaneDescription:{id:"vOmRXB",defaultMessage:"Skills let you extend ChatGPT's capabilities with custom functionality. Create a skill to get started."},createDraft:{id:"HhtSew",defaultMessage:"Create skill"},saveDraftLoading:{id:"nVnCpP",defaultMessage:"Creating skill..."}});function Ms({onBack:a,onRetry:i,onClose:n}){return e.jsx(Rt,{testId:"modal-no-access",isOpen:!0,onClose:()=>n(),title:e.jsx(f,{id:"PZM705",defaultMessage:"Failed to load skill."}),footerClassName:"justify-center",footerContent:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(ze,{color:"secondary",onClick:i,children:e.jsx(f,{id:"FxBRY4",defaultMessage:"Retry"})}),e.jsx(ze,{color:"primary",onClick:a,children:e.jsx(f,{id:"pnbC84",defaultMessage:"Back"})})]}),showCloseButton:!0,children:e.jsx("p",{className:"text-token-text-secondary pb-2 text-sm",children:e.jsx(f,{id:"JkuEq5",defaultMessage:"Skill does not exist or you don't have access to the skill."})})})}const lt=500;function js({hazelnutId:a}){"use no forget";var Ue,Te,Ie,Ae,He,Oe,Ge,We,qe,Ke,Xe;const i=St(),n=Ut(),h=Et(),E=Ct(),[j,R]=r.useState(""),[y,b]=r.useState(""),[U,G]=r.useState(""),[w,C]=r.useState([]),[F,xe]=r.useState(!1),[ge,he]=r.useState(!1),[W,nt]=r.useState(null),ee=r.useRef(null),q=r.useRef(!1),K=r.useRef(!1),[ke,ve]=r.useState(!1),[te,be]=r.useState(null),[p,N]=r.useState(null),[dt,we]=r.useState(null),se=r.useRef(new Set),[ct,Me]=r.useState(!1),[ut,M]=r.useState(!1),[ae,mt]=r.useState(560),[X,je]=r.useState(!1),ye=r.useRef(null),$=r.useCallback((t,s)=>{const o=t.trim().toLowerCase(),l=s?"skill.md":o;se.current.has(l)||(se.current.add(l),O.logEventWithStatsig("chatgpt_web_skill_editor_file_edited","chatgpt_web_skill_editor_file_edited",{file_type:s?"skill_md":"other",file_path:t,hazelnut_id:a!=null?a:""}))},[a]),T=r.useCallback(t=>{var s;O.logStructuredEvent(et,{hazelnutId:a!=null?a:""}),N({draftFile:{clientId:"instructions-file",filename:"SKILL.md",path:"SKILL.md",size:(s=t==null?void 0:t.length)!=null?s:U.length,contentType:"text/markdown",content:t!=null?t:U,status:"inmemory"},onSave:o=>{G(o),M(!0),$("SKILL.md",!0)},placeholder:i.formatMessage(ce.instructionsPlaceholder)})},[U,a,i,$]),Se=r.useCallback(()=>{const t=new Set(w.map(l=>(l.path||l.filename).toLowerCase())),s="unknown.md";if(!t.has(s))return s;let o=1;for(;;){const l="unknown".concat(o,".md");if(!t.has(l))return l;o++}},[w]),ie=r.useCallback((t,s)=>{C(o=>{const l=o.find(c=>c.clientId===t);if(l){const c=P(l.path||l.filename);$(c,!1)}return o.map(c=>c.clientId===t?{clientId:c.clientId,filename:c.filename,size:new TextEncoder().encode(s).length,contentType:c.contentType,path:c.path,status:"inmemory",content:s}:c)}),M(!0)},[$]),ft=r.useCallback(()=>{const t=Se(),s=ue(),o=ds(t),l={clientId:s,filename:t,size:0,contentType:"text/markdown",path:o,status:"inmemory",content:""};C(c=>[x({},l),...c]),be({clientId:s,value:o,original:o}),N({draftFile:l,onSave:c=>{ie(s,c),M(!0)}}),we(s)},[Se,ie]),{skillData:m,isLoadingSkill:pt,didFailSkillLoad:Ee}=Zt({hazelnutId:a!=null?a:""}),I=pt,Ce=(Ie=((Ue=m==null?void 0:m.permissions)==null?void 0:Ue.can_export)||((Te=m==null?void 0:m.permissions)==null?void 0:Te.can_read))!=null?Ie:!0,S=(He=(Ae=m==null?void 0:m.permissions)==null?void 0:Ae.can_write)!=null?He:!0,xt=(Ge=(Oe=m==null?void 0:m.permissions)==null?void 0:Oe.can_share)!=null?Ge:!0;r.useEffect(()=>{if(Ee){const t=It();Tt(t,Ms,{onBack:()=>h(-1),onRetry:()=>window.location.reload()})}},[Ee,h]),r.useEffect(()=>{a&&(W==null?void 0:W.id)===a||(q.current=!1,K.current=!1,G(""),M(!1))},[a,W]),r.useEffect(()=>{se.current.clear()},[a]),r.useEffect(()=>{var t,s;if(m&&!q.current){if(R((t=m.name)!=null?t:""),b((s=m.description)!=null?s:""),m.files&&m.sediment_id){const o=Object.entries(m.files).filter(([l])=>l.trim().toLowerCase()!=="skill.md").sort(([l],[c])=>l.localeCompare(c)).map(([l,c])=>{var v;return{clientId:ue(),fileId:m.sediment_id,filename:me(l),size:(v=c==null?void 0:c.length)!=null?v:0,contentType:"application/octet-stream",path:l,status:"saved",range:c}});o.length>0&&C(l=>[...o,...l])}q.current=!0,M(!1)}},[m]);const Fe=r.useCallback((t,s)=>{const c=Math.max(320,s-420);return Math.min(c,Math.max(320,t))},[]),_=r.useCallback(t=>{const s=ye.current;if(!s)return;const o=s.getBoundingClientRect(),l=t-o.left;mt(Fe(l,o.width))},[Fe]),Le=r.useCallback(t=>{t.preventDefault(),je(!0),"touches"in t&&t.touches[0]?_(t.touches[0].clientX):"clientX"in t&&_(t.clientX)},[_]);r.useEffect(()=>{if(!X)return;const t=l=>_(l.clientX),s=l=>{l.touches[0]&&_(l.touches[0].clientX)},o=()=>je(!1);return window.addEventListener("mousemove",t),window.addEventListener("mouseup",o),window.addEventListener("touchmove",s),window.addEventListener("touchend",o),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",o),window.removeEventListener("touchmove",s),window.removeEventListener("touchend",o)}},[_,X]);const Pe=r.useCallback(t=>{const s=ee.current;s&&(t?(s.setAttribute("webkitdirectory",""),s.setAttribute("directory","")):(s.removeAttribute("webkitdirectory"),s.removeAttribute("directory")))},[]),gt=r.useMemo(()=>{var o;const t=w.reduce((l,c)=>{var u;const v=P(c.path).toLowerCase();return v&&l.set(v,((u=l.get(v))!=null?u:0)+1),l},new Map),s={};for(const l of w){const c=P(l.path).toLowerCase(),v=c&&(o=t.get(c))!=null?o:0;s[l.clientId]=cs(i,l.path,v)}return s},[w,i]),le=w.some(t=>t.status==="uploading"),oe=w.some(t=>t.status==="error"),re=Object.values(gt).some(Boolean),ht=r.useMemo(()=>[...w].sort((t,s)=>(t.path||t.filename).localeCompare(s.path||s.filename)),[w]),ne=ut,kt=async t=>{const s=t.target.files;if(!s||s.length===0)return;const o=Array.from(s);O.logEventWithStatsig("chatgpt_web_skill_editor_files_uploaded","chatgpt_web_skill_editor_files_uploaded",{file_count:o.length,hazelnut_id:a!=null?a:""}),await gs(o,C,i,n),t.target.value="",Pe(!1)},Ne=r.useCallback(async(t,s)=>{try{const o=await us(t,s);o&&G(l=>l||o),T(o)}catch(o){if(s!=null&&s.aborted)return;Q.addError(o)}},[G,T]);r.useEffect(()=>{if(!a){T();return}if(!m||K.current||!ms(m.files))return;const t=new AbortController;return K.current=!0,Ne(m,t.signal),()=>{t.abort()}},[a,m,Ne,T]);const vt=t=>{C(s=>s.filter(o=>o.clientId!==t)),M(!0),(p==null?void 0:p.draftFile.clientId)===t&&N(null),(te==null?void 0:te.clientId)===t&&be(null)},_e=r.useMemo(()=>!!(!j.trim()||!y.trim()||le||oe||re),[re,oe,le,j,y]),Be=r.useMemo(()=>j.trim()?null:i.formatMessage(d.validationMissingName),[j,i]),De=r.useMemo(()=>y.trim()?null:i.formatMessage(d.validationMissingDescription),[y,i]),Re=async()=>{var o,l,c,v;if(!j.trim()){n.danger(i.formatMessage(d.validationMissingName));return}if(!U.trim()){n.danger(i.formatMessage(d.validationMissingInstructions));return}if(le){n.danger(i.formatMessage(d.validationFileUploading));return}if(oe||re){n.danger(i.formatMessage(d.saveFailed));return}const t=w.filter(u=>u.status==="uploaded"||u.status==="saved").map(u=>{if(!("fileId"in u))throw new Error("Uploaded file missing fileId");return x({file_id:"".concat(u.fileId),path:P(u.path)},u.range?{range:u.range}:{})}),s=w.filter(u=>u.status==="inmemory"&&"content"in u).filter(u=>u.content.trim()!=="").map(u=>({path:P(u.path),content:u.content}));xe(!0);try{const g=(o=(await as({id:a!=null?a:null,name:j.trim(),description:y.trim(),instructions:U,files:t,file_contents:s},E)).hazelnuts)==null?void 0:o[0];if(nt(()=>g||null),M(!1),g&&g.files&&g.sediment_id){const B=new Map(w.map(k=>[P(k.path).toLowerCase(),k])),A=Object.entries(g.files).filter(([k])=>k.trim().toLowerCase()!=="skill.md").sort(([k],[L])=>k.localeCompare(L)).map(([k,L])=>{var J,$e;const V=P(k).toLowerCase(),D=B.get(V);return{clientId:(J=D==null?void 0:D.clientId)!=null?J:ue(),fileId:g.sediment_id,filename:me(k),size:($e=L==null?void 0:L.length)!=null?$e:0,contentType:"application/octet-stream",path:k,status:"saved",range:L}});C(A),N(k=>{var D;if(!k)return null;if(((D=k.draftFile.path)!=null?D:"").trim().toLowerCase()==="skill.md")return k;const V=A.find(J=>J.clientId===k.draftFile.clientId);return V?H(x({},k),{draftFile:V}):null})}g!=null&&g.id&&g.id!==a&&(h("/skills/editor/".concat(g.id),{replace:!0}),q.current=!0,K.current=!0),O.logStructuredEvent(a?Gt:et,{hazelnutId:(c=(l=g==null?void 0:g.id)!=null?l:a)!=null?c:""}),a||O.logEventWithStatsig("chatgpt_web_skill_creation_method_selected","chatgpt_web_skill_creation_method_selected",{method:"manual",hazelnut_id:(v=g==null?void 0:g.id)!=null?v:""}),n.success(i.formatMessage(d.saveSuccess))}catch(u){Q.addError(u);const g=Wt(u);n.danger(g!=null?g:i.formatMessage(d.saveFailed))}finally{xe(!1)}};return e.jsxs("div",{className:"flex h-screen min-h-0 flex-col",children:[e.jsxs("div",{className:"border-token-border-light flex flex-row items-center justify-between gap-2 border-b px-2 py-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(tt,{color:"ghost",icon:At,label:i.formatMessage(d.backButton),onClick:()=>{ne?Me(!0):h(-1)},children:e.jsx(f,x({},d.backButton))})}),e.jsx("div",{children:e.jsx("p",{className:"text-token-text-secondary text-sm font-medium",children:e.jsx(f,x({},d.title))})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a&&ne&&e.jsx("span",{className:"text-token-text-tertiary text-xs italic",children:e.jsx(f,x({},d.unsavedLabel))}),a&&e.jsx(tt,{onClick:()=>ve(!0),disabled:F||!xt,color:"secondary",icon:zt,children:e.jsx(f,x({},d.shareButton))}),e.jsx(z,{onClick:Re,disabled:_e||F||!S,color:"primary",children:F?e.jsx(f,x({},d.saveDraftLoading)):e.jsx(f,x({},a?d.saveDraft:d.createDraft))}),e.jsxs(fe,{triggerButton:e.jsx(z,{color:"secondary",disabled:F,"aria-label":i.formatMessage(d.moreMenuLabel),icon:Ot}),alignOffset:0,children:[e.jsx(Y.Item,{onClick:async()=>{if(a){he(!0);try{const s=(await es(a)).hazelnuts[0];s!=null&&s.id&&s.id!==a&&window.location.assign("/skills/editor/".concat(s.id)),n.success(i.formatMessage(d.cloneSuccess))}catch(t){Q.addError(t),n.danger(i.formatMessage(d.cloneFailed))}he(!1)}},icon:ge?e.jsx(Ht,{}):void 0,disabled:!a||F||!Ce||ge,children:e.jsx(f,x({},d.cloneButton))}),e.jsx(Y.Item,{onClick:async()=>{if(!a||!m)return;const t=m.base_sediment_id;try{const o=(await ts(a,t)).download_url;if(o)window.open(o,"_blank"),n.success(i.formatMessage(d.exportSuccess));else throw new Error("Missing download URL")}catch(s){Q.addError(s),n.danger(i.formatMessage(d.exportFailed))}},disabled:F||!Ce||!a||!m,children:e.jsx(f,x({},d.exportButton))})]})]})]}),e.jsxs("div",{ref:ye,className:"flex min-h-0 flex-1 flex-col overflow-y-auto lg:flex-row lg:overflow-hidden",style:{userSelect:X?"none":void 0},children:[e.jsx("div",{className:"h-full w-full",style:{flexBasis:ae},children:a?e.jsx(bs,{hazelnutId:a,hasUnsavedChanges:ne}):e.jsx(ws,{handleCreateSkill:Re,anyValidationError:_e,isSaving:F})}),e.jsx("div",{role:"separator","aria-orientation":"vertical","aria-valuenow":Math.round(ae),"aria-valuemin":320,"aria-valuemax":9999,className:"relative mx-1 hidden w-2 shrink-0 cursor-col-resize items-center justify-center lg:flex ".concat(X?"bg-token-border-strong/40":""),onMouseDown:Le,onTouchStart:Le,children:e.jsx("div",{className:"bg-token-border-strong h-12 w-px rounded-full"})}),e.jsx("div",{className:"flex min-h-screen min-w-0 flex-1 flex-col gap-4 py-4 pe-3 lg:min-h-0 lg:min-w-[420px] lg:ps-4",style:{flexBasis:"calc(100% - ".concat(ae,"px)")},children:e.jsx("div",{className:"border-token-border-light bg-token-bg-primary flex min-h-0 flex-1 flex-col rounded-2xl border shadow-xl xl:overflow-y-auto",children:e.jsxs("div",{className:"grid min-h-0 flex-1 grid-rows-[1fr_1fr] xl:grid-cols-[minmax(360px,1fr)_20rem] xl:grid-rows-1",children:[e.jsx("div",{className:"flex min-h-0 flex-col gap-4 overflow-hidden",children:e.jsx("div",{className:"bg-token-bg-primary flex min-h-0 flex-1 flex-col p-5",children:e.jsx("div",{className:"flex min-h-0 flex-1 overflow-scroll",children:(p==null?void 0:p.draftFile.status)==="inmemory"?e.jsx(fs,{clientId:p.draftFile.clientId,fileName:p.draftFile.filename,filePath:p.draftFile.path,defaultContent:p.draftFile.content,placeholder:p.placeholder,language:(qe=(We=at(p.draftFile))==null?void 0:We.language)!=null?qe:null,onSave:p.onSave}):a&&p&&e.jsx(ps,{hazelnutId:a,file:p.draftFile,onSave:p.onSave})})})}),e.jsx("div",{className:"xl:border-token-border-light bg-gray-solid-50 dark:bg-gray-solid-1000 flex min-h-0 flex-col gap-4 overflow-y-auto px-5 py-3 xl:border-s",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(st,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsx("label",{className:"text-token-text-secondary text-sm font-semibold",children:e.jsx(f,x({},d.nameLabel))})}),I?e.jsx(de,{lines:1,size:"lg",width:60}):e.jsx(os,{value:j,onChange:t=>{R(t.target.value),M(!0)},placeholder:i.formatMessage(d.nameLabel),disabled:!S}),!I&&Be&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:Be})]}),e.jsxs(st,{children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("label",{className:"text-token-text-secondary text-sm font-semibold",children:e.jsx(f,x({},d.descriptionLabel))}),e.jsx("span",{className:"text-token-text-tertiary text-xs",children:e.jsx(f,H(x({},d.descriptionCounter),{values:{count:y.length,limit:lt}}))})]}),I?e.jsx("div",{className:"py-1",children:e.jsx(de,{lines:2,size:"base",width:90,widthVariance:10})}):e.jsx(rs,{className:"h-auto",value:y,rows:5,placeholder:i.formatMessage(d.descriptionLabel),onChange:t=>{b(t.target.value),M(!0)},maxLength:lt,disabled:!S}),!I&&De&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:De})]}),e.jsxs("div",{className:"mt-12 mb-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-token-text-secondary text-sm font-semibold",children:e.jsx(f,x({},d.filesSectionTitle))}),e.jsxs("div",{children:[e.jsx("input",{type:"file",className:"hidden",ref:ee,multiple:!0,onChange:kt}),e.jsx("div",{children:S&&e.jsxs(fe,{triggerButton:e.jsx(z,{size:"small",disabled:!S,icon:ss,children:e.jsx(f,x({},d.uploadFilesOrFolderButton))}),alignOffset:0,children:[e.jsx(Y.Item,{className:"w-full",onClick:()=>{ft(),M(!0)},disabled:!S,children:e.jsx(f,x({},d.createFileButton))}),e.jsx(Y.Item,{fillContainer:!0,className:"w-full",onSelect:t=>{var s;t.preventDefault(),Pe(!1),(s=ee.current)==null||s.click()},children:e.jsx(f,x({},d.uploadFilesButton))})]})})]})]}),e.jsx("div",{className:"space-y-2",children:I?e.jsx(de,{lines:4,size:"base",width:80,widthVariance:20}):e.jsxs(e.Fragment,{children:[e.jsx(it,{path:"SKILL.md",displayName:i.formatMessage(d.skillMdLabel),isSelected:((Ke=p==null?void 0:p.draftFile.path)!=null?Ke:"").toLowerCase()==="skill.md",deleteEnabled:!1,canEdit:S,onSelected:()=>T(),editDisabledTooltip:void 0}),ht.map(t=>{const s=t.path||t.filename,l=!at(t),c=(p==null?void 0:p.draftFile.clientId)===t.clientId,v=l?i.formatMessage(ce.canvasUnsupportedFile):void 0;return e.jsx(it,{path:t.path,displayName:s,isSelected:c,isSelectable:!l,selectDisabledTooltip:i.formatMessage(ce.canvasUnsupportedFile),deleteEnabled:!0,canEdit:S&&t.status!=="uploading",onSelected:()=>N({draftFile:t,onSave:u=>{ie(t.clientId,u),M(!0)}}),onDelete:()=>vt(t.clientId),onPathChange:u=>{if(u.toLowerCase()==="skill.md"){n.danger(i.formatMessage(d.validationPathSkillMd));return}const g=H(x({},t),{path:u,filename:me(u)});C(B=>B.map(A=>A.clientId===t.clientId?g:A)),M(!0),t.clientId===(p==null?void 0:p.draftFile.clientId)&&N(B=>B?H(x({},B),{draftFile:g}):null)},isPathEditing:dt===t.clientId,onIsPathEditingChange:u=>{we(u?t.clientId:null)},editDisabledTooltip:v},t.clientId)})]})})]})})]})})})]}),ke&&a&&e.jsx(hs,{hazelnutId:a,creatorId:(Xe=m==null?void 0:m.creator_id)!=null?Xe:"",isOpen:ke,onClose:()=>ve(!1)}),ct&&e.jsx(xs,{onContinueEditing:()=>Me(!1),onDiscardChanges:()=>h(-1)})]})}const d=ot({title:{defaultMessage:"Skill editor",id:"skillEditor.title"},subtitle:{defaultMessage:"Experiment with name, description, instructions, and knowledge files before creating a skill.",id:"skillEditor.subtitle"},nameLabel:{defaultMessage:"Name",id:"skillEditor.nameLabel"},descriptionLabel:{defaultMessage:"Description",id:"skillEditor.descriptionLabel"},descriptionCounter:{defaultMessage:"{count}/{limit}",id:"skillEditor.descriptionCounter"},instructionsLabel:{defaultMessage:"Instructions",id:"skillEditor.instructionsLabel"},skillMdLabel:{defaultMessage:"SKILL.md",id:"skillEditor.skillMdLabel"},filesSectionTitle:{defaultMessage:"Files",id:"skillEditor.filesSectionTitle"},createFileButton:{defaultMessage:"Create new file",id:"skillEditor.createFileButton"},uploadFilesButton:{defaultMessage:"Upload files",id:"skillEditor.uploadFilesButton"},uploadFilesOrFolderButton:{defaultMessage:"Upload",id:"skillEditor.uploadFilesOrFolderButton"},uploadFolderButton:{defaultMessage:"Upload folder",id:"skillEditor.uploadFolderButton"},uploadInProgress:{defaultMessage:"Uploading…",id:"skillEditor.uploadInProgress"},uploadFailed:{defaultMessage:"Failed to upload file. Please try again.",id:"skillEditor.uploadFailed"},pathLabel:{defaultMessage:"Relative path",id:"skillEditor.pathLabel"},saveDraft:{defaultMessage:"Save",id:"skillEditor.saveDraft"},createDraft:{defaultMessage:"Create",id:"skillEditor.createDraft"},saveDraftLoading:{defaultMessage:"Saving…",id:"skillEditor.saveDraftLoading"},saveSuccess:{defaultMessage:"Skill saved",id:"skillEditor.saveSuccess"},saveFailed:{defaultMessage:"Unable to create the skill. Please try again.",id:"skillEditor.saveFailed"},validationMissingName:{defaultMessage:"Name is required.",id:"skillEditor.validationMissingName"},validationMissingInstructions:{defaultMessage:"Instructions are required.",id:"skillEditor.validationMissingInstructions"},validationMissingDescription:{defaultMessage:"Description is required.",id:"skillEditor.validationMissingDescription"},validationFileUploading:{defaultMessage:"Wait for uploads to finish before creating the skill.",id:"skillEditor.validationFileUploading"},validationPathEmpty:{defaultMessage:"File path cannot be empty.",id:"skillEditor.validationPathEmpty"},validationPathAbsolute:{defaultMessage:"Use a relative path (exclude leading slashes).",id:"skillEditor.validationPathAbsolute"},validationPathDot:{defaultMessage:"Remove '.' or '..' segments from the path.",id:"skillEditor.validationPathDot"},validationPathDuplicate:{defaultMessage:"Each file path must be unique.",id:"skillEditor.validationPathDuplicate"},validationPathSkillMd:{defaultMessage:"Attachments cannot overwrite SKILL.md.",id:"skillEditor.validationPathSkillMd"},pathPlaceholder:{defaultMessage:"docs/example.pdf",id:"skillEditor.pathPlaceholder"},failedSkillLoad:{defaultMessage:"Failed to load skill metadata.",id:"skillEditor.failedSkillLoad"},backButton:{defaultMessage:"Back",id:"skillEditor.backButton"},shareButton:{defaultMessage:"Share",id:"skillEditor.shareButton"},unsavedLabel:{defaultMessage:"Unsaved",id:"skillEditor.unsavedLabel"},moreMenuLabel:{defaultMessage:"More",id:"skillEditor.moreMenuLabel"},cloneButton:{defaultMessage:"Clone",id:"skillEditor.cloneButton"},cloneSuccess:{defaultMessage:"Skill cloned",id:"skillEditor.cloneSuccess"},cloneFailed:{defaultMessage:"Unable to clone the skill. Please try again.",id:"skillEditor.cloneFailed"},exportButton:{defaultMessage:"Export",id:"skillEditor.exportButton"},exportSuccess:{defaultMessage:"Export started",id:"skillEditor.exportSuccess"},exportFailed:{defaultMessage:"Unable to export the skill. Please try again.",id:"skillEditor.exportFailed"}}),aa=()=>(is(),null),ia=Ft(function(){const i=pe(),h=!!rt(i)&&ls(i);ks(h);const E=Lt();return h?e.jsx(qt,{children:e.jsx(js,{hazelnutId:E.hazelnutId})}):null});export{aa as clientLoader,ia as default};
//# sourceMappingURL=cnsg5nrhkjb65tfd.js.map
