var $=Object.freeze,X=Object.defineProperty,K=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var z=(n,a,l)=>a in n?X(n,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[a]=l,T=(n,a)=>{for(var l in a||(a={}))te.call(a,l)&&z(n,l,a[l]);if(V)for(var l of V(a))ne.call(a,l)&&z(n,l,a[l]);return n},B=(n,a)=>K(n,ee(a));var W=(n,a)=>$(X(n,"raw",{value:$(a||n.slice())}));import{r as v,j as t,M as ae}from"./fg33krlcm0qyi6yw.js";import{S as G,R as ie,B as se,T as re,a as O,C as oe,X as ce,b as le,Y as de,c as ue,d as H,M as U,e as Y,f as me,r as xe}from"./e5dt5h62tjqfeb7c.js";import{an as y}from"./k65njl5wlgspihfr.js";import{F as fe,c0 as he,l as ve}from"./mtk1qztvnb31pw5r.js";import{p as je}from"./oc29jc50rrvtu7z8.js";const q="default",Z=n=>n.toLocaleString();var Q;const J=fe.div(Q||(Q=W(["flex h-full grow items-center justify-center text-lg text-token-text-tertiary"]))),P=n=>"values"in n,be=n=>"blank"in n,ge=(n,a)=>{var x,S,f;if(be(n))return(x=n.blank)!=null?x:0;if(a)return(S=n.total)!=null?S:0;let l=0;for(const u of Object.values((f=n.values)!=null?f:{}))typeof u=="number"&&u>l&&(l=u);return l};function Ce({title:n,data:a,hideLegend:l=!1,seriesColorMap:x,forceStack:S=!1,stackOrder:f,legendOrder:u,filters:o,filterLabel:R,valueFormatter:M,labelFormatter:E,hideYAxis:A=!1,hideReferenceLine:I=!1}){"use no forget";const[j,k]=v.useState(()=>{var r;return(r=o==null?void 0:o[0])==null?void 0:r.id}),N=M!=null?M:Z,C=v.useCallback(r=>{k(r)},[]),{activeData:w,processedSeriesData:e}=v.useMemo(()=>{if(a==="loading")return{activeData:"loading",processedSeriesData:"loading"};if(!(o!=null&&o.length))return{activeData:a,processedSeriesData:a.data};const r=j!=null?j:o[0].id,h=o.find(m=>m.id===r);if(!h)return{activeData:a,processedSeriesData:a.data};const i=h.apply(a);return{activeData:i,processedSeriesData:i.data}},[o,j,a]),s=o!=null&&o.length?j!=null?j:o[0].id:"",c=v.useMemo(()=>S||!x?!0:Object.values(x).filter(r=>typeof r=="string").length<=1,[S,x]),d=v.useMemo(()=>e==="loading"?0:e.reduce((r,h)=>{var i;return Math.max(r,(i=ge(h,c))!=null?i:0)},0),[e,c]),b=v.useMemo(()=>{if(w==="loading"||e==="loading")return{};const r=u?new Map(u.map((i,m)=>[i,m])):void 0,h=Object.keys(w.metrics).map(i=>{var g,p;const m=e.reduce((L,F)=>{var _;return P(F)?L+((_=F.values[i])!=null?_:0):L},0);return{displayName:(p=(g=w.metrics[i])==null?void 0:g.displayName)!=null?p:i,total:m,groupKey:i}}).sort((i,m)=>{if(r){const g=r.get(i.groupKey),p=r.get(m.groupKey);if(g!==void 0&&p!==void 0)return g-p;if(g!==void 0)return-1;if(p!==void 0)return 1}return m.total-i.total});return Object.fromEntries(h.map(({total:i,groupKey:m,displayName:g},p)=>{var L;return[m,{displayName:g,total:i,color:(L=x==null?void 0:x[m])!=null?L:G[p%G.length]}]}))},[u,e,x,w]),D=v.useMemo(()=>{const r=Object.entries(b);return Object.fromEntries(r.flatMap(([h,i])=>[[h,i],["values.".concat(h),i]]))},[b]);return t.jsxs("div",{className:"border-token-border-default mb-4 flex min-h-[350px] flex-col rounded-lg border pt-4 pb-4",children:[t.jsx("div",{className:"px-6",children:t.jsxs("div",{className:"flex items-center justify-between gap-3",children:[t.jsx("div",{className:"text-token-text-secondary text-sm",children:n!=null?n:null}),o!=null&&o.length?t.jsx("div",{className:"flex shrink-0 items-center gap-2",children:t.jsxs(y.Root,{value:s,onValueChange:C,children:[t.jsxs(y.Trigger,{"aria-label":R,className:"border-token-border-default text-token-text-primary bg-token-bg-primary flex items-center gap-2 rounded-full border px-3 py-1.5 text-sm font-medium",children:[t.jsx(y.Value,{}),t.jsx(y.Icon,{})]}),t.jsx(y.Portal,{children:t.jsx(y.Content,{className:"min-w-[160px]",children:o.map(r=>t.jsx(y.Item,{value:r.id,children:r.label},r.id))})})]})}):null]})}),t.jsx(pe,{processedData:e,maxTotal:d,seriesMetadata:b,tooltipMetricToLabel:D,hideLegend:l,stackSeries:c,stackOrder:f,legendOrder:u,valueFormatter:N,labelFormatter:E,hideYAxis:A,hideReferenceLine:I})]})}function pe({processedData:n,maxTotal:a,seriesMetadata:l,tooltipMetricToLabel:x,hideLegend:S,stackSeries:f,stackOrder:u,legendOrder:o,valueFormatter:R,labelFormatter:M,hideYAxis:E=!1,hideReferenceLine:A=!1}){"use no forget";const[I,j]=v.useState(),k=v.useMemo(()=>{if(o)return new Map(o.map((e,s)=>[e,s]))},[o]),N=v.useMemo(()=>Object.entries(l).sort(([e],[s])=>{if(e==="other"&&s==="other")return 0;if(e==="other")return 1;if(s==="other")return-1;if(k){const c=k.get(e),d=k.get(s);if(c!==void 0&&d!==void 0)return c-d;if(c!==void 0)return-1;if(d!==void 0)return 1}return 0}),[k,l]),C=v.useMemo(()=>{const e=N.map(([d])=>d);if(!u||u.length===0)return e;const s=new Set(u),c=[];return u.forEach(d=>{e.includes(d)&&c.push(d)}),e.forEach(d=>{s.has(d)||c.push(d)}),c},[N,u]);if(n==="loading")return t.jsx(J,{children:t.jsx(he,{})});if(a===0)return t.jsx(J,{children:t.jsx(ae,{id:"codex.analytics.multiBarOverview.noData",defaultMessage:"No data for this period"})});const w=f?n.map(e=>{var s,c;if(P(e))for(let d=C.length-1;d>=0;d-=1){const b=C[d];if(((c=(s=e.values)==null?void 0:s[b])!=null?c:0)>0)return b}}):[];return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:ve(xe,"flex grow items-center"),children:t.jsx(ie,{width:"100%",height:220,children:t.jsxs(se,{data:n,margin:{left:E?20:-20,top:14,right:20},barGap:f?4:1,children:[t.jsx(re,{isAnimationActive:!1,content:({payload:e,active:s,label:c})=>t.jsx(oe,{active:s,label:c,payload:e&&[...e].reverse(),valueFormatter:R,labelFormatter:M,metricToLabel:x}),cursor:{opacity:.2,fill:O}}),t.jsx(ce,{dataKey:"date",axisLine:!1,tickLine:!1,tick:le,tickFormatter:e=>je(e).toLocaleDateString(void 0,{month:"short",day:"numeric"}),interval:n.length-2}),t.jsx(de,{axisLine:!1,tickLine:!1,hide:E,domain:[0,a],ticks:[0,a],fontSize:11,fill:O,tick:e=>t.jsx(ue,B(T({},e),{textAnchor:"start",y:e.payload.value===0?e.y:e.y-10,x:e.x-10,fontWeight:400,children:Z(e.payload.value)}))}),C.map(e=>{const s="values.".concat(e),c=I&&I!==e;return t.jsx(H,{dataKey:s,stackId:f?q:void 0,isAnimationActive:!1,children:n.map((d,b)=>{var i,m;const D=f&&w[b]===e,r=f?D?[4,4,0,0]:[0,0,0,0]:[4,4,0,0],h=c?U:(m=(i=l[e])==null?void 0:i.color)!=null?m:U;return t.jsx(Y,{radius:r,fill:h,opacity:c?.15:1},"cell-".concat(e,"-").concat(b))})},s)}),f?t.jsx(H,{dataKey:"blank",minPointSize:1,stackId:q,isAnimationActive:!1,children:n.map((e,s)=>t.jsx(Y,{opacity:.5,fill:"blank"in e&&e.blank===0?O:"transparent"},"cell-".concat(s)))}):null,!A&&t.jsx(me,{y:a,stroke:O,strokeDasharray:"3 3",shape:e=>t.jsx("line",B(T({},e),{x1:22}))})]})})}),!S&&t.jsx("div",{className:"text-token-text-primary flex w-full flex-wrap items-center justify-center text-sm",children:N.map(([e,{displayName:s,color:c}])=>t.jsxs("div",{className:"mx-4 mb-1 flex cursor-pointer items-center justify-center",title:s,onMouseOut:()=>j(void 0),onMouseOver:()=>j(e),children:[t.jsx("div",{className:"me-1 h-2 w-2 rounded-[1px]",style:{backgroundColor:c}}),t.jsx("span",{className:"me-1 whitespace-nowrap",children:s})]},e))})]})}export{Ce as M};
//# sourceMappingURL=ep0d6f4xq9bi1u8z.js.map
