var _e=Object.defineProperty,Ce=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var je=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ke=(m,e,t)=>e in m?_e(m,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[e]=t,re=(m,e)=>{for(var t in e||(e={}))Me.call(e,t)&&ke(m,t,e[t]);if(je)for(var t of je(e))Ee.call(e,t)&&ke(m,t,e[t]);return m},le=(m,e)=>Ce(m,Pe(e));import{j as l,c as Re,r as b}from"./fg33krlcm0qyi6yw.js";import{jR as ze,jS as We,jT as M}from"./k65njl5wlgspihfr.js";import{l as Y,aS as Ae}from"./mtk1qztvnb31pw5r.js";import{Slideshow as Le}from"./aca3smawwxanpb7s.js";import{u as Be,S as Fe}from"./jk107mwxn0lro4xz.js";import{s as Oe,a as qe}from"./mw40q7txi1y5m4dq.js";import{u as $e}from"./gi9hyxr9tw3nqr5l.js";import"./goc4414xjv43pin0.js";import"./f96c6fguu1kcw0go.js";import"./ej6tlexkw0sv7caa.js";import"./hwa6pbq6i57ntwuh.js";import"./fmwvxydiodjqi0t8.js";import"./nb22pb07i8ebbv0i.js";const De=({goPrev:m,goNext:e,setIsPlaying:t,thumbnails:g,selectedSlideIdx:u})=>{const E=g.length<=1||u===0,T=g.length<=1||u===g.length-1,p=g.length<=1;return l.jsxs("div",{className:Y("absolute start-1/2 bottom-2 flex -translate-x-1/2 items-center overflow-hidden rounded-2xl border","border-token-border-light bg-token-bg-primary text-token-text-primary","transition-opacity duration-150","can-hover:opacity-0 can-hover:pointer-events-none","can-hover:group-hover:opacity-100 can-hover:group-hover:pointer-events-auto"),children:[l.jsx("button",{onClick:m,disabled:E,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:l.jsx(ze,{className:"icon-sm"})}),l.jsx("div",{className:"border-token-border-light h-6 border-s"}),l.jsx("button",{onClick:()=>t(!0),disabled:p,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:l.jsx(We,{className:"size-5"})}),l.jsx("div",{className:"border-token-border-light h-6 border-s"}),l.jsx("button",{onClick:e,disabled:T,className:"hover:text-token-text-primary disabled:text-token-text-tertiary rounded px-4 py-2",children:l.jsx(Ae,{className:"icon-sm"})})]})},it=m=>{"use forget";var xe,be,pe,ge,ve,Se,we,ye;const e=Re.c(85),{walnutId:t,isLoading:g,isError:u,isPresentation:E,isInShareModal:T,errorMessage:p,showWorksheetTabs:ae,isResponsiveSheet:ce,responsiveSheetHeight:Z}=m,Ie=ae===void 0?!1:ae,r=ce===void 0?!1:ce,{presentationMap:R,setSelectedSlideIdx:v,setSelectedSheetIdx:H}=$e(),d=(xe=R[t])==null?void 0:xe.presentation,i=(be=R[t])==null?void 0:be.workbook,z=(ge=(pe=R[t])==null?void 0:pe.selectedSlideIdx)!=null?ge:0,Ne=(Se=(ve=R[t])==null?void 0:ve.selectedSheetIdx)!=null?Se:0,{accentStroke:W}=Be(),de=(we=i==null?void 0:i.sheets.length)!=null?we:0,_=de>0?Math.min(Math.max(Ne,0),de-1):0,C=i==null?void 0:i.sheets[_],Te=d?z:_,o=r?Z!=null?Z:400:void 0;let A;e[0]===Symbol.for("react.memo_cache_sentinel")?(A=[],e[0]=A):A=e[0];const[f,he]=b.useState(A),[S,me]=b.useState(!1),fe=b.useRef(null),ee=o!=null?o:0;let L;e[1]!==ee?(L={width:0,height:ee},e[1]=ee,e[2]=L):L=e[2];const[h,ue]=b.useState(L);let B,F;e[3]!==r||e[4]!==o?(B=()=>{if(!r||!o)return;const n=requestAnimationFrame(()=>{ue(s=>s.height===o?s:le(re({},s),{height:o}))});return()=>{cancelAnimationFrame(n)}},F=[r,o],e[3]=r,e[4]=o,e[5]=B,e[6]=F):(B=e[5],F=e[6]),b.useEffect(B,F);let O,q;e[7]!==p||e[8]!==u||e[9]!==r?(O=()=>{if(!r||u||p==="fileTooLarge")return;const n=fe.current;if(!n)return;const s=()=>{const c=n.getBoundingClientRect().width;ue(x=>x.width===c?x:le(re({},x),{width:c}))};if(s(),typeof ResizeObserver>"u")return;const a=new ResizeObserver(()=>s());return a.observe(n),()=>a.disconnect()},q=[r,u,p],e[7]=p,e[8]=u,e[9]=r,e[10]=O,e[11]=q):(O=e[10],q=e[11]),b.useEffect(O,q);let $,D;e[12]!==d?($=()=>{d&&(async()=>{const n=await Promise.all(d.slides.map(s=>Oe(s,d)));he(n)})()},D=[d],e[12]=d,e[13]=$,e[14]=D):($=e[13],D=e[14]),b.useEffect($,D);let G;e[15]!==r||e[16]!==h.height||e[17]!==h.width||e[18]!==o||e[19]!==i?(G=()=>{if(!i||r&&(!h.width||!(o!=null?o:h.height)))return;const n=r?Math.max(1,Math.round(h.width)):void 0,s=r?Math.max(1,Math.round(o!=null?o:h.height)):void 0;(async()=>{const a=await Promise.all(i.sheets.map(c=>qe(c,20,10,0,i,n,s)));he(a)})()},e[15]=r,e[16]=h.height,e[17]=h.width,e[18]=o,e[19]=i,e[20]=G):G=e[20];let J;if(e[21]!==r||e[22]!==h.height||e[23]!==h.width||e[24]!==o||e[25]!==t||e[26]!==i?(J=[i,r,h.width,h.height,o,t],e[21]=r,e[22]=h.height,e[23]=h.width,e[24]=o,e[25]=t,e[26]=i,e[27]=J):J=e[27],b.useEffect(G,J),u||p==="fileTooLarge")return null;let K;e[28]!==v||e[29]!==f.length||e[30]!==t?(K=()=>{v(t,n=>{const s=n>0?n-1:f.length-1;return M("walnut.slide_navigated",{slide_index:s.toString(),direction:"prev"}),s})},e[28]=v,e[29]=f.length,e[30]=t,e[31]=K):K=e[31];const te=K;let Q;e[32]!==v||e[33]!==f.length||e[34]!==t?(Q=()=>{v(t,n=>{const s=n<f.length-1?n+1:0;return M("walnut.slide_navigated",{slide_index:s.toString(),direction:"next"}),s})},e[32]=v,e[33]=f.length,e[34]=t,e[35]=Q):Q=e[35];const se=Q;let U;e[36]!==H||e[37]!==t||e[38]!==i?(U=n=>{var a;if(!i)return;H(t,n);const s=(a=i.sheets[n])==null?void 0:a.name;M("walnut.sheet_tab_clicked",{sheet_index:n.toString(),sheet_name:s!=null?s:""})},e[36]=H,e[37]=t,e[38]=i,e[39]=U):U=e[39];const ne=U,ie=(ye=f[Te])!=null?ye:f[0],oe=!!(Ie&&i&&C&&W);let P;if(g||!d&&!i||!f.length){const n=E&&"aspect-16/9";let s;e[40]!==n?(s=Y("bg-token-bg-tertiary shimmer-loading flex h-[250px] w-full items-center justify-center gap-2",n),e[40]=n,e[41]=s):s=e[41];let a;e[42]===Symbol.for("react.memo_cache_sentinel")?(a=l.jsx("div",{className:"border-token-border-heavy items center h-4 w-4 animate-spin rounded-full border-2 border-t-transparent"}),e[42]=a):a=e[42];let c;e[43]!==s?(c=l.jsx("div",{className:s,children:a}),e[43]=s,e[44]=c):c=e[44],P=c}else{const n=E&&"aspect-16/9 h-[250px]",s=r&&"h-full w-full",a=!i&&"max-h-[280px]";let c;e[45]!==n||e[46]!==s||e[47]!==a?(c=Y("m-0 bg-white object-contain",n,s,a),e[45]=n,e[46]=s,e[47]=a,e[48]=c):c=e[48];let x;e[49]!==ie||e[50]!==c?(x=l.jsx("img",{src:ie,alt:"",className:c}),e[49]=ie,e[50]=c,e[51]=x):x=e[51],P=x}let w;e[52]!==se||e[53]!==te||e[54]!==S||e[55]!==d||e[56]!==z||e[57]!==f?(w=d&&l.jsx(De,{goPrev:te,goNext:se,setIsPlaying:n=>{n&&!S&&M("walnut.slideshow_entered",{}),me(n)},thumbnails:f,selectedSlideIdx:z}),e[52]=se,e[53]=te,e[54]=S,e[55]=d,e[56]=z,e[57]=f,e[58]=w):w=e[58];let V;e[59]===Symbol.for("react.memo_cache_sentinel")?(V=Y("flex w-full items-center justify-center"),e[59]=V):V=e[59];let y;e[60]!==r||e[61]!==o?(y=r&&o?{height:o}:void 0,e[60]=r,e[61]=o,e[62]=y):y=e[62];let j;e[63]!==P||e[64]!==y?(j=l.jsx("div",{ref:fe,className:V,style:y,children:P}),e[63]=P,e[64]=y,e[65]=j):j=e[65];let k;e[66]!==W||e[67]!==ne||e[68]!==_||e[69]!==C||e[70]!==oe||e[71]!==i?(k=oe&&i&&C&&l.jsx("div",{className:"w-full",children:l.jsx(Fe,{workbook:i,activeSheetIdx:_,onSheetClick:ne,accentStroke:W,selectionRect:null,sheet:C})}),e[66]=W,e[67]=ne,e[68]=_,e[69]=C,e[70]=oe,e[71]=i,e[72]=k):k=e[72];let I;e[73]!==S||e[74]!==d||e[75]!==t?(I=d&&S&&l.jsx(Le,{startIndex:0,onExit:()=>{M("walnut.slideshow_exited",{}),me(!1)},walnutId:t}),e[73]=S,e[74]=d,e[75]=t,e[76]=I):I=e[76];let N;e[77]!==T?(N=T&&l.jsx("div",{className:"from-token-bg-primary pointer-events-none absolute start-0 end-0 bottom-0 z-10 h-40 bg-gradient-to-t to-transparent","data-testid":"walnut-mini-player-share-gradient"}),e[77]=T,e[78]=N):N=e[78];let X;return e[79]!==w||e[80]!==j||e[81]!==k||e[82]!==I||e[83]!==N?(X=l.jsxs("div",{className:"relative flex flex-col items-center",children:[w,j,k,I,N]}),e[79]=w,e[80]=j,e[81]=k,e[82]=I,e[83]=N,e[84]=X):X=e[84],X};export{it as WalnutMiniPlayer};
//# sourceMappingURL=hrc7mmie8bo9xvvu.js.map
