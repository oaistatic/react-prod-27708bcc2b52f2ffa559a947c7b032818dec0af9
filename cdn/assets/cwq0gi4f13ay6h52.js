import{j as e,e as v,M as l,c as N}from"./fg33krlcm0qyi6yw.js";import{b as y,d as p,I,ck as C,C as k,cU as h,g2 as u,gJ as R,rq as U,a9 as w}from"./mtk1qztvnb31pw5r.js";import{N as A,dN as F,dO as S,dP as _,dQ as E,dR as P}from"./k65njl5wlgspihfr.js";function z({room:t,onClose:s}){"use no forget";var b;const r=y(),c=A(r),d=p(()=>t.creatorAccountUserId$()),n=p(()=>t.members$()),i=(b=I(r))==null?void 0:b.normalizedAccountUserId,m=p(()=>!t||!i?null:t.members$().some(a=>a.accountUserId===i)),x=(t==null?void 0:t.projectId)!=null&&!m,o=v(),M=C(r);return e.jsx(k,{testId:"modal-calpico-chat-members",isOpen:!0,onClose:()=>s(),type:"success",headerClassName:"pb-1",title:e.jsx(l,{id:"tEvWSQ",defaultMessage:"People"}),showCloseButton:!0,children:e.jsxs("div",{className:"flex max-h-[min(40vh,492px)] flex-col",children:[e.jsx("div",{className:"border-token-border-heavy min-h-0 flex-1 overflow-y-auto border-t",children:e.jsx("div",{className:"divide-token-border-light divide-y",children:(n!=null?n:[]).map(a=>{const f=a.accountUserId===i,j=a.accountUserId===d;return e.jsxs("div",{className:"group/hover flex w-full items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[f?e.jsx("button",{type:"button","aria-label":o.formatMessage({id:"OQ5GtO",defaultMessage:"Edit your profile"}),onClick:()=>{s(),h(r,F,{accountUserId:a.accountUserId})},className:"rounded-full bg-transparent p-0",children:e.jsx("img",{src:a.avatarUrl,alt:a.name,className:"bg-token-border-default gizmo-shadow-stroke box-content h-8 w-8 rounded-full object-cover p-[0.5px]"})}):e.jsx("img",{src:a.avatarUrl,alt:a.name,className:"bg-token-border-default gizmo-shadow-stroke box-content h-8 w-8 rounded-full object-cover p-[0.5px]"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{children:a.name}),e.jsx(O,{username:a.username,isRoomCreator:j,isSelf:f})]})]}),f?null:e.jsxs(u.Root,{children:[e.jsx(u.Trigger,{className:"group/trigger","aria-label":o.formatMessage({id:"U93nHF",defaultMessage:"Actions for {name}"},{name:a.name}),children:e.jsx(R,{className:"icon-sm hidden group-hover/hover:block group-data-[state=open]/trigger:block"})}),e.jsx(u.Portal,{children:e.jsxs(u.Content,{size:"small",children:[e.jsx(u.Item,{color:"danger",icon:e.jsx(_,{className:"icon-sm"}),label:e.jsx(l,{id:"D/xte+",defaultMessage:"Report"}),onClick:()=>{s(),h(r,S,{entityId:a.accountUserId,entityType:U.Profile,title:o.formatMessage({id:"PUcghs",defaultMessage:"Report profile"})})}}),j?null:e.jsx(u.Item,{color:"danger",icon:e.jsx(E,{className:"icon-sm"}),label:e.jsx(l,{id:"rT5Wj+",defaultMessage:"Remove from group"}),onClick:async()=>{if(window.confirm(o.formatMessage({id:"MtV6M+",defaultMessage:"Remove {memberName} from {roomName}? {memberName} will no longer see the chat history."},{memberName:a.name,roomName:t.name$()})))try{await c.removeMemberFromRoom$(t.id,a.accountUserId)}catch(g){M.danger(o.formatMessage({id:"cGNRGI",defaultMessage:"Failed to remove member: {error}"},{error:g instanceof Error?g.message:String(g)}),{toastId:"calpico_room_failed_to_remove_member"});return}}})]})})]})]},a.accountUserId)})})}),x?null:e.jsxs("div",{className:"border-token-border-light flex flex-shrink-0 items-center justify-between border-t pt-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"flex flex-col items-start",children:e.jsx(l,{id:"IveYPe",defaultMessage:"Add people"})})}),e.jsx(w,{type:"button",onClick:()=>{s(),h(r,P,{room:t})},color:"ghost",className:"border-token-border-heavy rounded-full border px-4 py-2 text-sm font-medium",children:e.jsx(l,{id:"XYZ1+I",defaultMessage:"Add"})})]})]})})}function O(t){"use forget";const s=N.c(6),{username:r,isRoomCreator:c,isSelf:d}=t;let n;s[0]===Symbol.for("react.memo_cache_sentinel")?(n=e.jsx(l,{id:"AZaJQ0",defaultMessage:"You"}),s[0]=n):n=s[0];const i=n;let m;s[1]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsx(l,{id:"ePmMIc",defaultMessage:"admin"}),s[1]=m):m=s[1];const x=m;let o;return s[2]!==c||s[3]!==d||s[4]!==r?(o=e.jsx("span",{className:"text-token-text-tertiary text-sm",children:d&&c?e.jsxs(e.Fragment,{children:[i," 路 @",r," 路 ",x]}):d?e.jsxs(e.Fragment,{children:[i," 路 @",r]}):c?e.jsxs(e.Fragment,{children:["@",r," 路 ",x]}):e.jsxs(e.Fragment,{children:["@",r]})}),s[2]=c,s[3]=d,s[4]=r,s[5]=o):o=s[5],o}const L=({room:t,onClose:s})=>{"use no forget";return e.jsx(z,{room:t,onClose:s})};export{L as CalpicoChatMembersModalContainer};
//# sourceMappingURL=cwq0gi4f13ay6h52.js.map
