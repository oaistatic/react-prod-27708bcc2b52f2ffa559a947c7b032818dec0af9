const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdv21chic8hs0mt3.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/haneze5lyzwaewf8.js","assets/k65njl5wlgspihfr.js","assets/conversation-small-332fs9rk.css","assets/ose6175gtasqnfv0.js","assets/o51gjyxad96i2yey.js","assets/cv3wsu6uenrjij6h.js"])))=>i.map(i=>d[i]);
var Ct=Object.freeze,Nt=Object.defineProperty,Ss=Object.defineProperties;var Cs=Object.getOwnPropertyDescriptors;var Ze=Object.getOwnPropertySymbols;var Tt=Object.prototype.hasOwnProperty,kt=Object.prototype.propertyIsEnumerable;var wt=(r,e,t)=>e in r?Nt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ce=(r,e)=>{for(var t in e||(e={}))Tt.call(e,t)&&wt(r,t,e[t]);if(Ze)for(var t of Ze(e))kt.call(e,t)&&wt(r,t,e[t]);return r},Ue=(r,e)=>Ss(r,Cs(e));var Mt=(r,e)=>{var t={};for(var s in r)Tt.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&Ze)for(var s of Ze(r))e.indexOf(s)<0&&kt.call(r,s)&&(t[s]=r[s]);return t};var ot=(r,e)=>Ct(Nt(r,"raw",{value:Ct(e||r.slice())}));import{_ as Zt,c as L,e as $e,b as es,j as n,r as D,M as ve,f as ws,a9 as It}from"./fg33krlcm0qyi6yw.js";import{bh as ts,b as Y,cU as re,hd as Ns,dQ as ut,d as H,lp as ss,e2 as ft,e4 as Ts,l as _e,a9 as ns,o as ls,rC as ks,tJ as Ms,sF as Is,P as Rs,hv as As,ee as Rt,rq as os,I as Qe,T as $s,gK as Es,g2 as Oe,i6 as Ds,bv as Ls,xq as at,sP as At,hg as as,p7 as Ps,rv as Fs,aX as Us,da as Os,gd as Bs,ac as is,fe as zs,c0 as Hs,oM as Gs,hP as qs}from"./mtk1qztvnb31pw5r.js";import{u as tt,a as rs,C as cs,i as Ws,g as Vs,b as Ks,c as Ys,d as Qs,e as Js}from"./f7wnq403lct52o9c.js";import{N as Pe,yz as ds,rm as ms,aP as Xs,rw as Zs,fu as en,yA as us,eq as gt,hl as tn,eE as sn,dV as $t,hd as nn,dW as Et,cL as fs,dO as ps,dP as gs,gX as hs,yB as Dt,ao as ln,yC as on,yD as an,ib as rn,kS as cn,ab as dn,ac as mn,yE as Lt,aw as un,dR as xs,cx as fn,yF as pn,yG as gn,dQ as hn,yH as xn,yI as yn,nF as Pt,cr as bn,yJ as jn,cI as vn,rl as _n,hQ as Sn,yK as Cn,un as wn,af as Nn,ag as Ft,yL as Tn,rh as kn}from"./k65njl5wlgspihfr.js";import{LightboxNew as Mn}from"./pdv21chic8hs0mt3.js";import{a as In}from"./i5jw6wfkpao2rx5t.js";import{C as Rn}from"./kgrrqncjl71482vi.js";import{markdownToClipboardContent as An}from"./l9but48wvxtwnlrx.js";import{T as $n}from"./esz2kgkc587ofop0.js";import{B as Ut}from"./lk20vhnihsv557ob.js";import En from"./dg0rfsh5mqkm9hm4.js";import{M as Dn}from"./j559fgwy6wrk3b1f.js";import{S as Ln}from"./c2cj1dlcffke3f7m.js";import{P as Pn}from"./btb1r2uxm2m1lsr5.js";import{D as Fn}from"./mbql81gwv5du9dtu.js";import{u as Un}from"./k43gn7pl526u53kc.js";import{r as On}from"./kgjs6438c34s9yzr.js";import{M as ys}from"./he7oe7s4xa3cph5y.js";import{ProductFlyout as Bn}from"./f0s4ve9f1pnkq8dh.js";import{a as zn}from"./nxe574t4em7jpfaw.js";import{S as Hn}from"./iupestt9odrsfzg9.js";const pt=ts(()=>Zt(()=>import("./pdv21chic8hs0mt3.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(r=>r.LightboxNew.Root));function ht(r){"use forget";var k,M,A,T,$,O,P;const e=L.c(33),{calpicoFileId:t,attachment:s,roomId:o,messageId:i}=r,l=Y();let m;e[0]!==l?(m=Pe(l),e[0]=l,e[1]=m):m=e[1];const a=m,u=$e(),f=t!=null?t:"";let c;e[2]!==f?(c=ds(f),e[2]=f,e[3]=c):c=e[3];const x=a.hasAccess&&t!=null;let _;e[4]!==c||e[5]!==x?(_=Ue(Ce({},c),{enabled:x}),e[4]=c,e[5]=x,e[6]=_):_=e[6];const{data:h}=es(_),b=tt();let v,d,p,y,g;if(e[7]!==s||e[8]!==t||e[9]!==h){if(d=void 0,g=0,p=0,y=(k=t!=null?t:s==null?void 0:s.post_id)!=null?k:"image",h!=null&&h.download_url){const{image_metadata:U}=h;U&&(g=(M=U.width)!=null?M:0,p=(A=U.height)!=null?A:0),d=h.download_url}else s!=null&&s.thumbnail_url&&(g=($=(T=s.thumbnail_metadata)==null?void 0:T.width)!=null?$:0,p=(P=(O=s.thumbnail_metadata)==null?void 0:O.height)!=null?P:0,d=s.thumbnail_url);e[7]=s,e[8]=t,e[9]=h,e[10]=d,e[11]=p,e[12]=y,e[13]=g}else d=e[10],p=e[11],y=e[12],g=e[13];if(v=g&&p?g/p:null,d==null)return null;let j;e[14]!==u?(j=u.formatMessage({id:"rLelSU",defaultMessage:"Image attachment"}),e[14]=u,e[15]=j):j=e[15];const S=j;let w;e[16]!==b||e[17]!==l||e[18]!==d||e[19]!==p||e[20]!==S||e[21]!==y||e[22]!==i||e[23]!==o||e[24]!==g?(w=()=>{const U=[{id:y,archived:!1,transformationId:null,url:d,assetPointer:null,thumbnail:null,width:g,height:p,title:S}];pt.prefetch(),re(l,pt,{images:U,initialIndex:0,children:o&&i?n.jsx(Mn.Footer,{children:n.jsx(rs,{controller:b,children:n.jsx(Gn,{roomId:o,messageId:i})})}):null})},e[16]=b,e[17]=l,e[18]=d,e[19]=p,e[20]=S,e[21]=y,e[22]=i,e[23]=o,e[24]=g,e[25]=w):w=e[25];const C=w;let N;e[26]!==v?(N=v?{aspectRatio:v}:{},e[26]=v,e[27]=N):N=e[27];let I;return e[28]!==d||e[29]!==C||e[30]!==S||e[31]!==N?(I=n.jsx("img",{src:d,className:"max-h-64 min-w-0 flex-1 cursor-pointer rounded-lg object-fill",style:N,alt:S,onClick:C}),e[28]=d,e[29]=C,e[30]=S,e[31]=N,e[32]=I):I=e[32],I}function Gn(r){"use forget";const e=L.c(10),{roomId:t,messageId:s}=r,o=Y(),i=tt(),l=$e();let m;e[0]!==o?(m=()=>(Ns(o,pt),!1),e[0]=o,e[1]=m):m=e[1];const a=m;let u,f;e[2]!==l||e[3]!==s||e[4]!==i?(u=()=>(i.setReplyToImage(s,l),()=>{i.clearReplyTo()}),f=[i,s,l],e[2]=l,e[3]=s,e[4]=i,e[5]=u,e[6]=f):(u=e[5],f=e[6]),D.useEffect(u,f);let c;return e[7]!==a||e[8]!==t?(c=n.jsx("div",{className:"px-0",children:n.jsx(cs,{roomId:t,scrollToBottom:a})}),e[7]=a,e[8]=t,e[9]=c):c=e[9],c}function qn(r){"use forget";var a;const e=L.c(14),{attachment:t}=r;let s;e[0]!==t.thumbnail_url||e[1]!==t.title?(s=t.thumbnail_url&&n.jsx("img",{className:"object-cover",src:t.thumbnail_url,alt:(a=t.title)!=null?a:void 0}),e[0]=t.thumbnail_url,e[1]=t.title,e[2]=s):s=e[2];let o;e[3]!==t.title?(o=n.jsx("div",{className:"font-medium",children:t.title}),e[3]=t.title,e[4]=o):o=e[4];let i;e[5]!==t.description?(i=n.jsx("div",{className:"text-sm",children:t.description}),e[5]=t.description,e[6]=i):i=e[6];let l;e[7]!==o||e[8]!==i?(l=n.jsxs("div",{className:"p-2",children:[o,i]}),e[7]=o,e[8]=i,e[9]=l):l=e[9];let m;return e[10]!==t.url||e[11]!==s||e[12]!==l?(m=n.jsxs("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-default block max-w-sm overflow-hidden rounded-2xl border",children:[s,l]}),e[10]=t.url,e[11]=s,e[12]=l,e[13]=m):m=e[13],m}function st(r){"use forget";const e=L.c(2),{label:t}=r;let s;return e[0]!==t?(s=n.jsx("div",{className:"text-token-text-secondary mb-1 text-xs",children:t}),e[0]=t,e[1]=s):s=e[1],s}const xt=r=>{var e,t;return(t=(e=r.loading_message)!=null?e:r.loadingMessage)!=null?t:null};function nt(r){"use forget";const e=L.c(16),{previewContent:t,attachment:s,onOpen:o,disableLink:i}=r,l=i===void 0?!1:i,m=l?"button":"a";let a;e[0]!==s.url||e[1]!==l||e[2]!==o?(a=l?{type:"button",onClick:v=>{o==null||o(s.url),v.preventDefault(),v.stopPropagation()}}:{href:s.url,target:"_blank",rel:"noopener noreferrer",onClick:v=>{(o==null?void 0:o(s.url))&&(v.preventDefault(),v.stopPropagation())}},e[0]=s.url,e[1]=l,e[2]=o,e[3]=a):a=e[3];const u=a;let f;e[4]!==s.title?(f=n.jsx("div",{className:"font-medium",children:s.title}),e[4]=s.title,e[5]=f):f=e[5];const c=t!=null?t:"";let x;e[6]!==c?(x=n.jsx("div",{className:"text-sm",children:n.jsx(gt,{size:"small",children:c})}),e[6]=c,e[7]=x):x=e[7];let _;e[8]!==f||e[9]!==x?(_=n.jsxs("div",{className:"space-y-1",children:[f,x]}),e[8]=f,e[9]=x,e[10]=_):_=e[10];let h;e[11]===Symbol.for("react.memo_cache_sentinel")?(h=n.jsx("div",{className:"pointer-events-none absolute start-0 end-0 bottom-0 z-10 h-12 bg-gradient-to-b from-transparent from-20% to-[var(--bg-primary)] to-100%"}),e[11]=h):h=e[11];let b;return e[12]!==m||e[13]!==_||e[14]!==u?(b=n.jsxs(m,Ue(Ce({},u),{className:"border-token-border-light relative block max-h-64 max-w-sm overflow-hidden rounded-2xl border p-4 text-start",children:[_,h]})),e[12]=m,e[13]=_,e[14]=u,e[15]=b):b=e[15],b}function Wn(r){"use forget";const e=L.c(17),{attachment:t,roomId:s}=r;let o;e[0]!==t?(o=xt(t),e[0]=t,e[1]=o):o=e[1];const i=o,l=t.messages.length===0&&i!=null?i:void 0;let m;e[2]!==t||e[3]!==l?(m=n.jsx(nt,{attachment:t,previewContent:l}),e[2]=t,e[3]=l,e[4]=m):m=e[4];let a=m;if(t.messages.length>0){const c=t.messages[t.messages.length-1];e:switch(c.content.content_type){case"text":{let x;e[5]!==t||e[6]!==c?(x=n.jsx(yt,{message:c,attachment:t}),e[5]=t,e[6]=c,e[7]=x):x=e[7],a=x;break e}case"multimodal_text":{let x;e[8]!==t||e[9]!==c||e[10]!==s?(x=n.jsx(bs,{message:c,attachment:t,roomId:s,messageId:c.id}),e[8]=t,e[9]=c,e[10]=s,e[11]=x):x=e[11],a=x;break e}}}let u;e[12]!==t.label?(u=t.label&&n.jsx(st,{label:t.label}),e[12]=t.label,e[13]=u):u=e[13];let f;return e[14]!==a||e[15]!==u?(f=n.jsxs("div",{children:[u,a]}),e[14]=a,e[15]=u,e[16]=f):f=e[16],f}function Vn(r){"use forget";var v,d,p,y;const e=L.c(44),{attachment:t,roomId:s,messageId:o}=r,i=Y(),l=(v=t.title)!=null?v:"Note";let m;e[0]!==t||e[1]!==i||e[2]!==o||e[3]!==s?(m=()=>{var g;return re(i,us,{attachmentId:t.post_id,attachmentKind:"post",postAttachment:t,title:(g=t.title)!=null?g:"Note",roomId:s,replyToMessageId:o}),!0},e[0]=t,e[1]=i,e[2]=o,e[3]=s,e[4]=m):m=e[4];const a=m;let u;e[5]!==t?(u=xt(t),e[5]=t,e[6]=u):u=e[6];const f=u,c=(d=t.post_type)!=null?d:null,x=(p=t.summary)!=null?p:null;let _;if(c==="note"){const g=(y=x!=null?x:f)!=null?y:"",j=x==null&&f!=null;let S;e[7]!==l?(S=n.jsx("div",{className:"font-medium",children:l}),e[7]=l,e[8]=S):S=e[8];let w;e[9]!==j||e[10]!==g?(w=j?n.jsx("span",{className:"result-streaming streaming-dot loading-shimmer relative pt-1",children:n.jsx(gt,{size:"small",className:"prose-p:my-0 prose-ul:my-0 prose-ol:my-0",children:g})}):g,e[9]=j,e[10]=g,e[11]=w):w=e[11];let C;e[12]!==w?(C=n.jsx("div",{className:"text-token-text-secondary line-clamp-3 text-sm leading-5 whitespace-pre-wrap",children:w}),e[12]=w,e[13]=C):C=e[13];let N;e[14]!==S||e[15]!==C?(N=n.jsxs("div",{className:"space-y-1",children:[S,C]}),e[14]=S,e[15]=C,e[16]=N):N=e[16];let I;e[17]!==a||e[18]!==N?(I=n.jsx("button",{type:"button",onClick:a,className:"border-token-border-light bg-token-bg-primary hover:border-token-border-strong relative block w-full max-w-sm overflow-hidden rounded-2xl border p-4 text-start shadow-sm transition",children:N}),e[17]=a,e[18]=N,e[19]=I):I=e[19],_=I}else{const g=t.messages.length===0&&f!=null?f:void 0;let j;e[20]!==a?(j=()=>a(),e[20]=a,e[21]=j):j=e[21];let S;if(e[22]!==t||e[23]!==g||e[24]!==j?(S=n.jsx(nt,{attachment:t,previewContent:g,onOpen:j,disableLink:!0}),e[22]=t,e[23]=g,e[24]=j,e[25]=S):S=e[25],_=S,t.messages.length>0){const w=t.messages[t.messages.length-1];e:switch(w.content.content_type){case"text":{let C;e[26]!==a?(C=()=>a(),e[26]=a,e[27]=C):C=e[27];let N;e[28]!==t||e[29]!==w||e[30]!==C?(N=n.jsx(yt,{message:w,attachment:t,onOpen:C,disableLink:!0}),e[28]=t,e[29]=w,e[30]=C,e[31]=N):N=e[31],_=N;break e}case"multimodal_text":{let C;e[32]!==a?(C=()=>a(),e[32]=a,e[33]=C):C=e[33];let N;e[34]!==t||e[35]!==w||e[36]!==s||e[37]!==C?(N=n.jsx(bs,{message:w,attachment:t,roomId:s,messageId:w.id,onOpen:C,disableLink:!0}),e[34]=t,e[35]=w,e[36]=s,e[37]=C,e[38]=N):N=e[38],_=N;break e}}}}let h;e[39]!==t.label?(h=t.label&&n.jsx(st,{label:t.label}),e[39]=t.label,e[40]=h):h=e[40];let b;return e[41]!==_||e[42]!==h?(b=n.jsxs("div",{children:[h,_]}),e[41]=_,e[42]=h,e[43]=b):b=e[43],b}function Kn(r){"use forget";var Se,ce,de,Fe,xe,me,ue,fe,Ne;const e=L.c(88),{attachment:t,roomId:s,messageId:o}=r,i=Y(),l=(Se=t.title)!=null?Se:"Report";let m;e[0]!==t||e[1]!==i||e[2]!==o||e[3]!==s?(m=()=>{var B;return re(i,us,{attachmentId:t.post_id,attachmentKind:"post",postAttachment:t,title:(B=t.title)!=null?B:"Report",roomId:s,replyToMessageId:o}),!0},e[0]=t,e[1]=i,e[2]=o,e[3]=s,e[4]=m):m=e[4];const a=m,u=((ce=t.messages)==null?void 0:ce.length)>0,f=u?t.messages[t.messages.length-1]:null;let c;e[5]!==t?(c=xt(t),e[5]=t,e[6]=c):c=e[6];const x=c;let _;e[7]!==t.preview||e[8]!==f||e[9]!==x?(_=f!=null?ut(f,{shouldGetTextFromContentReferences:!0,shouldGetVisibleText:!0}):(de=x!=null?x:t.preview)!=null?de:"",e[7]=t.preview,e[8]=f,e[9]=x,e[10]=_):_=e[10];const h=_;let b;e[11]!==i?(b=Pe(i),e[11]=i,e[12]=b):b=e[12];const v=b;let d;e[13]!==v||e[14]!==o?(d=()=>v.liveMessageIds$().has(o),e[13]=v,e[14]=o,e[15]=d):d=e[15];const p=H(d),y=D.useRef(null);let g;e[16]!==o?(g=(...B)=>{console.log("[CalpicoReportAttachment]",o,...B)},e[16]=o,e[17]=g):g=e[17];const j=g,[S,w]=D.useState(p),C=D.useRef(!1),[N,I]=D.useState(!p);let k;e[18]!==i?(k=ss(i),e[18]=i,e[19]=k):k=e[19];const M=k;let A,T;e[20]!==j||e[21]!==N||e[22]!==p||e[23]!==S?(A=()=>{var B,W;j("state-change",{messageArrivedLive:p,shouldAnimate:S,expanded:N,contentHeight:(W=(B=y.current)==null?void 0:B.scrollHeight)!=null?W:null})},T=[j,N,p,S],e[20]=j,e[21]=N,e[22]=p,e[23]=S,e[24]=A,e[25]=T):(A=e[24],T=e[25]),D.useEffect(A,T);let $,O;e[26]!==j||e[27]!==p?($=()=>{p&&(j("mark-live-message",{messageArrivedLive:p}),w(!0),I(!1),C.current=!1)},O=[j,p],e[26]=j,e[27]=p,e[28]=$,e[29]=O):($=e[28],O=e[29]),D.useEffect($,O);let P,U;e[30]!==j||e[31]!==S?(P=()=>{if(!S){j("skip-animation"),I(!0);return}if(C.current){j("already-animated");return}C.current=!0;const B=window.requestAnimationFrame(()=>{var W,X;j("start-animation-frame",{contentHeight:(X=(W=y.current)==null?void 0:W.scrollHeight)!=null?X:null}),I(!0)});return()=>{j("cancel-animation-frame"),window.cancelAnimationFrame(B)}},U=[j,S],e[30]=j,e[31]=S,e[32]=P,e[33]=U):(P=e[32],U=e[33]),D.useEffect(P,U);let Z;e:{const B=Yn;if(f){let Ie;e[34]!==f?(Ie="parts"in f.content?f.content:{content_type:"text",parts:[ut(f,{shouldGetTextFromContentReferences:!0,shouldGetVisibleText:!0})]},e[34]=f,e[35]=Ie):Ie=e[35];const Ee=Ie;let ye;e[36]!==f.status?(ye=B(f.status),e[36]=f.status,e[37]=ye):ye=e[37];let be;e[38]!==f.metadata?(be=(Fe=f.metadata)!=null?Fe:{},e[38]=f.metadata,e[39]=be):be=e[39];const De=(xe=f.recipient)!=null?xe:"all",Le=(me=f.channel)!=null?me:"commentary";let Re;e[40]!==Ee||e[41]!==f||e[42]!==ye||e[43]!==be||e[44]!==De||e[45]!==Le?(Re=Ue(Ce({},f),{content:Ee,status:ye,metadata:be,recipient:De,channel:Le}),e[40]=Ee,e[41]=f,e[42]=ye,e[43]=be,e[44]=De,e[45]=Le,e[46]=Re):Re=e[46],Z=Re;break e}const W="".concat(o,"-report-preview");let X;e[47]===Symbol.for("react.memo_cache_sentinel")?(X={role:ft.Assistant,name:"assistant"},e[47]=X):X=e[47];const ie=h!=null?h:"";let Te;e[48]!==ie?(Te={content_type:Ts.Text,parts:[ie]},e[48]=ie,e[49]=Te):Te=e[49];let ke;e[50]===Symbol.for("react.memo_cache_sentinel")?(ke={},e[50]=ke):ke=e[50];let Me;e[51]!==W||e[52]!==Te?(Me={id:W,author:X,content:Te,status:"finished_successfully",metadata:ke,recipient:"all",channel:"commentary",end_turn:!0},e[51]=W,e[52]=Te,e[53]=Me):Me=e[53],Z=Me}const F=Z;let q;e[54]!==F.content||e[55]!==h?(q="parts"in F.content?F.content.parts:[h!=null?h:""],e[54]=F.content,e[55]=h,e[56]=q):q=e[56];const V=q,G=!u;let Q;e[57]!==t.label?(Q=t.label&&n.jsx(st,{label:t.label}),e[57]=t.label,e[58]=Q):Q=e[58];let te;e[59]===Symbol.for("react.memo_cache_sentinel")?(te={width:"100%",maxWidth:"100%"},e[59]=te):te=e[59];let J;e[60]!==l?(J=n.jsx("div",{className:"text-token-text-primary text-lg leading-tight font-semibold tracking-tight",children:l}),e[60]=l,e[61]=J):J=e[61];const ne=G?"text-token-text-secondary w-full overflow-hidden":"text-token-text-secondary w-full overflow-hidden text-sm leading-6",pe=S?N?"12rem":0:void 0,le=N?1:0,oe=S?"height 0.8s cubic-bezier(0.33, 1, 0.68, 1), opacity 0.4s ease":void 0,K=S?"height, opacity":void 0;let z;e[62]!==pe||e[63]!==le||e[64]!==oe||e[65]!==K?(z={width:"100%",minWidth:"100%",display:"block",height:pe,maxHeight:"12rem",opacity:le,transition:oe,willChange:K},e[62]=pe,e[63]=le,e[64]=oe,e[65]=K,e[66]=z):z=e[66];let ee;e[67]!==M||e[68]!==G||e[69]!==p||e[70]!==F||e[71]!==V||e[72]!==h?(ee=G?n.jsx(Xs,{text:h}):n.jsx(In,{conversation:M,parts:V,messages:[F],hasActiveRequest:F.status==="in_progress"&&p,isCompletionInProgress:F.status==="in_progress",className:"text-sm",citations:(ue=F.metadata)==null?void 0:ue.citations,contentReferences:(fe=F.metadata)==null?void 0:fe.content_references,attachments:(Ne=F.metadata)==null?void 0:Ne.attachments,isUserTurn:F.author.role===ft.User,isFinalUserTurn:!1,turnIndex:0,id:F.id,isFeedbackEnabled:!1,isWithinFirstAssistantTurns:!1,size:"small",superWidgetContent:null}),e[67]=M,e[68]=G,e[69]=p,e[70]=F,e[71]=V,e[72]=h,e[73]=ee):ee=e[73];let se;e[74]!==ne||e[75]!==z||e[76]!==ee?(se=n.jsx("div",{className:ne,ref:y,style:z,children:ee}),e[74]=ne,e[75]=z,e[76]=ee,e[77]=se):se=e[77];let we;e[78]!==J||e[79]!==se?(we=n.jsxs("div",{className:"flex flex-col gap-3",children:[J,se]}),e[78]=J,e[79]=se,e[80]=we):we=e[80];let ge;e[81]===Symbol.for("react.memo_cache_sentinel")?(ge=n.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-16 bg-gradient-to-b from-transparent from-30% to-[var(--bg-primary)]"}),e[81]=ge):ge=e[81];let ae;e[82]!==a||e[83]!==we?(ae=n.jsxs("button",{type:"button",onClick:a,className:"border-token-border-light bg-token-bg-primary hover:border-token-border-strong relative block w-full min-w-0 flex-1 overflow-hidden rounded-3xl border p-5 text-start shadow-sm transition",style:te,children:[we,ge]}),e[82]=a,e[83]=we,e[84]=ae):ae=e[84];let he;return e[85]!==Q||e[86]!==ae?(he=n.jsxs("div",{className:"w-full flex-1",children:[Q,ae]}),e[85]=Q,e[86]=ae,e[87]=he):he=e[87],he}function Yn(r){if(!r)return;const e=r.toLowerCase();return e.includes("in_progress")?"in_progress":e.includes("partial")?"finished_partial_completion":e.includes("success")?"finished_successfully":r}function Qn(r){"use forget";var m;const e=L.c(8),{attachment:t}=r;let s;e[0]!==t.label?(s=t.label&&n.jsx(st,{label:t.label}),e[0]=t.label,e[1]=s):s=e[1];const o=(m=t.preview)!=null?m:void 0;let i;e[2]!==t||e[3]!==o?(i=n.jsx(nt,{previewContent:o,attachment:t}),e[2]=t,e[3]=o,e[4]=i):i=e[4];let l;return e[5]!==s||e[6]!==i?(l=n.jsxs("div",{children:[s,i]}),e[5]=s,e[6]=i,e[7]=l):l=e[7],l}function yt(r){"use forget";const e=L.c(7),{message:t,attachment:s,onOpen:o,disableLink:i}=r;let l;e[0]!==t?(l=ut(t,{shouldGetTextFromContentReferences:!0,shouldGetVisibleText:!0}),e[0]=t,e[1]=l):l=e[1];const m=l;let a;return e[2]!==s||e[3]!==i||e[4]!==o||e[5]!==m?(a=n.jsx(nt,{previewContent:m,attachment:s,onOpen:o,disableLink:i}),e[2]=s,e[3]=i,e[4]=o,e[5]=m,e[6]=a):a=e[6],a}function bs(r){"use forget";const e=L.c(9),{message:t,attachment:s,roomId:o,messageId:i,onOpen:l,disableLink:m}=r;if(t.content.content_type==="multimodal_text"&&t.content.parts.some(Jn)&&(s.thumbnail_url||s.thumbnail_metadata)){let f;return e[0]!==s||e[1]!==i||e[2]!==o?(f=n.jsx(ht,{attachment:s,roomId:o,messageId:i},s.post_id),e[0]=s,e[1]=i,e[2]=o,e[3]=f):f=e[3],f}let u;return e[4]!==s||e[5]!==m||e[6]!==t||e[7]!==l?(u=n.jsx(yt,{message:t,attachment:s,onOpen:l,disableLink:m}),e[4]=s,e[5]=m,e[6]=t,e[7]=l,e[8]=u):u=e[8],u}function Jn(r){return typeof r=="object"&&r!=null&&"content_type"in r&&r.content_type==="image_asset_pointer"}function Xn(r){"use forget";var a,u;const e=L.c(6),{attachment:t}=r,s=t.video_metadata?"".concat(t.video_metadata.width," / ").concat(t.video_metadata.height):void 0,o=(a=t.video_url)!=null?a:void 0,i=(u=t.thumbnail_url)!=null?u:void 0;let l;e[0]!==s?(l=s?{aspectRatio:s}:void 0,e[0]=s,e[1]=l):l=e[1];let m;return e[2]!==o||e[3]!==i||e[4]!==l?(m=n.jsx("video",{src:o,poster:i,controls:!0,autoPlay:!0,muted:!0,playsInline:!0,className:"max-h-64 w-full rounded-lg object-contain",style:l}),e[2]=o,e[3]=i,e[4]=l,e[5]=m):m=e[5],m}function et(r){"use forget";const e=L.c(13),{message:t,roomId:s}=r,o=Y();let i;e[0]!==o?(i=ms(o),e[0]=o,e[1]=i):i=e[1];const l=i,m=t.role==="assistant"?t.attachments:t.content.attachments;if(m==null||m.length===0)return null;let a;if(e[2]!==m||e[3]!==l||e[4]!==t.id||e[5]!==s){let f;e[7]!==l||e[8]!==t.id||e[9]!==s?(f=(c,x)=>{var _,h,b,v,d,p,y,g;switch(c.type){case"file":return l?n.jsx("div",{className:"w-full max-w-sm",children:n.jsx(Zn,{attachment:c,roomId:s,messageId:t.id})},(h=c.file_id)!=null?h:x):n.jsx("div",{className:"w-full",children:n.jsx(ht,{calpicoFileId:c.file_id,roomId:s,messageId:t.id})},(_=c.file_id)!=null?_:x);case"link":return n.jsx("div",{className:"mb-2 max-w-sm",children:n.jsx(qn,{attachment:c})},(b=c.url)!=null?b:x);case"post":{const j=c,S=(v=j.post_type)!=null?v:null;return n.jsx("div",{className:"mb-2 w-full min-w-0 flex-1".concat(S==="report"?"mt-3":""),children:S==="report"?n.jsx(Kn,{attachment:j,roomId:s,messageId:t.id}):S==="note"||((d=j.messages)==null?void 0:d.length)>0?n.jsx(Vn,{attachment:j,roomId:s,messageId:t.id}):n.jsx(Wn,{attachment:j,roomId:s,messageId:t.id})},(p=j.post_id)!=null?p:x)}case"conversation":return n.jsx("div",{className:"mb-2",children:n.jsx(Qn,{attachment:c,roomId:s,messageId:t.id})},(y=c.conversation_id)!=null?y:x);case"media":return n.jsx("div",{className:"mb-2",children:n.jsx(Xn,{attachment:c})},(g=c.post_id)!=null?g:x);case"sticker":return null;case"sticker_pack":return null}return null},e[7]=l,e[8]=t.id,e[9]=s,e[10]=f):f=e[10],a=m.map(f),e[2]=m,e[3]=l,e[4]=t.id,e[5]=s,e[6]=a}else a=e[6];let u;return e[11]!==a?(u=n.jsx("div",{className:"mb-2 flex max-w-full items-end gap-2",children:a}),e[11]=a,e[12]=u):u=e[12],u}function Zn(r){"use forget";var A,T,$,O;const e=L.c(36),{attachment:t,roomId:s,messageId:o}=r,i=Y();let l;e[0]!==i?(l=Pe(i),e[0]=i,e[1]=l):l=e[1];const m=l,a=$e();let u;e[2]!==t.file_id?(u=ds(t.file_id),e[2]=t.file_id,e[3]=u):u=e[3];const f=m.hasAccess&&t.file==null;let c;e[4]!==u||e[5]!==f?(c=Ue(Ce({},u),{enabled:f}),e[4]=u,e[5]=f,e[6]=c):c=e[6];const{data:x,status:_}=es(c),h=(A=t.file)!=null?A:x;if(h==null&&_==="pending"){let P;e[7]!==a?(P=a.formatMessage({id:"k1r+7h",defaultMessage:"Loading…"}),e[7]=a,e[8]=P):P=e[8];let U;return e[9]!==P?(U=n.jsx("div",{className:"border-token-border-light bg-token-bg-tertiary text-token-text-secondary flex max-w-sm items-center gap-2 rounded-lg border px-3 py-2 text-sm",children:P}),e[9]=P,e[10]=U):U=e[10],U}if(!h)return null;if(Ws((T=h.mime_type)!=null?T:void 0)){let P;return e[11]!==t.file_id||e[12]!==o||e[13]!==s?(P=n.jsx(ht,{calpicoFileId:t.file_id,roomId:s,messageId:o}),e[11]=t.file_id,e[12]=o,e[13]=s,e[14]=P):P=e[14],P}const v=($=h.download_url)!=null?$:void 0;let d;e[15]!==h.name||e[16]!==a?(d=(O=h.name)!=null?O:a.formatMessage({id:"yBlMBy",defaultMessage:"Document"}),e[15]=h.name,e[16]=a,e[17]=d):d=e[17];const p=d;let y;e[18]!==h.mime_type||e[19]!==a?(y=Vs(h.mime_type,a),e[18]=h.mime_type,e[19]=a,e[20]=y):y=e[20];const g=y;let j;e[21]!==v?(j=()=>{v&&window.open(v,"_blank","noopener,noreferrer")},e[21]=v,e[22]=j):j=e[22];const S=!v;let w;e[23]===Symbol.for("react.memo_cache_sentinel")?(w=n.jsx(Zs,{className:"icon-md shrink-0"}),e[23]=w):w=e[23];let C;e[24]!==p?(C=n.jsx("div",{className:"text-token-text-primary line-clamp-2 font-medium",children:p}),e[24]=p,e[25]=C):C=e[25];let N;e[26]!==g?(N=n.jsx("div",{className:"text-token-text-secondary truncate text-xs",children:g}),e[26]=g,e[27]=N):N=e[27];let I;e[28]!==C||e[29]!==N?(I=n.jsxs("div",{className:"min-w-0 flex-1",children:[C,N]}),e[28]=C,e[29]=N,e[30]=I):I=e[30];let k;e[31]===Symbol.for("react.memo_cache_sentinel")?(k=n.jsx(en,{className:"icon-sm shrink-0"}),e[31]=k):k=e[31];let M;return e[32]!==I||e[33]!==j||e[34]!==S?(M=n.jsxs("button",{type:"button",onClick:j,className:"border-token-border-light bg-token-bg-tertiary flex w-full max-w-sm items-center gap-3 rounded-lg border px-3 py-3 text-start transition disabled:cursor-not-allowed disabled:opacity-60",disabled:S,children:[w,I,k]}),e[32]=I,e[33]=j,e[34]=S,e[35]=M):M=e[35],M}const el=300,tl=600,Ot=60;function sl(r){"use forget";const e=L.c(26),{children:t,contentHeight:s,messageId:o,stopMainScroll:i,mainScrollRef:l}=r,m=Y();let a;e[0]!==m?(a=()=>tn(m),e[0]=m,e[1]=a):a=e[1];const{height:u}=H(a),f=(u-52-104-44-80)*.8,c=Math.min(tl,Math.max(el,f)),[x,_]=D.useState(!1),h="collapsible-chatgpt-message-".concat(o),b=s>c+Ot,v=b?"mb-2":"";let d;e[2]!==v?(d=_e("relative",v),e[2]=v,e[3]=d):d=e[3];const p=b&&!x?"overflow-y-hidden":"overflow-visible";let y;e[4]!==p?(y=_e(p),e[4]=p,e[5]=y):y=e[5];const g=b?x?s+Ot:c:"auto";let j;e[6]!==g?(j={maxHeight:g},e[6]=g,e[7]=j):j=e[7];const S=b?!x:!1;let w;e[8]!==h||e[9]!==t||e[10]!==y||e[11]!==j||e[12]!==S?(w=n.jsx("div",{className:y,style:j,id:h,"aria-hidden":S,children:t}),e[8]=h,e[9]=t,e[10]=y,e[11]=j,e[12]=S,e[13]=w):w=e[13];let C;e[14]!==h||e[15]!==c||e[16]!==s||e[17]!==x||e[18]!==l||e[19]!==b||e[20]!==i?(C=b?n.jsxs(n.Fragment,{children:[x?null:n.jsx("div",{className:_e("pointer-events-none absolute start-0 end-0 h-[66px]","from-token-bg-primary bg-gradient-to-t to-transparent","bottom-9")}),n.jsx("div",{children:n.jsx(ns,{color:"ghost",onClick:()=>{if(_(!x),i(),x){const I=l.current;if(I==null)return;const k=s-c;I.scrollTop=I.scrollTop-k}else return},className:"-mx-3","aria-expanded":x,"aria-controls":h,children:x?n.jsx(ve,{id:"g//l+q",defaultMessage:"Show less"}):n.jsx(ve,{id:"VgASqq",defaultMessage:"Show more"})})})]}):null,e[14]=h,e[15]=c,e[16]=s,e[17]=x,e[18]=l,e[19]=b,e[20]=i,e[21]=C):C=e[21];let N;return e[22]!==C||e[23]!==d||e[24]!==w?(N=n.jsxs("div",{className:d,children:[w,C]}),e[22]=C,e[23]=d,e[24]=w,e[25]=N):N=e[25],N}function nl(r){"use forget";var b,v,d;const e=L.c(17),{message:t}=r;if(t.content.content_type!=="text")return null;const s=String(t.content.parts[0]||""),o=(b=t.metadata)==null?void 0:b.content_references;let i;e[0]!==s||e[1]!==o?(i=Is(s,o),e[0]=s,e[1]=o,e[2]=i):i=e[2];const{processedText:l,displayedContentReferences:m}=i;let a;e[3]!==((v=t.metadata)==null?void 0:v.content_references)?(a=(p,y)=>{var g,j,S;Rs.logEvent("ChatGPT Table Copy Clicked"),As(An((g=p.markdownSource)!=null?g:"",(S=(j=t.metadata)==null?void 0:j.content_references)!=null?S:[]),void 0,y)},e[3]=(d=t.metadata)==null?void 0:d.content_references,e[4]=a):a=e[4];const u=a;let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f={turnIndex:0},e[5]=f):f=e[5];let c;e[6]!==m||e[7]!==t?(c={message:t,contentReferences:m,isActivelyStreaming:!1,onShowSearchResults:ll,useSafeUrls:!0,analyticsMetadata:f},e[6]=m,e[7]=t,e[8]=c):c=e[8];let x;e[9]!==u?(x={table:p=>{const j=p,{node:y}=j,g=Mt(j,["node"]);return n.jsx("div",{className:"w-full max-w-full overflow-x-auto",style:{scrollbarWidth:"none"},children:n.jsx($n,Ue(Ce({},g),{unstyledContainer:!0,onClickCopy:S=>u(y,S)}))})}},e[9]=u,e[10]=x):x=e[10];let _;e[11]!==l||e[12]!==x?(_=n.jsx(gt,{className:"[&>p:last-child]:mb-0!",componentOverrides:x,children:l}),e[11]=l,e[12]=x,e[13]=_):_=e[13];let h;return e[14]!==c||e[15]!==_?(h=n.jsx(nn.Provider,{value:c,children:_}),e[14]=c,e[15]=_,e[16]=h):h=e[16],h}function ll(){}const Bt=new Set(["python","python_user_visible","python_caas","python_caas_user_visible","python_caas_cot"]);function ol(r){var s;const e=(s=r.author)!=null&&s.name&&Bt.has(r.author.name)?Ue(Ce({},r.author),{name:"python"}):r.author,t=r.recipient&&Bt.has(r.recipient)?"python":r.recipient;return e===r.author&&t===r.recipient?r:Ue(Ce({},r),{author:e,recipient:t})}function al(r,e){var i;const t=ks.createRootNode("calpico-root-".concat(r)),s={[t.id]:{id:t.id,parent:t.parentId,children:[],message:t.message}};let o=t.id;for(const l of e)s[l.id]={id:l.id,parent:o,children:[],message:l},(i=s[o])==null||i.children.push(l.id),o=l.id;return{conversation_id:r,mapping:s,current_node:o,moderation_results:[],title:null}}function js(r){"use forget";const e=L.c(46),{message:t,roomId:s}=r,o=Y();let i;e[0]!==o?(i=()=>ss(o),e[0]=o,e[1]=i):i=e[1];const[l]=D.useState(i),m=t.rawMessages;let a;e[2]!==m?(a=m.map(ol),e[2]=m,e[3]=a):a=e[3];const u=a,[f,c]=D.useState(ml),x=u.every(k=>f.has(k.id));let _;e[4]!==l.id||e[5]!==u?(_=al(l.id,u),e[4]=l.id,e[5]=u,e[6]=_):_=e[6];const h=_;let b,v;e[7]!==l.id||e[8]!==u||e[9]!==h?(b=()=>{Rt.updateThreadFromServer(l.id,h,{skipIfExisting:!1}),c(new Set(u.map(dl)))},v=[u,l.id,h],e[7]=l.id,e[8]=u,e[9]=h,e[10]=b,e[11]=v):(b=e[10],v=e[11]),D.useEffect(b,v);let d,p;e[12]!==l.id?(d=()=>()=>{Rt.deleteThread(l.id)},p=[l.id],e[12]=l.id,e[13]=d,e[14]=p):(d=e[13],p=e[14]),D.useEffect(d,p);let y;e[15]!==u?(y=u.reduce(cl,[]),e[15]=u,e[16]=y):y=e[16];const g=y;if(!x||g.length===0){const k=l.id;let M;e[17]!==u?(M=u.map(rl),e[17]=u,e[18]=M):M=e[18];let A;e[19]!==t||e[20]!==s?(A=t.attachments&&n.jsx(et,{roomId:s,message:t}),e[19]=t,e[20]=s,e[21]=A):A=e[21];let T;e[22]!==l.id?(T=n.jsx($t,{clientThreadId:l.id}),e[22]=l.id,e[23]=T):T=e[23];let $;return e[24]!==l.id||e[25]!==M||e[26]!==A||e[27]!==T?($=n.jsxs(Et,{clientThreadId:k,children:[M,A,T]}),e[24]=l.id,e[25]=M,e[26]=A,e[27]=T,e[28]=$):$=e[28],$}const j=g.length-1,S=l.id;let w;if(e[29]!==l||e[30]!==g||e[31]!==j){let k;e[33]!==l||e[34]!==j?(k=(M,A)=>{const T=A===j,$=M.role===ft.Assistant&&T;return n.jsx(Rn,{groupedMessagesToRender:M.messageGroups,allMessages:M.messages,allGroupedMessages:M.messageGroups,conversation:l,isUserTurn:!1,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,isFinalTurn:T,isFinalUserTurn:!1,isFinalAssistantTurn:$,hasActiveRequest:!1,onRequestCompletion:il,turnIndex:A},M.id)},e[33]=l,e[34]=j,e[35]=k):k=e[35],w=g.map(k),e[29]=l,e[30]=g,e[31]=j,e[32]=w}else w=e[32];let C;e[36]!==t||e[37]!==s?(C=t.attachments&&n.jsx(et,{roomId:s,message:t}),e[36]=t,e[37]=s,e[38]=C):C=e[38];let N;e[39]!==l.id?(N=n.jsx($t,{clientThreadId:l.id}),e[39]=l.id,e[40]=N):N=e[40];let I;return e[41]!==l.id||e[42]!==w||e[43]!==C||e[44]!==N?(I=n.jsxs(Et,{clientThreadId:S,children:[w,C,N]}),e[41]=l.id,e[42]=w,e[43]=C,e[44]=N,e[45]=I):I=e[45],I}function il(){}function rl(r){return n.jsx("div",{className:"mb-3 last:mb-0",children:n.jsx(nl,{message:r})},r.id)}function cl(r,e){return Ms(r,e)}function dl(r){return r.id}function ml(){return new Set}function ul(r){"use forget";const e=L.c(8),{message:t,roomId:s,stopMainScroll:o,mainScrollRef:i}=r,l=Y();if(ls(l,"3552088870")){let a;return e[0]!==i||e[1]!==t||e[2]!==s||e[3]!==o?(a=n.jsx(fl,{message:t,roomId:s,stopMainScroll:o,mainScrollRef:i}),e[0]=i,e[1]=t,e[2]=s,e[3]=o,e[4]=a):a=e[4],a}let m;return e[5]!==t||e[6]!==s?(m=n.jsx(js,{message:t,roomId:s}),e[5]=t,e[6]=s,e[7]=m):m=e[7],m}function fl(r){"use forget";const e=L.c(10),{message:t,roomId:s,stopMainScroll:o,mainScrollRef:i}=r,[l,m]=D.useState(0);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=sn({axis:"height",onChange:x=>{const{height:_}=x;m(h=>_)}}),e[0]=a):a=e[0];const u=a;let f;e[1]!==t||e[2]!==s?(f=n.jsx("div",{ref:u,children:n.jsx(js,{message:t,roomId:s})}),e[1]=t,e[2]=s,e[3]=f):f=e[3];let c;return e[4]!==l||e[5]!==i||e[6]!==t.id||e[7]!==o||e[8]!==f?(c=n.jsx(sl,{contentHeight:l,messageId:t.id,stopMainScroll:o,mainScrollRef:i,children:f}),e[4]=l,e[5]=i,e[6]=t.id,e[7]=o,e[8]=f,e[9]=c):c=e[9],c}function zt({actions:r,className:e}){return n.jsx("div",{className:_e("flex min-h-6 items-center gap-1",e),children:r.map((t,s)=>t.popoverContent?n.jsxs(rn,{children:[n.jsx(cn,{asChild:!0,children:n.jsx("button",{type:"button",onClick:t.onClick,title:t.title,className:"radix-state-open:bg-token-bg-tertiary hover:bg-token-bg-tertiary radix-state-open:text-token-icon-primary hover:text-token-icon-primary text-token-icon-secondary flex h-6 w-6 items-center justify-center rounded-full transition",children:t.icon})}),n.jsx(dn,{children:n.jsx(mn,{side:"top",sideOffset:8,align:"center",className:"bg-token-bg-primary rounded-full p-1.5 shadow-[0_4px_64px_0_rgba(0,0,0,0.2)]",children:t.popoverContent})})]},s):n.jsx("button",{type:"button",onClick:t.onClick,title:t.title,className:"radix-state-open:bg-token-bg-tertiary hover:bg-token-bg-tertiary radix-state-open:text-token-icon-primary hover:text-token-icon-primary text-token-icon-secondary flex h-6 w-6 items-center justify-center rounded-full transition",children:t.icon},s))})}function it(r){"use forget";const e=L.c(6),{roomId:t,message:s,className:o,enabledActions:i}=r,l=Y(),m=Pe(l),a=tt(),u=s.id,f=$e();if(s.role==="user"&&(s.deliveryState==="pending"||s.deliveryState==="failed")){let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=[],e[0]=h):h=e[0];let b;return e[1]!==o?(b=n.jsx(zt,{className:o,actions:h}),e[1]=o,e[2]=b):b=e[2],b}const x=i.map(h=>{var b;switch(h){case"addReaction":{const v=(b=Qe(l))==null?void 0:b.normalizedAccountUserId,d=v?s.reactions[v]:null,p=d?Ut.includes(d):!1;return{icon:n.jsx(En,{className:"icon-sm"}),popoverContent:n.jsxs(n.Fragment,{children:[Ut.map(y=>n.jsx(Dt,{asChild:!0,children:n.jsx("button",{className:_e("inline-flex h-10 w-10 items-center justify-center rounded-full text-2xl",d===y&&"bg-token-bg-secondary"),onClick:async()=>{d===y?await m.removeMessageReaction$(t,u):await m.addMessageReaction$(t,u,{reaction:y})},children:y})},y)),n.jsx(Dt,{asChild:!0,children:d==null||p?n.jsx("button",{className:"inline-flex h-10 w-10 items-center justify-center text-2xl",onClick:()=>{re(l,on,{onSelect:async g=>{await m.addMessageReaction$(t,u,{reaction:g})}})},children:n.jsx("div",{className:"bg-token-bg-secondary flex h-7 w-7 items-center justify-center rounded-full",children:n.jsx(ln,{className:"icon-sm text-token-icon-primary"})})},"more_emojis"):n.jsx("button",{className:_e("bg-token-bg-secondary inline-flex h-10 w-10 items-center justify-center rounded-full text-2xl"),onClick:async()=>{await m.removeMessageReaction$(t,u)},children:d},d)})]}),title:f.formatMessage({id:"o7T6ns",defaultMessage:"Add reaction"})}}case"reply":return{icon:n.jsx(hs,{className:"icon-sm"}),title:f.formatMessage({id:"67Ys9k",defaultMessage:"Reply"}),onClick:()=>{a.setReplyToMessage(s,f)}};case"report":return{icon:n.jsx(gs,{className:"icon-sm"}),title:f.formatMessage({id:"5Z3K6i",defaultMessage:"Report"}),onClick:()=>{re(l,ps,{entityId:s.id,entityType:os.Message,title:f.formatMessage({id:"32LaLp",defaultMessage:"Report message"})})}};case"delete":{const v=()=>{m.deleteMessage$(t,u)},d=()=>{re(l,an,{handleDelete:v})};return{icon:n.jsx(fs,{className:"icon-sm"}),title:f.formatMessage({id:"8SVfHI",defaultMessage:"Delete"}),onClick:d}}case"inspectorLog":return null;default:return null}}).filter(pl);let _;return e[3]!==x||e[4]!==o?(_=n.jsx(zt,{className:o,actions:x}),e[3]=x,e[4]=o,e[5]=_):_=e[5],_}function pl(r){return r!=null}function rt(r){"use forget";var f;const e=L.c(15),{message:t,className:s}=r;let o,i,l,m;if(e[0]!==s||e[1]!==t.reactions){m=Symbol.for("react.early_return_sentinel");e:{const c=Object.entries(t.reactions);if(c.length===0){m=null;break e}const x=new Map;for(const[_,h]of c)x.has(h)||x.set(h,[]),(f=x.get(h))==null||f.push(_);e[6]!==s?(i=_e("flex items-center gap-1",s),e[6]=s,e[7]=i):i=e[7],e[8]===Symbol.for("react.memo_cache_sentinel")?(o=_e("bg-token-bg-tertiary outline-token-bg-primary flex items-center rounded-full px-1 text-sm outline-2"),e[8]=o):o=e[8],l=Array.from(x.entries()).map(gl)}e[0]=s,e[1]=t.reactions,e[2]=o,e[3]=i,e[4]=l,e[5]=m}else o=e[2],i=e[3],l=e[4],m=e[5];if(m!==Symbol.for("react.early_return_sentinel"))return m;let a;e[9]!==o||e[10]!==l?(a=n.jsx("div",{className:o,children:l}),e[9]=o,e[10]=l,e[11]=a):a=e[11];let u;return e[12]!==i||e[13]!==a?(u=n.jsx("div",{className:i,children:a}),e[12]=i,e[13]=a,e[14]=u):u=e[14],u}function gl(r){const[e,t]=r;return n.jsx(hl,{emoji:e,userIds:t},e)}function hl({emoji:r,userIds:e}){const t=Y(),s=Pe(t),o=H(()=>e.map(a=>{var f,c;if(a==="assistant")return"ChatGPT";const u=(f=s.users$().get(a))==null?void 0:f.name;return u==null?(c=s.userProfileSnapshots$().get(a))==null?void 0:c.name:u})),i=e.length,l=o.map((a,u)=>a!=null?a:e[u]),m=n.jsx("div",{className:"flex flex-col items-center gap-0.5",children:l.map((a,u)=>n.jsx("span",{children:a},"".concat(e[u],"-").concat(u)))});return n.jsx($s,{label:m,side:"top",withArrow:!0,sideOffset:0,theme:"default",className:"inline-flex cursor-default items-center gap-1 rounded-full px-1 py-0.5",children:n.jsxs("span",{className:"inline-flex items-center gap-1",children:[n.jsx("span",{children:r}),i>1?n.jsx("span",{className:"text-token-text-secondary text-xs",children:i}):null]})})}function xl(r){"use forget";var N,I;const e=L.c(32),{room:t}=r,s=Y();let o;e[0]!==t?(o=()=>t==null?void 0:t.name$(),e[0]=t,e[1]=o):o=e[1];const i=H(o);let l;e[2]!==t?(l=()=>t==null?void 0:t.creatorAccountUserId$(),e[2]=t,e[3]=l):l=e[3];const m=H(l);let a;e[4]!==s?(a=(N=Qe(s))==null?void 0:N.normalizedAccountUserId,e[4]=s,e[5]=a):a=e[5];const u=a===m;let f;e[6]!==s?(f=(I=Qe(s))==null?void 0:I.normalizedAccountUserId,e[6]=s,e[7]=f):f=e[7];const c=f;let x;e[8]!==c||e[9]!==t?(x=()=>!t||!c?null:t.members$().some(k=>k.accountUserId===c),e[8]=c,e[9]=t,e[10]=x):x=e[10];const _=H(x),h=(t==null?void 0:t.projectId)!=null&&!_;let b;e[11]!==t?(b=()=>{var k;return(k=t==null?void 0:t.members$().length)!=null?k:0},e[11]=t,e[12]=b):b=e[12];const v=H(b),d=u||v===1,p=v>1,y=$e();let g;e[13]!==i?(g=i==null?null:n.jsx(yl,{roomName:i}),e[13]=i,e[14]=g):g=e[14];let j;e[15]!==s||e[16]!==y||e[17]!==h||e[18]!==t||e[19]!==i||e[20]!==d||e[21]!==p?(j=t==null||i==null?n.jsx("div",{}):n.jsxs("div",{className:"flex w-2/3 items-center",children:[n.jsx("div",{className:"md:hidden",children:n.jsx(Ln,{})}),n.jsxs(Es,{alignOffset:-4,size:"small",triggerButton:n.jsxs(Pt,{children:[n.jsx("span",{className:"truncate overflow-hidden text-start text-lg",children:i}),n.jsx(bn,{className:"icon-sm text-token-icon-tertiary"})]}),testId:"calpico-room-settings-dropdown",children:[n.jsx(Oe.Item,{icon:Dn,onClick:()=>{re(s,Lt,{room:t})},children:n.jsx(ve,{id:"MlDLlK",defaultMessage:"People"})}),h?null:n.jsxs(n.Fragment,{children:[n.jsx(Oe.Item,{icon:un,onClick:()=>{re(s,xs,{room:t})},children:n.jsx(ve,{id:"C+QPSB",defaultMessage:"Manage group link"})}),n.jsx(Oe.Item,{icon:fn,onClick:()=>{re(s,pn,{room:t})},children:n.jsx(ve,{id:"S+Al8v",defaultMessage:"Rename group"})}),n.jsx(Oe.Item,{icon:Ds,onClick:()=>{re(s,gn,{room:t})},children:n.jsx(ve,{id:"iQoNfK",defaultMessage:"Customize ChatGPT"})})]}),n.jsx(Oe.Separator,{}),n.jsx(Oe.Item,{icon:gs,onClick:()=>{re(s,ps,{entityId:t.id,entityType:os.CalpicoRoom,title:y.formatMessage({id:"o7lr8d",defaultMessage:"Report group chat"})})},color:"danger",children:n.jsx(ve,{id:"rGTGQC",defaultMessage:"Report"})}),!h&&p?n.jsx(Oe.Item,{icon:hn,onClick:()=>{re(s,xn,{room:t})},color:"danger",children:n.jsx(ve,{id:"/E3t8l",defaultMessage:"Leave group"})}):null,!h&&d?n.jsx(Oe.Item,{icon:fs,onClick:()=>{re(s,yn,{room:t})},color:"danger",children:n.jsx(ve,{id:"c7EK/q",defaultMessage:"Delete group"})}):null]})]}),e[15]=s,e[16]=y,e[17]=h,e[18]=t,e[19]=i,e[20]=d,e[21]=p,e[22]=j):j=e[22];let S;e[23]!==s||e[24]!==t?(S=t==null?null:n.jsx("div",{className:"px-2.5",children:n.jsx(Pt,{className:"-me-1 rounded-full px-1 py-1",onClick:()=>{re(s,Lt,{room:t})},children:n.jsx(jn,{room:t,baseSize:32,variant:"horizontal-stack"})})}),e[23]=s,e[24]=t,e[25]=S):S=e[25];let w;e[26]!==j||e[27]!==S?(w=n.jsxs(Pn,{id:"calpico-page-header",shouldStickSnorlaxNewThread:!1,shouldUseTransparentDefaultHeaderBackground:!0,shouldShowUpgradeStyles:!1,edgeShadowClass:"[box-shadow:var(--sharp-edge-top-shadow)]",shouldDisableTransition:!0,children:[j,S]}),e[26]=j,e[27]=S,e[28]=w):w=e[28];let C;return e[29]!==w||e[30]!==g?(C=n.jsxs(n.Fragment,{children:[g,w]}),e[29]=w,e[30]=g,e[31]=C):C=e[31],C}function yl(r){"use forget";const e=L.c(2),{roomName:t}=r;let s;return e[0]!==t?(s=n.jsx(vn,{children:n.jsx("title",{children:t})}),e[0]=t,e[1]=s):s=e[1],s}function ct(r){"use forget";const e=L.c(6),{targetMessage:t}=r,s=$e();let o;e[0]!==s||e[1]!==t?(o=t?_n(t,100)||s.formatMessage({id:"PnfKiD",defaultMessage:"Attachment"}):s.formatMessage({id:"y3kg1o",defaultMessage:"Loading message"}),e[0]=s,e[1]=t,e[2]=o):o=e[2];const i=o;let l;e[3]===Symbol.for("react.memo_cache_sentinel")?(l=n.jsx(hs,{className:"icon-sm me-1 flex-shrink-0"}),e[3]=l):l=e[3];let m;return e[4]!==i?(m=n.jsx(Ls,{children:n.jsxs("div",{className:"text-token-text-secondary mb-1 flex items-start text-xs font-medium",children:[l,n.jsx("span",{className:"line-clamp-2 break-words",children:i})]})}),e[4]=i,e[5]=m):m=e[5],m}function bl({children:r,className:e}){const t=Y(),s=tt(),o=ms(t),i=$e(),{getRootProps:l,isDragActive:m}=Un({onDropAccepted:a=>{const u=Array.from(a).map(f=>Ys(f,c=>Qs(s.roomId,c)));s.attachments$.set(f=>[...f,...u.map(c=>({kind:"fileUpload",calpicoFileId:"",state:c}))])},multiple:!0,accept:o?Ce(Ce({},at(At)),at(Ks)):at(At)});return n.jsxs("div",Ue(Ce({},l()),{className:_e("relative",e),children:[r,m?n.jsxs(Fn,{children:[n.jsx(Sn,{}),n.jsx("div",{className:"font-medium",children:o?i.formatMessage({id:"4GdYBD",defaultMessage:"Drop a file to upload"}):i.formatMessage({id:"tUo5fR",defaultMessage:"Drop an image to upload"})})]}):null]}))}const jl=ws({user:{id:"9vw5O1",defaultMessage:"User"}});function vl(r){"use forget";const e=L.c(20),{roomId:t}=r,s=Y();let o;e[0]!==s?(o=Pe(s),e[0]=s,e[1]=o):o=e[1];const i=o,l=$e();let m;e[2]!==i||e[3]!==t?(m=()=>{var d;return(d=i.rooms$().get(t))==null?void 0:d.assistantHeartbeats$()},e[2]=i,e[3]=t,e[4]=m):m=e[4];const a=H(m);let u;e[5]!==l?(u=l.formatMessage(jl.user),e[5]=l,e[6]=u):u=e[6];const f=u;let c;e[7]!==i||e[8]!==f||e[9]!==t?(c=()=>{var p,y;return((y=(p=i.rooms$().get(t))==null?void 0:p.userHeartbeats$())!=null?y:[]).map(g=>{var S,w;const{accountUserId:j}=g;return(w=(S=i.users$().get(j))==null?void 0:S.name)!=null?w:f})},e[7]=i,e[8]=f,e[9]=t,e[10]=c):c=e[10];const x=H(c);let _;e[11]!==a?(_=a!=null?a:[],e[11]=a,e[12]=_):_=e[12];let h;e[13]!==_?(h=_.map(_l),e[13]=_,e[14]=h):h=e[14];let b;e[15]!==x?(b=x.length>0?n.jsx(Nl,{typingUserDisplayNames:x}):null,e[15]=x,e[16]=b):b=e[16];let v;return e[17]!==h||e[18]!==b?(v=n.jsxs("div",{className:"flex flex-col gap-4",children:[h,b]}),e[17]=h,e[18]=b,e[19]=v):v=e[19],v}function _l(r){return n.jsx(Sl,{message:r.message},r.modelSlug)}function Sl(r){"use forget";const e=L.c(4),{message:t}=r;let s,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(s=[On],o={p:wl,strong:Cl},e[0]=s,e[1]=o):(s=e[0],o=e[1]);const i=t!=null?t:"";let l;return e[2]!==i?(l=n.jsx("div",{className:"flex items-center gap-3",children:n.jsx(ys,{remarkPlugins:s,components:o,className:"markdown [&>p:last-child]:mb-0!",children:i})}),e[2]=i,e[3]=l):l=e[3],l}function Cl(r){const{children:e}=r;return n.jsx("strong",{className:"font-semibold",children:e})}function wl(r){const{children:e}=r;return n.jsx("p",{className:"text-token-text-secondary loading-shimmer-pure-text text-sm leading-tight wrap-anywhere",children:e})}function Nl(r){"use forget";const e=L.c(14),{typingUserDisplayNames:t}=r,s=t.length;if(s===0)return null;let o;e[0]!==s||e[1]!==t[0]?(o=s===1&&n.jsx(ve,{id:"7izLl8",defaultMessage:"{userDisplayName} is typing",values:{userDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]})}}),e[0]=s,e[1]=t[0],e[2]=o):o=e[2];let i;e[3]!==s||e[4]!==t[0]||e[5]!==t[1]?(i=s===2&&n.jsx(ve,{id:"nVUHou",defaultMessage:"{primaryUserDisplayName} & {secondaryUserDisplayName} are typing",values:{primaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]}),secondaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[1]})}}),e[3]=s,e[4]=t[0],e[5]=t[1],e[6]=i):i=e[6];let l;e[7]!==s||e[8]!==t[0]?(l=s>2&&n.jsx(ve,{id:"k+PAM5",defaultMessage:"{primaryUserDisplayName} & <strong>{remainingCount} more</strong> are typing",values:{primaryUserDisplayName:n.jsx("strong",{className:"font-semibold",children:t[0]}),remainingCount:s-1,strong:Tl}}),e[7]=s,e[8]=t[0],e[9]=l):l=e[9];let m;return e[10]!==o||e[11]!==i||e[12]!==l?(m=n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("p",{className:"text-token-text-secondary loading-shimmer-pure-text items-baseline text-sm leading-tight",children:[o,i,l]})}),e[10]=o,e[11]=i,e[12]=l,e[13]=m):m=e[13],m}function Tl(r){return n.jsx("strong",{className:"font-semibold",children:r},"typing-indicator-strong")}const vs=String.raw;var Kt;const Ht=vs(Kt||(Kt=ot(["p{Emoji}(?:p{EMod}|[󠀠-󠁾]+󠁿|️?⃣?)"],["\\p{Emoji}(?:\\p{EMod}|[\\u{E0020}-\\u{E007E}]+\\u{E007F}|\\uFE0F?\\u20E3?)"])));var Yt;const kl=()=>new RegExp(vs(Yt||(Yt=ot(["p{RI}{2}|(?![#*d](?!️?⃣))","(?:‍",")*"],["\\p{RI}{2}|(?![#*\\d](?!\\uFE0F?\\u20E3))","(?:\\u200D",")*"])),Ht,Ht),"gu"),Ml=5;function Il(r){if(r.includes("\n"))return!1;const e=kl();if(!new RegExp("^(?:".concat(e.source,"| )+$"),"u").test(r))return!1;const s=Array.from(r.matchAll(e)).length;return!(s===0||s>Ml)}function Gt(r){"use forget";const e=L.c(4),{text:t}=r;if(Il(t)){let o;return e[0]!==t?(o=n.jsx("p",{className:"text-2xl",children:t}),e[0]=t,e[1]=o):o=e[1],o}let s;return e[2]!==t?(s=n.jsx("p",{className:"m-0 wrap-anywhere whitespace-pre-wrap",children:t}),e[2]=t,e[3]=s):s=e[3],s}function Rl(r){"use forget";const e=L.c(8),{room:t}=r;let s;e[0]!==t?(s=()=>t.threadSidebar$(),e[0]=t,e[1]=s):s=e[1];const o=H(s),i=o!=null;let l;e[2]!==o||e[3]!==t?(l=n.jsx(Al,{room:t,activeSidebar:o}),e[2]=o,e[3]=t,e[4]=l):l=e[4];let m;return e[5]!==i||e[6]!==l?(m=n.jsx(as,{children:n.jsx(Hn,{isExpanded:i,children:l})}),e[5]=i,e[6]=l,e[7]=m):m=e[7],m}function Al({room:r,activeSidebar:e}){const t=H(Ps);if(!e)return null;switch(e.type){case"product":return n.jsx($l,{room:r,activeSidebar:e,type:t?"sidebar":"modal"})}return null}function $l(r){"use forget";const e=L.c(25),{activeSidebar:t,room:s,type:o}=r,i=o===void 0?"sidebar":o,l=Y(),m=s.id,{calpicoMessageId:a,messageId:u,contentReferenceStartIndex:f,productIndex:c}=t;let x;e[0]!==a||e[1]!==f||e[2]!==u||e[3]!==s?(x=()=>{var C,N;const S=s.messages$().find(I=>I.id===a);if(!S||S.role!=="assistant")return null;const w=S.rawMessages.find(I=>I.id===u);return w?(N=(C=w.metadata)==null?void 0:C.content_references)==null?void 0:N.find(I=>I.start_idx===f):null},e[0]=a,e[1]=f,e[2]=u,e[3]=s,e[4]=x):x=e[4];const _=H(x);let h;e[5]!==u||e[6]!==m?(h={clientThreadId:m,messageId:u},e[5]=u,e[6]=m,e[7]=h):h=e[7];const b=h;let v;e[8]!==l||e[9]!==s?(v=()=>{Pe(l).closeThreadSidebar$(s)},e[8]=l,e[9]=s,e[10]=v):v=e[10];const d=v;if(!_)return null;let p;e[11]!==_||e[12]!==c?(p=zn({contentReference:_,productIndex:c}),e[11]=_,e[12]=c,e[13]=p):p=e[13];const{product:y}=p;if(!y)return null;let g;e[14]!==f||e[15]!==u||e[16]!==c?(g={messageId:u,contentReferenceStartIndex:f,productIndex:c},e[14]=f,e[15]=u,e[16]=c,e[17]=g):g=e[17];let j;return e[18]!==b||e[19]!==d||e[20]!==y||e[21]!==m||e[22]!==g||e[23]!==i?(j=n.jsx(Bn,{clientThreadId:m,product:y,sidebar:g,handleCloseThreadSidebar:d,analyticsMetadata:b,type:i}),e[18]=b,e[19]=d,e[20]=y,e[21]=m,e[22]=g,e[23]=i,e[24]=j):j=e[24],j}/*!---------------------------------------------------------------------------------------------
 *  Copyright (c) StackBlitz. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/const El={damping:.7,stiffness:.05,mass:1.25},Dl=70,Ll=1e3/60,Pl=350;let lt=!1;var Qt;(Qt=globalThis.document)==null||Qt.addEventListener("mousedown",()=>{lt=!0});var Jt;(Jt=globalThis.document)==null||Jt.addEventListener("mouseup",()=>{lt=!1});var Xt;(Xt=globalThis.document)==null||Xt.addEventListener("click",()=>{lt=!1});const Fl=(r={})=>{const[e,t]=D.useState(!1),[s,o]=D.useState(r.initial!==!1),[i,l]=D.useState(!1),m=D.useRef(null);m.current=r;const a=D.useCallback(()=>{var g;if(!lt)return!1;const p=window.getSelection();if(!p||!p.rangeCount)return!1;const y=p.getRangeAt(0);return y.commonAncestorContainer.contains(v.current)||((g=v.current)==null?void 0:g.contains(y.commonAncestorContainer))},[]),u=D.useCallback(p=>{c.isAtBottom=p,o(p)},[]),f=D.useCallback(p=>{c.escapedFromLock=p,t(p)},[]),c=D.useMemo(()=>{let p;return{escapedFromLock:e,isAtBottom:s,resizeDifference:0,accumulated:0,velocity:0,listeners:new Set,get scrollTop(){var y,g;return(g=(y=v.current)==null?void 0:y.scrollTop)!=null?g:0},set scrollTop(y){v.current&&(v.current.scrollTop=y,c.ignoreScrollToTop=v.current.scrollTop)},get targetScrollTop(){return!v.current||!d.current?0:v.current.scrollHeight-1-v.current.clientHeight},get calculatedTargetScrollTop(){if(!v.current||!d.current)return 0;const{targetScrollTop:y}=this;if(!r.targetScrollTop)return y;if((p==null?void 0:p.targetScrollTop)===y)return p.calculatedScrollTop;const g=Math.max(Math.min(r.targetScrollTop(y,{scrollElement:v.current,contentElement:d.current}),y),0);return p={targetScrollTop:y,calculatedScrollTop:g},requestAnimationFrame(()=>{p=void 0}),g},get scrollDifference(){return this.calculatedTargetScrollTop-this.scrollTop},get isNearBottom(){return this.scrollDifference<=Dl}}},[]),x=D.useCallback((p={})=>{var N,I;typeof p=="string"&&(p={animation:p}),p.preserveScrollPosition||u(!0);const y=Date.now()+(Number(p.wait)||0),g=mt(m.current,p.animation),{ignoreEscapes:j=!1}=p;let S,w=c.calculatedTargetScrollTop;p.duration instanceof Promise?p.duration.finally(()=>{S=Date.now()}):S=y+((N=p.duration)!=null?N:0);const C=async()=>{const k=new Promise(requestAnimationFrame).then(()=>{var $,O;if(!c.isAtBottom)return c.animation=void 0,!1;const{scrollTop:M}=c,A=performance.now(),T=(A-(($=c.lastTick)!=null?$:A))/Ll;if(c.animation||(c.animation={behavior:g,promise:k,ignoreEscapes:j}),c.animation.behavior===g&&(c.lastTick=A),a()||y>Date.now())return C();if(M<Math.min(w,c.calculatedTargetScrollTop)){if(((O=c.animation)==null?void 0:O.behavior)===g){if(g==="instant")return c.scrollTop=c.calculatedTargetScrollTop,C();c.velocity=(g.damping*c.velocity+g.stiffness*c.scrollDifference)/g.mass,c.accumulated+=c.velocity*T,c.scrollTop+=c.accumulated,c.scrollTop!==M&&(c.accumulated=0)}return C()}return S>Date.now()?(w=c.calculatedTargetScrollTop,C()):(c.animation=void 0,c.scrollTop<c.calculatedTargetScrollTop?x({animation:mt(m.current,m.current.resize),ignoreEscapes:j,duration:Math.max(0,S-Date.now())||void 0}):c.isAtBottom)});return k.then(M=>(requestAnimationFrame(()=>{c.animation||(c.lastTick=void 0,c.velocity=0)}),M))};return p.wait!==!0&&(c.animation=void 0),((I=c.animation)==null?void 0:I.behavior)===g?c.animation.promise:C()},[u,a,c]),_=D.useCallback(()=>{f(!0),u(!1)},[f,u]),h=D.useCallback(({target:p})=>{if(p!==v.current)return;const{scrollTop:y,ignoreScrollToTop:g}=c;let{lastScrollTop:j=y}=c;c.lastScrollTop=y,c.ignoreScrollToTop=void 0,g&&g>y&&(j=g),l(c.isNearBottom),setTimeout(()=>{var C;if(c.resizeDifference||y===g)return;if(a()){f(!0),u(!1);return}const S=y>j,w=y<j;if((C=c.animation)!=null&&C.ignoreEscapes){c.scrollTop=j;return}w&&(f(!0),u(!1)),S&&f(!1),!c.escapedFromLock&&c.isNearBottom&&u(!0)},1)},[f,u,a,c]),b=D.useCallback(({target:p,deltaY:y})=>{var j;let g=p;for(;!["scroll","auto"].includes(getComputedStyle(g).overflow);){if(!g.parentElement)return;g=g.parentElement}g===v.current&&y<0&&v.current.scrollHeight>v.current.clientHeight&&!((j=c.animation)!=null&&j.ignoreEscapes)&&(f(!0),u(!1))},[f,u,c]),v=qt(p=>{var y,g;(y=v.current)==null||y.removeEventListener("scroll",h),(g=v.current)==null||g.removeEventListener("wheel",b),p==null||p.addEventListener("scroll",h,{passive:!0}),p==null||p.addEventListener("wheel",b,{passive:!0})},[]),d=qt(p=>{var g,j;if((g=c.resizeObserver)==null||g.disconnect(),!p)return;let y;c.resizeObserver=new ResizeObserver(([S])=>{const{height:w}=S.contentRect,C=w-(y!=null?y:w);if(c.resizeDifference=C,c.scrollTop>c.targetScrollTop&&(c.scrollTop=c.targetScrollTop),l(c.isNearBottom),C>=0){const N=mt(m.current,y?m.current.resize:m.current.initial);x({animation:N,wait:!0,preserveScrollPosition:!0,duration:N==="instant"?void 0:Pl})}else c.isNearBottom&&(f(!1),u(!0));y=w,requestAnimationFrame(()=>{setTimeout(()=>{c.resizeDifference===C&&(c.resizeDifference=0)},1)})}),(j=c.resizeObserver)==null||j.observe(p)},[]);return{contentRef:d,scrollRef:v,scrollToBottom:x,stopScroll:_,isAtBottom:s||i,isNearBottom:i,escapedFromLock:e,state:c}};function qt(r,e){const t=D.useCallback(s=>(t.current=s,r(s)),e);return t}const dt=new Map;function mt(...r){var o,i,l;const e=Ce({},El);let t=!1;for(const m of r){if(m==="instant"){t=!0;continue}typeof m=="object"&&(t=!1,e.damping=(o=m.damping)!=null?o:e.damping,e.stiffness=(i=m.stiffness)!=null?i:e.stiffness,e.mass=(l=m.mass)!=null?l:e.mass)}const s=JSON.stringify(e);return dt.has(s)||dt.set(s,Object.freeze(e)),t?"instant":dt.get(s)}ts(()=>Zt(()=>import("./ose6175gtasqnfv0.js"),__vite__mapDeps([7,1,2,3,8,9,5,6])).then(r=>r.JsonViewer));function Wt(r,e){return r.role!==e.role?!1:r.role==="user"&&e.role==="user"?r.accountUserId===e.accountUserId:(r.role==="assistant"&&e.role==="assistant",!1)}function Vt(r,e){return Gs(e.createdAt,r.createdAt)>30}function _s(r){"use forget";const e=L.c(15),{date:t}=r,s=Y();let o;if(e[0]!==s||e[1]!==t){const x=is().locale;o=Tn(t,x),e[0]=s,e[1]=t,e[2]=o}else o=e[2];const{date:i,time:l}=o;let m;e[3]!==t?(m=t.toISOString(),e[3]=t,e[4]=m):m=e[4];let a;e[5]!==i?(a=n.jsx("span",{className:"font-semibold",children:i}),e[5]=i,e[6]=a):a=e[6];let u;e[7]!==l?(u=n.jsx("span",{children:l}),e[7]=l,e[8]=u):u=e[8];let f;e[9]!==a||e[10]!==u?(f=n.jsx(ve,{id:"Bn2rwA",defaultMessage:"{date} {time}",values:{date:a,time:u}}),e[9]=a,e[10]=u,e[11]=f):f=e[11];let c;return e[12]!==m||e[13]!==f?(c=n.jsx("time",{className:"text-token-text-secondary block w-full px-2 py-0.5 text-center text-xs",dateTime:m,children:f}),e[12]=m,e[13]=f,e[14]=c):c=e[14],c}function ho(){"use forget";var a;const r=L.c(5),e=Y(),t=(a=It().id)!=null?a:null,s=It().gizmoSlug;let o;r[0]!==s?(o=s?Fs(s):void 0,r[0]=s,r[1]=o):o=r[1];const i=o,l=Pe(e);if(t==null||!l.hasAccess)return null;let m;return r[2]!==i||r[3]!==t?(m=n.jsx(Ul,{roomId:t,projectId:i}),r[2]=i,r[3]=t,r[4]=m):m=r[4],m}function Ul(r){"use forget";var bt,jt;const e=L.c(133),{roomId:t,projectId:s}=r,o=Y();let i;e[0]!==o?(i=Pe(o),e[0]=o,e[1]=i):i=e[1];const l=i;let m;e[2]!==l||e[3]!==t?(m=()=>l.rooms$().get(t),e[2]=l,e[3]=t,e[4]=m):m=e[4];const a=H(m);let u;e[5]!==a?(u=()=>{var R;return(R=a==null?void 0:a.fetchSource$())!=null?R:null},e[5]=a,e[6]=u):u=e[6];const f=H(u),c=a==null,x=c||f==="summary";let _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_={initial:"instant",resize:"instant"},e[7]=_):_=e[7];const{contentRef:h,scrollRef:b,scrollToBottom:v,isNearBottom:d,stopScroll:p}=Fl(_);let y;e[8]!==b?(y=R=>{const E=R?wn(R):null;b.current!==E&&b(E)},e[8]=b,e[9]=y):y=e[9];const g=Us(y);let j;e[10]===Symbol.for("react.memo_cache_sentinel")?(j=new Set([]),e[10]=j):j=e[10];const S=D.useRef(j);let w,C;e[11]!==l||e[12]!==s||e[13]!==t||e[14]!==x?(w=()=>{!x||S.current.has(t)||(S.current.add(t),l.fetchRoom$(t,s))},C=[l,x,t,s],e[11]=l,e[12]=s,e[13]=t,e[14]=x,e[15]=w,e[16]=C):(w=e[15],C=e[16]),D.useEffect(w,C);let N;e[17]===Symbol.for("react.memo_cache_sentinel")?(N=new Set([]),e[17]=N):N=e[17];const I=D.useRef(N);let k,M;e[18]!==l||e[19]!==c||e[20]!==t?(k=()=>{c||I.current.has(t)||(I.current.add(t),l.fetchMessages$({roomId:t}))},M=[l,c,t],e[18]=l,e[19]=c,e[20]=t,e[21]=k,e[22]=M):(k=e[21],M=e[22]),D.useEffect(k,M);let A;e[23]!==l||e[24]!==t?(A=()=>{var R;return(R=l.rooms$().get(t))==null?void 0:R.viewMessages$()},e[23]=l,e[24]=t,e[25]=A):A=e[25];const T=H(A),$=D.useRef(null);let O;e[26]!==l||e[27]!==t?(O=()=>{var R,E;return(E=(R=l.rooms$().get(t))==null?void 0:R.isFetchingMessages$())!=null?E:!1},e[26]=l,e[27]=t,e[28]=O):O=e[28];const P=H(O);let U;e[29]!==l||e[30]!==t?(U=()=>{var R,E;return(E=(R=l.rooms$().get(t))==null?void 0:R.hasFetchedBeginning$())!=null?E:!1},e[29]=l,e[30]=t,e[31]=U):U=e[31];const Z=H(U);let F;e[32]!==l||e[33]!==t?(F=()=>{var E,je,Ae;const R=(E=l.rooms$().get(t))==null?void 0:E.viewMessages$();return(Ae=(je=R==null?void 0:R[0])==null?void 0:je.id)!=null?Ae:null},e[32]=l,e[33]=t,e[34]=F):F=e[34];const q=H(F);let V;e[35]!==l||e[36]!==q||e[37]!==t||e[38]!==b?(V=R=>{const E=b.current;if(!E)return;const je=l.rooms$().get(t);if(!je||je.isFetchingMessages$()||je.hasFetchedBeginning$()||R==="scroll"&&!(E.scrollTop<=200))return;const Ae=q!=null?q:null,Ve=E.getBoundingClientRect(),Ke=Ae?E.querySelector('[data-message-id="'.concat(Ae,'"]')):null,Xe=Ke?Ke.getBoundingClientRect().top-Ve.top:null;$.current={previousScrollHeight:E.scrollHeight,anchorId:Ae,anchorOffset:Xe},l.fetchMoreMessages$(t,"before")},e[35]=l,e[36]=q,e[37]=t,e[38]=b,e[39]=V):V=e[39];const G=V;let Q,te;e[40]!==G||e[41]!==b?(Q=()=>{const R=b.current;if(R==null)return;const E=zs(()=>{G("scroll")},100);return R.addEventListener("scroll",E,{passive:!0}),()=>{R.removeEventListener("scroll",E),E.cancel()}},te=[b,G],e[40]=G,e[41]=b,e[42]=Q,e[43]=te):(Q=e[42],te=e[43]),D.useEffect(Q,te);let J;e[44]!==G||e[45]!==b?(J=()=>{const R=b.current;if(!R)return;const E=requestAnimationFrame(()=>{R.scrollHeight<=R.clientHeight+1&&G("underflow")});return()=>cancelAnimationFrame(E)},e[44]=G,e[45]=b,e[46]=J):J=e[46];let ne;e[47]!==G||e[48]!==T||e[49]!==b?(ne=[T,b,G],e[47]=G,e[48]=T,e[49]=b,e[50]=ne):ne=e[50],D.useEffect(J,ne);let pe;e[51]!==b?(pe=()=>{const R=$.current;if(!R)return;const E=b.current;if(!E){$.current=null;return}const{anchorId:je,anchorOffset:Ae,previousScrollHeight:Ve}=R,Ke=function(Ye,_t){Ye.scrollTop=Ye.scrollTop+_t};if(je&&Ae!=null){const vt=E.getBoundingClientRect(),Ye=E.querySelector('[data-message-id="'.concat(je,'"]'));if(Ye){const St=Ye.getBoundingClientRect().top-vt.top-Ae;St&&Ke(E,St),$.current=null;return}}const Xe=E.scrollHeight-Ve;Xe&&Ke(E,Xe),$.current=null},e[51]=b,e[52]=pe):pe=e[52];let le;e[53]!==T||e[54]!==b?(le=[T,b],e[53]=T,e[54]=b,e[55]=le):le=e[55],Os(pe,le);let oe;e[56]!==T?(oe=Bs(T),e[56]=T,e[57]=oe):oe=e[57];const K=oe,z=K==null?void 0:K.id,ee=K==null?void 0:K.createdAt;let se;e[58]===Symbol.for("react.memo_cache_sentinel")?(se=new Set,e[58]=se):se=e[58];const we=D.useRef(se);let ge,ae;e[59]!==l||e[60]!==d||e[61]!==ee||e[62]!==z||e[63]!==t?(ge=()=>{z==null||ee==null||!d||we.current.has(z)||(we.current.add(z),l.markRoomRead$(t,ee))},ae=[z,ee,t,l,d],e[59]=l,e[60]=d,e[61]=ee,e[62]=z,e[63]=t,e[64]=ge,e[65]=ae):(ge=e[64],ae=e[65]),D.useEffect(ge,ae);let he;e[66]===Symbol.for("react.memo_cache_sentinel")?(he=new Set,e[66]=he):he=e[66];const Se=D.useRef(he);let ce,de;e[67]!==d||e[68]!==z||e[69]!==v?(ce=()=>{z==null||!d||Se.current.has(z)||(Se.current.add(z),requestAnimationFrame(()=>{v("instant")}))},de=[z,v,d],e[67]=d,e[68]=z,e[69]=v,e[70]=ce,e[71]=de):(ce=e[70],de=e[71]),D.useEffect(ce,de);const Fe=!P&&((bt=T==null?void 0:T.length)!=null?bt:0)<Cn,xe=P&&!Z&&!Fe;let me;e[72]!==o?(me=(jt=Qe(o))==null?void 0:jt.normalizedAccountUserId,e[72]=o,e[73]=me):me=e[73];const ue=me;let fe;e[74]!==ue||e[75]!==a?(fe=()=>!a||!ue?null:a.members$().some(R=>R.accountUserId===ue),e[74]=ue,e[75]=a,e[76]=fe):fe=e[76];const Ne=H(fe),B=(a==null?void 0:a.projectId)!=null&&!Ne,W=$e(),X=a!=null?a:null;let ie;e[77]!==X?(ie=n.jsx(xl,{room:X}),e[77]=X,e[78]=ie):ie=e[78];let Te;e[79]===Symbol.for("react.memo_cache_sentinel")?(Te={scrollbarGutter:"stable both-edges"},e[79]=Te):Te=e[79];let ke;e[80]!==xe?(ke=xe?n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(Hs,{className:"text-token-text-secondary"})}):null,e[80]=xe,e[81]=ke):ke=e[81];let Me;e[82]!==B||e[83]!==t||e[84]!==T||e[85]!==b||e[86]!==p?(Me=(T!=null?T:[]).map((R,E)=>{const je=E>0&&T!=null&&Vt(T[E-1],R),Ae=E>0&&T!=null&&Wt(R,T[E-1])&&!je,Ve=T!=null&&E<T.length-1&&Wt(R,T[E+1])&&!Vt(R,T[E+1]);return[je?n.jsx(_s,{date:R.createdAt},"ts-".concat(R.id)):null,n.jsx(zl,{calpicoMessage:R,roomId:t,groupWithPrevious:Ae,groupWithNext:Ve,stopMainScroll:p,mainScrollRef:b,isRoomReadOnly:B},R.id)]}),e[82]=B,e[83]=t,e[84]=T,e[85]=b,e[86]=p,e[87]=Me):Me=e[87];let Ie;e[88]!==K||e[89]!==t?(Ie=K!=null?n.jsx(vl,{roomId:t}):null,e[88]=K,e[89]=t,e[90]=Ie):Ie=e[90];let Ee;e[91]!==h||e[92]!==ke||e[93]!==Me||e[94]!==Ie?(Ee=n.jsx(Nn,{fullHeight:!0,horizontalPadding:"standard",children:n.jsx(Ft,{children:n.jsxs("div",{className:"relative flex min-h-full grow flex-col justify-start gap-2 py-6",style:Te,ref:h,children:[ke,Me,Ie]})})}),e[91]=h,e[92]=ke,e[93]=Me,e[94]=Ie,e[95]=Ee):Ee=e[95];let ye;e[96]!==g||e[97]!==Ee?(ye=n.jsx("div",{className:"flex-1",ref:g,children:Ee}),e[96]=g,e[97]=Ee,e[98]=ye):ye=e[98];let be;e[99]!==B||e[100]!==t||e[101]!==v?(be=n.jsx(cs,{roomId:t,scrollToBottom:v}),e[99]=B,e[100]=t,e[101]=v,e[102]=be):be=e[102];let De;e[103]!==W?(De=W.formatMessage({id:"ISN8OO",defaultMessage:"ChatGPT can make mistakes. Check important info. Your personal ChatGPT memory is never used in group chats."}),e[103]=W,e[104]=De):De=e[104];let Le;e[105]!==De?(Le=n.jsx("div",{className:"text-token-text-secondary relative mt-auto flex min-h-8 w-full items-center justify-center p-2 text-center text-xs text-pretty",children:n.jsx("p",{children:De})}),e[105]=De,e[106]=Le):Le=e[106];let Re;e[107]!==be||e[108]!==Le?(Re=n.jsx("div",{className:"bg-token-bg-primary sticky bottom-0 z-20",children:n.jsxs(Ft,{children:[be,Le]})}),e[107]=be,e[108]=Le,e[109]=Re):Re=e[109];let Be;e[110]!==ie||e[111]!==ye||e[112]!==Re?(Be=n.jsxs("section",{className:"flex min-h-screen flex-1 flex-col",children:[ie,ye,Re]}),e[110]=ie,e[111]=ye,e[112]=Re,e[113]=Be):Be=e[113];let ze;e[114]!==B||e[115]!==Be?(ze=n.jsx(Ol,{isRoomViewOnly:B,children:Be}),e[114]=B,e[115]=Be,e[116]=ze):ze=e[116];let He;e[117]!==l||e[118]!==(a==null?void 0:a._oai_internal_roomSystemInstructions)||e[119]!==(a==null?void 0:a._oai_internal_speakDecisionToolDescription)||e[120]!==t?(He=null,e[117]=l,e[118]=a==null?void 0:a._oai_internal_roomSystemInstructions,e[119]=a==null?void 0:a._oai_internal_speakDecisionToolDescription,e[120]=t,e[121]=He):He=e[121];let Ge;e[122]!==a?(Ge=a?n.jsx(Rl,{room:a}):null,e[122]=a,e[123]=Ge):Ge=e[123];let qe;e[124]!==Ge?(qe=n.jsx(as,{children:Ge}),e[124]=Ge,e[125]=qe):qe=e[125];let We;e[126]!==ze||e[127]!==He||e[128]!==qe?(We=n.jsxs(n.Fragment,{children:[ze,He,qe]}),e[126]=ze,e[127]=He,e[128]=qe,e[129]=We):We=e[129];let Je;return e[130]!==t||e[131]!==We?(Je=n.jsx(rs,{roomId:t,children:We},t),e[130]=t,e[131]=We,e[132]=Je):Je=e[132],Je}function Ol(r){"use forget";const e=L.c(4),{isRoomViewOnly:t,children:s}=r;if(t){let i;return e[0]!==s?(i=n.jsx("div",{className:"relative min-w-0 grow",children:s}),e[0]=s,e[1]=i):i=e[1],i}let o;return e[2]!==s?(o=n.jsx(bl,{className:"min-w-0 grow",children:s}),e[2]=s,e[3]=o):o=e[3],o}function Bl(r){"use forget";const e=L.c(2),{accountUserId:t}=r,s=kn(t);let o;return e[0]!==s?(o=n.jsx("span",{className:"text-token-text-secondary text-xs",children:s}),e[0]=s,e[1]=o):o=e[1],o}function zl(r){"use forget";var g,j,S,w,C,N,I;const e=L.c(135),{calpicoMessage:t,roomId:s,groupWithPrevious:o,groupWithNext:i,stopMainScroll:l,mainScrollRef:m,isRoomReadOnly:a}=r,u=Y(),f=is().locale,c=$e();let x;e[0]!==u?(x=Pe(u),e[0]=u,e[1]=x):x=e[1];const _=x;let h;e[2]!==_?(h=()=>_.messageDebugMode$(),e[2]=_,e[3]=h):h=e[3],H(h);let b;e[4]!==_||e[5]!==s?(b=()=>{const k=_.rooms$().get(s);return k?k.shouldInsertHeader$():!1},e[4]=_,e[5]=s,e[6]=b):b=e[6];const v=H(b),d=t,p=Qe(u),y=(g=p==null?void 0:p.normalizedAccountUserId)!=null?g:null;switch(d.role){case"user":{const k=d.accountUserId===y,M=!!((j=d.content.attachments)!=null&&j.length);let A;e[10]!==d.reactions?(A=Object.keys(d.reactions),e[10]=d.reactions,e[11]=A):A=e[11];const T=A.length>0;if(k){let se;e[12]===Symbol.for("react.memo_cache_sentinel")?(se=["addReaction","reply","delete"],e[12]=se):se=e[12];const we=se,ge=(S=d.requestId)!=null?S:d.id,ae=!i&&"mb-4",he=T&&"mb-2";let Se;e[13]!==ae||e[14]!==he?(Se=_e("group/message relative flex flex-col items-end gap-1",ae,he),e[13]=ae,e[14]=he,e[15]=Se):Se=e[15];let ce;e[16]!==d.replyTo?(ce=d.replyTo?n.jsx(ct,{targetMessage:(w=d.replyTo.message)!=null?w:null}):null,e[16]=d.replyTo,e[17]=ce):ce=e[17];let de;e[18]!==a?(de=a?[]:we,e[18]=a,e[19]=de):de=e[19];let Fe;e[20]===Symbol.for("react.memo_cache_sentinel")?(Fe=[],e[20]=Fe):Fe=e[20];let xe;e[21]!==de?(xe=[...de,...Fe],e[21]=de,e[22]=xe):xe=e[22];let me;e[23]!==d||e[24]!==s||e[25]!==xe?(me=n.jsx(it,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:xe}),e[23]=d,e[24]=s,e[25]=xe,e[26]=me):me=e[26];let ue;e[27]!==M||e[28]!==d||e[29]!==s?(ue=M?n.jsx(et,{message:d,roomId:s}):null,e[27]=M,e[28]=d,e[29]=s,e[30]=ue):ue=e[30];let fe;e[31]!==M||e[32]!==d.content.text?(fe=d.content.text?n.jsx("div",{className:_e("group/message user-message-bubble-color relative max-w-full rounded-ss-3xl rounded-b-3xl px-4 py-2.5",M?"rounded-se-lg":"rounded-se-3xl"),children:n.jsx(Gt,{text:d.content.text})}):null,e[31]=M,e[32]=d.content.text,e[33]=fe):fe=e[33];let Ne;e[34]!==d||e[35]!==s?(Ne=n.jsx(rt,{roomId:s,message:d,className:"absolute end-3 -bottom-4 z-10"}),e[34]=d,e[35]=s,e[36]=Ne):Ne=e[36];let B;e[37]!==c||e[38]!==d.deliveryErrorMessage||e[39]!==d.deliveryState?(B=d.deliveryState==="failed"?n.jsx("p",{className:"text-token-text-error mt-1 text-end text-xs",role:"alert",children:(C=d.deliveryErrorMessage)!=null?C:c.formatMessage({id:"PTNnih",defaultMessage:"Failed to send message."})}):null,e[37]=c,e[38]=d.deliveryErrorMessage,e[39]=d.deliveryState,e[40]=B):B=e[40];let W;e[41]!==ue||e[42]!==fe||e[43]!==Ne||e[44]!==B?(W=n.jsxs("div",{className:"relative flex max-w-4/5 flex-col items-end justify-end",children:[ue,fe,Ne,B]}),e[41]=ue,e[42]=fe,e[43]=Ne,e[44]=B,e[45]=W):W=e[45];let X;e[46]!==me||e[47]!==W?(X=n.jsxs("div",{className:"flex w-full flex-row items-center justify-end gap-2",children:[me,W]}),e[46]=me,e[47]=W,e[48]=X):X=e[48];let ie;return e[49]!==d.id||e[50]!==ce||e[51]!==X||e[52]!==ge||e[53]!==Se?(ie=n.jsxs("div",{className:Se,"data-message-id":d.id,children:[ce,X]},ge),e[49]=d.id,e[50]=ce,e[51]=X,e[52]=ge,e[53]=Se,e[54]=ie):ie=e[54],ie}let $;e[55]===Symbol.for("react.memo_cache_sentinel")?($=["addReaction","reply"],e[55]=$):$=e[55];const O=$,P=!i&&"mb-4",U=T&&"mb-3";let Z;e[56]!==P||e[57]!==U?(Z=_e("group/message flex gap-2",P,U),e[56]=P,e[57]=U,e[58]=Z):Z=e[58];let F;e[59]!==i||e[60]!==d.accountUserId?(F=i?n.jsx("div",{className:"h-7 w-7 flex-shrink-0"}):n.jsx("div",{className:"gizmo-shadow-stroke h-7 w-7 flex-shrink-0 self-end rounded-full",children:n.jsx(Js,{accountUserId:d.accountUserId,allowViewingProfile:!0,size:"medium"})}),e[59]=i,e[60]=d.accountUserId,e[61]=F):F=e[61];const q=o?null:n.jsx("div",{className:"flex w-full items-center ps-4",children:n.jsxs("div",{children:[n.jsx(Bl,{accountUserId:d.accountUserId}),n.jsx("span",{className:"text-token-text-secondary ms-2 text-xs opacity-0 group-hover/message:opacity-100",title:d.createdAt.toLocaleString(f),children:d.createdAt.toLocaleTimeString(f,{hour:"numeric",minute:"2-digit"})})]})});let V;e[62]!==d.replyTo?(V=d.replyTo?n.jsx(ct,{targetMessage:(N=d.replyTo.message)!=null?N:null}):null,e[62]=d.replyTo,e[63]=V):V=e[63];let G;e[64]!==M||e[65]!==d||e[66]!==s?(G=M?n.jsx(et,{message:d,roomId:s}):null,e[64]=M,e[65]=d,e[66]=s,e[67]=G):G=e[67];let Q;e[68]!==M||e[69]!==d.content.text?(Q=d.content.text?n.jsx("div",{className:_e("group/message bg-token-bg-tertiary relative max-w-full rounded-ss-3xl rounded-b-3xl px-4 py-2.5",M?"rounded-se-lg":"rounded-se-3xl"),children:n.jsx(Gt,{text:d.content.text})}):null,e[68]=M,e[69]=d.content.text,e[70]=Q):Q=e[70];let te;e[71]!==d||e[72]!==s?(te=n.jsx(rt,{roomId:s,message:d,className:"absolute end-3 -bottom-4 z-10"}),e[71]=d,e[72]=s,e[73]=te):te=e[73];let J;e[74]!==G||e[75]!==Q||e[76]!==te?(J=n.jsxs("div",{className:"relative flex max-w-4/5 flex-col justify-start",children:[G,Q,te]}),e[74]=G,e[75]=Q,e[76]=te,e[77]=J):J=e[77];let ne;e[78]!==a?(ne=a?[]:O,e[78]=a,e[79]=ne):ne=e[79];let pe;e[80]===Symbol.for("react.memo_cache_sentinel")?(pe=[],e[80]=pe):pe=e[80];let le;e[81]!==ne?(le=[...ne,"report",...pe],e[81]=ne,e[82]=le):le=e[82];let oe;e[83]!==d||e[84]!==s||e[85]!==le?(oe=n.jsx(it,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:le}),e[83]=d,e[84]=s,e[85]=le,e[86]=oe):oe=e[86];let K;e[87]!==J||e[88]!==oe?(K=n.jsxs("div",{className:"flex w-full flex-row items-center justify-start gap-2",children:[J,oe]}),e[87]=J,e[88]=oe,e[89]=K):K=e[89];let z;e[90]!==q||e[91]!==V||e[92]!==K?(z=n.jsxs("div",{className:"flex grow flex-col items-start gap-1",children:[q,V,K]}),e[90]=q,e[91]=V,e[92]=K,e[93]=z):z=e[93];let ee;return e[94]!==d.id||e[95]!==z||e[96]!==Z||e[97]!==F?(ee=n.jsxs("div",{className:Z,"data-message-id":d.id,children:[F,z]}),e[94]=d.id,e[95]=z,e[96]=Z,e[97]=F,e[98]=ee):ee=e[98],ee}case"assistant":{let k;e[99]===Symbol.for("react.memo_cache_sentinel")?(k=["addReaction","reply","delete"],e[99]=k):k=e[99];const M=k,A=o?null:n.jsx("div",{className:"mb-1 flex w-full items-center justify-between",children:n.jsxs("div",{children:[n.jsx(Hl,{modelSlug:d.modelSlug}),n.jsx("span",{className:"text-token-text-secondary ms-2 text-xs opacity-0 group-hover/message:opacity-100",title:d.createdAt.toLocaleString(f),children:d.createdAt.toLocaleTimeString(f,{hour:"numeric",minute:"2-digit"})})]})});let T;e[100]!==d.replyTo?(T=d.replyTo?n.jsx(ct,{targetMessage:(I=d.replyTo.message)!=null?I:null}):null,e[100]=d.replyTo,e[101]=T):T=e[101];let $;e[102]!==m||e[103]!==d||e[104]!==s||e[105]!==l?($=n.jsx("div",{className:"relative max-w-full min-w-0 shrink",children:n.jsx(ul,{message:d,roomId:s,stopMainScroll:l,mainScrollRef:m})}),e[102]=m,e[103]=d,e[104]=s,e[105]=l,e[106]=$):$=e[106];let O;e[107]!==A||e[108]!==T||e[109]!==$?(O=n.jsxs("div",{className:"relative flex grow flex-col",children:[A,T,$]}),e[107]=A,e[108]=T,e[109]=$,e[110]=O):O=e[110];let P;e[111]!==d||e[112]!==s?(P=Object.keys(d.reactions).length>0?n.jsx("div",{className:"flex",children:n.jsx(rt,{roomId:s,message:d})}):null,e[111]=d,e[112]=s,e[113]=P):P=e[113];let U;e[114]!==a?(U=a?[]:M,e[114]=a,e[115]=U):U=e[115];let Z;e[116]===Symbol.for("react.memo_cache_sentinel")?(Z=[],e[116]=Z):Z=e[116];let F;e[117]!==U?(F=[...U,...Z],e[117]=U,e[118]=F):F=e[118];let q;e[119]!==d||e[120]!==s||e[121]!==F?(q=n.jsx(it,{roomId:s,message:d,className:"radix-state-open:opacity-100 opacity-0 group-hover/message:opacity-100",enabledActions:F}),e[119]=d,e[120]=s,e[121]=F,e[122]=q):q=e[122];let V;return e[123]!==d.id||e[124]!==q||e[125]!==O||e[126]!==P?(V=n.jsxs("div",{className:"group/message","data-message-id":d.id,children:[O,P,q]}),e[123]=d.id,e[124]=q,e[125]=O,e[126]=P,e[127]=V):V=e[127],V}case"system":{let k;return e[128]!==_||e[129]!==u||e[130]!==a||e[131]!==d||e[132]!==s||e[133]!==v?(k=n.jsx(Gl,{message:d,roomId:s,ctx:u,calpicoState:_,shouldInsertHeader:v,isRoomReadOnly:a}),e[128]=_,e[129]=u,e[130]=a,e[131]=d,e[132]=s,e[133]=v,e[134]=k):k=e[134],k}}}function Hl(r){"use forget";const e=L.c(11),{modelSlug:t}=r,s=Y();let o;e[0]!==s?(o=()=>qs(s,{isGizmo:!1}),e[0]=s,e[1]=o):o=e[1];const i=H(o);let l;e:{if(t!=null){let f;if(e[2]!==t||e[3]!==i.categories){let _;e[5]!==t?(_=h=>{const{defaultModel:b}=h;return b===t},e[5]=t,e[6]=_):_=e[6],f=i.categories.find(_),e[2]=t,e[3]=i.categories,e[4]=f}else f=e[4];const c=f,x=c==null?void 0:c.shortLabel;if(x){l="ChatGPT ".concat(x);break e}}l="ChatGPT"}const m=l;if(ls(s,"1987254067")){let f;return e[7]!==m?(f=n.jsx("span",{className:"text-token-text-secondary text-xs",children:m}),e[7]=m,e[8]=f):f=e[8],f}let u;return e[9]!==m?(u=n.jsx("span",{className:"text-token-text-secondary text-xs",title:m,children:"ChatGPT"}),e[9]=m,e[10]=u):u=e[10],u}function Gl(r){"use forget";const e=L.c(28),{message:t,roomId:s,ctx:o,calpicoState:i,shouldInsertHeader:l,isRoomReadOnly:m}=r;let a;e[0]!==i||e[1]!==s?(a=()=>i.rooms$().get(s),e[0]=i,e[1]=s,e[2]=a):a=e[2];const u=H(a),f=t.content.type==="create_magic_link"||t.content.type==="create_chat"&&!l,c=$e();let x;e[3]!==c||e[4]!==(u==null?void 0:u.projectId)?(x=c.formatMessage({id:"HYPzFm",defaultMessage:"Invite with link"}),e[3]=c,e[4]=u==null?void 0:u.projectId,e[5]=x):x=e[5];const _=x;let h;e[6]!==c?(h=c.formatMessage({id:"e7LaZn",defaultMessage:"Your personal ChatGPT memory is never used in group chats."}),e[6]=c,e[7]=h):h=e[7];const b=h;let v;e[8]!==t.content.type||e[9]!==t.createdAt||e[10]!==t.id?(v=t.content.type==="create_chat"?n.jsx("div",{className:"mb-3",children:n.jsx(_s,{date:t.createdAt},"ts-".concat(t.id))}):null,e[8]=t.content.type,e[9]=t.createdAt,e[10]=t.id,e[11]=v):v=e[11];let d;e[12]===Symbol.for("react.memo_cache_sentinel")?(d={p:Wl,strong:ql},e[12]=d):d=e[12];let p;e[13]!==t.content.text?(p=n.jsx("div",{className:"self-center",children:n.jsx("div",{className:"flex items-center justify-center gap-1.5",children:n.jsx(ys,{components:d,children:t.content.text})})}),e[13]=t.content.text,e[14]=p):p=e[14];let y;e[15]!==i||e[16]!==o||e[17]!==m||e[18]!==b||e[19]!==s||e[20]!==_||e[21]!==f?(y=f?n.jsxs("div",{className:"mt-4 self-center text-center",children:[n.jsx("p",{className:"text-token-text-secondary text-xs",children:b}),m?null:n.jsx(ns,{color:"secondary",className:"mt-4 mb-2",contentWrapperClassName:"text-xs font-semibold",label:_,onClick:()=>{const j=i.rooms$().get(s);if(!j)return;re(o,xs,{room:j})},children:_})]}):null,e[15]=i,e[16]=o,e[17]=m,e[18]=b,e[19]=s,e[20]=_,e[21]=f,e[22]=y):y=e[22];let g;return e[23]!==t.id||e[24]!==v||e[25]!==p||e[26]!==y?(g=n.jsxs("div",{className:"self-center","data-message-id":t.id,children:[v,p,y]}),e[23]=t.id,e[24]=v,e[25]=p,e[26]=y,e[27]=g):g=e[27],g}function ql(r){const{children:e}=r;return n.jsx("strong",{className:"font-semibold",children:e})}function Wl(r){const{children:e}=r;return n.jsx("p",{className:"text-token-text-secondary text-center text-xs wrap-anywhere",children:e})}export{ho as C};
//# sourceMappingURL=hid2i29zl74fpzeb.js.map
