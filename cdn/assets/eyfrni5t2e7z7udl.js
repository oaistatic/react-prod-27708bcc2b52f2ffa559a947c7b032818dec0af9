import{j as e,e as B,M as T,h as re,r as E}from"./fg33krlcm0qyi6yw.js";import{g as le,T as de}from"./exqqo21frem4no6f.js";import{b2 as ie,hk as ce,fu as _,as as me,jY as z,qv as xe,c as fe,hf as $,hj as ue,qw as he,qx as pe,qy as be,Z as ge}from"./k65njl5wlgspihfr.js";import{m as G,i as je,b as ye}from"./kimw6epkq1t36pow.js";import{u as ve,a as ke,D as Ne}from"./nk8claqige01rjll.js";import{d9 as Q,l as j,g2 as y,T as N,a9 as J,jr as Me,uP as we,hh as Ce,gd as Ee,dv as Y,bg as Z,bX as Te,b as U}from"./mtk1qztvnb31pw5r.js";import{E as Be}from"./h5lbwoaovb563r4k.js";import{t as De}from"./oxont9zeuaiwb679.js";import{C as K,T as Le}from"./cca0236s2s07nwln.js";import{g as Se}from"./bj1ejin6tzi0v3v8.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./l09h2qppleubii6l.js";import"./m5btqmw2ud0umdwr.js";import"./mstl8wgfzorpgdoe.js";import"./f2sn8zvpzei2915e.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./ieglwgr2zyuektzv.js";import"./deakbbf27g8e7ba0.js";import"./j1qri9ykgswuwttk.js";import"./g3lybt7hj0s143gw.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./nwdwrv5b1h68xdm5.js";import"./b2l059fz4znz94nm.js";function Ae({textdocVersion:r,clientThreadId:n}){const{handleCopy:c,copyLabel:m}=ve({textdocVersion:r,clientThreadId:n}),d=!Q();return e.jsx(ie,{onCopy:c,className:"px-1.5 py-1",iconClassName:j("icon-md",!d&&"hidden"),iconOnly:d,buttonText:d?void 0:m})}function Re({textdocVersion:r,isDisabled:n=!1,clientThreadId:c}){const m=B(),{handleFileDownload:d,handleBlobDownload:f,isLoading:u,downloadCopyLabel:t,isDocument:s}=ke({textdocVersion:r,clientThreadId:c});return n||(n=u||!r||r.type===ce.LOADING),s?e.jsxs(y.Root,{open:!u&&!n?void 0:!1,children:[e.jsx(y.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:t,children:e.jsx(_,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{align:"end",children:[e.jsx(y.Item,{onClick:l=>{l.preventDefault(),d("pdf")},children:m.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(y.Item,{onClick:l=>{l.preventDefault(),d("docx")},children:m.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(y.Item,{onClick:l=>{l.preventDefault(),d("md")},children:m.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:t,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:e.jsx(_,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:n,onClick:f,children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function qe({onClick:r}){const n=B();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:r,children:[e.jsx(N,{label:e.jsx(T,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(me,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:n.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Fe({onClick:r,disabled:n,isCodePreviewable:c}){const d=B().formatMessage(c?G.previewCode:G.runCode);return n?e.jsx(J,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(N,{label:e.jsx(T,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(z,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d})]})}):e.jsxs(J,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:r,disabled:!1,children:[e.jsx(N,{label:e.jsx(T,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(z,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d})]})}var A,X;function He(){if(X)return A;X=1;var r=xe(),n=Me(),c=we(),m=parseFloat,d=Math.min,f=Math.random;function u(t,s,l){if(l&&typeof l!="boolean"&&n(t,s,l)&&(s=l=void 0),l===void 0&&(typeof s=="boolean"?(l=s,s=void 0):typeof t=="boolean"&&(l=t,t=void 0)),t===void 0&&s===void 0?(t=0,s=1):(t=c(t),s===void 0?(s=t,t=0):s=c(s)),t>s){var a=t;t=s,s=a}if(l||t%1||s%1){var h=f();return d(t+h*(s-t+m("1e-"+((h+"").length-1))),s)}return r(t,s)}return A=u,A}var We=He();const _e=re(We),ze=({isCanvasHovered:r=!1,onClick:n})=>{const c=B();return e.jsx(N,{label:c.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(ge,{color:r?"primary":"secondary",icon:Be,onClick:n})})},Ge=({textdocId:r,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,marginBottom:u,size:t="large",height:s=t==="large"?"22rem":"10rem",minHeight:l,isCanvasOpen:a=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:D=!1,isInlinePreview:o=!1,isStreaming:g=!1,isUserMessage:v=!1,onClick:p,onPreview:L,children:S})=>{const M=E.useRef(null),[k,R]=E.useState(!1),[V]=E.useState(()=>_e(100,180,!1)),P=U(),w=fe(r),I=Ce(n),i=Ee(w==null?void 0:w.versions),x=$(P),C=!x,O=w==null&&I===void 0,ee=i==null||g,q=!!i&&je(i.type,i.content),te=!!i&&ye(i.type),ae=q||te,F=b&&a&&f!=null?f:d,se=F?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!k}),children:F}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(Y,{lines:1,size:"base",width:100,widthVariance:0})}),H=i!=null&&i.type&&ue(i.type)?le(i.type):void 0,W=!c||D?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:V},children:e.jsx(Y,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":x}),children:c}),x&&H&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",H]})]}),ne=()=>{!M.current||h||(he.logButtonClick(pe.MESSAGE_ATTACHMENT,{type:m}),be(M.current),p==null||p())},oe=Q();return e.jsxs(Z.div,{role:C?"button":void 0,id:Se(r),initial:{opacity:g?0:1,scale:g?.9:1},animate:{opacity:1,scale:1},transition:x?{type:"spring",bounce:0,damping:60}:{type:"spring",bounce:0},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",x?"overflow-visible":"overflow-hidden",h?"cursor-default":C?"cursor-pointer":"cursor-text",{"select-none":C,"border-token-text-tertiary font-medium dark:border-gray-600":b&&a,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":a||!o,"rounded-3xl":!a&&o,"max-w-full":!v&&(a||!o),"max-w-[var(--user-chat-width,70%)]":v&&(a||!o),[oe?"w-full":"".concat(De.tableContainer," rounded-none")]:!v&&!a&&o,"w-[var(--user-chat-width,70%)]":v&&!a&&o,"w-full pt-1 pb-3 sm:max-w-none":o&&x}),onMouseEnter:()=>!h&&R(!0),onMouseLeave:()=>R(!1),onClick:()=>C?ne():void 0,ref:M,style:{marginBottom:u,height:o&&!a?s:void 0,minHeight:o&&!a?l:void 0,width:t==="small"?"300px":void 0},children:[!(x&&o)&&e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!k&&!b,"border-token-border-heavy":k&&!b,"text-token-text-primary text-sm font-medium":!a&&k&&o,"py-2":a||!o,"py-3":!x&&!a&&o,"text-token-text-secondary text-sm font-medium":!a&&!k&&o,"pt-0 pb-2 sm:px-6":x}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":a||!o,"gap-3.5":!a&&o}),children:[!x&&se,W]}),a?e.jsx(Z.span,{animate:g?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:g&&e.jsx(de,{gap:1,padding:0})}):e.jsx(ze,{isCanvasHovered:k,onClick:p})]}),x&&o&&!h?e.jsx("div",{className:"@w-xl/main:top-0 sticky top-(--header-height) z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:j("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:W}),e.jsx("div",{className:"flex items-center justify-end",children:O&&!a?e.jsxs("span",{className:"bg-token-surface-tertiary/40 text-token-text-tertiary inline-flex items-center px-2.5 py-0.5 text-xs font-normal",children:[e.jsx(Te,{className:"me-1 h-3 w-3 shrink-0"}),e.jsx(T,{id:"m8Uz8Y",defaultMessage:"Canvas is not supported in shared conversations"})]}):x&&!a?e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ae,{textdocVersion:i!=null?i:null,clientThreadId:n})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(qe,{onClick:p})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Re,{isDisabled:ee,textdocVersion:i!=null?i:null,clientThreadId:n})}),ae&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Fe,{isCodePreviewable:q,disabled:g,onClick:L})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!a&&S,o&&!a&&!x&&e.jsx(K,{size:t,position:"bottom"}),o&&t==="small"&&!a&&!x&&e.jsx(K,{size:t,position:"right"})]})]})},ht=({textdocId:r,clientThreadId:n,name:c,tag:m,icon:d,iconSelected:f,isCanvasOpen:u=!1,isFetching:t=!1,isFocused:s=!1,isInlinePreview:l=!1,isStreaming:a=!1,isUserMessage:h=!1,onClick:b,onPreview:D})=>{const[o,g]=E.useState(!1),v=U(),p=$(v),L=M=>{g(M>0)},S=l&&!u?16:12;return e.jsx(Ge,{textdocId:r,name:c,tag:m,icon:d,height:p?"auto":void 0,iconSelected:f,marginBottom:S,isCanvasOpen:u,isFocused:s,isInlinePreview:l,isStreaming:a,isUserMessage:h,onClick:b,onPreview:D,clientThreadId:n,children:l&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":o,"border-transparent":!o}),children:t&&!(p&&a)?e.jsx(Ne,{numLines:20}):!!r&&e.jsx(Le,{disableScroll:p,onScroll:L,textdocId:r,clientThreadId:n})})})};export{ht as CanvasMessageAttachment,Ge as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=eyfrni5t2e7z7udl.js.map
