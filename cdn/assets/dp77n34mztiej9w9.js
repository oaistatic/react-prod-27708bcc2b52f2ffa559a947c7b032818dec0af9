var fe=Object.defineProperty,pe=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var le=a=>{throw TypeError(a)};var ce=(a,e,t)=>e in a?fe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,L=(a,e)=>{for(var t in e||(e={}))ve.call(e,t)&&ce(a,t,e[t]);if(de)for(var t of de(e))we.call(e,t)&&ce(a,t,e[t]);return a},O=(a,e)=>pe(a,me(e));var ue=(a,e,t)=>e.has(a)||le("Cannot "+t);var d=(a,e,t)=>(ue(a,e,"read from private field"),t?t.call(a):e.get(a)),j=(a,e,t)=>e.has(a)?le("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),$=(a,e,t,s)=>(ue(a,e,"write to private field"),s?s.call(a,t):e.set(a,t),t);import{h as ye,c as K,b as z,a as be}from"./fg33krlcm0qyi6yw.js";import{r as ke}from"./fc76377xmf89lezj.js";import{fA as J,eD as X}from"./mtk1qztvnb31pw5r.js";import{a as Ee}from"./sy1xvqwioh9ks4z8.js";const He={new:{id:"aardvark.status.new",defaultMessage:"New",description:"New status"},triaged:{id:"aardvark.status.triaged",defaultMessage:"Triaged",description:"Triaged status"},in_progress:{id:"aardvark.status.inProgress",defaultMessage:"In progress",description:"In progress status"},fixed:{id:"aardvark.status.fixed",defaultMessage:"Fixed",description:"Fixed status"},wontfix:{id:"aardvark.status.wontfix",defaultMessage:"Won't fix",description:"Won't fix status"},duplicate:{id:"aardvark.status.duplicate",defaultMessage:"Duplicate",description:"Duplicate status"}},Ne={critical:{id:"aardvark.crit.critical",defaultMessage:"Critical",description:"Critical severity"},high:{id:"aardvark.crit.high",defaultMessage:"High",description:"High severity"},medium:{id:"aardvark.crit.medium",defaultMessage:"Medium",description:"Medium severity"},low:{id:"aardvark.crit.low",defaultMessage:"Low",description:"Low severity"}},De={none:{id:"aardvark.assignee.none",defaultMessage:"None",description:"None assignee option label"}},je={search:{id:"aardvark.filter.assignee.search",defaultMessage:"Search by name or email",description:"Search assignees by name or email"}},$e={success:{id:"aardvark.proposedPatch.generation.validation.success",defaultMessage:"Success",description:"Badge label indicating the patch generation or validation is successful."},failed:{id:"aardvark.proposedPatch.generation.validation.failed",defaultMessage:"Failed",description:"Badge label indicating the patch generation or validation is failed."},pending:{id:"aardvark.proposedPatch.generation.validation.pending",defaultMessage:"Pending",description:"Badge label indicating the patch generation or validation is pending."},running:{id:"aardvark.proposedPatch.generation.validation.running",defaultMessage:"Running",description:"Badge label indicating the patch generation or validation is running."},unknown:{id:"aardvark.proposedPatch.generation.validation.unknown",defaultMessage:"Unknown",description:"Badge label indicating the patch generation or validation is unknown."}},We={security:{id:"aardvark.finding.signal.security",defaultMessage:"Security",description:"Security signal"},privacy:{id:"aardvark.finding.signal.privacy",defaultMessage:"Privacy",description:"Privacy signal"},validated:{id:"aardvark.finding.signal.validated",defaultMessage:"Validated",description:"Validated signal"},patch:{id:"aardvark.finding.signal.patch",defaultMessage:"Patch generated",description:"Short chip label used in the findings list under the Vulnerability column and in the metadata Signals section to show that Aardvark generated a proposed patch for this finding. Audience: security reviewers scanning dense tables, so the label must stay a single short word with no punctuation. When present, it indicates has_patch=true; when absent, no patch is available."},attackpath:{id:"aardvark.finding.signal.attackpath",defaultMessage:"Attack-path",description:"Attack-path generated signal"}},Ue={committedHeader:{id:"aardvark.table.committedHeader",defaultMessage:"Committed",description:"Committed header"},detectedHeader:{id:"aardvark.table.detectedHeader",defaultMessage:"Detected",description:"Detected header"}},Be={githubConnectionNotEnabled:{id:"aardvark.toast.githubConnectionNotEnabled",defaultMessage:"GitHub connection is not enabled. Please contact your workspace admin.",description:"Toast message shown when GitHub connection is not enabled"},statusUpdate:{id:"aardvark.toast.statusError",defaultMessage:"Failed to update status: {details}",description:"Toast message shown when updating a finding's status fails"},assigneeUpdate:{id:"aardvark.toast.assigneeError",defaultMessage:"Failed to update assignee: {details}",description:"Toast message shown when updating the assignee fails"},scanSettingsSave:{id:"aardvark.toast.scanSettingsError",defaultMessage:"Failed to save scan settings: {details}",description:"Toast shown when saving scan settings fails"},findingsLoad:{id:"aardvark.toast.findingsLoadError",defaultMessage:"Failed to load findings: {details}",description:"Toast shown when the findings table fails to load"},recommendedLoad:{id:"aardvark.toast.recommendedLoadError",defaultMessage:"Failed to load recommended findings: {details}",description:"Toast shown when the recommended list fails to load"},findingLoad:{id:"aardvark.toast.findingLoadError",defaultMessage:"Failed to load finding: {details}",description:"Toast shown when the finding details page fails to load"},scanConfigLoad:{id:"aardvark.toast.scanConfigLoadError",defaultMessage:"Failed to load scan configurations: {details}",description:"Toast shown when scan configurations cannot be retrieved"},accessibleReposLoad:{id:"aardvark.toast.accessibleReposLoadError",defaultMessage:"Failed to load repositories: {details}",description:"Error toast on the Aardvark findings page when the repository dropdown cannot load accessible repositories from /aardvark/scan-findings/list-accessible-repos. Audience: workspace members browsing findings; tone is urgent but concise. Shown as a single-line toast notification triggered immediately after the fetch fails. Placeholder {details} is the raw error detail string from the API and might be empty or a technical status message; show it verbatim."},githubConnection:{id:"aardvark.toast.githubConnectionError",defaultMessage:"GitHub connection error: {details}",description:"Toast shown on the Aardvark scans page when the GitHub connector fails to initialize through usePlatformConnector (for example when the connector service is unavailable or an auth handshake fails). Audience: workspace members trying to connect GitHub to configure scans; tone is urgent and concise. This is a single-line toast triggered as soon as the connector hook reports an error; no Markdown or HTML is supported. Placeholder {details} is the raw connector error message string returned from the hook; it may be empty or a technical error code—render it exactly as provided and allow it to be blank without substituting fallback text."},githubInstallationsLoad:{id:"aardvark.toast.githubInstallationsError",defaultMessage:"Failed to load GitHub installations: {details}",description:"Error toast on the Aardvark scans page when the GitHub installations list cannot be fetched via useWhamGithubInstallationsV2 while rendering the connected repositories section. Audience: workspace members configuring scans; tone should be urgent but concise. Appears as a single-line toast fired immediately after the fetch fails; no Markdown/HTML allowed. Placeholder {details} is the raw error detail string returned from the request and may be empty or a technical status message—display it verbatim even when empty."},githubRepositoriesLoad:{id:"aardvark.toast.githubRepositoriesError",defaultMessage:"Failed to load GitHub repositories: {details}",description:"Error toast on the Aardvark scans page when fetching the repository list for a selected GitHub installation fails in the connected repositories table (useInfiniteQuery pagination). Audience: workspace members reviewing or configuring scans; tone is urgent and concise. The toast is single-line and triggers immediately after the fetch error, including during paginated loads; no Markdown/HTML formatting. Placeholder {details} is the raw error message string from the failed request and may be empty or technical—render it exactly as provided and allow it to be blank."},githubConnectionInline:{id:"aardvark.home.connectGithub.error",defaultMessage:"We're having trouble connecting to GitHub right now. See console for full error details.",description:"Inline message shown on the Connect GitHub card when the connector is down"},recommendedMissingScan:{id:"aardvark.recommended.missingScan",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Inline error shown when no configured scan exists for the selected repo"},recommendedMissingScanToast:{id:"aardvark.recommended.missingScan.toast",defaultMessage:"We couldn't find a configured scan for the selected repository.",description:"Toast shown when no configured scan exists for the selected repo"},findingNotFound:{id:"aardvark.finding.details.notFound",defaultMessage:"Finding not found",description:"Message shown when the finding details page fails to load because the finding ID is invalid"}},Se=["application/json","application/vnd.apache.arrow.stream"];function Ce(a){return Se.includes(a)}function re(a){const e={};for(const[t,s]of Object.entries(a))s!=null&&(e[t]="".concat(s));return e}function _e(a,e){for(const[t,s]of Object.entries(e))a=a.replace("{".concat(t,"}"),s);return a}var q,W,U,I,F,H;const Y=class Y{constructor(e,t,s,i,n,o){j(this,q);j(this,W);j(this,U);j(this,I);j(this,F);j(this,H);var v,c;if(/\/+$/.test(s))throw new Error("The prefix is not allowed to have trailing slashes");if(/\/+$/.test(t))throw new Error("The baseUrl is not allowed to have trailing slashes");$(this,W,s),$(this,H,t),$(this,U,i),$(this,I,n),$(this,q,e),$(this,F,{fetchFn:(v=o==null?void 0:o.fetchFn)!=null?v:fetch.bind(globalThis),onContentTypeError:(c=o==null?void 0:o.onContentTypeError)!=null?c:(()=>{})})}withProduces(e){return new Y(d(this,q),d(this,H),d(this,W),e,d(this,I),d(this,F))}withConsumes(e){return new Y(d(this,q),d(this,H),d(this,W),d(this,U),e,d(this,F))}withPrefix(e){return new Y(d(this,q),d(this,H),e,d(this,U),d(this,I),d(this,F))}async _request(e,t,s,i){var k,m,w,f,p,E,S,C,_,M;let n=new URLSearchParams(re((k=s==null?void 0:s.query)!=null?k:{})).toString();n&&(n="?"+n);const o=d(this,H)+d(this,W)+t,v=s==null?void 0:JSON.stringify(s.body),c=v?{"Content-Type":d(this,U)}:null,l=await d(this,F).fetchFn(_e(o,re((m=s==null?void 0:s.path)!=null?m:{}))+n,O(L({credentials:"same-origin"},i!=null?i:{}),{method:e,headers:O(L(L(O(L({},c!=null?c:{}),{Accept:d(this,I)}),(w=i==null?void 0:i.headers)!=null?w:{}),re((f=s==null?void 0:s.headers)!=null?f:{})),{"X-OpenAI-Client":d(this,q)}),body:v})),g=l.headers.get("Content-Type");if(!g)throw(E=(p=d(this,F)).onContentTypeError)==null||E.call(p,l),new Error("Content-Type was not provided with the response");if(!Ce(g))throw(C=(S=d(this,F)).onContentTypeError)==null||C.call(S,l),new Error("Unsupported return content type ".concat(g));if(g!==d(this,I))throw(M=(_=d(this,F)).onContentTypeError)==null||M.call(_,l),new Error("Return content type ".concat(g," was provided but this client only accepts ").concat(d(this,I),"."));switch(g){case"application/json":const y=await l.json();return{status:l.status,data:y,raw:l};case"application/vnd.apache.arrow.stream":const b=await l.arrayBuffer();return{status:l.status,data:b,raw:l}}}async get(e,...t){return await this._request("GET",e,...t)}async post(e,...t){return await this._request("POST",e,...t)}async put(e,...t){return await this._request("PUT",e,...t)}async patch(e,...t){return await this._request("PATCH",e,...t)}async delete(e,...t){return await this._request("DELETE",e,...t)}async head(e,...t){return await this._request("HEAD",e,...t)}};q=new WeakMap,W=new WeakMap,U=new WeakMap,I=new WeakMap,F=new WeakMap,H=new WeakMap;let oe=Y;class Z extends oe{constructor(e,t){super("aardvark",e,"","application/json","application/json",t)}}var Me=ke();const Qe=ye(Me);function Te(a){var e;if(!(typeof a!="object"||a===null)&&typeof((e=a.error)==null?void 0:e.message)=="string")return a.error.message}function ee(a,e){var i,n;const t=Te(e),s=t!=null?t:"".concat(a," ").concat((n=(i=e.error)==null?void 0:i.code)!=null?n:"");return new Error(s)}function Ke(a){var s;if(a instanceof Ee)return a.payload.message;const e=(s=a==null?void 0:a.message)!=null?s:"";if(e.trim().startsWith("500"))return"Internal server error. Check console for details.";const t=140;return e.length>t?e.slice(0,t)+"...":e}const T=a=>a.split(",").map(e=>e.trim()).filter(e=>e&&e.toLowerCase()!=="all"),he=()=>["aardvark","scan-findings","accessible-repos"],ge=async a=>{const t=await new Z(J).get("/aardvark/scan-findings/list-accessible-repos",{headers:X(),query:{force_refresh:a}});if(t.status!==200)throw ee(t.status,t.data);return t.data};function Ve(){"use forget";const a=K.c(1);let e;return a[0]===Symbol.for("react.memo_cache_sentinel")?(e={queryKey:he(),queryFn:Ae,staleTime:3e6,refetchOnWindowFocus:!0},a[0]=e):e=a[0],z(e)}function Ae(){return ge(!1)}function Oe(){"use forget";const a=K.c(2),e=be();let t;return a[0]!==e?(t=async s=>{const i=await ge(s);return e.setQueryData(he(),i),i},a[0]=e,a[1]=t):t=a[1],t}function Fe(a){"use forget";var s,i,n,o,v,c,l,g,k;const e=K.c(42);let t;e:{if(!a){let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=[],e[0]=h):h=e[0];let r;e[1]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[1]=r):r=e[1];let N;e[2]===Symbol.for("react.memo_cache_sentinel")?(N=[],e[2]=N):N=e[2];let D;e[3]===Symbol.for("react.memo_cache_sentinel")?(D=[],e[3]=D):D=e[3];let B;e[4]===Symbol.for("react.memo_cache_sentinel")?(B=[],e[4]=B):B=e[4];let Q;e[5]===Symbol.for("react.memo_cache_sentinel")?(Q={repoCsv:"",repoList:h,validationFilter:"all",patchFilter:"all",statusesCsv:"",statusList:r,critCsv:"",criticalityList:N,assigneesCsv:"",assigneeList:D,assigneeEmailsCsv:"",assigneeEmailList:B,authorsCsv:"",authorList:[],sortParam:"",pathPrefixesCsv:"",queryText:""},e[5]=Q):Q=e[5],t=Q;break e}let m,w,f,p,E,S,C,_,M,y,b,A,u,G,P,R,x;if(e[6]!==a){const h=new URLSearchParams(a),r=(s=h.get("repo"))!=null?s:"",N=h.get("validated"),D=h.get("has_patch"),B=N==="true"?"validated":N==="false"?"unvalidated":"all",Q=D==="true"?"with_patch":D==="false"?"without_patch":"all",te=(i=h.get("status"))!=null?i:"",ae=(n=h.get("criticality"))!=null?n:"",se=(o=h.get("assignee"))!=null?o:"",ie=(v=h.get("assignee_email"))!=null?v:"",ne=(c=h.get("author"))!=null?c:"";f=(l=h.get("sort"))!=null?l:"",m=(g=h.get("path_prefix"))!=null?g:"",w=(k=h.get("q"))!=null?k:"",p=r,y=r?T(r):[],b=B,A=Q,u=te,G=te?T(te):[],P=ae,R=ae?T(ae):[],x=se,E=se?T(se):[],S=ie,C=ie?T(ie):[],_=ne,M=ne?T(ne):[],e[6]=a,e[7]=m,e[8]=w,e[9]=f,e[10]=p,e[11]=E,e[12]=S,e[13]=C,e[14]=_,e[15]=M,e[16]=y,e[17]=b,e[18]=A,e[19]=u,e[20]=G,e[21]=P,e[22]=R,e[23]=x}else m=e[7],w=e[8],f=e[9],p=e[10],E=e[11],S=e[12],C=e[13],_=e[14],M=e[15],y=e[16],b=e[17],A=e[18],u=e[19],G=e[20],P=e[21],R=e[22],x=e[23];let V;e[24]!==m||e[25]!==w||e[26]!==f||e[27]!==p||e[28]!==E||e[29]!==S||e[30]!==C||e[31]!==_||e[32]!==M||e[33]!==y||e[34]!==b||e[35]!==A||e[36]!==u||e[37]!==G||e[38]!==P||e[39]!==R||e[40]!==x?(V={repoCsv:p,repoList:y,validationFilter:b,patchFilter:A,statusesCsv:u,statusList:G,critCsv:P,criticalityList:R,assigneesCsv:x,assigneeList:E,assigneeEmailsCsv:S,assigneeEmailList:C,authorsCsv:_,authorList:M,sortParam:f,pathPrefixesCsv:m,queryText:w},e[24]=m,e[25]=w,e[26]=f,e[27]=p,e[28]=E,e[29]=S,e[30]=C,e[31]=_,e[32]=M,e[33]=y,e[34]=b,e[35]=A,e[36]=u,e[37]=G,e[38]=P,e[39]=R,e[40]=x,e[41]=V):V=e[41],t=V}return t}function Ye(a,e){"use forget";const t=K.c(31),{repoCsv:s,validationFilter:i,patchFilter:n,statusesCsv:o,critCsv:v,assigneesCsv:c,assigneeEmailsCsv:l,authorsCsv:g,sortParam:k,pathPrefixesCsv:m,queryText:w}=Fe(a),f=e==null?void 0:e.limit,p=e==null?void 0:e.cursor,E=f!=null?f:null,S=p!=null?p:null,C=k||null,_=m||null,M=w||null;let y;t[0]!==l||t[1]!==c||t[2]!==g||t[3]!==v||t[4]!==n||t[5]!==s||t[6]!==o||t[7]!==E||t[8]!==S||t[9]!==C||t[10]!==_||t[11]!==M||t[12]!==i?(y=["aardvark","findings","scan",s,i,o,v,c,l,g,E,S,C,_,M,n],t[0]=l,t[1]=c,t[2]=g,t[3]=v,t[4]=n,t[5]=s,t[6]=o,t[7]=E,t[8]=S,t[9]=C,t[10]=_,t[11]=M,t[12]=i,t[13]=y):y=t[13];let b;t[14]!==l||t[15]!==c||t[16]!==g||t[17]!==v||t[18]!==p||t[19]!==f||t[20]!==n||t[21]!==m||t[22]!==w||t[23]!==s||t[24]!==k||t[25]!==o||t[26]!==i?(b=async()=>{const u={},G=typeof f=="number"&&Number.isFinite(f)&&f>0?f:500,P=typeof p=="number"&&Number.isFinite(p)&&p>=0,R=P?p:0;if(u.limit=String(G),P&&(u.cursor=String(R)),s){const r=T(s);r.length>0&&(u.repo=r.join(","))}if(i==="validated"?u.validated="true":i==="unvalidated"&&(u.validated="false"),n==="with_patch"?u.has_patch="true":n==="without_patch"&&(u.has_patch="false"),k&&(u.sort=k),o){const r=T(o);r.length>0&&(u.status=r.join(","))}if(v){const r=T(v);r.length>0&&(u.criticality=r.join(","))}if(c){const r=T(c);r.length>0&&(u.assignee=r.join(","))}if(l){const r=T(l);r.length>0&&(u.assignee_email=r.join(","))}if(g){const r=T(g);r.length>0&&(u.author=r.join(","))}if(m){const r=T(m);r.length>0&&(u.path_prefix=r.join(","))}const x=w.trim();x&&(u.q=x);const h=await new Z(J).get("/aardvark/scan-findings",{headers:X(),query:u});if(h.status!==200)throw ee(h.status,h.data);return h.data},t[14]=l,t[15]=c,t[16]=g,t[17]=v,t[18]=p,t[19]=f,t[20]=n,t[21]=m,t[22]=w,t[23]=s,t[24]=k,t[25]=o,t[26]=i,t[27]=b):b=t[27];let A;return t[28]!==y||t[29]!==b?(A={queryKey:y,queryFn:b,staleTime:3e4,refetchOnWindowFocus:!0},t[28]=y,t[29]=b,t[30]=A):A=t[30],z(A)}function ze(a){"use forget";const e=K.c(8),t=a!=null?a:null;let s;e[0]!==t?(s=["aardvark","findings","recommended",t],e[0]=t,e[1]=s):s=e[1];const i=!!t;let n;e[2]!==t?(n=async()=>{var l,g,k,m,w;if(!t)throw new Error("No configured scan id found for recommended findings");const c=await new Z(J).get("/aardvark/rankings",{headers:X(),query:{configured_scan_id:t}});if(c.status!==200)throw ee(c.status,c.data);return{items:(g=(l=c.data.ranking_item_list)==null?void 0:l.map(Le))!=null?g:[],total:(m=(k=c.data.ranking_item_list)==null?void 0:k.length)!=null?m:0,ranking_end_time:(w=c.data.ranking_end_time)!=null?w:null}},e[2]=t,e[3]=n):n=e[3];let o;return e[4]!==s||e[5]!==i||e[6]!==n?(o={queryKey:s,enabled:i,queryFn:n,staleTime:3e4,refetchOnWindowFocus:!0},e[4]=s,e[5]=i,e[6]=n,e[7]=o):o=e[7],z(o)}function Le(a){return a}function Je(a){"use forget";const e=K.c(2);let t;return e[0]!==a?(t={queryKey:["aardvark","finding",a],queryFn:async()=>{const i=await new Z(J).get("/aardvark/scan-findings/{id}",{headers:X(),path:{id:a}});if(i.status!==200)throw ee(i.status,i.data);return i.data},staleTime:3e4,refetchInterval:Pe,refetchIntervalInBackground:!0,refetchOnWindowFocus:!0},e[0]=a,e[1]=t):t=e[1],z(t)}function Pe(a){const e=a.state.data,t=e==null?void 0:e.proposed_patch;return t?t.status!=="finished"?5e3:t.status==="finished"&&t.success!==!0?1e4:!1:!1}function Xe(a,e,t){a.setQueriesData({queryKey:["aardvark","findings"],exact:!1},s=>{var n;if(!s)return s;const i=((n=s.items)!=null?n:[]).map(o=>o.hid===e?L(L({},o),t):o);return O(L({},s),{items:i})})}function Ze(a,e,t){a.setQueryData(["aardvark","finding",e],s=>s&&L(L({},s),t))}export{je as A,Ne as C,Be as E,We as F,$e as P,He as S,De as a,Z as b,Ze as c,he as d,Ke as e,Qe as f,ee as g,Oe as h,Ve as i,Ye as j,Ue as k,ze as l,Xe as p,Je as u};
//# sourceMappingURL=dp77n34mztiej9w9.js.map
