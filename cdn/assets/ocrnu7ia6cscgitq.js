var es=Object.defineProperty,ns=Object.defineProperties;var rs=Object.getOwnPropertyDescriptors;var Tt=Object.getOwnPropertySymbols;var ts=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable;var Ct=(e,n,t)=>n in e?es(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,He=(e,n)=>{for(var t in n||(n={}))ts.call(n,t)&&Ct(e,t,n[t]);if(Tt)for(var t of Tt(n))os.call(n,t)&&Ct(e,t,n[t]);return e},gn=(e,n)=>ns(e,rs(n));import{h as Xr,c as Kr,j as ve,r as S,k as ss,d as In,e as is}from"./fg33krlcm0qyi6yw.js";import{_ as fs,nh as us,na as ls,nc as cs,nb as as,n9 as gs,l as hs,da as ds}from"./mtk1qztvnb31pw5r.js";import{C as Fe,R as Pe,F as no,p as qn,a as Sr,e as ye,r as Oe,f as vs,g as Tn,c as ps,d as ws,b as Es}from"./fmwvxydiodjqi0t8.js";import{A as wr}from"./f96c6fguu1kcw0go.js";import{a as ms,u as Ns,S as As}from"./jk107mwxn0lro4xz.js";import{d4 as Rs}from"./k65njl5wlgspihfr.js";import{A as Is}from"./mr025ud04jb4rh0r.js";import{A as ys}from"./jkdx73dfg7n0gxrn.js";import{u as Ms}from"./gi9hyxr9tw3nqr5l.js";import{o as Ts}from"./hwa6pbq6i57ntwuh.js";import{k as Cs}from"./ej6tlexkw0sv7caa.js";import"./nb22pb07i8ebbv0i.js";const Ds=Cs("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");function Os(e,n,t,r,s,c){const a=n.current;if(!a||t.current)return;const g=a.getBoundingClientRect(),h=e.clientX-g.left,f=e.clientY-g.top,o=a.scrollLeft+h/r,i=a.scrollTop+f/r,u=i>=0&&i<=Fe,l=o>=0&&o<=Pe,d=[0];for(let m=0;m<s.length;m++)d[m+1]=d[m]+s[m];const v=[0];for(let m=0;m<c.length;m++)v[m+1]=v[m]+c[m];let p="";const E=4/Math.max(r,1e-4);if(u){const m=o-Pe;if(m>=0)for(let w=1;w<d.length;w++){const N=d[w];if(Math.abs(N-m)<=E){p="col-resize";break}}}else if(l){const m=i-Fe;if(m>=0)for(let w=1;w<v.length;w++){const N=v[w];if(Math.abs(N-m)<=E){p="row-resize";break}}}try{a.style.cursor=p}catch(m){}}function Ls(e){var t;const n=new Map;for(const r of(t=e.sharedFormulas)!=null?t:[])typeof r.si=="number"&&r.base&&r.anchor&&n.set(r.si,{base:r.base,anchor:r.anchor});return n}const ro=/([$]?[A-Z]+[$]?\d+)/g;function Fs(e){var n;return Array.from(new Set((n=e.match(ro))!=null?n:[]))}function Ps(e,n){var he,le,fe;const{containerRef:t,canvasRef:r,zoom:s,viewColWidths:c,rowHeights:a,selectionStartRef:g,selectionEndRef:h,setSelectionRect:f,setIsDragging:o,redrawSelectionOverlay:i,setResizeGuide:u,resizingRef:l,setColSizeOverrides:d,setRowSizeOverrides:v,redraw:p,setSelectedAddr:E,setSelectedRow:m,sheet:w}=n,N=t.current,A=r.current;if(!A||!N)return;try{N.focus()}catch(re){}const I=A.getBoundingClientRect(),y=e.clientX-I.left,T=e.clientY-I.top,C=N.scrollLeft+y/s,V=N.scrollTop+T/s,H=V>=0&&V<=Fe,B=C>=0&&C<=Pe,X=[0];for(let re=0;re<c.length;re++)X[re+1]=X[re]+c[re];const te=[0];for(let re=0;re<a.length;re++)te[re+1]=te[re]+a[re];const ue=4/Math.max(s,1e-4),we=20,Y=12;if(H){const re=C-Pe;if(re>=0){let de=-1;for(let J=1;J<X.length;J++){const ae=X[J];if(Math.abs(ae-re)<=ue){de=J;break}}if(de>0){e.preventDefault();const J=de-1,ae=(he=c[J])!=null?he:no;l.current={type:"col",index:J,startClientX:e.clientX,startClientY:e.clientY,startSize:ae};const Ne=Pe+X[J]-N.scrollLeft;u({type:"col",pos:Ne+ae});const ge=O=>{const L=l.current;if(!L||L.type!=="col")return;const U=(O.clientX-L.startClientX)/s,F=Math.max(we,L.startSize+U),x=Pe+X[L.index]-N.scrollLeft;u({type:"col",pos:x+F}),i()},M=O=>{window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",M);const L=l.current;l.current=null;const U=L?(O.clientX-L.startClientX)/s:0,F=L?Math.max(we,L.startSize+U):void 0;u(null),L&&typeof F=="number"&&(d(x=>gn(He({},x),{[L.index]:F})),p(),i());try{N.style.cursor=""}catch(x){}};window.addEventListener("mousemove",ge),window.addEventListener("mouseup",M);try{N.style.cursor="col-resize"}catch(O){}return}}}if(B){const re=V-Fe;if(re>=0){let de=-1;for(let J=1;J<te.length;J++){const ae=te[J];if(Math.abs(ae-re)<=ue){de=J;break}}if(de>0){e.preventDefault();const J=de-1,ae=(le=a[J])!=null?le:qn(Sr);l.current={type:"row",index:J,startClientX:e.clientX,startClientY:e.clientY,startSize:ae};const Ne=Fe+te[J]-N.scrollTop;u({type:"row",pos:Ne+ae});const ge=O=>{const L=l.current;if(!L||L.type!=="row")return;const U=(O.clientY-L.startClientY)/s,F=Math.max(Y,L.startSize+U),x=Fe+te[L.index]-N.scrollTop;u({type:"row",pos:x+F}),i()},M=O=>{window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",M);const L=l.current;l.current=null;const U=L?(O.clientY-L.startClientY)/s:0,F=L?Math.max(Y,L.startSize+U):void 0;u(null),L&&typeof F=="number"&&(v(x=>gn(He({},x),{[L.index]:F})),p(),i());try{N.style.cursor=""}catch(x){}};window.addEventListener("mousemove",ge),window.addEventListener("mouseup",M);try{N.style.cursor="row-resize"}catch(O){}return}}}const _=N.scrollLeft+y/s-Pe,ne=N.scrollTop+T/s-Fe;if(_<0||ne<0)return;let ie=0,G=0;for(;G<c.length&&ie+c[G]<=_;)ie+=c[G],G++;ie=0;let oe=0;for(;oe<a.length&&ie+a[oe]<=ne;)ie+=a[oe],oe++;{const de=((fe=w.mergedCells)!=null?fe:[]).find(J=>{const ae=ye(J.startAddress),Ne=Oe(J.startAddress),ge=ye(J.endAddress),M=Oe(J.endAddress),O=Math.min(ae,ge),L=Math.max(ae,ge),U=Math.min(Ne,M),F=Math.max(Ne,M);return G>=O&&G<=L&&oe>=U&&oe<=F});if(de){const J=ye(de.startAddress),ae=Oe(de.startAddress),Ne=ye(de.endAddress),ge=Oe(de.endAddress),M=Math.min(J,Ne),O=Math.min(ae,ge);G=M,oe=O}E("".concat(vs(G)).concat(oe+1)),m(oe)}const q={row:oe,col:G};g.current=q,h.current=q,f({r1:q.row,c1:q.col,r2:q.row,c2:q.col}),o(!0),i();const k=re=>{const de=t.current,J=r.current;if(!de||!J)return;const ae=J.getBoundingClientRect(),Ne=re.clientX-ae.left,ge=re.clientY-ae.top,M=de.scrollLeft+Ne/s-Pe,O=de.scrollTop+ge/s-Fe;if(M<0||O<0)return;let L=0,U=0;for(;U<c.length&&L+c[U]<=M;)L+=c[U],U++;let F=0,x=0;for(;x<a.length&&F+a[x]<=O;)F+=a[x],x++;U=Math.max(0,Math.min(U,c.length-1)),x=Math.max(0,Math.min(x,a.length-1)),h.current={row:x,col:U},f({r1:Math.min(q.row,x),c1:Math.min(q.col,U),r2:Math.max(q.row,x),c2:Math.max(q.col,U)}),i()},j=()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",j),o(!1)};window.addEventListener("mousemove",k),window.addEventListener("mouseup",j)}function Vs(e){var u,l,d,v,p,E,m,w,N,A,I,y,T,C,V,H,B,X,te,ue,we;const{selectionRect:n,selRow:t,selCol:r,sheet:s,styleInfos:c}=e,a=new Map,g=n!=null?n:{r1:t,c1:r,r2:t,c2:r},h=g.r2-g.r1+1,f=g.c2-g.c1+1,o=Array.from({length:h},()=>Array.from({length:f},()=>({})));for(let Y=g.r1;Y<=g.r2;Y++){const _=s.rows.find(ne=>ne.index-1===Y);for(let ne=g.c1;ne<=g.c2;ne++){const ie=_==null?void 0:_.cells.find(re=>ye(re.address)===ne),G=(l=c[(u=ie==null?void 0:ie.styleIndex)!=null?u:0])!=null?l:{},oe=Y-g.r1,q=ne-g.c1,k={};k.v=ie?Tn(ie,c,a):"";const j=typeof((d=G.font)==null?void 0:d.size)=="number"&&G.font.size>0?G.font.size*72/96:void 0,he=G.align==="left"||G.align==="center"||G.align==="right"?G.align:void 0,le=G.verticalAlign===wr.ANCHOR_TYPE_TOP?"top":G.verticalAlign===wr.ANCHOR_TYPE_MIDDLE?"middle":(G.verticalAlign===wr.ANCHOR_TYPE_BOTTOM,"bottom");k.fmt={bold:(v=G.font)==null?void 0:v.bold,italic:(p=G.font)==null?void 0:p.italic,color:(m=G.textColor)!=null?m:(E=G.font)==null?void 0:E.color,bg:G.fill,align:he,valign:le,numFmt:G.numberFormatCode,fontFamily:(w=G.font)==null?void 0:w.family,fontSizePt:j,border:{top:(N=G.borderStyles)!=null&&N.top?{style:G.borderStyles.top,color:(A=G.borders)==null?void 0:A.top}:void 0,right:(I=G.borderStyles)!=null&&I.right?{style:G.borderStyles.right,color:(y=G.borders)==null?void 0:y.right}:void 0,bottom:(T=G.borderStyles)!=null&&T.bottom?{style:G.borderStyles.bottom,color:(C=G.borders)==null?void 0:C.bottom}:void 0,left:(V=G.borderStyles)!=null&&V.left?{style:G.borderStyles.left,color:(H=G.borders)==null?void 0:H.left}:void 0},diagonal:(B=G.borderStyles)!=null&&B.diagonal||(X=G.borders)!=null&&X.diagonal?{style:(te=G.borderStyles)==null?void 0:te.diagonal,color:(ue=G.borders)==null?void 0:ue.diagonal,up:!!G.borderDiagonalUp,down:!!G.borderDiagonalDown}:void 0};const fe=o[oe];fe&&(fe[q]=k)}}const i=[];for(const Y of(we=s.mergedCells)!=null?we:[]){const _=Math.min(ye(Y.startAddress),ye(Y.endAddress)),ne=Math.max(ye(Y.startAddress),ye(Y.endAddress)),ie=Math.min(Oe(Y.startAddress),Oe(Y.endAddress)),G=Math.max(Oe(Y.startAddress),Oe(Y.endAddress)),oe=Math.max(g.r1,ie),q=Math.min(g.r2,G),k=Math.max(g.c1,_),j=Math.min(g.c2,ne);if(oe>q||k>j)continue;const he=oe-g.r1,le=k-g.c1,fe=q-oe+1,re=j-k+1;(fe>1||re>1)&&i.push({r:he,c:le,rowspan:fe,colspan:re})}return{rows:o,merges:i}}function qs(e){const n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return String(e!=null?e:"").replace(/[&<>"]/g,t=>{var r;return(r=n[t])!=null?r:t})}function Us(e,n){var l,d,v,p,E,m,w,N,A,I,y,T,C,V,H,B,X,te,ue,we;const t=new Map,r=new Set;for(const Y of n)t.set("".concat(Y.r,",").concat(Y.c),Y);const s=e.reduce((Y,_)=>{var ne;return Math.max(Y,(ne=_==null?void 0:_.length)!=null?ne:0)},0),c=new Array(s).fill(0),a=Y=>{const G=Y.length*7+10,oe=Math.max(20,Math.min(G,360));return Math.round(oe)};for(let Y=0;Y<e.length;Y++){const _=(d=(l=e[Y])==null?void 0:l.length)!=null?d:0;for(let ne=0;ne<_;ne++){const ie="".concat(Y,",").concat(ne);if(r.has(ie))continue;const G=t.get(ie);let oe=1;if(G){oe=Math.max(1,G.colspan);for(let le=0;le<G.rowspan;le++)for(let fe=0;fe<G.colspan;fe++)(le||fe)&&r.add("".concat(Y+le,",").concat(ne+fe))}const q=(p=(v=e[Y])==null?void 0:v[ne])!=null?p:{},k=String((E=q.v)!=null?E:"");if(!s)continue;const j=a(k),he=Math.max(1,Math.round(j/oe));for(let le=0;le<oe&&ne+le<s;le++){const fe=(m=c[ne+le])!=null?m:0;c[ne+le]=Math.max(fe,he)}}}for(let Y=0;Y<c.length;Y++){const _=c[Y];(!_||!isFinite(_))&&(c[Y]=32)}function g(Y){if(!Y)return"#000";if(/^#/i.test(Y))return Y;const _=Y.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\)$/i);if(_){const ne=Number(_[1]),ie=Number(_[2]),G=Number(_[3]),oe=q=>Math.max(0,Math.min(255,q)).toString(16).padStart(2,"0");return"#".concat(oe(ne)).concat(oe(ie)).concat(oe(G)).toUpperCase()}return Y}let h='<table style="table-layout:fixed;border-collapse:collapse;width:0px">';if(s>0){h+="<colgroup>";for(let Y=0;Y<s;Y++){const _=Math.max(1,Math.round((w=c[Y])!=null?w:0));h+='<col width="'.concat(_,'"/>')}h+="</colgroup>"}for(let Y=0;Y<e.length;Y++){h+="<tr>";const _=(A=(N=e[Y])==null?void 0:N.length)!=null?A:0;for(let ne=0;ne<_;ne++){if(r.has("".concat(Y,",").concat(ne)))continue;const ie=t.get("".concat(Y,",").concat(ne));let G="";if(ie){ie.rowspan>1&&(G+=' rowspan="'.concat(ie.rowspan,'"')),ie.colspan>1&&(G+=' colspan="'.concat(ie.colspan,'"'));for(let fe=0;fe<ie.rowspan;fe++)for(let re=0;re<ie.colspan;re++)(fe||re)&&r.add("".concat(Y+fe,",").concat(ne+re))}const oe=(y=(I=e[Y])==null?void 0:I[ne])!=null?y:{},q=(T=oe.fmt)!=null?T:{},k=[];if(q.bold&&k.push("font-weight:bold"),q.italic&&k.push("font-style:italic"),q.underline&&k.push("text-decoration:underline"),q.strike&&k.push("text-decoration:line-through"),q.color&&k.push("color:".concat(g(q.color))),q.fontFamily){const fe=/\s/.test(q.fontFamily)?'"'.concat(q.fontFamily,'"'):q.fontFamily;k.push("font-family:".concat(fe))}if(typeof q.fontSizePt=="number"&&isFinite(q.fontSizePt)&&q.fontSizePt>0){const fe="".concat(Math.round(q.fontSizePt*10)/10,"pt");k.push("font-size:".concat(fe))}if(q.bg){k.push("background-color:".concat(q.bg));const fe=g(q.bg);k.push("background:".concat(fe)),k.push("mso-pattern:black none")}q.align&&k.push("text-align:".concat(q.align)),q.valign&&k.push("vertical-align:".concat(q.valign)),q.wrap===!1&&k.push("white-space:nowrap"),q.numFmt?k.push('mso-number-format:"'.concat(String(q.numFmt).replace(/"/g,'\\"'),'"')):k.push('mso-number-format:"General"'),typeof oe.v=="string"&&/^\s*=/.test(oe.v)&&k.push('mso-number-format:"\\@"');const j=fe=>{switch(fe){case"hair":return{widthPx:1,cssStyle:"solid"};case"thin":return{widthPx:1,cssStyle:"solid"};case"medium":return{widthPx:2,cssStyle:"solid"};case"thick":return{widthPx:3,cssStyle:"solid"};case"dotted":return{widthPx:1,cssStyle:"dotted"};case"dashed":return{widthPx:1,cssStyle:"dashed"};case"mediumDashed":return{widthPx:2,cssStyle:"dashed"};case"dashDot":return{widthPx:1,cssStyle:"dashed"};case"dashDotDot":return{widthPx:1,cssStyle:"dotted"};case"mediumDashDot":return{widthPx:2,cssStyle:"dashed"};case"mediumDashDotDot":return{widthPx:2,cssStyle:"dotted"};case"double":return{widthPx:3,cssStyle:"double"};case"slantDashDot":return{widthPx:2,cssStyle:"dashed"};default:return null}},he=(fe,re,de)=>{const J=j(re);if(!J)return;const ae=de!=null?de:"#000",Ne="".concat(J.widthPx,"px ").concat(J.cssStyle," ").concat(ae),ge=J.widthPx*72/96,M="".concat(ge,"pt ").concat(J.cssStyle," ").concat(g(ae));k.push("border-".concat(fe,":").concat(Ne)),k.push("mso-border-".concat(fe,"-alt:").concat(M))};if((C=q.border)!=null&&C.top&&he("top",q.border.top.style,q.border.top.color),(V=q.border)!=null&&V.right&&he("right",q.border.right.style,q.border.right.color),(H=q.border)!=null&&H.bottom&&he("bottom",q.border.bottom.style,q.border.bottom.color),(B=q.border)!=null&&B.left&&he("left",q.border.left.style,q.border.left.color),(X=q.diagonal)!=null&&X.up||(te=q.diagonal)!=null&&te.down){const fe=q.diagonal.style,re=(ue=q.diagonal.color)!=null?ue:"#000",de=j(fe);if(de){const J=de.widthPx*72/96,ae="".concat(J,"pt ").concat(de.cssStyle," ").concat(g(re));q.diagonal.up&&k.push("mso-diagonal-up:".concat(ae)),q.diagonal.down&&k.push("mso-diagonal-down:".concat(ae))}}const le=k.length?" style='".concat(k.join(";"),"'"):"";h+="<td".concat(G).concat(le,">").concat(qs((we=oe.v)!=null?we:""),"</td>")}h+="</tr>"}return h+="</table>","".concat('<html><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=ProgId content="Excel.Sheet"><meta name=Generator content="Microsoft Excel 15"><style>table{mso-displayed-decimal-separator:"\\.";mso-displayed-thousand-separator:"\\,";}tr{mso-height-source:auto;}td{padding-top:1px;padding-right:1px;padding-left:1px;mso-ignore:padding;color:black;font-size:12.0pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"Aptos Narrow", sans-serif;mso-font-charset:0;text-align:general;vertical-align:bottom;border:none;white-space:nowrap;mso-rotate:0;}</style></head><body>').concat("<!--StartFragment-->").concat(h).concat("<!--EndFragment-->").concat("</body></html>")}function $s(e){return e.map(n=>(n!=null?n:[]).map(t=>{var c;const r=(c=t==null?void 0:t.v)!=null?c:"",s=String(r);return/[\t\n\r]/.test(s)?'"'.concat(s.replace(/"/g,'""'),'"'):s}).join("	")).join("\n")}function xs(e){const{containerRef:n,selectionRectRef:t,sheetRef:r,styleInfosRef:s,selRowRef:c,selColRef:a,selectionStartRef:g,selectionEndRef:h,copyOutlineRectRef:f,copyAnimReqRef:o,copyDashOffsetRef:i,redrawSelectionOverlay:u}=e,l=()=>{try{o.current!=null&&(cancelAnimationFrame(o.current),o.current=null);const d=g.current,v=h.current;if(d&&v){const p=Math.min(d.row,v.row),E=Math.max(d.row,v.row),m=Math.min(d.col,v.col),w=Math.max(d.col,v.col);f.current={r1:p,c1:m,r2:E,c2:w},i.current=0;const N=()=>{i.current=(i.current+.08)%1e3,u(),o.current=requestAnimationFrame(N)};N()}}catch(d){}};return async function(v){var C,V;const p=n.current;if(!p)return;const E=(C=document.activeElement)!=null?C:null;if(E&&!p.contains(E))return;const m=t.current,w=r.current,N=s.current;if(!w||!N)return;const{rows:A,merges:I}=Vs({selectionRect:m,selRow:c.current,selCol:a.current,sheet:w,styleInfos:N}),y=Us(A,I),T=$s(A);try{if(v.clipboardData){v.preventDefault(),v.clipboardData.setData("text/html",y),v.clipboardData.setData("text/plain",T),l();return}}catch(H){}try{const H=window.ClipboardItem;if(H&&((V=navigator.clipboard)!=null&&V.write)){const B=new H({"text/html":new Blob([y],{type:"text/html"}),"text/plain":new Blob([T],{type:"text/plain"})});await navigator.clipboard.write([B]),v.preventDefault(),l();return}}catch(H){}try{v.clipboardData&&(v.preventDefault(),v.clipboardData.setData("text/plain",T),l())}catch(H){}}}var Zn={exports:{}},Hs=Zn.exports,Dt;function zs(){return Dt||(Dt=1,(function(e,n){(function(t,r){e.exports=r()})(Hs,function(){var t=(function(r,s){var c=Array.prototype.concat,a=Array.prototype.slice,g=Object.prototype.toString;function h(m,w){var N=m>w?m:w;return r.pow(10,17-~~(r.log(N>0?N:-N)*r.LOG10E))}var f=Array.isArray||function(w){return g.call(w)==="[object Array]"};function o(m){return g.call(m)==="[object Function]"}function i(m){return typeof m=="number"?m-m===0:!1}function u(m){return c.apply([],m)}function l(){return new l._init(arguments)}l.fn=l.prototype,l._init=function(w){if(f(w[0]))if(f(w[0][0])){o(w[1])&&(w[0]=l.map(w[0],w[1]));for(var N=0;N<w[0].length;N++)this[N]=w[0][N];this.length=w[0].length}else this[0]=o(w[1])?l.map(w[0],w[1]):w[0],this.length=1;else if(i(w[0]))this[0]=l.seq.apply(null,w),this.length=1;else{if(w[0]instanceof l)return l(w[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:h,isArray:f,isFunction:o,isNumber:i,toVector:u},l._random_fn=r.random,l.setRandom=function(w){if(typeof w!="function")throw new TypeError("fn is not a function");l._random_fn=w},l.extend=function(w){var N,A;if(arguments.length===1){for(A in w)l[A]=w[A];return this}for(N=1;N<arguments.length;N++)for(A in arguments[N])w[A]=arguments[N][A];return w},l.rows=function(w){return w.length||1},l.cols=function(w){return w[0].length||1},l.dimensions=function(w){return{rows:l.rows(w),cols:l.cols(w)}},l.row=function(w,N){return f(N)?N.map(function(A){return l.row(w,A)}):w[N]},l.rowa=function(w,N){return l.row(w,N)},l.col=function(w,N){if(f(N)){var A=l.arange(w.length).map(function(){return new Array(N.length)});return N.forEach(function(T,C){l.arange(w.length).forEach(function(V){A[V][C]=w[V][T]})}),A}for(var I=new Array(w.length),y=0;y<w.length;y++)I[y]=[w[y][N]];return I},l.cola=function(w,N){return l.col(w,N).map(function(A){return A[0]})},l.diag=function(w){for(var N=l.rows(w),A=new Array(N),I=0;I<N;I++)A[I]=[w[I][I]];return A},l.antidiag=function(w){for(var N=l.rows(w)-1,A=new Array(N),I=0;N>=0;N--,I++)A[I]=[w[I][N]];return A},l.transpose=function(w){var N=[],A,I,y,T,C;for(f(w[0])||(w=[w]),I=w.length,y=w[0].length,C=0;C<y;C++){for(A=new Array(I),T=0;T<I;T++)A[T]=w[T][C];N.push(A)}return N.length===1?N[0]:N},l.map=function(w,N,A){var I,y,T,C,V;for(f(w[0])||(w=[w]),y=w.length,T=w[0].length,C=A?w:new Array(y),I=0;I<y;I++)for(C[I]||(C[I]=new Array(T)),V=0;V<T;V++)C[I][V]=N(w[I][V],I,V);return C.length===1?C[0]:C},l.cumreduce=function(w,N,A){var I,y,T,C,V;for(f(w[0])||(w=[w]),y=w.length,T=w[0].length,C=A?w:new Array(y),I=0;I<y;I++)for(C[I]||(C[I]=new Array(T)),T>0&&(C[I][0]=w[I][0]),V=1;V<T;V++)C[I][V]=N(C[I][V-1],w[I][V]);return C.length===1?C[0]:C},l.alter=function(w,N){return l.map(w,N,!0)},l.create=function(w,N,A){var I=new Array(w),y,T;for(o(N)&&(A=N,N=w),y=0;y<w;y++)for(I[y]=new Array(N),T=0;T<N;T++)I[y][T]=A(y,T);return I};function d(){return 0}l.zeros=function(w,N){return i(N)||(N=w),l.create(w,N,d)};function v(){return 1}l.ones=function(w,N){return i(N)||(N=w),l.create(w,N,v)},l.rand=function(w,N){return i(N)||(N=w),l.create(w,N,l._random_fn)};function p(m,w){return m===w?1:0}l.identity=function(w,N){return i(N)||(N=w),l.create(w,N,p)},l.symmetric=function(w){var N=w.length,A,I;if(w.length!==w[0].length)return!1;for(A=0;A<N;A++)for(I=0;I<N;I++)if(w[I][A]!==w[A][I])return!1;return!0},l.clear=function(w){return l.alter(w,d)},l.seq=function(w,N,A,I){o(I)||(I=!1);var y=[],T=h(w,N),C=(N*T-w*T)/((A-1)*T),V=w,H;for(H=0;V<=N&&H<A;H++,V=(w*T+C*T*H)/T)y.push(I?I(V,H):V);return y},l.arange=function(w,N,A){var I=[],y;if(A=A||1,N===s&&(N=w,w=0),w===N||A===0)return[];if(w<N&&A<0)return[];if(w>N&&A>0)return[];if(A>0)for(y=w;y<N;y+=A)I.push(y);else for(y=w;y>N;y+=A)I.push(y);return I},l.slice=(function(){function m(N,A,I,y){var T,C=[],V=N.length;if(A===s&&I===s&&y===s)return l.copy(N);if(A=A||0,I=I||N.length,A=A>=0?A:V+A,I=I>=0?I:V+I,y=y||1,A===I||y===0)return[];if(A<I&&y<0)return[];if(A>I&&y>0)return[];if(y>0)for(T=A;T<I;T+=y)C.push(N[T]);else for(T=A;T>I;T+=y)C.push(N[T]);return C}function w(N,A){var I,y;if(A=A||{},i(A.row)){if(i(A.col))return N[A.row][A.col];var T=l.rowa(N,A.row);return I=A.col||{},m(T,I.start,I.end,I.step)}if(i(A.col)){var C=l.cola(N,A.col);return y=A.row||{},m(C,y.start,y.end,y.step)}y=A.row||{},I=A.col||{};var V=m(N,y.start,y.end,y.step);return V.map(function(H){return m(H,I.start,I.end,I.step)})}return w})(),l.sliceAssign=function(w,N,A){var I,y;if(i(N.row)){if(i(N.col))return w[N.row][N.col]=A;N.col=N.col||{},N.col.start=N.col.start||0,N.col.end=N.col.end||w[0].length,N.col.step=N.col.step||1,I=l.arange(N.col.start,r.min(w.length,N.col.end),N.col.step);var T=N.row;return I.forEach(function(V,H){w[T][V]=A[H]}),w}if(i(N.col)){N.row=N.row||{},N.row.start=N.row.start||0,N.row.end=N.row.end||w.length,N.row.step=N.row.step||1,y=l.arange(N.row.start,r.min(w[0].length,N.row.end),N.row.step);var C=N.col;return y.forEach(function(V,H){w[V][C]=A[H]}),w}return A[0].length===s&&(A=[A]),N.row.start=N.row.start||0,N.row.end=N.row.end||w.length,N.row.step=N.row.step||1,N.col.start=N.col.start||0,N.col.end=N.col.end||w[0].length,N.col.step=N.col.step||1,y=l.arange(N.row.start,r.min(w.length,N.row.end),N.row.step),I=l.arange(N.col.start,r.min(w[0].length,N.col.end),N.col.step),y.forEach(function(V,H){I.forEach(function(B,X){w[V][B]=A[H][X]})}),w},l.diagonal=function(w){var N=l.zeros(w.length,w.length);return w.forEach(function(A,I){N[I][I]=A}),N},l.copy=function(w){return w.map(function(N){return i(N)?N:N.map(function(A){return A})})};var E=l.prototype;return E.length=0,E.push=Array.prototype.push,E.sort=Array.prototype.sort,E.splice=Array.prototype.splice,E.slice=Array.prototype.slice,E.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},E.map=function(w,N){return l(l.map(this,w,N))},E.cumreduce=function(w,N){return l(l.cumreduce(this,w,N))},E.alter=function(w){return l.alter(this,w),this},(function(m){for(var w=0;w<m.length;w++)(function(N){E[N]=function(A){var I=this,y;return A?(setTimeout(function(){A.call(I,E[N].call(I))}),this):(y=l[N](this),f(y)?l(y):y)}})(m[w])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),(function(m){for(var w=0;w<m.length;w++)(function(N){E[N]=function(A,I){var y=this;return I?(setTimeout(function(){I.call(y,E[N].call(y,A))}),this):l(l[N](this,A))}})(m[w])})("row col".split(" ")),(function(m){for(var w=0;w<m.length;w++)(function(N){E[N]=function(){return l(l[N].apply(null,arguments))}})(m[w])})("create zeros ones rand identity".split(" ")),l})(Math);return(function(r,s){var c=r.utils.isFunction;function a(f,o){return f-o}function g(f,o,i){return s.max(o,s.min(f,i))}r.sum=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u];return i},r.sumsqrd=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u]*o[u];return i},r.sumsqerr=function(o){for(var i=r.mean(o),u=0,l=o.length,d;--l>=0;)d=o[l]-i,u+=d*d;return u},r.sumrow=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u];return i},r.product=function(o){for(var i=1,u=o.length;--u>=0;)i*=o[u];return i},r.min=function(o){for(var i=o[0],u=0;++u<o.length;)o[u]<i&&(i=o[u]);return i},r.max=function(o){for(var i=o[0],u=0;++u<o.length;)o[u]>i&&(i=o[u]);return i},r.unique=function(o){for(var i={},u=[],l=0;l<o.length;l++)i[o[l]]||(i[o[l]]=!0,u.push(o[l]));return u},r.mean=function(o){return r.sum(o)/o.length},r.meansqerr=function(o){return r.sumsqerr(o)/o.length},r.geomean=function(o){var i=o.map(s.log),u=r.mean(i);return s.exp(u)},r.median=function(o){var i=o.length,u=o.slice().sort(a);return i&1?u[i/2|0]:(u[i/2-1]+u[i/2])/2},r.cumsum=function(o){return r.cumreduce(o,function(i,u){return i+u})},r.cumprod=function(o){return r.cumreduce(o,function(i,u){return i*u})},r.diff=function(o){var i=[],u=o.length,l;for(l=1;l<u;l++)i.push(o[l]-o[l-1]);return i},r.rank=function(f){var o,i=[],u={};for(o=0;o<f.length;o++){var l=f[o];u[l]?u[l]++:(u[l]=1,i.push(l))}var d=i.sort(a),v={},p=1;for(o=0;o<d.length;o++){var l=d[o],E=u[l],m=p,w=p+E-1,N=(m+w)/2;v[l]=N,p+=E}return f.map(function(A){return v[A]})},r.mode=function(o){var i=o.length,u=o.slice().sort(a),l=1,d=0,v=0,p=[],E;for(E=0;E<i;E++)u[E]===u[E+1]?l++:(l>d?(p=[u[E]],d=l,v=0):l===d&&(p.push(u[E]),v++),l=1);return v===0?p[0]:p},r.range=function(o){return r.max(o)-r.min(o)},r.variance=function(o,i){return r.sumsqerr(o)/(o.length-(i?1:0))},r.pooledvariance=function(o){var i=o.reduce(function(l,d){return l+r.sumsqerr(d)},0),u=o.reduce(function(l,d){return l+d.length},0);return i/(u-o.length)},r.deviation=function(f){for(var o=r.mean(f),i=f.length,u=new Array(i),l=0;l<i;l++)u[l]=f[l]-o;return u},r.stdev=function(o,i){return s.sqrt(r.variance(o,i))},r.pooledstdev=function(o){return s.sqrt(r.pooledvariance(o))},r.meandev=function(o){for(var i=r.mean(o),u=[],l=o.length-1;l>=0;l--)u.push(s.abs(o[l]-i));return r.mean(u)},r.meddev=function(o){for(var i=r.median(o),u=[],l=o.length-1;l>=0;l--)u.push(s.abs(o[l]-i));return r.median(u)},r.coeffvar=function(o){return r.stdev(o)/r.mean(o)},r.quartiles=function(o){var i=o.length,u=o.slice().sort(a);return[u[s.round(i/4)-1],u[s.round(i/2)-1],u[s.round(i*3/4)-1]]},r.quantiles=function(o,i,u,l){var d=o.slice().sort(a),v=[i.length],p=o.length,E,m,w,N,A,I;for(typeof u>"u"&&(u=3/8),typeof l>"u"&&(l=3/8),E=0;E<i.length;E++)m=i[E],w=u+m*(1-u-l),N=p*m+w,A=s.floor(g(N,1,p-1)),I=g(N-A,0,1),v[E]=(1-I)*d[A-1]+I*d[A];return v},r.percentile=function(o,i,u){var l=o.slice().sort(a),d=i*(l.length+(u?1:-1))+(u?0:1),v=parseInt(d),p=d-v;return v+1<l.length?l[v-1]+p*(l[v]-l[v-1]):l[v-1]},r.percentileOfScore=function(o,i,u){var l=0,d=o.length,v=!1,p,E;for(u==="strict"&&(v=!0),E=0;E<d;E++)p=o[E],(v&&p<i||!v&&p<=i)&&l++;return l/d},r.histogram=function(o,i){i=i||4;var u=r.min(o),l=(r.max(o)-u)/i,d=o.length,v=[],p;for(p=0;p<i;p++)v[p]=0;for(p=0;p<d;p++)v[s.min(s.floor((o[p]-u)/l),i-1)]+=1;return v},r.covariance=function(o,i){var u=r.mean(o),l=r.mean(i),d=o.length,v=new Array(d),p;for(p=0;p<d;p++)v[p]=(o[p]-u)*(i[p]-l);return r.sum(v)/(d-1)},r.corrcoeff=function(o,i){return r.covariance(o,i)/r.stdev(o,1)/r.stdev(i,1)},r.spearmancoeff=function(f,o){return f=r.rank(f),o=r.rank(o),r.corrcoeff(f,o)},r.stanMoment=function(o,i){for(var u=r.mean(o),l=r.stdev(o),d=o.length,v=0,p=0;p<d;p++)v+=s.pow((o[p]-u)/l,i);return v/o.length},r.skewness=function(o){return r.stanMoment(o,3)},r.kurtosis=function(o){return r.stanMoment(o,4)-3};var h=r.prototype;(function(f){for(var o=0;o<f.length;o++)(function(i){h[i]=function(u,l){var d=[],v=0,p=this;if(c(u)&&(l=u,u=!1),l)return setTimeout(function(){l.call(p,h[i].call(p,u))}),this;if(this.length>1){for(p=u===!0?this:this.transpose();v<p.length;v++)d[v]=r[i](p[v]);return d}return r[i](this[0],u)}})(f[o])})("cumsum cumprod".split(" ")),(function(f){for(var o=0;o<f.length;o++)(function(i){h[i]=function(u,l){var d=[],v=0,p=this;if(c(u)&&(l=u,u=!1),l)return setTimeout(function(){l.call(p,h[i].call(p,u))}),this;if(this.length>1){for(i!=="sumrow"&&(p=u===!0?this:this.transpose());v<p.length;v++)d[v]=r[i](p[v]);return u===!0?r[i](r.utils.toVector(d)):d}return r[i](this[0],u)}})(f[o])})("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),(function(f){for(var o=0;o<f.length;o++)(function(i){h[i]=function(){var u=[],l=0,d=this,v=Array.prototype.slice.call(arguments),p;if(c(v[v.length-1])){p=v[v.length-1];var E=v.slice(0,v.length-1);return setTimeout(function(){p.call(d,h[i].apply(d,E))}),this}else{p=void 0;var m=function(N){return r[i].apply(d,[N].concat(v))}}if(this.length>1){for(d=d.transpose();l<d.length;l++)u[l]=m(d[l]);return u}return m(this[0])}})(f[o])})("quantiles percentileOfScore".split(" "))})(t,Math),(function(r,s){r.gammaln=function(a){var g=0,h=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,o,i,u;for(u=(i=o=a)+5.5,u-=(o+.5)*s.log(u);g<6;g++)f+=h[g]/++i;return s.log(2.5066282746310007*f/o)-u},r.loggam=function(a){var g,h,f,o,i,u,l,d=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(g=a,l=0,a==1||a==2)return 0;for(a<=7&&(l=s.floor(7-a),g=a+l),h=1/(g*g),f=2*s.PI,i=d[9],u=8;u>=0;u--)i*=h,i+=d[u];if(o=i/g+.5*s.log(f)+(g-.5)*s.log(g)-g,a<=7)for(u=1;u<=l;u++)o-=s.log(g-1),g-=1;return o},r.gammafn=function(a){var g=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,o=0,i=0,u=0,l=a,d,v,p,E;if(a>171.6243769536076)return 1/0;if(l<=0)if(E=l%1+36e-17,E)f=(l&1?-1:1)*s.PI/s.sin(s.PI*E),l=1-l;else return 1/0;for(p=l,l<1?v=l++:v=(l-=o=(l|0)-1)-1,d=0;d<8;++d)u=(u+g[d])*v,i=i*v+h[d];if(E=u/i+1,p<l)E/=p;else if(p>l)for(d=0;d<o;++d)E*=l,l++;return f&&(E=f/E),E},r.gammap=function(a,g){return r.lowRegGamma(a,g)*r.gammafn(a)},r.lowRegGamma=function(a,g){var h=r.gammaln(a),f=a,o=1/a,i=o,u=g+1-a,l=1/1e-30,d=1/u,v=d,p=1,E=-~(s.log(a>=1?a:1/a)*8.5+a*.4+17),m;if(g<0||a<=0)return NaN;if(g<a+1){for(;p<=E;p++)o+=i*=g/++f;return o*s.exp(-g+a*s.log(g)-h)}for(;p<=E;p++)m=-p*(p-a),u+=2,d=m*d+u,l=u+m/l,d=1/d,v*=d*l;return 1-v*s.exp(-g+a*s.log(g)-h)},r.factorialln=function(a){return a<0?NaN:r.gammaln(a+1)},r.factorial=function(a){return a<0?NaN:r.gammafn(a+1)},r.combination=function(a,g){return a>170||g>170?s.exp(r.combinationln(a,g)):r.factorial(a)/r.factorial(g)/r.factorial(a-g)},r.combinationln=function(a,g){return r.factorialln(a)-r.factorialln(g)-r.factorialln(a-g)},r.permutation=function(a,g){return r.factorial(a)/r.factorial(a-g)},r.betafn=function(a,g){if(!(a<=0||g<=0))return a+g>170?s.exp(r.betaln(a,g)):r.gammafn(a)*r.gammafn(g)/r.gammafn(a+g)},r.betaln=function(a,g){return r.gammaln(a)+r.gammaln(g)-r.gammaln(a+g)},r.betacf=function(a,g,h){var f=1e-30,o=1,i=g+h,u=g+1,l=g-1,d=1,v=1-i*a/u,p,E,m,w;for(s.abs(v)<f&&(v=f),v=1/v,w=v;o<=100&&(p=2*o,E=o*(h-o)*a/((l+p)*(g+p)),v=1+E*v,s.abs(v)<f&&(v=f),d=1+E/d,s.abs(d)<f&&(d=f),v=1/v,w*=v*d,E=-(g+o)*(i+o)*a/((g+p)*(u+p)),v=1+E*v,s.abs(v)<f&&(v=f),d=1+E/d,s.abs(d)<f&&(d=f),v=1/v,m=v*d,w*=m,!(s.abs(m-1)<3e-7));o++);return w},r.gammapinv=function(a,g){var h=0,f=g-1,o=1e-8,i=r.gammaln(g),u,l,d,v,p,E,m;if(a>=1)return s.max(100,g+100*s.sqrt(g));if(a<=0)return 0;for(g>1?(E=s.log(f),m=s.exp(f*(E-1)-i),p=a<.5?a:1-a,d=s.sqrt(-2*s.log(p)),u=(2.30753+d*.27061)/(1+d*(.99229+d*.04481))-d,a<.5&&(u=-u),u=s.max(.001,g*s.pow(1-1/(9*g)-u/(3*s.sqrt(g)),3))):(d=1-g*(.253+g*.12),a<d?u=s.pow(a/d,1/g):u=1-s.log(1-(a-d)/(1-d)));h<12;h++){if(u<=0)return 0;if(l=r.lowRegGamma(g,u)-a,g>1?d=m*s.exp(-(u-f)+f*(s.log(u)-E)):d=s.exp(-u+f*s.log(u)-i),v=l/d,u-=d=v/(1-.5*s.min(1,v*((g-1)/u-1))),u<=0&&(u=.5*(u+d)),s.abs(d)<o*u)break}return u},r.erf=function(a){var g=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=g.length-1,f=!1,o=0,i=0,u,l,d,v;for(a<0&&(a=-a,f=!0),u=2/(2+a),l=4*u-2;h>0;h--)d=o,o=l*o-i+g[h],i=d;return v=u*s.exp(-a*a+.5*(g[0]+l*o)-i),f?v-1:1-v},r.erfc=function(a){return 1-r.erf(a)},r.erfcinv=function(a){var g=0,h,f,o,i;if(a>=2)return-100;if(a<=0)return 100;for(i=a<1?a:2-a,o=s.sqrt(-2*s.log(i/2)),h=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);g<2;g++)f=r.erfc(h)-i,h+=f/(1.1283791670955126*s.exp(-h*h)-h*f);return a<1?h:-h},r.ibetainv=function(a,g,h){var f=1e-8,o=g-1,i=h-1,u=0,l,d,v,p,E,m,w,N,A,I,y;if(a<=0)return 0;if(a>=1)return 1;for(g>=1&&h>=1?(v=a<.5?a:1-a,p=s.sqrt(-2*s.log(v)),w=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,a<.5&&(w=-w),N=(w*w-3)/6,A=2/(1/(2*g-1)+1/(2*h-1)),I=w*s.sqrt(N+A)/A-(1/(2*h-1)-1/(2*g-1))*(N+5/6-2/(3*A)),w=g/(g+h*s.exp(2*I))):(l=s.log(g/(g+h)),d=s.log(h/(g+h)),p=s.exp(g*l)/g,E=s.exp(h*d)/h,I=p+E,a<p/I?w=s.pow(g*I*a,1/g):w=1-s.pow(h*I*(1-a),1/h)),y=-r.gammaln(g)-r.gammaln(h)+r.gammaln(g+h);u<10;u++){if(w===0||w===1)return w;if(m=r.ibeta(w,g,h)-a,p=s.exp(o*s.log(w)+i*s.log(1-w)+y),E=m/p,w-=p=E/(1-.5*s.min(1,E*(o/w-i/(1-w)))),w<=0&&(w=.5*(w+p)),w>=1&&(w=.5*(w+p+1)),s.abs(p)<f*w&&u>0)break}return w},r.ibeta=function(a,g,h){var f=a===0||a===1?0:s.exp(r.gammaln(g+h)-r.gammaln(g)-r.gammaln(h)+g*s.log(a)+h*s.log(1-a));return a<0||a>1?!1:a<(g+1)/(g+h+2)?f*r.betacf(a,g,h)/g:1-f*r.betacf(1-a,h,g)/h},r.randn=function(a,g){var h,f,o,i,u;if(g||(g=a),a)return r.create(a,g,function(){return r.randn()});do h=r._random_fn(),f=1.7156*(r._random_fn()-.5),o=h-.449871,i=s.abs(f)+.386595,u=o*o+i*(.196*i-.25472*o);while(u>.27597&&(u>.27846||f*f>-4*s.log(h)*h*h));return f/h},r.randg=function(a,g,h){var f=a,o,i,u,l,d,v;if(h||(h=g),a||(a=1),g)return v=r.zeros(g,h),v.alter(function(){return r.randg(a)}),v;a<1&&(a+=1),o=a-1/3,i=1/s.sqrt(9*o);do{do d=r.randn(),l=1+i*d;while(l<=0);l=l*l*l,u=r._random_fn()}while(u>1-.331*s.pow(d,4)&&s.log(u)>.5*d*d+o*(1-l+s.log(l)));if(a==f)return o*l;do u=r._random_fn();while(u===0);return s.pow(u,1/f)*o*l},(function(c){for(var a=0;a<c.length;a++)(function(g){r.fn[g]=function(){return r(r.map(this,function(h){return r[g](h)}))}})(c[a])})("gammaln gammafn factorial factorialln".split(" ")),(function(c){for(var a=0;a<c.length;a++)(function(g){r.fn[g]=function(){return r(r[g].apply(null,arguments))}})(c[a])})("randn".split(" "))})(t,Math),(function(r,s){(function(f){for(var o=0;o<f.length;o++)(function(i){r[i]=function u(l,d,v){return this instanceof u?(this._a=l,this._b=d,this._c=v,this):new u(l,d,v)},r.fn[i]=function(u,l,d){var v=r[i](u,l,d);return v.data=this,v},r[i].prototype.sample=function(u){var l=this._a,d=this._b,v=this._c;return u?r.alter(u,function(){return r[i].sample(l,d,v)}):r[i].sample(l,d,v)},(function(u){for(var l=0;l<u.length;l++)(function(d){r[i].prototype[d]=function(v){var p=this._a,E=this._b,m=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?r.fn.map.call(v,function(w){return r[i][d](w,p,E,m)}):r[i][d](v,p,E,m)}})(u[l])})("pdf cdf inv".split(" ")),(function(u){for(var l=0;l<u.length;l++)(function(d){r[i].prototype[d]=function(){return r[i][d](this._a,this._b,this._c)}})(u[l])})("mean median mode variance".split(" "))})(f[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(o,i,u){return o>1||o<0?0:i==1&&u==1?1:i<512&&u<512?s.pow(o,i-1)*s.pow(1-o,u-1)/r.betafn(i,u):s.exp((i-1)*s.log(o)+(u-1)*s.log(1-o)-r.betaln(i,u))},cdf:function(o,i,u){return o>1||o<0?(o>1)*1:r.ibeta(o,i,u)},inv:function(o,i,u){return r.ibetainv(o,i,u)},mean:function(o,i){return o/(o+i)},median:function(o,i){return r.ibetainv(.5,o,i)},mode:function(o,i){return(o-1)/(o+i-2)},sample:function(o,i){var u=r.randg(o);return u/(u+r.randg(i))},variance:function(o,i){return o*i/(s.pow(o+i,2)*(o+i+1))}}),r.extend(r.centralF,{pdf:function(o,i,u){var l,d,v;return o<0?0:i<=2?o===0&&i<2?1/0:o===0&&i===2?1:1/r.betafn(i/2,u/2)*s.pow(i/u,i/2)*s.pow(o,i/2-1)*s.pow(1+i/u*o,-(i+u)/2):(l=i*o/(u+o*i),d=u/(u+o*i),v=i*d/2,v*r.binomial.pdf((i-2)/2,(i+u-2)/2,l))},cdf:function(o,i,u){return o<0?0:r.ibeta(i*o/(i*o+u),i/2,u/2)},inv:function(o,i,u){return u/(i*(1/r.ibetainv(o,i/2,u/2)-1))},mean:function(o,i){return i>2?i/(i-2):void 0},mode:function(o,i){return o>2?i*(o-2)/(o*(i+2)):void 0},sample:function(o,i){var u=r.randg(o/2)*2,l=r.randg(i/2)*2;return u/o/(l/i)},variance:function(o,i){if(!(i<=4))return 2*i*i*(o+i-2)/(o*(i-2)*(i-2)*(i-4))}}),r.extend(r.cauchy,{pdf:function(o,i,u){return u<0?0:u/(s.pow(o-i,2)+s.pow(u,2))/s.PI},cdf:function(o,i,u){return s.atan((o-i)/u)/s.PI+.5},inv:function(f,o,i){return o+i*s.tan(s.PI*(f-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,i){return r.randn()*s.sqrt(1/(2*r.randg(.5)))*i+o}}),r.extend(r.chisquare,{pdf:function(o,i){return o<0?0:o===0&&i===2?.5:s.exp((i/2-1)*s.log(o)-o/2-i/2*s.log(2)-r.gammaln(i/2))},cdf:function(o,i){return o<0?0:r.lowRegGamma(i/2,o/2)},inv:function(f,o){return 2*r.gammapinv(f,.5*o)},mean:function(f){return f},median:function(o){return o*s.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return r.randg(o/2)*2},variance:function(o){return 2*o}}),r.extend(r.exponential,{pdf:function(o,i){return o<0?0:i*s.exp(-i*o)},cdf:function(o,i){return o<0?0:1-s.exp(-i*o)},inv:function(f,o){return-s.log(1-f)/o},mean:function(f){return 1/f},median:function(f){return 1/f*s.log(2)},mode:function(){return 0},sample:function(o){return-1/o*s.log(r._random_fn())},variance:function(f){return s.pow(f,-2)}}),r.extend(r.gamma,{pdf:function(o,i,u){return o<0?0:o===0&&i===1?1/u:s.exp((i-1)*s.log(o)-o/u-r.gammaln(i)-i*s.log(u))},cdf:function(o,i,u){return o<0?0:r.lowRegGamma(i,o/u)},inv:function(f,o,i){return r.gammapinv(f,o)*i},mean:function(f,o){return f*o},mode:function(o,i){if(o>1)return(o-1)*i},sample:function(o,i){return r.randg(o)*i},variance:function(o,i){return o*i*i}}),r.extend(r.invgamma,{pdf:function(o,i,u){return o<=0?0:s.exp(-(i+1)*s.log(o)-u/o-r.gammaln(i)+i*s.log(u))},cdf:function(o,i,u){return o<=0?0:1-r.lowRegGamma(i,u/o)},inv:function(f,o,i){return i/r.gammapinv(1-f,o)},mean:function(f,o){return f>1?o/(f-1):void 0},mode:function(o,i){return i/(o+1)},sample:function(o,i){return i/r.randg(o)},variance:function(o,i){if(!(o<=2))return i*i/((o-1)*(o-1)*(o-2))}}),r.extend(r.kumaraswamy,{pdf:function(o,i,u){return o===0&&i===1?u:o===1&&u===1?i:s.exp(s.log(i)+s.log(u)+(i-1)*s.log(o)+(u-1)*s.log(1-s.pow(o,i)))},cdf:function(o,i,u){return o<0?0:o>1?1:1-s.pow(1-s.pow(o,i),u)},inv:function(o,i,u){return s.pow(1-s.pow(1-o,1/u),1/i)},mean:function(f,o){return o*r.gammafn(1+1/f)*r.gammafn(o)/r.gammafn(1+1/f+o)},median:function(o,i){return s.pow(1-s.pow(2,-1/i),1/o)},mode:function(o,i){if(o>=1&&i>=1&&o!==1&&i!==1)return s.pow((o-1)/(o*i-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(o,i,u){return o<=0?0:s.exp(-s.log(o)-.5*s.log(2*s.PI)-s.log(u)-s.pow(s.log(o)-i,2)/(2*u*u))},cdf:function(o,i,u){return o<0?0:.5+.5*r.erf((s.log(o)-i)/s.sqrt(2*u*u))},inv:function(f,o,i){return s.exp(-1.4142135623730951*i*r.erfcinv(2*f)+o)},mean:function(o,i){return s.exp(o+i*i/2)},median:function(o){return s.exp(o)},mode:function(o,i){return s.exp(o-i*i)},sample:function(o,i){return s.exp(r.randn()*i+o)},variance:function(o,i){return(s.exp(i*i)-1)*s.exp(2*o+i*i)}}),r.extend(r.noncentralt,{pdf:function(o,i,u){var l=1e-14;return s.abs(u)<l?r.studentt.pdf(o,i):s.abs(o)<l?s.exp(r.gammaln((i+1)/2)-u*u/2-.5*s.log(s.PI*i)-r.gammaln(i/2)):i/o*(r.noncentralt.cdf(o*s.sqrt(1+2/i),i+2,u)-r.noncentralt.cdf(o,i,u))},cdf:function(o,i,u){var l=1e-14,d=200;if(s.abs(u)<l)return r.studentt.cdf(o,i);var v=!1;o<0&&(v=!0,u=-u);for(var p=r.normal.cdf(-u,0,1),E=l+1,m=E,w=o*o/(o*o+i),N=0,A=s.exp(-u*u/2),I=s.exp(-u*u/2-.5*s.log(2)-r.gammaln(3/2))*u;N<d||m>l||E>l;)m=E,N>0&&(A*=u*u/(2*N),I*=u*u/(2*(N+1/2))),E=A*r.beta.cdf(w,N+.5,i/2)+I*r.beta.cdf(w,N+1,i/2),p+=.5*E,N++;return v?1-p:p}}),r.extend(r.normal,{pdf:function(o,i,u){return s.exp(-.5*s.log(2*s.PI)-s.log(u)-s.pow(o-i,2)/(2*u*u))},cdf:function(o,i,u){return .5*(1+r.erf((o-i)/s.sqrt(2*u*u)))},inv:function(f,o,i){return-1.4142135623730951*i*r.erfcinv(2*f)+o},mean:function(f){return f},median:function(o){return o},mode:function(f){return f},sample:function(o,i){return r.randn()*i+o},variance:function(f,o){return o*o}}),r.extend(r.pareto,{pdf:function(o,i,u){return o<i?0:u*s.pow(i,u)/s.pow(o,u+1)},cdf:function(o,i,u){return o<i?0:1-s.pow(i/o,u)},inv:function(o,i,u){return i/s.pow(1-o,1/u)},mean:function(o,i){if(!(i<=1))return i*s.pow(o,i)/(i-1)},median:function(o,i){return o*(i*s.SQRT2)},mode:function(o){return o},variance:function(f,o){if(!(o<=2))return f*f*o/(s.pow(o-1,2)*(o-2))}}),r.extend(r.studentt,{pdf:function(o,i){return i=i>1e100?1e100:i,1/(s.sqrt(i)*r.betafn(.5,i/2))*s.pow(1+o*o/i,-((i+1)/2))},cdf:function(o,i){var u=i/2;return r.ibeta((o+s.sqrt(o*o+i))/(2*s.sqrt(o*o+i)),u,u)},inv:function(f,o){var i=r.ibetainv(2*s.min(f,1-f),.5*o,.5);return i=s.sqrt(o*(1-i)/i),f>.5?i:-i},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return r.randn()*s.sqrt(o/(2*r.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(o,i,u){return o<0||i<0||u<0?0:u/i*s.pow(o/i,u-1)*s.exp(-s.pow(o/i,u))},cdf:function(o,i,u){return o<0?0:1-s.exp(-s.pow(o/i,u))},inv:function(f,o,i){return o*s.pow(-s.log(1-f),1/i)},mean:function(f,o){return f*r.gammafn(1+1/o)},median:function(o,i){return o*s.pow(s.log(2),1/i)},mode:function(o,i){return i<=1?0:o*s.pow((i-1)/i,1/i)},sample:function(o,i){return o*s.pow(-s.log(r._random_fn()),1/i)},variance:function(o,i){return o*o*r.gammafn(1+2/i)-s.pow(r.weibull.mean(o,i),2)}}),r.extend(r.uniform,{pdf:function(o,i,u){return o<i||o>u?0:1/(u-i)},cdf:function(o,i,u){return o<i?0:o<u?(o-i)/(u-i):1},inv:function(f,o,i){return o+f*(i-o)},mean:function(o,i){return .5*(o+i)},median:function(o,i){return r.mean(o,i)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,i){return o/2+i/2+(i/2-o/2)*(2*r._random_fn()-1)},variance:function(o,i){return s.pow(i-o,2)/12}});function c(f,o,i,u){for(var l=0,d=1,v=1,p=1,E=0,m=0,w;s.abs((v-m)/v)>u;)m=v,w=-(o+E)*(o+i+E)*f/(o+2*E)/(o+2*E+1),l=v+w*l,d=p+w*d,E=E+1,w=E*(i-E)*f/(o+2*E-1)/(o+2*E),v=l+w*v,p=d+w*p,l=l/p,d=d/p,v=v/p,p=1;return v/o}r.extend(r.binomial,{pdf:function(o,i,u){return u===0||u===1?i*u===o?1:0:r.combination(i,o)*s.pow(u,o)*s.pow(1-u,i-o)},cdf:function(o,i,u){var l,d=1e-10;if(o<0)return 0;if(o>=i)return 1;if(u<0||u>1||i<=0)return NaN;o=s.floor(o);var v=u,p=o+1,E=i-o,m=p+E,w=s.exp(r.gammaln(m)-r.gammaln(E)-r.gammaln(p)+p*s.log(v)+E*s.log(1-v));return v<(p+1)/(m+2)?l=w*c(v,p,E,d):l=1-w*c(1-v,E,p,d),s.round((1-l)*(1/d))/(1/d)}}),r.extend(r.negbin,{pdf:function(o,i,u){return o!==o>>>0?!1:o<0?0:r.combination(o+i-1,i-1)*s.pow(1-u,o)*s.pow(u,i)},cdf:function(o,i,u){var l=0,d=0;if(o<0)return 0;for(;d<=o;d++)l+=r.negbin.pdf(d,i,u);return l}}),r.extend(r.hypgeom,{pdf:function(o,i,u,l){if(o!==o|0)return!1;if(o<0||o<u-(i-l))return 0;if(o>l||o>u)return 0;if(u*2>i)return l*2>i?r.hypgeom.pdf(i-u-l+o,i,i-u,i-l):r.hypgeom.pdf(l-o,i,i-u,l);if(l*2>i)return r.hypgeom.pdf(u-o,i,u,i-l);if(u<l)return r.hypgeom.pdf(o,i,l,u);for(var d=1,v=0,p=0;p<o;p++){for(;d>1&&v<l;)d*=1-u/(i-v),v++;d*=(l-p)*(u-p)/((p+1)*(i-u-l+p+1))}for(;v<l;v++)d*=1-u/(i-v);return s.min(1,s.max(0,d))},cdf:function(o,i,u,l){if(o<0||o<u-(i-l))return 0;if(o>=l||o>=u)return 1;if(u*2>i)return l*2>i?r.hypgeom.cdf(i-u-l+o,i,i-u,i-l):1-r.hypgeom.cdf(l-o-1,i,i-u,l);if(l*2>i)return 1-r.hypgeom.cdf(u-o-1,i,u,i-l);if(u<l)return r.hypgeom.cdf(o,i,l,u);for(var d=1,v=1,p=0,E=0;E<o;E++){for(;d>1&&p<l;){var m=1-u/(i-p);v*=m,d*=m,p++}v*=(l-E)*(u-E)/((E+1)*(i-u-l+E+1)),d+=v}for(;p<l;p++)d*=1-u/(i-p);return s.min(1,s.max(0,d))}}),r.extend(r.poisson,{pdf:function(o,i){return i<0||o%1!==0||o<0?0:s.pow(i,o)*s.exp(-i)/r.factorial(o)},cdf:function(o,i){var u=[],l=0;if(o<0)return 0;for(;l<=o;l++)u.push(r.poisson.pdf(l,i));return r.sum(u)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(o){var i=1,u=0,l=s.exp(-o);do u++,i*=r._random_fn();while(i>l);return u-1},sampleLarge:function(o){var i=o,u,l,d,v,p,E,m,w,N,A;for(v=s.sqrt(i),p=s.log(i),m=.931+2.53*v,E=-.059+.02483*m,w=1.1239+1.1328/(m-3.4),N=.9277-3.6224/(m-2);;){if(l=s.random()-.5,d=s.random(),A=.5-s.abs(l),u=s.floor((2*E/A+m)*l+i+.43),A>=.07&&d<=N)return u;if(!(u<0||A<.013&&d>A)&&s.log(d)+s.log(w)-s.log(E/(A*A)+m)<=-i+u*p-r.loggam(u+1))return u}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),r.extend(r.triangular,{pdf:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<i||o>u?0:o<l?2*(o-i)/((u-i)*(l-i)):o===l?2/(u-i):2*(u-o)/((u-i)*(u-l))},cdf:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<=i?0:o>=u?1:o<=l?s.pow(o-i,2)/((u-i)*(l-i)):1-s.pow(u-o,2)/((u-i)*(u-l))},inv:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<=(l-i)/(u-i)?i+(u-i)*s.sqrt(o*((l-i)/(u-i))):i+(u-i)*(1-s.sqrt((1-o)*(1-(l-i)/(u-i))))},mean:function(o,i,u){return(o+i+u)/3},median:function(o,i,u){if(u<=(o+i)/2)return i-s.sqrt((i-o)*(i-u))/s.sqrt(2);if(u>(o+i)/2)return o+s.sqrt((i-o)*(u-o))/s.sqrt(2)},mode:function(o,i,u){return u},sample:function(o,i,u){var l=r._random_fn();return l<(u-o)/(i-o)?o+s.sqrt(l*(i-o)*(u-o)):i-s.sqrt((1-l)*(i-o)*(i-u))},variance:function(o,i,u){return(o*o+i*i+u*u-o*i-o*u-i*u)/18}}),r.extend(r.arcsine,{pdf:function(o,i,u){return u<=i?NaN:o<=i||o>=u?0:2/s.PI*s.pow(s.pow(u-i,2)-s.pow(2*o-i-u,2),-.5)},cdf:function(o,i,u){return o<i?0:o<u?2/s.PI*s.asin(s.sqrt((o-i)/(u-i))):1},inv:function(f,o,i){return o+(.5-.5*s.cos(s.PI*f))*(i-o)},mean:function(o,i){return i<=o?NaN:(o+i)/2},median:function(o,i){return i<=o?NaN:(o+i)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,i){return(o+i)/2+(i-o)/2*s.sin(2*s.PI*r.uniform.sample(0,1))},variance:function(o,i){return i<=o?NaN:s.pow(i-o,2)/8}});function a(f){return f/s.abs(f)}r.extend(r.laplace,{pdf:function(o,i,u){return u<=0?0:s.exp(-s.abs(o-i)/u)/(2*u)},cdf:function(o,i,u){return u<=0?0:o<i?.5*s.exp((o-i)/u):1-.5*s.exp(-(o-i)/u)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,o){return 2*o*o},sample:function(o,i){var u=r._random_fn()-.5;return o-i*a(u)*s.log(1-2*s.abs(u))}});function g(f,o,i){var u=12,l=6,d=-30,v=-50,p=60,E=8,m=3,w=2,N=3,A=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],I=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],y=f*.5;if(y>=E)return 1;var T=2*r.normal.cdf(y,0,1,1,0)-1;T>=s.exp(v/i)?T=s.pow(T,i):T=0;var C;f>m?C=w:C=N;for(var V=y,H=(E-y)/C,B=V+H,X=0,te=i-1,ue=1;ue<=C;ue++){for(var we=0,Y=.5*(B+V),_=.5*(B-V),ne=1;ne<=u;ne++){var ie,G;l<ne?(ie=u-ne+1,G=A[ie-1]):(ie=ne,G=-A[ie-1]);var oe=_*G,q=Y+oe,k=q*q;if(k>p)break;var j=2*r.normal.cdf(q,0,1,1,0),he=2*r.normal.cdf(q,f,1,1,0),le=j*.5-he*.5;le>=s.exp(d/te)&&(le=I[ie-1]*s.exp(-(.5*k))*s.pow(le,te),we+=le)}we*=2*_*i/s.sqrt(2*s.PI),X+=we,V=B,B+=H}return T+=X,T<=s.exp(d/o)?0:(T=s.pow(T,o),T>=1?1:T)}function h(f,o,i){var u=.322232421088,l=.099348462606,d=-1,v=.588581570495,p=-.342242088547,E=.531103462366,m=-.204231210125,w=.10353775285,N=-453642210148e-16,A=.0038560700634,I=.8832,y=.2368,T=1.208,C=1.4142,V=120,H=.5-.5*f,B=s.sqrt(s.log(1/(H*H))),X=B+((((B*N+m)*B+p)*B+d)*B+u)/((((B*A+w)*B+E)*B+v)*B+l);i<V&&(X+=(X*X*X+X)/i/4);var te=I-y*X;return i<V&&(te+=-1.214/i+T*X/i),X*(te*s.log(o-1)+C)}r.extend(r.tukey,{cdf:function(o,i,u){var l=1,d=i,v=16,p=8,E=-30,m=1e-14,w=100,N=800,A=5e3,I=25e3,y=1,T=.5,C=.25,V=.125,H=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],B=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(u<2||l<1||d<2)return NaN;if(!Number.isFinite(o))return 1;if(u>I)return g(o,l,d);var X=u*.5,te=X*s.log(u)-u*s.log(2)-r.gammaln(X),ue=X-1,we=u*.25,Y;u<=w?Y=y:u<=N?Y=T:u<=A?Y=C:Y=V,te+=s.log(Y);for(var _=0,ne=1;ne<=50;ne++){for(var ie=0,G=(2*ne-1)*Y,oe=1;oe<=v;oe++){var q,k;p<oe?(q=oe-p-1,k=te+ue*s.log(G+H[q]*Y)-(H[q]*Y+G)*we):(q=oe-1,k=te+ue*s.log(G-H[q]*Y)+(H[q]*Y-G)*we);var j;if(k>=E){p<oe?j=o*s.sqrt((H[q]*Y+G)*.5):j=o*s.sqrt((-(H[q]*Y)+G)*.5);var he=g(j,l,d),le=he*B[q]*s.exp(k);ie+=le}}if(ne*Y>=1&&ie<=m)break;_+=ie}if(ie>m)throw new Error("tukey.cdf failed to converge");return _>1&&(_=1),_},inv:function(f,o,i){var u=1,l=o,d=1e-4,v=50;if(i<2||u<1||l<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var p=h(f,l,i),E=r.tukey.cdf(p,o,i)-f,m;E>0?m=s.max(0,p-1):m=p+1;for(var w=r.tukey.cdf(m,o,i)-f,N,A=1;A<v;A++){N=m-w*(m-p)/(w-E),E=w,p=m,N<0&&(N=0,w=-f),w=r.tukey.cdf(N,o,i)-f,m=N;var I=s.abs(m-p);if(I<d)return N}throw new Error("tukey.inv failed to converge")}})})(t,Math),(function(r,s){var c=Array.prototype.push,a=r.utils.isArray;function g(h){return a(h)||h instanceof r}r.extend({add:function(f,o){return g(o)?(g(o[0])||(o=[o]),r.map(f,function(i,u,l){return i+o[u][l]})):r.map(f,function(i){return i+o})},subtract:function(f,o){return g(o)?(g(o[0])||(o=[o]),r.map(f,function(i,u,l){return i-o[u][l]||0})):r.map(f,function(i){return i-o})},divide:function(f,o){return g(o)?(g(o[0])||(o=[o]),r.multiply(f,r.inv(o))):r.map(f,function(i){return i/o})},multiply:function(f,o){var i,u,l,d,v,p,E,m;if(f.length===void 0&&o.length===void 0)return f*o;if(v=f.length,p=f[0].length,E=r.zeros(v,l=g(o)?o[0].length:p),m=0,g(o)){for(;m<l;m++)for(i=0;i<v;i++){for(d=0,u=0;u<p;u++)d+=f[i][u]*o[u][m];E[i][m]=d}return v===1&&m===1?E[0][0]:E}return r.map(f,function(w){return w*o})},outer:function(f,o){return r.multiply(f.map(function(i){return[i]}),[o])},dot:function(f,o){g(f[0])||(f=[f]),g(o[0])||(o=[o]);for(var i=f[0].length===1&&f.length!==1?r.transpose(f):f,u=o[0].length===1&&o.length!==1?r.transpose(o):o,l=[],d=0,v=i.length,p=i[0].length,E,m;d<v;d++){for(l[d]=[],E=0,m=0;m<p;m++)E+=i[d][m]*u[d][m];l[d]=E}return l.length===1?l[0]:l},pow:function(f,o){return r.map(f,function(i){return s.pow(i,o)})},exp:function(f){return r.map(f,function(o){return s.exp(o)})},log:function(f){return r.map(f,function(o){return s.log(o)})},abs:function(f){return r.map(f,function(o){return s.abs(o)})},norm:function(f,o){var i=0,u=0;for(isNaN(o)&&(o=2),g(f[0])&&(f=f[0]);u<f.length;u++)i+=s.pow(s.abs(f[u]),o);return s.pow(i,1/o)},angle:function(f,o){return s.acos(r.dot(f,o)/(r.norm(f)*r.norm(o)))},aug:function(f,o){var i=[],u;for(u=0;u<f.length;u++)i.push(f[u].slice());for(u=0;u<i.length;u++)c.apply(i[u],o[u]);return i},inv:function(f){for(var o=f.length,i=f[0].length,u=r.identity(o,i),l=r.gauss_jordan(f,u),d=[],v=0,p;v<o;v++)for(d[v]=[],p=i;p<l[0].length;p++)d[v][p-i]=l[v][p];return d},det:function h(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var o=0,i=0;i<f.length;i++){for(var u=[],l=1;l<f.length;l++){u[l-1]=[];for(var d=0;d<f.length;d++)d<i?u[l-1][d]=f[l][d]:d>i&&(u[l-1][d-1]=f[l][d])}var v=i%2?-1:1;o+=h(u)*f[0][i]*v}return o},gauss_elimination:function(f,o){var i=0,u=0,l=f.length,d=f[0].length,v=1,p=0,E=[],m,w,N,A;for(f=r.aug(f,o),m=f[0].length,i=0;i<l;i++){for(w=f[i][i],u=i,A=i+1;A<d;A++)w<s.abs(f[A][i])&&(w=f[A][i],u=A);if(u!=i)for(A=0;A<m;A++)N=f[i][A],f[i][A]=f[u][A],f[u][A]=N;for(u=i+1;u<l;u++)for(v=f[u][i]/f[i][i],A=i;A<m;A++)f[u][A]=f[u][A]-v*f[i][A]}for(i=l-1;i>=0;i--){for(p=0,u=i+1;u<=l-1;u++)p=p+E[u]*f[i][u];E[i]=(f[i][m-1]-p)/f[i][i]}return E},gauss_jordan:function(f,o){var i=r.aug(f,o),u=i.length,l=i[0].length,d=0,v,p,E;for(p=0;p<u;p++){var m=p;for(E=p+1;E<u;E++)s.abs(i[E][p])>s.abs(i[m][p])&&(m=E);var w=i[p];for(i[p]=i[m],i[m]=w,E=p+1;E<u;E++)for(d=i[E][p]/i[p][p],v=p;v<l;v++)i[E][v]-=i[p][v]*d}for(p=u-1;p>=0;p--){for(d=i[p][p],E=0;E<p;E++)for(v=l-1;v>p-1;v--)i[E][v]-=i[p][v]*i[E][p]/d;for(i[p][p]/=d,v=u;v<l;v++)i[p][v]/=d}return i},triaUpSolve:function(f,o){var i=f[0].length,u=r.zeros(1,i)[0],l,d=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),d=!0),r.arange(i-1,-1,-1).forEach(function(v){l=r.arange(v+1,i).map(function(p){return u[p]*f[v][p]}),u[v]=(o[v]-r.sum(l))/f[v][v]}),d?u.map(function(v){return[v]}):u},triaLowSolve:function(f,o){var i=f[0].length,u=r.zeros(1,i)[0],l,d=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),d=!0),r.arange(i).forEach(function(v){l=r.arange(v).map(function(p){return f[v][p]*u[p]}),u[v]=(o[v]-r.sum(l))/f[v][v]}),d?u.map(function(v){return[v]}):u},lu:function(f){var o=f.length,i=r.identity(o),u=r.zeros(f.length,f[0].length),l;return r.arange(o).forEach(function(d){u[0][d]=f[0][d]}),r.arange(1,o).forEach(function(d){r.arange(d).forEach(function(v){l=r.arange(v).map(function(p){return i[d][p]*u[p][v]}),i[d][v]=(f[d][v]-r.sum(l))/u[v][v]}),r.arange(d,o).forEach(function(v){l=r.arange(d).map(function(p){return i[d][p]*u[p][v]}),u[d][v]=f[l.length][v]-r.sum(l)})}),[i,u]},cholesky:function(f){var o=f.length,i=r.zeros(f.length,f[0].length),u;return r.arange(o).forEach(function(l){u=r.arange(l).map(function(d){return s.pow(i[l][d],2)}),i[l][l]=s.sqrt(f[l][l]-r.sum(u)),r.arange(l+1,o).forEach(function(d){u=r.arange(l).map(function(v){return i[l][v]*i[d][v]}),i[d][l]=(f[l][d]-r.sum(u))/i[l][l]})}),i},gauss_jacobi:function(f,o,i,u){for(var l=0,d=0,v=f.length,p=[],E=[],m=[],w,N,A,I;l<v;l++)for(p[l]=[],E[l]=[],m[l]=[],d=0;d<v;d++)l>d?(p[l][d]=f[l][d],E[l][d]=m[l][d]=0):l<d?(E[l][d]=f[l][d],p[l][d]=m[l][d]=0):(m[l][d]=f[l][d],p[l][d]=E[l][d]=0);for(A=r.multiply(r.multiply(r.inv(m),r.add(p,E)),-1),N=r.multiply(r.inv(m),o),w=i,I=r.add(r.multiply(A,i),N),l=2;s.abs(r.norm(r.subtract(I,w)))>u;)w=I,I=r.add(r.multiply(A,w),N),l++;return I},gauss_seidel:function(f,o,i,u){for(var l=0,d=f.length,v=[],p=[],E=[],m,w,N,A,I;l<d;l++)for(v[l]=[],p[l]=[],E[l]=[],m=0;m<d;m++)l>m?(v[l][m]=f[l][m],p[l][m]=E[l][m]=0):l<m?(p[l][m]=f[l][m],v[l][m]=E[l][m]=0):(E[l][m]=f[l][m],v[l][m]=p[l][m]=0);for(A=r.multiply(r.multiply(r.inv(r.add(E,v)),p),-1),N=r.multiply(r.inv(r.add(E,v)),o),w=i,I=r.add(r.multiply(A,i),N),l=2;s.abs(r.norm(r.subtract(I,w)))>u;)w=I,I=r.add(r.multiply(A,w),N),l=l+1;return I},SOR:function(f,o,i,u,l){for(var d=0,v=f.length,p=[],E=[],m=[],w,N,A,I,y;d<v;d++)for(p[d]=[],E[d]=[],m[d]=[],w=0;w<v;w++)d>w?(p[d][w]=f[d][w],E[d][w]=m[d][w]=0):d<w?(E[d][w]=f[d][w],p[d][w]=m[d][w]=0):(m[d][w]=f[d][w],p[d][w]=E[d][w]=0);for(I=r.multiply(r.inv(r.add(m,r.multiply(p,l))),r.subtract(r.multiply(m,1-l),r.multiply(E,l))),A=r.multiply(r.multiply(r.inv(r.add(m,r.multiply(p,l))),o),l),N=i,y=r.add(r.multiply(I,i),A),d=2;s.abs(r.norm(r.subtract(y,N)))>u;)N=y,y=r.add(r.multiply(I,N),A),d++;return y},householder:function(f){for(var o=f.length,i=f[0].length,u=0,l=[],d=[],v,p,E,m,w;u<o-1;u++){for(v=0,m=u+1;m<i;m++)v+=f[m][u]*f[m][u];for(w=f[u+1][u]>0?-1:1,v=w*s.sqrt(v),p=s.sqrt((v*v-f[u+1][u]*v)/2),l=r.zeros(o,1),l[u+1][0]=(f[u+1][u]-v)/(2*p),E=u+2;E<o;E++)l[E][0]=f[E][u]/(2*p);d=r.subtract(r.identity(o,i),r.multiply(r.multiply(l,r.transpose(l)),2)),f=r.multiply(d,r.multiply(f,d))}return f},QR:(function(){var h=r.sum,f=r.arange;function o(i){var u=i.length,l=i[0].length,d=r.zeros(l,l);i=r.copy(i);var v,p,E;for(p=0;p<l;p++){for(d[p][p]=s.sqrt(h(f(u).map(function(m){return i[m][p]*i[m][p]}))),v=0;v<u;v++)i[v][p]=i[v][p]/d[p][p];for(E=p+1;E<l;E++)for(d[p][E]=h(f(u).map(function(m){return i[m][p]*i[m][E]})),v=0;v<u;v++)i[v][E]=i[v][E]-i[v][p]*d[p][E]}return[i,d]}return o})(),lstsq:(function(){function h(o){o=r.copy(o);var i=o.length,u=r.identity(i);return r.arange(i-1,-1,-1).forEach(function(l){r.sliceAssign(u,{row:l},r.divide(r.slice(u,{row:l}),o[l][l])),r.sliceAssign(o,{row:l},r.divide(r.slice(o,{row:l}),o[l][l])),r.arange(l).forEach(function(d){var v=r.multiply(o[d][l],-1),p=r.slice(o,{row:d}),E=r.multiply(r.slice(o,{row:l}),v);r.sliceAssign(o,{row:d},r.add(p,E));var m=r.slice(u,{row:d}),w=r.multiply(r.slice(u,{row:l}),v);r.sliceAssign(u,{row:d},r.add(m,w))})}),u}function f(o,i){var u=!1;i[0].length===void 0&&(i=i.map(function(I){return[I]}),u=!0);var l=r.QR(o),d=l[0],v=l[1],p=o[0].length,E=r.slice(d,{col:{end:p}}),m=r.slice(v,{row:{end:p}}),w=h(m),N=r.transpose(E);N[0].length===void 0&&(N=[N]);var A=r.multiply(r.multiply(w,N),i);return A.length===void 0&&(A=[[A]]),u?A.map(function(I){return I[0]}):A}return f})(),jacobi:function(f){for(var o=1,i=f.length,u=r.identity(i,i),l=[],d,v,p,E,m,w,N,A;o===1;){for(w=f[0][1],E=0,m=1,v=0;v<i;v++)for(p=0;p<i;p++)v!=p&&w<s.abs(f[v][p])&&(w=s.abs(f[v][p]),E=v,m=p);for(f[E][E]===f[m][m]?N=f[E][m]>0?s.PI/4:-s.PI/4:N=s.atan(2*f[E][m]/(f[E][E]-f[m][m]))/2,A=r.identity(i,i),A[E][E]=s.cos(N),A[E][m]=-s.sin(N),A[m][E]=s.sin(N),A[m][m]=s.cos(N),u=r.multiply(u,A),d=r.multiply(r.multiply(r.inv(A),f),A),f=d,o=0,v=1;v<i;v++)for(p=1;p<i;p++)v!=p&&s.abs(f[v][p])>.001&&(o=1)}for(v=0;v<i;v++)l.push(f[v][v]);return[u,l]},rungekutta:function(f,o,i,u,l,d){var v,p,E,m,w;if(d===2)for(;u<=i;)v=o*f(u,l),p=o*f(u+o,l+v),E=l+(v+p)/2,l=E,u=u+o;if(d===4)for(;u<=i;)v=o*f(u,l),p=o*f(u+o/2,l+v/2),m=o*f(u+o/2,l+p/2),w=o*f(u+o,l+m),E=l+(v+2*p+2*m+w)/6,l=E,u=u+o;return l},romberg:function(f,o,i,u){for(var l=0,d=(i-o)/2,v=[],p=[],E=[],m,w,N,A,I;l<u/2;){for(I=f(o),N=o,A=0;N<=i;N=N+d,A++)v[A]=N;for(m=v.length,N=1;N<m-1;N++)I+=(N%2!==0?4:2)*f(v[N]);I=d/3*(I+f(i)),E[l]=I,d/=2,l++}for(w=E.length,m=1;w!==1;){for(N=0;N<w-1;N++)p[N]=(s.pow(4,m)*E[N+1]-E[N])/(s.pow(4,m)-1);w=p.length,E=p,p=[],m++}return E},richardson:function(f,o,i,u){function l(y,T){for(var C=0,V=y.length,H;C<V;C++)y[C]===T&&(H=C);return H}for(var d=s.abs(i-f[l(f,i)+1]),v=0,p=[],E=[],m,w,N,A,I;u>=d;)m=l(f,i+u),w=l(f,i),p[v]=(o[m]-2*o[w]+o[2*w-m])/(u*u),u/=2,v++;for(A=p.length,N=1;A!=1;){for(I=0;I<A-1;I++)E[I]=(s.pow(4,N)*p[I+1]-p[I])/(s.pow(4,N)-1);A=E.length,p=E,E=[],N++}return p},simpson:function(f,o,i,u){for(var l=(i-o)/u,d=f(o),v=[],p=o,E=0,m=1,w;p<=i;p=p+l,E++)v[E]=p;for(w=v.length;m<w-1;m++)d+=(m%2!==0?4:2)*f(v[m]);return l/3*(d+f(i))},hermite:function(f,o,i,u){for(var l=f.length,d=0,v=0,p=[],E=[],m=[],w=[],N;v<l;v++){for(p[v]=1,N=0;N<l;N++)v!=N&&(p[v]*=(u-f[N])/(f[v]-f[N]));for(E[v]=0,N=0;N<l;N++)v!=N&&(E[v]+=1/(f[v]-f[N]));m[v]=(1-2*(u-f[v])*E[v])*(p[v]*p[v]),w[v]=(u-f[v])*(p[v]*p[v]),d+=m[v]*o[v]+w[v]*i[v]}return d},lagrange:function(f,o,i){for(var u=0,l=0,d,v,p=f.length;l<p;l++){for(v=o[l],d=0;d<p;d++)l!=d&&(v*=(i-f[d])/(f[l]-f[d]));u+=v}return u},cubic_spline:function(f,o,i){for(var u=f.length,l=0,d,v=[],p=[],E=[],m=[],w=[],N=[],A=[];l<u-1;l++)w[l]=f[l+1]-f[l];for(E[0]=0,l=1;l<u-1;l++)E[l]=3/w[l]*(o[l+1]-o[l])-3/w[l-1]*(o[l]-o[l-1]);for(l=1;l<u-1;l++)v[l]=[],p[l]=[],v[l][l-1]=w[l-1],v[l][l]=2*(w[l-1]+w[l]),v[l][l+1]=w[l],p[l][0]=E[l];for(m=r.multiply(r.inv(v),p),d=0;d<u-1;d++)N[d]=(o[d+1]-o[d])/w[d]-w[d]*(m[d+1][0]+2*m[d][0])/3,A[d]=(m[d+1][0]-m[d][0])/(3*w[d]);for(d=0;d<u&&!(f[d]>i);d++);return d-=1,o[d]+(i-f[d])*N[d]+r.sq(i-f[d])*m[d]+(i-f[d])*r.sq(i-f[d])*A[d]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var o=f.length,i=f[0].length,u=0,l,d,v=[],p=[],E=[],m=[],w=[],N=[],A=[],I=[],y=[],T=[];for(u=0;u<o;u++)v[u]=r.sum(f[u])/i;for(u=0;u<i;u++)for(A[u]=[],l=0;l<o;l++)A[u][l]=f[l][u]-v[l];for(A=r.transpose(A),u=0;u<o;u++)for(I[u]=[],l=0;l<o;l++)I[u][l]=r.dot([A[u]],[A[l]])/(i-1);for(E=r.jacobi(I),y=E[0],p=E[1],T=r.transpose(y),u=0;u<p.length;u++)for(l=u;l<p.length;l++)p[u]<p[l]&&(d=p[u],p[u]=p[l],p[l]=d,m=T[u],T[u]=T[l],T[l]=m);for(N=r.transpose(A),u=0;u<o;u++)for(w[u]=[],l=0;l<N.length;l++)w[u][l]=r.dot([T[u]],[N[l]]);return[f,p,T,w]}}),(function(h){for(var f=0;f<h.length;f++)(function(o){r.fn[o]=function(i,u){var l=this;return u?(setTimeout(function(){u.call(l,r.fn[o].call(l,i))},15),this):typeof r[o](this,i)=="number"?r[o](this,i):r(r[o](this,i))}})(h[f])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(t,Math),(function(r,s){var c=[].slice,a=r.utils.isNumber,g=r.utils.isArray;r.extend({zscore:function(){var o=c.call(arguments);return a(o[1])?(o[0]-o[1])/o[2]:(o[0]-r.mean(o[1]))/r.stdev(o[1],o[2])},ztest:function(){var o=c.call(arguments),i;return g(o[1])?(i=r.zscore(o[0],o[1],o[3]),o[2]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2):o.length>2?(i=r.zscore(o[0],o[1],o[2]),o[3]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2):(i=o[0],o[1]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2)}}),r.extend(r.fn,{zscore:function(o,i){return(o-this.mean())/this.stdev(i)},ztest:function(o,i,u){var l=s.abs(this.zscore(o,u));return i===1?r.normal.cdf(-l,0,1):r.normal.cdf(-l,0,1)*2}}),r.extend({tscore:function(){var o=c.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/s.sqrt(o[3])):(o[0]-r.mean(o[1]))/(r.stdev(o[1],!0)/s.sqrt(o[1].length))},ttest:function(){var o=c.call(arguments),i;return o.length===5?(i=s.abs(r.tscore(o[0],o[1],o[2],o[3])),o[4]===1?r.studentt.cdf(-i,o[3]-1):r.studentt.cdf(-i,o[3]-1)*2):a(o[1])?(i=s.abs(o[0]),o[2]==1?r.studentt.cdf(-i,o[1]-1):r.studentt.cdf(-i,o[1]-1)*2):(i=s.abs(r.tscore(o[0],o[1])),o[2]==1?r.studentt.cdf(-i,o[1].length-1):r.studentt.cdf(-i,o[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/s.sqrt(this.cols()))},ttest:function(o,i){return i===1?1-r.studentt.cdf(s.abs(this.tscore(o)),this.cols()-1):r.studentt.cdf(-s.abs(this.tscore(o)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var o=c.call(arguments),i,u,l,d,v,p,E,m;if(o.length===1){for(v=new Array(o[0].length),E=0;E<o[0].length;E++)v[E]=o[0][E];o=v}for(u=new Array,E=0;E<o.length;E++)u=u.concat(o[E]);for(l=r.mean(u),i=0,E=0;E<o.length;E++)i=i+o[E].length*s.pow(r.mean(o[E])-l,2);for(i/=o.length-1,p=0,E=0;E<o.length;E++)for(d=r.mean(o[E]),m=0;m<o[E].length;m++)p+=s.pow(o[E][m]-d,2);return p/=u.length-o.length,i/p},anovaftest:function(){var o=c.call(arguments),i,u,l,d;if(a(o[0]))return 1-r.centralF.cdf(o[0],o[1],o[2]);var v=r.anovafscore(o);for(i=o.length-1,l=0,d=0;d<o.length;d++)l=l+o[d].length;return u=l-i-1,1-r.centralF.cdf(v,i,u)},ftest:function(o,i,u){return 1-r.centralF.cdf(o,i,u)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var o=0,i;for(i=0;i<this.length;i++)o=o+this[i].length;return r.ftest(this.anovafscore(),this.length-1,o-this.length)}}),r.extend({qscore:function(){var o=c.call(arguments),i,u,l,d,v;return a(o[0])?(i=o[0],u=o[1],l=o[2],d=o[3],v=o[4]):(i=r.mean(o[0]),u=r.mean(o[1]),l=o[0].length,d=o[1].length,v=o[2]),s.abs(i-u)/(v*s.sqrt((1/l+1/d)/2))},qtest:function(){var o=c.call(arguments),i;o.length===3?(i=o[0],o=o.slice(1)):o.length===7?(i=r.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(i=r.qscore(o[0],o[1],o[2]),o=o.slice(3));var u=o[0],l=o[1];return 1-r.tukey.cdf(i,l,u-l)},tukeyhsd:function(o){for(var i=r.pooledstdev(o),u=o.map(function(m){return r.mean(m)}),l=o.reduce(function(m,w){return m+w.length},0),d=[],v=0;v<o.length;++v)for(var p=v+1;p<o.length;++p){var E=r.qtest(u[v],u[p],o[v].length,o[p].length,i,l,o.length);d.push([[v,p],E])}return d}}),r.extend({normalci:function(){var o=c.call(arguments),i=new Array(2),u;return o.length===4?u=s.abs(r.normal.inv(o[1]/2,0,1)*o[2]/s.sqrt(o[3])):u=s.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/s.sqrt(o[2].length)),i[0]=o[0]-u,i[1]=o[0]+u,i},tci:function(){var o=c.call(arguments),i=new Array(2),u;return o.length===4?u=s.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/s.sqrt(o[3])):u=s.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/s.sqrt(o[2].length)),i[0]=o[0]-u,i[1]=o[0]+u,i},significant:function(o,i){return o<i}}),r.extend(r.fn,{normalci:function(o,i){return r.normalci(o,i,this.toArray())},tci:function(o,i){return r.tci(o,i,this.toArray())}});function h(f,o,i,u){if(f>1||i>1||f<=0||i<=0)throw new Error("Proportions should be greater than 0 and less than 1");var l=(f*o+i*u)/(o+u),d=s.sqrt(l*(1-l)*(1/o+1/u));return(f-i)/d}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(o,i,u,l){var d=h(o,i,u,l);return r.ztest(d,1)},twoSidedDifferenceOfProportions:function(o,i,u,l){var d=h(o,i,u,l);return r.ztest(d,2)}})})(t,Math),t.models=(function(){function r(h){var f=h[0].length,o=t.arange(f).map(function(i){var u=t.arange(f).filter(function(l){return l!==i});return s(t.col(h,i).map(function(l){return l[0]}),t.col(h,u))});return o}function s(h,f){var o=h.length,i=f[0].length-1,u=o-i-1,l=t.lstsq(f,h),d=t.multiply(f,l.map(function(A){return[A]})).map(function(A){return A[0]}),v=t.subtract(h,d),p=t.mean(h),E=t.sum(d.map(function(A){return Math.pow(A-p,2)})),m=t.sum(h.map(function(A,I){return Math.pow(A-d[I],2)})),w=E+m,N=E/w;return{exog:f,endog:h,nobs:o,df_model:i,df_resid:u,coef:l,predict:d,resid:v,ybar:p,SST:w,SSE:E,SSR:m,R2:N}}function c(h){var f=r(h.exog),o=Math.sqrt(h.SSR/h.df_resid),i=f.map(function(p){var E=p.SST,m=p.R2;return o/Math.sqrt(E*(1-m))}),u=h.coef.map(function(p,E){return(p-0)/i[E]}),l=u.map(function(p){var E=t.studentt.cdf(p,h.df_resid);return(E>.5?1-E:E)*2}),d=t.studentt.inv(.975,h.df_resid),v=h.coef.map(function(p,E){var m=d*i[E];return[p-m,p+m]});return{se:i,t:u,p:l,sigmaHat:o,interval95:v}}function a(h){var f=h.R2/h.df_model/((1-h.R2)/h.df_resid),o=function(u,l,d){return t.beta.cdf(u/(d/l+u),l/2,d/2)},i=1-o(f,h.df_model,h.df_resid);return{F_statistic:f,pvalue:i}}function g(h,f){var o=s(h,f),i=c(o),u=a(o),l=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=i,o.f=u,o.adjust_R2=l,o}return{ols:g}})(),t.extend({buildxmatrix:function(){for(var s=new Array(arguments.length),c=0;c<arguments.length;c++){var a=[1];s[c]=a.concat(arguments[c])}return t(s)},builddxmatrix:function(){for(var s=new Array(arguments[0].length),c=0;c<arguments[0].length;c++){var a=[1];s[c]=a.concat(arguments[0][c])}return t(s)},buildjxmatrix:function(s){for(var c=new Array(s.length),a=0;a<s.length;a++)c[a]=s[a];return t.builddxmatrix(c)},buildymatrix:function(s){return t(s).transpose()},buildjymatrix:function(s){return s.transpose()},matrixmult:function(s,c){var a,g,h,f,o;if(s.cols()==c.rows()){if(c.rows()>1){for(f=[],a=0;a<s.rows();a++)for(f[a]=[],g=0;g<c.cols();g++){for(o=0,h=0;h<s.cols();h++)o+=s.toArray()[a][h]*c.toArray()[h][g];f[a][g]=o}return t(f)}for(f=[],a=0;a<s.rows();a++)for(f[a]=[],g=0;g<c.cols();g++){for(o=0,h=0;h<s.cols();h++)o+=s.toArray()[a][h]*c.toArray()[g];f[a][g]=o}return t(f)}},regress:function(s,c){var a=t.xtranspxinv(s),g=s.transpose(),h=t.matrixmult(t(a),g);return t.matrixmult(h,c)},regresst:function(s,c,a){var g=t.regress(s,c),h={};h.anova={};var f=t.jMatYBar(s,g);h.yBar=f;var o=c.mean();h.anova.residuals=t.residuals(c,f),h.anova.ssr=t.ssr(f,o),h.anova.msr=h.anova.ssr/(s[0].length-1),h.anova.sse=t.sse(c,f),h.anova.mse=h.anova.sse/(c.length-(s[0].length-1)-1),h.anova.sst=t.sst(c,o),h.anova.mst=h.anova.sst/(c.length-1),h.anova.r2=1-h.anova.sse/h.anova.sst,h.anova.r2<0&&(h.anova.r2=0),h.anova.fratio=h.anova.msr/h.anova.mse,h.anova.pvalue=t.anovaftest(h.anova.fratio,s[0].length-1,c.length-(s[0].length-1)-1),h.anova.rmse=Math.sqrt(h.anova.mse),h.anova.r2adj=1-h.anova.mse/h.anova.mst,h.anova.r2adj<0&&(h.anova.r2adj=0),h.stats=new Array(s[0].length);for(var i=t.xtranspxinv(s),u,l,d,v=0;v<g.length;v++)u=Math.sqrt(h.anova.mse*Math.abs(i[v][v])),l=Math.abs(g[v]/u),d=t.ttest(l,c.length-s[0].length-1,a),h.stats[v]=[g[v],u,l,d];return h.regress=g,h},xtranspx:function(s){return t.matrixmult(s.transpose(),s)},xtranspxinv:function(s){var c=t.matrixmult(s.transpose(),s),a=t.inv(c);return a},jMatYBar:function(s,c){var a=t.matrixmult(s,c);return new t(a)},residuals:function(s,c){return t.matrixsubtract(s,c)},ssr:function(s,c){for(var a=0,g=0;g<s.length;g++)a+=Math.pow(s[g]-c,2);return a},sse:function(s,c){for(var a=0,g=0;g<s.length;g++)a+=Math.pow(s[g]-c[g],2);return a},sst:function(s,c){for(var a=0,g=0;g<s.length;g++)a+=Math.pow(s[g]-c,2);return a},matrixsubtract:function(s,c){for(var a=new Array(s.length),g=0;g<s.length;g++){a[g]=new Array(s[g].length);for(var h=0;h<s[g].length;h++)a[g][h]=s[g][h]-c[g][h]}return t(a)}}),t.jStat=t,t})})(Zn)),Zn.exports}var Ys=zs();const K=Xr(Ys);var Er={},Ot;function Bs(){return Ot||(Ot=1,(function(e){(function(n){n(typeof DO_NOT_EXPORT_BESSEL>"u"?e:{})})(function(n){n.version="1.0.2";var t=Math;function r(o,i){for(var u=0,l=0;u<o.length;++u)l=i*l+o[u];return l}function s(o,i,u,l,d){if(i===0)return u;if(i===1)return l;for(var v=2/o,p=l,E=1;E<i;++E)p=l*E*v+d*u,u=l,l=p;return p}function c(o,i,u,l,d){return function(p,E){if(l){if(p===0)return l==1?-1/0:1/0;if(p<0)return NaN}if(E===0)return o(p);if(E===1)return i(p);if(E<0)return NaN;E|=0;var m=o(p),w=i(p);return s(p,E,m,w,d)}}var a=(function(){var o=.636619772,i=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function v(A){var I=0,y=0,T=0,C=A*A;if(A<8)y=r(i,C),T=r(u,C),I=y/T;else{var V=A-.785398164;C=64/C,y=r(l,C),T=r(d,C),I=t.sqrt(o/A)*(t.cos(V)*y-t.sin(V)*T*8/A)}return I}var p=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),E=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),w=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(A){var I=0,y=0,T=0,C=A*A,V=t.abs(A)-2.356194491;return Math.abs(A)<8?(y=A*r(p,C),T=r(E,C),I=y/T):(C=64/C,y=r(m,C),T=r(w,C),I=t.sqrt(o/t.abs(A))*(t.cos(V)*y-t.sin(V)*T*8/t.abs(A)),A<0&&(I=-I)),I}return function A(I,y){if(y=Math.round(y),!isFinite(I))return isNaN(I)?I:0;if(y<0)return(y%2?-1:1)*A(I,-y);if(I<0)return(y%2?-1:1)*A(-I,y);if(y===0)return v(I);if(y===1)return N(I);if(I===0)return 0;var T=0;if(I>y)T=s(I,y,v(I),N(I),-1);else{for(var C=2*t.floor((y+t.floor(t.sqrt(40*y)))/2),V=!1,H=0,B=0,X=1,te=0,ue=2/I,we=C;we>0;we--)te=we*ue*X-H,H=X,X=te,t.abs(X)>1e10&&(X*=1e-10,H*=1e-10,T*=1e-10,B*=1e-10),V&&(B+=X),V=!V,we==y&&(T=H);B=2*B-X,T/=B}return T}})(),g=(function(){var o=.636619772,i=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),u=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function v(A){var I=0,y=0,T=0,C=A*A,V=A-.785398164;return A<8?(y=r(i,C),T=r(u,C),I=y/T+o*a(A,0)*t.log(A)):(C=64/C,y=r(l,C),T=r(d,C),I=t.sqrt(o/A)*(t.sin(V)*y+t.cos(V)*T*8/A)),I}var p=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),E=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),m=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),w=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(A){var I=0,y=0,T=0,C=A*A,V=A-2.356194491;return A<8?(y=A*r(p,C),T=r(E,C),I=y/T+o*(a(A,1)*t.log(A)-1/A)):(C=64/C,y=r(m,C),T=r(w,C),I=t.sqrt(o/A)*(t.sin(V)*y+t.cos(V)*T*8/A)),I}return c(v,N,"BESSELY",1,-1)})(),h=(function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),i=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function u(p){return p<=3.75?r(o,p*p/(3.75*3.75)):t.exp(t.abs(p))/t.sqrt(t.abs(p))*r(i,3.75/t.abs(p))}var l=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),d=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function v(p){return p<3.75?p*r(l,p*p/(3.75*3.75)):(p<0?-1:1)*t.exp(t.abs(p))/t.sqrt(t.abs(p))*r(d,3.75/t.abs(p))}return function p(E,m){if(m=Math.round(m),m===0)return u(E);if(m===1)return v(E);if(m<0)return NaN;if(t.abs(E)===0)return 0;if(E==1/0)return 1/0;var w=0,N,A=2/t.abs(E),I=0,y=1,T=0,C=2*t.round((m+t.round(t.sqrt(40*m)))/2);for(N=C;N>0;N--)T=N*A*y+I,I=y,y=T,t.abs(y)>1e10&&(y*=1e-10,I*=1e-10,w*=1e-10),N==m&&(w=I);return w*=p(E,0)/y,E<0&&m%2?-w:w}})(),f=(function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function u(p){return p<=2?-t.log(p/2)*h(p,0)+r(o,p*p/4):t.exp(-p)/t.sqrt(p)*r(i,2/p)}var l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),d=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function v(p){return p<=2?t.log(p/2)*h(p,1)+1/p*r(l,p*p/4):t.exp(-p)/t.sqrt(p)*r(d,2/p)}return c(u,v,"BESSELK",2,1)})();n.besselj=a,n.bessely=g,n.besseli=h,n.besselk=f})})(Er)),Er}var Gs=Bs();const rr=Xr(Gs),Zr=new Error("#NULL!"),Ve=new Error("#DIV/0!"),D=new Error("#VALUE!"),Cn=new Error("#REF!"),tr=new Error("#NAME?"),P=new Error("#NUM!"),ee=new Error("#N/A"),Qr=new Error("#ERROR!"),to=new Error("#GETTING_DATA");var ks=Object.freeze({__proto__:null,data:to,div0:Ve,error:Qr,na:ee,name:tr,nil:Zr,num:P,ref:Cn,value:D});let tn=!1;function Ws(){tn=!0}function Xs(){tn=!1}function oo(e){e<60&&(e+=1);const t=Math.floor(e-25569)*86400,r=new Date(t*1e3),s=e-Math.floor(e)+1e-7;let c=Math.floor(86400*s);const a=c%60;c-=a;const g=Math.floor(c/3600),h=Math.floor(c/60)%60;let f=r.getUTCDate(),o=r.getUTCMonth();return e>=60&&e<61&&(f=29,o=1),new Date(r.getUTCFullYear(),o,f,g,h,a)}function nn(e){const n=new Date(1900,0,1),t=e>-22038912e5?2:1;return Math.ceil((e-n)/864e5)+t}var Ks=Object.freeze({__proto__:null,dateToSerial:nn,get returnSerial(){return tn},serialToDate:oo,useDate:Xs,useSerial:Ws});const Ss="=",Zs=[">",">=","<","<=","=","<>"],so="operator",io="literal",Qs=[so,io],Qn=so,an=io;function je(e,n){if(Qs.indexOf(n)===-1)throw new Error("Unsupported token type: "+n);return{value:e,type:n}}function Js(e){return typeof e!="string"||/^\d+(\.\d+)?$/.test(e)&&(e=e.indexOf(".")===-1?parseInt(e,10):parseFloat(e)),e}function bs(e){const n=e.length,t=[];let r=0,s="",c="";for(;r<n;){const a=e.charAt(r);switch(a){case">":case"<":case"=":c=c+a,s.length>0&&(t.push(s),s="");break;default:c.length>0&&(t.push(c),c=""),s=s+a;break}r++}return s.length>0&&t.push(s),c.length>0&&t.push(c),t}function _s(e){let n="";const t=[];for(let r=0;r<e.length;r++){const s=e[r];r===0&&Zs.indexOf(s)>=0?t.push(je(s,Qn)):n+=s}return n.length>0&&t.push(je(Js(n),an)),t.length>0&&t[0].type!==Qn&&t.unshift(je(Ss,Qn)),t}function js(e){const n=[];let t;for(let r=0;r<e.length;r++){const s=e[r];switch(s.type){case Qn:t=s.value;break;case an:n.push(s.value);break}}return ei(n,t)}function ei(e,n){let t=!1;switch(n){case">":t=e[0]>e[1];break;case">=":t=e[0]>=e[1];break;case"<":t=e[0]<e[1];break;case"<=":t=e[0]<=e[1];break;case"=":t=e[0]==e[1];break;case"<>":t=e[0]!=e[1];break}return t}function Dn(e){return _s(bs(e))}const On=js;function or(e){const n=[];return qe(e,t=>{n.push(t)}),n}function qe(e,n){let t=-1;const r=e.length;for(;++t<r&&n(e[t],t,e)!==!1;);return e}function Jr(e){let n=e.length,t;for(;n--;)if(t=e[n],typeof t!="number"){if(t===!0){e[n]=1;continue}if(t===!1){e[n]=0;continue}if(typeof t=="string"){const r=R(t);e[n]=r instanceof Error?0:r}}return e}function fo(e,n){if(!e)return D;(!e.every(s=>Array.isArray(s))||e.length===0)&&(e=[[...e]]),e.map((s,c)=>{s.map((a,g)=>{a||(e[c][g]=0)})});const t=e.reduce((s,c,a)=>c.length>e[s].length?a:s,0),r=e[t].length;return e.map(s=>[...s,...Array(r-s.length).fill(0)])}function z(){let e;if(arguments.length===1){const n=arguments[0];e=ri(n)?or.apply(null,arguments):[n]}else e=Array.from(arguments);for(;!ti(e);)e=kr(e);return e}function kr(e){return!e||!e.reduce?[e]:e.reduce((n,t)=>{const r=Array.isArray(n),s=Array.isArray(t);return r&&s?n.concat(t):r?(n.push(t),n):s?[n].concat(t):[n,t]})}function ni(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(0,e.length-n)}function ri(e){return e!=null&&typeof e.length=="number"&&typeof e!="string"}function ti(e){if(!e)return!1;for(let n=0;n<e.length;++n)if(Array.isArray(e[n]))return!1;return!0}function Ie(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(n)}function Jn(e){return e?e[0].map((n,t)=>e.map(r=>r[t])):D}function Xe(e,n){let t=null;return qe(e,(r,s)=>{if(r[0]===n)return t=s,!1}),t==null?D:t}function ce(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function $(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function uo(e){return Math.round(e*1e14)/1e14}function on(){return z.apply(null,arguments).filter(n=>typeof n=="number")}function br(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const n=e.toUpperCase();if(n==="TRUE")return!0;if(n==="FALSE")return!1}return e instanceof Date&&!isNaN(e)?!0:D}function pe(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const n=parseFloat(e);return n<0||n>=2958466?P:oo(n)}return typeof e=="string"&&(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),!isNaN(e))?e:D}function lo(e){let n=e.length,t;for(;n--;){if(t=pe(e[n]),t===D)return t;e[n]=t}return e}function R(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),!isNaN(e)&&e!==""?parseFloat(e):D)}function Z(e){let n;if(!e||(n=e.length)===0)return D;let t;for(;n--;){if(e[n]instanceof Error)return e[n];if(t=R(e[n]),t instanceof Error)return t;e[n]=t}return e}function Ce(e){return e instanceof Error?e:e==null?"":e.toString()}function sr(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function ir(){const e=or(arguments),n=Z(z(e.shift()));if(n instanceof Error)return n;const t=e,r=t.length/2;for(let c=0;c<r;c++)t[c*2]=z(t[c*2]);let s=[];for(let c=0;c<n.length;c++){let a=!1;for(let g=0;g<r;g++){const h=t[g*2][c],f=t[g*2+1],o=f===void 0||f==="*";let i=!1;if(o)i=!0;else{const u=Dn(f+""),l=[je(h,an)].concat(u);i=On(l)}if(!i){a=!1;break}a=!0}a&&s.push(n[c])}return s}function mn(e){return e!=null}const co={};co.TYPE=e=>{switch(e){case Zr:return 1;case Ve:return 2;case D:return 3;case Cn:return 4;case tr:return 5;case P:return 6;case ee:return 7;case to:return 8}return ee};function oi(e){return e===null}function ao(e){return[D,Cn,Ve,P,tr,Zr].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function fr(e){return ao(e)||e===ee}function si(e){return!(Math.floor(Math.abs(e))&1)}function go(e){return e===!0||e===!1}function ii(e){return e===ee}function fi(e){return typeof e!="string"}function ur(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function ui(e){return!!(Math.floor(Math.abs(e))&1)}function ho(e){return typeof e=="string"}function li(e){return ur(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:fr(e)?e:0}function ci(){return ee}function ai(e){if(ur(e))return 1;if(ho(e))return 2;if(go(e))return 4;if(fr(e))return 16;if(Array.isArray(e))return 64}function gi(){if(arguments.length<2)return ee;const e=arguments[0];return e<1||e>254||arguments.length<e+1?D:arguments[e]}function hi(e,n){if(arguments.length!==2)return ee;if(n<0)return P;if(!(e instanceof Array)||typeof n!="number")return D;if(e.length!==0)return K.col(e,n)}function di(e){return arguments.length!==1?ee:e instanceof Array?e.length===0?0:K.cols(e):D}function vi(e,n,t,r){return vo(e,Jn(n),t,r)}function pi(e,n,t){const r=ce(e,n,t);if(r)return r;if(!Array.isArray(e))return D;const s=e.length>0&&!Array.isArray(e[0]);return s&&!t?(t=n,n=1):(t=t||1,n=n||1),t<0||n<0?D:s&&n===1&&t<=e.length?e[t-1]:n<=e.length&&t<=e[n-1].length?e[n-1][t-1]:Cn}function wi(e,n,t){n=z(n),t=t?z(t):n;const r=typeof e=="number";let s=ee;for(let c=0;c<n.length;c++){if(n[c]===e)return t[c];if(r&&n[c]<=e||typeof n[c]=="string"&&n[c].localeCompare(e)<0)s=t[c];else if(r&&n[c]>e)return s}return s}function Ei(e,n,t){if(!e&&e!==0||!n||(arguments.length===2&&(t=1),n=z(n),!(n instanceof Array))||t!==-1&&t!==0&&t!==1)return ee;let r,s;for(let c=0;c<n.length;c++)if(t===1){if(n[c]===e)return c+1;n[c]<e&&(s?n[c]>s&&(r=c+1,s=n[c]):(r=c+1,s=n[c]))}else if(t===0){if(typeof e=="string"&&typeof n[c]=="string"){const a=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]");if(new RegExp("^"+a+"$").test(n[c].toLowerCase()))return c+1}else if(n[c]===e)return c+1}else if(t===-1){if(n[c]===e)return c+1;n[c]>e&&(s?n[c]<s&&(r=c+1,s=n[c]):(r=c+1,s=n[c]))}return r||ee}function mi(e){return arguments.length!==1?ee:e instanceof Array?e.length===0?0:K.rows(e):D}function Ni(e,n=1,t=1,r=!1){if(!e||!Array.isArray(e))return ee;if(e.length===0)return 0;if(n=R(n),!n||n<1||(t=R(t),t!==1&&t!==-1))return D;if(r=br(r),typeof r!="boolean")return tr;const s=g=>g.sort((h,f)=>(h=Ce(h[n-1]),f=Ce(f[n-1]),t===1?h<f?t*-1:t:h>f?t:t*-1)),c=fo(e),a=r?Jn(c):c;return n>=1&&n<=a[0].length?r?Jn(s(a)):s(a):D}function Ai(e){if(!e)return ee;const n=fo(e);return Jn(n)}function _r(){const e=[];for(let n=0;n<arguments.length;++n){let t=!1;const r=arguments[n];for(let s=0;s<e.length&&(t=e[s]===r,!t);++s);t||e.push(r)}return e}function vo(e,n,t,r){if(!n||!t)return ee;r=!(r===0||r===!1);let s=ee,c=!1;const a=typeof e=="number",g=typeof e=="string"?e.toLowerCase():e;for(let h=0;h<n.length;h++){const f=n[h],o=typeof f[0]=="string"?f[0].toLowerCase():f[0];if(o===g){s=t<f.length+1?f[t-1]:Cn;break}else!c&&(a&&r&&o<=e||r&&typeof o=="string"&&o.localeCompare(e)<0)&&(s=t<f.length+1?f[t-1]:Cn);a&&o>e&&(c=!0)}return s}function po(e){return e=R(e),e===0?D:e instanceof Error?e:String.fromCharCode(e)}function Ri(e){if($(e))return e;e=e||"";const n=/[\0-\x1F]/g;return e.replace(n,"")}function wo(e){if($(e))return e;e=e||"";let n=e.charCodeAt(0);return isNaN(n)&&(n=D),n}function Eo(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;let t=0;for(;(t=e.indexOf(!0))>-1;)e[t]="TRUE";let r=0;for(;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")}const Ii=Eo;function yi(e,n=2){if(e=R(e),isNaN(e))return D;e=Lo(e,n);const t={style:"currency",currency:"USD",minimumFractionDigits:n>=0?n:0,maximumFractionDigits:n>=0?n:0},r=e.toLocaleString("en-US",t);return e<0?"$("+r.slice(2)+")":r}function Mi(e,n){if(arguments.length!==2)return ee;const t=ce(e,n);return t||(e=Ce(e),n=Ce(n),e===n)}function Ti(e,n,t){if(arguments.length<2)return ee;e=Ce(e),n=Ce(n),t=t===void 0?0:t;const r=n.indexOf(e,t-1);return r===-1?D:r+1}function mo(e,n=2,t=!1){if(e=R(e),isNaN(e)||(n=R(n),isNaN(n)))return D;if(n<0){const r=Math.pow(10,-n);e=Math.round(e/r)*r}else e=e.toFixed(n);if(t)e=e.toString().replace(/,/g,"");else{const r=e.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+$)/g,","),e=r.join(".")}return e}function Ci(e,n){const t=ce(e,n);return t||(e=Ce(e),n=n===void 0?1:n,n=R(n),n instanceof Error||typeof e!="string"?D:e.substring(0,n))}function Di(e){return arguments.length===0?Qr:e instanceof Error?e:Array.isArray(e)?D:Ce(e).length}function Oi(e){return arguments.length!==1?D:(e=Ce(e),$(e)?e:e.toLowerCase())}function Li(e,n,t){if(n==null)return D;if(n=R(n),t=R(t),$(n,t)||typeof e!="string")return t;const r=n-1,s=r+t;return e.substring(r,s)}function Fi(e,n,t){return e=mn(e)?e:"",typeof e=="number"?e:typeof e!="string"?ee:(n=typeof n>"u"?".":n,t=typeof t>"u"?",":t,Number(e.replace(n,".").replace(t,"")))}function Pi(e){return $(e)?e:isNaN(e)&&typeof e=="number"?D:(e=Ce(e),e.replace(/\w\S*/g,n=>n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()))}function Vi(e,n,t,r){return n=R(n),t=R(t),$(n,t)||typeof e!="string"||typeof r!="string"?D:e.substr(0,n-1)+r+e.substr(n-1+t)}function We(e,n){const t=ce(e,n);return t||(e=Ce(e),n=R(n),n instanceof Error?n:new Array(n+1).join(e))}function qi(e,n){const t=ce(e,n);return t||(e=Ce(e),n=n===void 0?1:n,n=R(n),n instanceof Error?n:e.substring(e.length-n))}function Ui(e,n,t){let r;return typeof e!="string"||typeof n!="string"?D:(t=t===void 0?0:t,r=n.toLowerCase().indexOf(e.toLowerCase(),t-1)+1,r===0?D:r)}function $i(e,n,t,r){if(arguments.length<3)return ee;if(!e||!n)return e;if(r===void 0)return e.split(n).join(t);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return D;let s=0,c=0;for(;s>-1&&e.indexOf(n,s)>-1;)if(s=e.indexOf(n,s+1),c++,s>-1&&c===r)return e.substring(0,s)+t+e.substring(s+n.length);return e}}function Ye(e){return e instanceof Error||typeof e=="string"?e:""}function xi(e,n){if(e===void 0||e instanceof Error||n instanceof Error)return ee;if(e instanceof Date)return e.toISOString().slice(0,10);if(n==null)return"";if(typeof n=="number")return String(n);if(typeof n!="string")return D;const t=n.startsWith("$")?"$":"",r=n.endsWith("%");n=n.replace(/%/g,"").replace(/\$/g,"");const s=n.includes(".")?n.split(".")[1].match(/0/g).length:0,c=!n.includes(",");return r&&(e=e*100),e=mo(e,s,c),e.startsWith("-")?(e=e.replace("-",""),e="-"+t+e):e=t+e,r&&(e=e+"%"),e}function Hi(e,n,...t){if(typeof n!="boolean"&&(n=br(n)),arguments.length<3)return ee;e=e!=null?e:"";let r=z(t),s=n?r.filter(c=>c):r;if(Array.isArray(e)){e=z(e);let c=s.map(g=>[g]),a=0;for(let g=0;g<c.length-1;g++)c[g].push(e[a]),a++,a===e.length&&(a=0);return s=z(c),s.join("")}return s.join(e)}function zi(e){return e=Ce(e),e instanceof Error?e:e.replace(/\s+/g," ").trim()}const Yi=po,Bi=wo;function Gi(e){return e=Ce(e),e instanceof Error?e:e.toUpperCase()}function ki(e){const n=ce(e);if(n)return n;if(typeof e=="number")return e;if(mn(e)||(e=""),typeof e!="string")return D;const t=/(%)$/.test(e)||/^(%)/.test(e);if(e=e.replace(/^[^0-9-]{0,3}/,""),e=e.replace(/[^0-9]{0,3}$/,""),e=e.replace(/[ ,]/g,""),e==="")return 0;let r=Number(e);return isNaN(r)?D:(r=r||0,t&&(r=r*.01),r)}const Wi=2.5066282746310002;function Xi(){const n=z(arguments).filter(mn);if(n.length===0)return P;const t=Z(n);return t instanceof Error?t:K.sum(K(t).subtract(K.mean(t)).abs()[0])/t.length}function dn(){const n=z(arguments).filter(mn);if(n.length===0)return Ve;const t=ce.apply(void 0,n);if(t)return t;const r=on(n),s=r.length;let c=0,a=0,g;for(let h=0;h<s;h++)c+=r[h],a+=1;return g=c/a,isNaN(g)&&(g=P),g}function jr(){const n=z(arguments).filter(mn);if(n.length===0)return Ve;const t=ce.apply(void 0,n);if(t)return t;const r=n,s=r.length;let c=0,a=0,g;for(let h=0;h<s;h++){const f=r[h];typeof f=="number"&&(c+=f),f===!0&&c++,f!==null&&a++}return g=c/a,isNaN(g)&&(g=P),g}function Ki(e,n,t){if(arguments.length<=1)return ee;t=t||e;const s=z(t).filter(mn);if(t=Z(s),e=z(e),t instanceof Error)return t;let c=0,a=0;const g=n===void 0||n==="*",h=g?null:Dn(n+"");for(let f=0;f<e.length;f++){const o=e[f];if(g)a+=t[f],c++;else{const i=[je(o,an)].concat(h);On(i)&&(a+=t[f],c++)}}return a/c}function Si(){const e=ir(...arguments),t=e.reduce((r,s)=>r+s,0)/e.length;return isNaN(t)?0:t}const xn={};xn.DIST=function(e,n,t,r,s,c){return arguments.length<4||(s=s===void 0?0:s,c=c===void 0?1:c,e=R(e),n=R(n),t=R(t),s=R(s),c=R(c),$(e,n,t,s,c))?D:(e=(e-s)/(c-s),r?K.beta.cdf(e,n,t):K.beta.pdf(e,n,t))};xn.INV=(e,n,t,r,s)=>(r=r===void 0?0:r,s=s===void 0?1:s,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s)?D:K.beta.inv(e,n,t)*(s-r)+r);const Ln={};Ln.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),r=R(r),$(e,n,t,r)?D:r?K.binomial.cdf(e,n,t):K.binomial.pdf(e,n,t));Ln.DIST.RANGE=(e,n,t,r)=>{if(r=r===void 0?t:r,e=R(e),n=R(n),t=R(t),r=R(r),$(e,n,t,r))return D;let s=0;for(let c=t;c<=r;c++)s+=Mn(e,c)*Math.pow(n,c)*Math.pow(1-n,e-c);return s};Ln.INV=(e,n,t)=>{if(e=R(e),n=R(n),t=R(t),$(e,n,t))return D;let r=0;for(;r<=e;){if(K.binomial.cdf(r,e,n)>=t)return r;r++}};const Se={};Se.DIST=(e,n,t)=>(e=R(e),n=R(n),$(e,n)?D:t?K.chisquare.cdf(e,n):K.chisquare.pdf(e,n));Se.DIST.RT=(e,n)=>!e|!n?ee:e<1||n>Math.pow(10,10)?P:typeof e!="number"||typeof n!="number"?D:1-K.chisquare.cdf(e,n);Se.INV=(e,n)=>(e=R(e),n=R(n),$(e,n)?D:K.chisquare.inv(e,n));Se.INV.RT=(e,n)=>!e|!n?ee:e<0||e>1||n<1||n>Math.pow(10,10)?P:typeof e!="number"||typeof n!="number"?D:K.chisquare.inv(1-e,n);Se.TEST=function(e,n){if(arguments.length!==2)return ee;if(!(e instanceof Array)||!(n instanceof Array)||e.length!==n.length||e[0]&&n[0]&&e[0].length!==n[0].length)return D;const t=e.length;let r,s,c;for(s=0;s<t;s++)e[s]instanceof Array||(r=e[s],e[s]=[],e[s].push(r)),n[s]instanceof Array||(r=n[s],n[s]=[],n[s].push(r));const a=e[0].length,g=a===1?t-1:(t-1)*(a-1);let h=0;const f=Math.PI;for(s=0;s<t;s++)for(c=0;c<a;c++)h+=Math.pow(e[s][c]-n[s][c],2)/n[s][c];function o(i,u){let l=Math.exp(-.5*i);u%2===1&&(l=l*Math.sqrt(2*i/f));let d=u;for(;d>=2;)l=l*i/d,d=d-2;let v=l,p=u;for(;v>1e-10*l;)p=p+2,v=v*i/p,l=l+v;return 1-l}return Math.round(o(h,g)*1e6)/1e6};const et={};et.NORM=(e,n,t)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:K.normalci(1,e,n,t)[1]-1);et.T=(e,n,t)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:K.tci(1,e,n,t)[1]-1);function Zi(e,n){return e=Z(z(e)),n=Z(z(n)),$(e,n)?D:K.corrcoeff(e,n)}function Un(){const e=z(arguments);return on(e).length}function $n(){const e=z(arguments);return e.length-No(e)}function No(){const e=z(arguments);let n=0,t;for(let r=0;r<e.length;r++)t=e[r],(t==null||t==="")&&n++;return n}function Qi(e,n){if(e=z(e),n===void 0||n==="*")return e.length;let r=0;const s=Dn(n+"");for(let c=0;c<e.length;c++){const a=e[c],g=[je(a,an)].concat(s);On(g)&&r++}return r}function Ji(){const e=or(arguments),n=new Array(z(e[0]).length);for(let r=0;r<n.length;r++)n[r]=!0;for(let r=0;r<e.length;r+=2){const s=z(e[r]),c=e[r+1];if(!(c===void 0||c==="*")){const g=Dn(c+"");for(let h=0;h<s.length;h++){const f=s[h],o=[je(f,an)].concat(g);n[h]=n[h]&&On(o)}}}let t=0;for(let r=0;r<n.length;r++)n[r]&&t++;return t}const Fn={};Fn.P=(e,n)=>{if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=K.mean(e),r=K.mean(n);let s=0;const c=e.length;for(let a=0;a<c;a++)s+=(e[a]-t)*(n[a]-r);return s/c};Fn.S=(e,n)=>(e=Z(z(e)),n=Z(z(n)),$(e,n)?D:K.covariance(e,n));function bi(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=K.mean(e);let t=0;for(let r=0;r<e.length;r++)t+=Math.pow(e[r]-n,2);return t}const nt={};nt.DIST=(e,n,t)=>(e=R(e),n=R(n),$(e,n)?D:t?K.exponential.cdf(e,n):K.exponential.pdf(e,n));const Ze={};Ze.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:r?K.centralF.cdf(e,n,t):K.centralF.pdf(e,n,t));Ze.DIST.RT=function(e,n,t){return arguments.length!==3?ee:e<0||n<1||t<1?P:typeof e!="number"||typeof n!="number"||typeof t!="number"?D:1-K.centralF.cdf(e,n,t)};Ze.INV=(e,n,t)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:e<=0||e>1?P:K.centralF.inv(e,n,t));Ze.INV.RT=function(e,n,t){return arguments.length!==3?ee:e<0||e>1||n<1||n>Math.pow(10,10)||t<1||t>Math.pow(10,10)?P:typeof e!="number"||typeof n!="number"||typeof t!="number"?D:K.centralF.inv(1-e,n,t)};Ze.TEST=(e,n)=>{if(!e||!n||!(e instanceof Array)||!(n instanceof Array))return ee;if(e.length<2||n.length<2)return Ve;const t=(g,h)=>{let f=0;for(let o=0;o<g.length;o++)f+=Math.pow(g[o]-h,2);return f},r=rn(e)/e.length,s=rn(n)/n.length,c=t(e,r)/(e.length-1),a=t(n,s)/(n.length-1);return c/a};function _i(e){return e=R(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2}function ji(e){if(e=R(e),e instanceof Error)return e;const n=Math.exp(2*e);return(n-1)/(n+1)}function Ao(e,n,t){if(e=R(e),n=Z(z(n)),t=Z(z(t)),$(e,n,t))return D;const r=K.mean(t),s=K.mean(n),c=t.length;let a=0,g=0;for(let o=0;o<c;o++)a+=(t[o]-r)*(n[o]-s),g+=Math.pow(t[o]-r,2);const h=a/g;return s-h*r+h*e}function ef(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=e.length,r=n.length,s=[];for(let c=0;c<=r;c++){s[c]=0;for(let a=0;a<t;a++)c===0?e[a]<=n[0]&&(s[0]+=1):c<r?e[a]>n[c-1]&&e[a]<=n[c]&&(s[c]+=1):c===r&&e[a]>n[r-1]&&(s[r]+=1)}return s}function Hn(e){return e=R(e),e instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?P:K.gammafn(e)}Hn.DIST=function(e,n,t,r){return arguments.length!==4?ee:e<0||n<=0||t<=0||typeof e!="number"||typeof n!="number"||typeof t!="number"?D:r?K.gamma.cdf(e,n,t,!0):K.gamma.pdf(e,n,t,!1)};Hn.INV=function(e,n,t){return arguments.length!==3?ee:e<0||e>1||n<=0||t<=0?P:typeof e!="number"||typeof n!="number"||typeof t!="number"?D:K.gamma.inv(e,n,t)};function rt(e){return e=R(e),e instanceof Error?e:K.gammaln(e)}rt.PRECISE=function(e){return arguments.length!==1?ee:e<=0?P:typeof e!="number"?D:K.gammaln(e)};function nf(e){return e=R(e),e instanceof Error?e:K.normal.cdf(e,0,1)-.5}function rf(){const e=Z(z(arguments));return e instanceof Error?e:K.geomean(e)}function tf(e,n,t,r){if(e=Z(z(e)),e instanceof Error)return e;let s;if(n===void 0)for(n=[],s=1;s<=e.length;s++)n.push(s);if(t===void 0&&(t=n),n=Z(z(n)),t=Z(z(t)),$(n,t))return D;r===void 0&&(r=!0);const c=e.length;let a=0,g=0,h=0,f=0;for(s=0;s<c;s++){const l=n[s],d=Math.log(e[s]);a+=l,g+=d,h+=l*d,f+=l*l}a/=c,g/=c,h/=c,f/=c;let o,i;r?(o=(h-a*g)/(f-a*a),i=g-o*a):(o=h/f,i=0);const u=[];for(s=0;s<t.length;s++)u.push(Math.exp(i+o*t[s]));return u}function of(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=e.length;let t=0;for(let r=0;r<n;r++)t+=1/e[r];return n/t}const tt={};tt.DIST=(e,n,t,r,s)=>{if(e=R(e),n=R(n),t=R(t),r=R(r),$(e,n,t,r))return D;function c(g,h,f,o){return Mn(f,g)*Mn(o-f,h-g)/Mn(o,h)}function a(g,h,f,o){let i=0;for(let u=0;u<=g;u++)i+=c(u,h,f,o);return i}return s?a(e,n,t,r):c(e,n,t,r)};function sf(e,n){return e=Z(e),n=Z(n),$(e,n)?D:e.length!==n.length?ee:Ao(0,e,n)}function ff(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=K.mean(e),t=e.length;let r=0;for(let s=0;s<t;s++)r+=Math.pow(e[s]-n,4);return r=r/Math.pow(K.stdev(e,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*r-3*(t-1)*(t-1)/((t-2)*(t-3))}function Ro(e,n){const t=ce.apply(void 0,e);return t||($(n)?n:(e=on(z(e)),n=R(n),n<0||e.length<n?D:e.sort((r,s)=>s-r)[n-1]))}function ot(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=K.mean(e),r=K.mean(n),s=n.length;let c=0,a=0;for(let f=0;f<s;f++)c+=(n[f]-r)*(e[f]-t),a+=Math.pow(n[f]-r,2);const g=c/a,h=t-g*r;return[g,h]}function uf(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n)||e.length!==n.length)return D;for(let r=0;r<e.length;r++)e[r]=Math.log(e[r]);const t=ot(e,n);return t[0]=Math.round(Math.exp(t[0])*1e6)/1e6,t[1]=Math.round(Math.exp(t[1])*1e6)/1e6,t}const Pn={};Pn.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:r?K.lognormal.cdf(e,n,t):K.lognormal.pdf(e,n,t));Pn.INV=(e,n,t)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:K.lognormal.inv(e,n,t));function bn(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;const t=on(e);return t.length===0?0:Math.max.apply(Math,t)}function lf(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;let t=Jr(e);return t=t.map(r=>r==null?0:r),t.length===0?0:Math.max.apply(Math,t)}function cf(){const e=ir(...arguments);return e.length===0?0:Math.max.apply(Math,e)}function Io(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;const t=Jr(e);let r=K.median(t);return isNaN(r)&&(r=P),r}function _n(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;const t=on(e);return t.length===0?0:Math.min.apply(Math,t)}function af(){const e=z(arguments),n=ce.apply(void 0,e);if(n)return n;let t=Jr(e);return t=t.map(r=>r==null?0:r),t.length===0?0:Math.min.apply(Math,t)}function gf(){const e=ir(...arguments);return e.length===0?0:Math.min.apply(Math,e)}const vn={};vn.MULT=function(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=e.length,t={};let r=[],s=0,c;for(let a=0;a<n;a++)c=e[a],t[c]=t[c]?t[c]+1:1,t[c]>s&&(s=t[c],r=[]),t[c]===s&&(r[r.length]=c);return r};vn.SNGL=function(){const e=Z(z(arguments));return e instanceof Error?e:vn.MULT(e).sort((n,t)=>n-t)[0]};const st={};st.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:r?K.negbin.cdf(e,n,t):K.negbin.pdf(e,n,t));const Qe={};Qe.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:t<=0?P:r?K.normal.cdf(e,n,t):K.normal.pdf(e,n,t));Qe.INV=(e,n,t)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:K.normal.inv(e,n,t));Qe.S={};Qe.S.DIST=(e,n)=>(e=R(e),e instanceof Error?D:n?K.normal.cdf(e,0,1):K.normal.pdf(e,0,1));Qe.S.INV=e=>(e=R(e),e instanceof Error?D:K.normal.inv(e,0,1));function yo(e,n){if(n=Z(z(n)),e=Z(z(e)),$(n,e))return D;const t=K.mean(e),r=K.mean(n),s=e.length;let c=0,a=0,g=0;for(let h=0;h<s;h++)c+=(e[h]-t)*(n[h]-r),a+=Math.pow(e[h]-t,2),g+=Math.pow(n[h]-r,2);return c/Math.sqrt(a*g)}const ke={};ke.EXC=(e,n)=>{if(e=Z(z(e)),n=R(n),$(e,n))return D;e=e.sort((c,a)=>c-a);const t=e.length;if(n<1/(t+1)||n>1-1/(t+1))return P;const r=n*(t+1)-1,s=Math.floor(r);return uo(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))};ke.INC=(e,n)=>{if(e=Z(z(e)),n=R(n),$(e,n))return D;e=e.sort((c,a)=>c-a);const t=e.length,r=n*(t-1),s=Math.floor(r);return uo(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))};const zn={};zn.EXC=(e,n,t)=>{if(t=t===void 0?3:t,e=Z(z(e)),n=R(n),t=R(t),$(e,n,t))return D;e=e.sort((o,i)=>o-i);const r=_r.apply(null,e),s=e.length,c=r.length,a=Math.pow(10,t);let g=0,h=!1,f=0;for(;!h&&f<c;)n===r[f]?(g=(e.indexOf(r[f])+1)/(s+1),h=!0):n>=r[f]&&(n<r[f+1]||f===c-1)&&(g=(e.indexOf(r[f])+1+(n-r[f])/(r[f+1]-r[f]))/(s+1),h=!0),f++;return Math.floor(g*a)/a};zn.INC=(e,n,t)=>{if(t=t===void 0?3:t,e=Z(z(e)),n=R(n),t=R(t),$(e,n,t))return D;e=e.sort((o,i)=>o-i);const r=_r.apply(null,e),s=e.length,c=r.length,a=Math.pow(10,t);let g=0,h=!1,f=0;for(;!h&&f<c;)n===r[f]?(g=e.indexOf(r[f])/(s-1),h=!0):n>=r[f]&&(n<r[f+1]||f===c-1)&&(g=(e.indexOf(r[f])+(n-r[f])/(r[f+1]-r[f]))/(s-1),h=!0),f++;return Math.floor(g*a)/a};function hf(e,n){return e=R(e),n=R(n),$(e,n)?D:en(e)/en(e-n)}function df(e,n){return e=R(e),n=R(n),$(e,n)?D:Math.pow(e,n)}function vf(e){return e=R(e),e instanceof Error?D:Math.exp(-.5*e*e)/Wi}const it={};it.DIST=(e,n,t)=>(e=R(e),n=R(n),$(e,n)?D:t?K.poisson.cdf(e,n):K.poisson.pdf(e,n));function pf(e,n,t,r){if(t===void 0)return 0;if(r=r===void 0?t:r,e=Z(z(e)),n=Z(z(n)),t=R(t),r=R(r),$(e,n,t,r))return D;if(t===r)return e.indexOf(t)>=0?n[e.indexOf(t)]:0;const s=e.sort((g,h)=>g-h),c=s.length;let a=0;for(let g=0;g<c;g++)s[g]>=t&&s[g]<=r&&(a+=n[e.indexOf(s[g])]);return a}const pn={};pn.EXC=(e,n)=>{if(e=Z(on(z(e))),n=R(n),$(e,n))return D;switch(n){case 1:return ke.EXC(e,.25);case 2:return ke.EXC(e,.5);case 3:return ke.EXC(e,.75);default:return P}};pn.INC=(e,n)=>{if(e=Z(on(z(e))),n=R(n),$(e,n))return D;switch(n){case 1:return ke.INC(e,.25);case 2:return ke.INC(e,.5);case 3:return ke.INC(e,.75);default:return P}};const Yn={};Yn.AVG=(e,n,t)=>{if(e=R(e),n=Z(z(n)),$(e,n))return D;n=z(n),t=t||!1;const r=t?(a,g)=>a-g:(a,g)=>g-a;n=n.sort(r);const s=n.length;let c=0;for(let a=0;a<s;a++)n[a]===e&&c++;return c>1?(2*n.indexOf(e)+c+1)/2:n.indexOf(e)+1};Yn.EQ=(e,n,t)=>{if(e=R(e),n=Z(z(n)),$(e,n))return D;t=t||!1;const r=t?(s,c)=>s-c:(s,c)=>c-s;return n=n.sort(r),n.indexOf(e)+1};function wf(e,n){if(arguments.length!==2)return ee;if(n<0)return P;if(!(e instanceof Array)||typeof n!="number")return D;if(e.length!==0)return K.row(e,n)}function Ef(e,n){return e=Z(z(e)),n=Z(z(n)),$(e,n)?D:Math.pow(yo(e,n),2)}function ft(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=K.mean(e),t=e.length;let r=0;for(let s=0;s<t;s++)r+=Math.pow(e[s]-n,3);return t*r/((t-1)*(t-2)*Math.pow(K.stdev(e,!0),3))}ft.P=function(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=K.mean(e),t=e.length;let r=0,s=0;for(let c=0;c<t;c++)s+=Math.pow(e[c]-n,3),r+=Math.pow(e[c]-n,2);return s=s/t,r=r/t,s/Math.pow(r,3/2)};function mf(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=K.mean(n),r=K.mean(e),s=n.length;let c=0,a=0;for(let g=0;g<s;g++)c+=(n[g]-t)*(e[g]-r),a+=Math.pow(n[g]-t,2);return c/a}function Mo(e,n){return e=Z(z(e)),n=R(n),$(e,n)?e:e.sort((t,r)=>t-r)[n-1]}function Nf(e,n,t){return e=R(e),n=R(n),t=R(t),$(e,n,t)?D:(e-n)/t}const ze={};ze.P=function(){const e=xe.P.apply(this,arguments);let n=Math.sqrt(e);return isNaN(n)&&(n=P),n};ze.S=function(){const e=xe.S.apply(this,arguments);return Math.sqrt(e)};function Af(){const e=To.apply(this,arguments);return Math.sqrt(e)}function Rf(){const e=Co.apply(this,arguments);let n=Math.sqrt(e);return isNaN(n)&&(n=P),n}function If(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=K.mean(n),r=K.mean(e),s=n.length;let c=0,a=0,g=0;for(let h=0;h<s;h++)c+=Math.pow(e[h]-r,2),a+=(n[h]-t)*(e[h]-r),g+=Math.pow(n[h]-t,2);return Math.sqrt((c-a*a/g)/(s-2))}Ye.DIST=(e,n,t)=>t!==1&&t!==2?P:t===1?Ye.DIST.RT(e,n):Ye.DIST["2T"](e,n);Ye.DIST["2T"]=function(e,n){return arguments.length!==2?ee:e<0||n<1?P:typeof e!="number"||typeof n!="number"?D:(1-K.studentt.cdf(e,n))*2};Ye.DIST.RT=function(e,n){return arguments.length!==2?ee:e<0||n<1?P:typeof e!="number"||typeof n!="number"?D:1-K.studentt.cdf(e,n)};Ye.INV=(e,n)=>(e=R(e),n=R(n),$(e,n)?D:K.studentt.inv(e,n));Ye.INV["2T"]=(e,n)=>(e=R(e),n=R(n),e<=0||e>1||n<1?P:$(e,n)?D:Math.abs(K.studentt.inv(e/2,n)));Ye.TEST=(e,n)=>{if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;const t=K.mean(e),r=K.mean(n);let s=0,c=0,a;for(a=0;a<e.length;a++)s+=Math.pow(e[a]-t,2);for(a=0;a<n.length;a++)c+=Math.pow(n[a]-r,2);s=s/(e.length-1),c=c/(n.length-1);const g=Math.abs(t-r)/Math.sqrt(s/e.length+c/n.length);return Ye.DIST["2T"](g,e.length+n.length-2)};function yf(e,n,t){if(e=Z(z(e)),n=Z(z(n)),t=Z(z(t)),$(e,n,t))return D;const r=ot(e,n),s=r[0],c=r[1],a=[];return t.forEach(g=>{a.push(s*g+c)}),a}function Mf(e,n){if(e=Z(z(e)),n=R(n),$(e,n))return D;const t=wn(e.length*n,2)/2;return K.mean(ni(Ie(e.sort((r,s)=>r-s),t),t))}const xe={};xe.P=function(){const e=on(z(arguments)),n=e.length;let t=0;const r=dn(e);let s;for(let c=0;c<n;c++)t+=Math.pow(e[c]-r,2);return s=t/n,isNaN(s)&&(s=P),s};xe.S=function(){const e=on(z(arguments)),n=e.length;let t=0;const r=dn(e);for(let s=0;s<n;s++)t+=Math.pow(e[s]-r,2);return t/(n-1)};function To(){const e=z(arguments),n=e.length;let t=0,r=0;const s=jr(e);for(let c=0;c<n;c++){const a=e[c];typeof a=="number"?t+=Math.pow(a-s,2):a===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),a!==null&&r++}return t/(r-1)}function Co(){const e=z(arguments),n=e.length;let t=0,r=0;const s=jr(e);let c;for(let a=0;a<n;a++){const g=e[a];typeof g=="number"?t+=Math.pow(g-s,2):g===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),g!==null&&r++}return c=t/r,isNaN(c)&&(c=P),c}const ut={};ut.DIST=(e,n,t,r)=>(e=R(e),n=R(n),t=R(t),$(e,n,t)?D:r?1-Math.exp(-Math.pow(e/t,n)):Math.pow(e,n-1)*Math.exp(-Math.pow(e/t,n))*n/Math.pow(t,n));const lt={};lt.TEST=(e,n,t)=>{if(e=Z(z(e)),n=R(n),$(e,n))return D;t=t||ze.S(e);const r=e.length;return 1-Qe.S.DIST((dn(e)-n)/(t/Math.sqrt(r)),!0)};function Tf(e){return e=R(e),e instanceof Error?e:Math.abs(e)}function Cf(e){if(e=R(e),e instanceof Error)return e;let n=Math.acos(e);return isNaN(n)&&(n=P),n}function Df(e){if(e=R(e),e instanceof Error)return e;let n=Math.log(e+Math.sqrt(e*e-1));return isNaN(n)&&(n=P),n}function Of(e){return e=R(e),e instanceof Error?e:Math.atan(1/e)}function Lf(e){if(e=R(e),e instanceof Error)return e;let n=.5*Math.log((e+1)/(e-1));return isNaN(n)&&(n=P),n}function Ff(e,n,t,r){if(e=R(e),n=R(e),$(e,n))return D;switch(e){case 1:return dn(t);case 2:return Un(t);case 3:return $n(t);case 4:return bn(t);case 5:return _n(t);case 6:return jn(t);case 7:return ze.S(t);case 8:return ze.P(t);case 9:return rn(t);case 10:return xe.S(t);case 11:return xe.P(t);case 12:return Io(t);case 13:return vn.SNGL(t);case 14:return Ro(t,r);case 15:return Mo(t,r);case 16:return ke.INC(t,r);case 17:return pn.INC(t,r);case 18:return ke.EXC(t,r);case 19:return pn.EXC(t,r)}}function Pf(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return D;let n=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,t=>{n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),n}function Vf(e){if(e=R(e),e instanceof Error)return e;let n=Math.asin(e);return isNaN(n)&&(n=P),n}function qf(e){return e=R(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))}function Uf(e){return e=R(e),e instanceof Error?e:Math.atan(e)}function $f(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||Math.atan2(e,n)}function xf(e){if(e=R(e),e instanceof Error)return e;let n=Math.log((1+e)/(1-e))/2;return isNaN(n)&&(n=P),n}function Hf(e,n,t){e=R(e),n=R(n),t=R(t);const r=ce(e,n,t);if(r)return r;if(n===0)return P;const s=e.toString(n);return new Array(Math.max(t+1-s.length,0)).join("0")+s}function ln(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(n===0?0:e>0&&n<0?P:Math.ceil(e/n)*n)}ln.MATH=(e,n,t=0)=>{n===void 0&&(n=e>0?1:-1),e=R(e),n=R(n),t=R(t);const r=ce(e,n,t);return r||(n===0?0:(n=Math.abs(n),t===0||e>0?Math.ceil(e/n)*n:Math.floor(e/n)*n))};ln.PRECISE=(e,n)=>ln.MATH(e,n);function Mn(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e<n?P:en(e)/(en(n)*en(e-n)))}function zf(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e<n?P:e===0&&n===0?1:Mn(e+n-1,e-1))}function Yf(e){return e=R(e),e instanceof Error?e:Math.cos(e)}function Bf(e){return e=R(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2}function Gf(e){return e=R(e),e instanceof Error?e:e===0?Ve:1/Math.tan(e)}function kf(e){if(e=R(e),e instanceof Error)return e;if(e===0)return Ve;const n=Math.exp(2*e);return(n+1)/(n-1)}function Wf(e){return e=R(e),e instanceof Error?e:e===0?Ve:1/Math.sin(e)}function Xf(e){return e=R(e),e instanceof Error?e:e===0?Ve:2/(Math.exp(e)-Math.exp(-e))}function Kf(e,n){if(arguments.length<2)return ee;e=e||"0",n=R(n);const t=ce(e,n);if(t)return t;if(n===0)return P;const r=parseInt(e,n);return isNaN(r)?P:r}function Sf(e){return e=R(e),e instanceof Error?e:e*180/Math.PI}function Zf(e){return e=R(e),e instanceof Error?e:ln.MATH(e,-2,-1)}function Qf(e){return arguments.length<1?ee:arguments.length>1?Qr:(e=R(e),e instanceof Error||(e=Math.exp(e)),e)}const Kn=[];function en(e){if(e=R(e),e instanceof Error)return e;const n=Math.floor(e);return n===0||n===1?1:(Kn[n]>0||(Kn[n]=en(n-1)*n),Kn[n])}function Do(e){if(e=R(e),e instanceof Error)return e;const n=Math.floor(e);return n<=0?1:n*Do(n-2)}function wn(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(n?e>0&&n<0?P:Math.floor(e/n)*n:Ve)}wn.MATH=(e,n=1,t=0)=>{e=R(e),n=R(n),t=R(t);const r=ce(e,n,t);return r||(n===0?0:(n=Math.abs(n),t===0||e>0?Math.floor(e/n)*n:Math.ceil(e/n)*n))};wn.PRECISE=(e,n)=>wn.MATH(e,n);function Jf(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=e.length,t=e[0];let r=t<0?-t:t;for(let s=1;s<n;s++){const c=e[s];let a=c<0?-c:c;for(;r&&a;)r>a?r%=a:a%=r;r+=a}return r}function bf(e){return e=R(e),e instanceof Error?e:Math.floor(e)}const _f={CEILING:ln};function jf(){const e=Z(z(arguments));if(e instanceof Error)return e;for(var n,t,r,s,c=1;(r=e.pop())!==void 0;){if(r===0)return 0;for(;r>1;){if(r%2){for(n=3,t=Math.floor(Math.sqrt(r));n<=t&&r%n;n+=2);s=n<=t?n:r}else s=2;for(r/=s,c*=s,n=e.length;n;e[--n]%s===0&&(e[n]/=s)===1&&e.splice(n,1));}}return c}function eu(e){return e=R(e),e instanceof Error?e:e===0?P:Math.log(e)}function nu(e,n){e=R(e),n=n?R(n):10;const t=ce(e,n);return t||(e===0||n===0?P:Math.log(e)/Math.log(n))}function ru(e){return e=R(e),e instanceof Error?e:e===0?P:Math.log(e)/Math.log(10)}function tu(e,n){return!Array.isArray(e)||!Array.isArray(n)||e.some(r=>!r.length)||n.some(r=>!r.length)||kr(e).some(r=>typeof r!="number")||kr(n).some(r=>typeof r!="number")||e[0].length!==n.length?D:Array(e.length).fill(0).map(()=>Array(n[0].length).fill(0)).map((r,s)=>r.map((c,a)=>e[s].reduce((g,h,f)=>g+h*n[f][a],0)))}function ou(e,n){e=R(e),n=R(n);const t=ce(e,n);if(t)return t;if(n===0)return Ve;let r=Math.abs(e%n);return r=e<0?n-r:r,n>0?r:-r}function su(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e*n===0?0:e*n<0?P:Math.round(e/n)*n)}function iu(){const e=Z(z(arguments));if(e instanceof Error)return e;let n=0,t=1;for(let r=0;r<e.length;r++)n+=e[r],t*=en(e[r]);return en(n)/t}function fu(e){return arguments.length>1?ee:(e=parseInt(e),!e||e<=0?D:Array(e).fill(0).map(()=>Array(e).fill(0)).map((n,t)=>(n[t]=1,n)))}function uu(e){if(e=R(e),e instanceof Error)return e;let n=Math.ceil(Math.abs(e));return n=n&1?n:n+1,e>=0?n:-n}function lu(){return Math.PI}function Oo(e,n){e=R(e),n=R(n);const t=ce(e,n);if(t)return t;if(e===0&&n===0)return P;const r=Math.pow(e,n);return isNaN(r)?P:r}function jn(){const n=z(arguments).filter(s=>s!=null);if(n.length===0)return 0;const t=Z(n);if(t instanceof Error)return t;let r=1;for(let s=0;s<t.length;s++)r*=t[s];return r}function cu(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||parseInt(e/n,10)}function au(e){return e=R(e),e instanceof Error?e:e*Math.PI/180}function gu(){return Math.random()}function hu(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||e+Math.ceil((n-e+1)*Math.random())-1}function du(e){if(e=R(e),e instanceof Error)return e;const n=String(e).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",s=3;for(;s--;)r=(t[+n.pop()+s*10]||"")+r;return new Array(+n.join("")+1).join("M")+r}function Lo(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||+(Math.round(+(e+"e"+n))+"e"+n*-1)}function vu(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function pu(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function wu(e){return e=R(e),e instanceof Error?e:1/Math.cos(e)}function Eu(e){return e=R(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))}function mu(e,n,t,r){if(e=R(e),n=R(n),t=R(t),r=Z(r),$(e,n,t,r))return D;let s=r[0]*Math.pow(e,n);for(let c=1;c<r.length;c++)s+=r[c]*Math.pow(e,n+c*t);return s}function Nu(e){return e=R(e),e instanceof Error?e:e<0?-1:e===0?0:1}function Au(e){return e=R(e),e instanceof Error?e:Math.sin(e)}function Ru(e){return e=R(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2}function Iu(e){return e=R(e),e instanceof Error?e:e<0?P:Math.sqrt(e)}function yu(e){return e=R(e),e instanceof Error?e:Math.sqrt(e*Math.PI)}function Mu(e,n){if(e=R(e),e instanceof Error)return e;switch(e){case 1:return dn(n);case 2:return Un(n);case 3:return $n(n);case 4:return bn(n);case 5:return _n(n);case 6:return jn(n);case 7:return ze.S(n);case 8:return ze.P(n);case 9:return rn(n);case 10:return xe.S(n);case 11:return xe.P(n);case 101:return dn(n);case 102:return Un(n);case 103:return $n(n);case 104:return bn(n);case 105:return _n(n);case 106:return jn(n);case 107:return ze.S(n);case 108:return ze.P(n);case 109:return rn(n);case 110:return xe.S(n);case 111:return xe.P(n)}}function rn(){let e=0;return qe(or(arguments),n=>{if(e instanceof Error)return!1;if(n instanceof Error)e=n;else if(typeof n=="number")e+=n;else if(typeof n=="string"){const t=parseFloat(n);!isNaN(t)&&(e+=t)}else if(Array.isArray(n)){const t=rn.apply(null,n);t instanceof Error?e=t:e+=t}}),e}function Tu(e,n,t){if(e=z(e),t=t?z(t):e,e instanceof Error)return e;if(n==null||n instanceof Error)return 0;let r=0;const s=n==="*",c=s?null:Dn(n+"");for(let a=0;a<e.length;a++){const g=e[a],h=t[a];if(s)r+=g;else{const f=[je(g,an)].concat(c);r+=On(f)?h:0}}return r}function Cu(){const e=ir(...arguments);return rn(e)}function Du(){if(!arguments||arguments.length===0)return D;const e=arguments.length+1;let n=0,t,r,s,c;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let g=0;g<arguments[0][a].length;g++){for(t=1,r=1;r<e;r++){const h=arguments[r-1][a][g];if(h instanceof Error)return h;if(c=R(h),c instanceof Error)return c;t*=c}n+=t}else{for(t=1,r=1;r<e;r++){const g=arguments[r-1][a];if(g instanceof Error)return g;if(s=R(g),s instanceof Error)return s;t*=s}n+=t}return n}function Ou(){const e=Z(z(arguments));if(e instanceof Error)return e;let n=0;const t=e.length;for(let r=0;r<t;r++)n+=ur(e[r])?e[r]*e[r]:0;return n}function Lu(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;let t=0;for(let r=0;r<e.length;r++)t+=e[r]*e[r]-n[r]*n[r];return t}function Fu(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;let t=0;e=Z(z(e)),n=Z(z(n));for(let r=0;r<e.length;r++)t+=e[r]*e[r]+n[r]*n[r];return t}function Pu(e,n){if(e=Z(z(e)),n=Z(z(n)),$(e,n))return D;let t=0;e=z(e),n=z(n);for(let r=0;r<e.length;r++)t+=Math.pow(e[r]-n[r],2);return t}function Vu(e){return e=R(e),e instanceof Error?e:Math.tan(e)}function qu(e){if(e=R(e),e instanceof Error)return e;const n=Math.exp(2*e);return(n-1)/(n+1)}function Uu(e,n){e=R(e),n=R(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function $u(e,n){if(arguments.length!==2)return ee;e=R(e),n=R(n);const t=ce(e,n);return t||e+n}function xu(e,n){if(arguments.length!==2)return ee;e=R(e),n=R(n);const t=ce(e,n);return t||(n===0?Ve:e/n)}function Hu(e,n){return arguments.length!==2?ee:e instanceof Error?e:n instanceof Error?n:(e===null&&(e=void 0),n===null&&(n=void 0),e===n)}function zu(e,n){if(arguments.length!==2)return ee;if(e instanceof Error)return e;if(n instanceof Error)return n;sr(e,n)?(e=Ce(e),n=Ce(n)):(e=R(e),n=R(n));const t=ce(e,n);return t||e>n}function Yu(e,n){if(arguments.length!==2)return ee;sr(e,n)?(e=Ce(e),n=Ce(n)):(e=R(e),n=R(n));const t=ce(e,n);return t||e>=n}function Bu(e,n){if(arguments.length!==2)return ee;sr(e,n)?(e=Ce(e),n=Ce(n)):(e=R(e),n=R(n));const t=ce(e,n);return t||e<n}function Gu(e,n){if(arguments.length!==2)return ee;sr(e,n)?(e=Ce(e),n=Ce(n)):(e=R(e),n=R(n));const t=ce(e,n);return t||e<=n}function ku(e,n){if(arguments.length!==2)return ee;e=R(e),n=R(n);const t=ce(e,n);return t||e-n}function Wu(e,n){if(arguments.length!==2)return ee;e=R(e),n=R(n);const t=ce(e,n);return t||e*n}function Xu(e,n){return arguments.length!==2?ee:e instanceof Error?e:n instanceof Error?n:(e===null&&(e=void 0),n===null&&(n=void 0),e!==n)}function Ku(e,n){return arguments.length!==2?ee:Oo(e,n)}var Su=Object.freeze({__proto__:null,ADD:$u,DIVIDE:xu,EQ:Hu,GT:zu,GTE:Yu,LT:Bu,LTE:Gu,MINUS:ku,MULTIPLY:Wu,NE:Xu,POW:Ku});const Zu=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Qu=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],er=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Ju(e,n,t){let r;return e=R(e),n=R(n),t=R(t),$(e,n,t)?r=D:(r=new Date(e,n-1,t),r.getFullYear()<0&&(r=P)),tn?nn(r):r}function un(e,n,t){t=t.toUpperCase(),e=pe(e),n=pe(n);const r=e.getFullYear(),s=e.getMonth(),c=e.getDate(),a=n.getFullYear(),g=n.getMonth(),h=n.getDate();let f;switch(t){case"Y":f=Math.floor(ct(e,n));break;case"D":f=hn(n,e);break;case"M":f=g-s+12*(a-r),h<c&&f--;break;case"MD":c<=h?f=h-c:(g===0?(e.setFullYear(a-1),e.setMonth(12)):(e.setFullYear(a),e.setMonth(g-1)),f=hn(n,e));break;case"YM":f=g-s+12*(a-r),h<c&&f--,f=f%12;break;case"YD":g>s||g===s&&h<c?e.setFullYear(a):e.setFullYear(a-1),f=hn(n,e);break}return f}function bu(e){if(typeof e!="string")return D;const n=Date.parse(e);if(isNaN(n))return D;const t=new Date(e);return tn?nn(t):t}function _u(e){const n=pe(e);return n instanceof Error?n:n.getDate()}function nr(e){const n=new Date(e);return n.setHours(0,0,0,0),n}function hn(e,n){return e=pe(e),n=pe(n),e instanceof Error?e:n instanceof Error?n:nn(nr(e))-nn(nr(n))}function cn(e,n,t){if(t=br(t||"false"),e=pe(e),n=pe(n),e instanceof Error)return e;if(n instanceof Error)return n;if(t instanceof Error)return t;const r=e.getMonth();let s=n.getMonth(),c,a;if(t)c=e.getDate()===31?30:e.getDate(),a=n.getDate()===31?30:n.getDate();else{const g=new Date(e.getFullYear(),r+1,0).getDate(),h=new Date(n.getFullYear(),s+1,0).getDate();c=e.getDate()===g?30:e.getDate(),n.getDate()===h?c<30?(s++,a=1):a=30:a=n.getDate()}return 360*(n.getFullYear()-e.getFullYear())+30*(s-r)+(a-c)}function ju(e,n){if(e=pe(e),e instanceof Error)return e;if(isNaN(n))return D;let t=e.getDate();e.setDate(1),n=parseInt(n,10),e.setMonth(e.getMonth()+n);let r=e.getMonth();if(t>28){let s=[31,28,31,30,31,30,31,31,30,31,30,31][r],c=e.getFullYear();r===1&&(c%4===0&&c%100!==0||c%400===0)&&(s=29),t=Math.min(t,s)}return e.setDate(t),tn?nn(e):e}function el(e,n){if(e=pe(e),e instanceof Error)return e;if(isNaN(n))return D;n=parseInt(n,10);const t=new Date(e.getFullYear(),e.getMonth()+n+1,0);return tn?nn(t):t}function nl(e){return e=pe(e),e instanceof Error?e:e.getHours()}function Fo(e){if(e=pe(e),e instanceof Error)return e;e=nr(e),e.setDate(e.getDate()+4-(e.getDay()||7));const n=new Date(e.getFullYear(),0,1);return Math.ceil(((e-n)/864e5+1)/7)}function rl(e){return e=pe(e),e instanceof Error?e:e.getMinutes()}function tl(e){return e=pe(e),e instanceof Error?e:e.getMonth()+1}function lr(e,n,t){return lr.INTL(e,n,1,t)}lr.INTL=(e,n,t,r)=>{if(e=pe(e),e instanceof Error)return e;if(n=pe(n),n instanceof Error)return n;let s=!1;const c=[],a=[1,2,3,4,5,6,0],g=new RegExp("^[0|1]{7}$");if(t===void 0)t=er[1];else if(typeof t=="string"&&g.test(t)){s=!0,t=t.split("");for(let i=0;i<t.length;i++)t[i]==="1"&&c.push(a[i])}else t=er[t];if(!(t instanceof Array))return D;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let i=0;i<r.length;i++){const u=pe(r[i]);if(u instanceof Error)return u;r[i]=u}const h=Math.round((n-e)/(1e3*60*60*24))+1;let f=h;const o=e;for(let i=0;i<h;i++){const u=new Date().getTimezoneOffset()>0?o.getUTCDay():o.getDay();let l=s?c.includes(u):u===t[0]||u===t[1];for(let d=0;d<r.length;d++){const v=r[d];if(v.getDate()===o.getDate()&&v.getMonth()===o.getMonth()&&v.getFullYear()===o.getFullYear()){l=!0;break}}l&&f--,o.setDate(o.getDate()+1)}return f};function ol(){return tn?nn(new Date):new Date}function sl(e){return e=pe(e),e instanceof Error?e:e.getSeconds()}function il(e,n,t){return e=R(e),n=R(n),t=R(t),$(e,n,t)?D:e<0||n<0||t<0?P:(3600*e+60*n+t)/86400}function fl(e){return e=pe(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400}function ul(){const e=nr(new Date);return tn?nn(e):e}function ll(e,n){if(e=pe(e),e instanceof Error)return e;n===void 0&&(n=1);const t=e.getDay();return Qu[n][t]}function cl(e,n){if(e=pe(e),e instanceof Error)return e;if(n===void 0&&(n=1),n===21)return Fo(e);const t=Zu[n];let r=new Date(e.getFullYear(),0,1);const s=r.getDay()<t?1:0;return r-=Math.abs(r.getDay()-t)*24*60*60*1e3,Math.floor((e-r)/(1e3*60*60*24)/7+1)+s}function cr(e,n,t){return cr.INTL(e,n,1,t)}cr.INTL=(e,n,t,r)=>{if(e=pe(e),e instanceof Error)return e;if(n=R(n),n instanceof Error)return n;if(t===void 0?t=er[1]:t=er[t],!(t instanceof Array))return D;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let a=0;a<r.length;a++){const g=pe(r[a]);if(g instanceof Error)return g;r[a]=g}let s=0;const c=Math.sign(n);for(;s<n*c;){e.setDate(e.getDate()+c);const a=e.getDay();if(!(a===t[0]||a===t[1])){for(let g=0;g<r.length;g++){const h=r[g];if(h.getDate()===e.getDate()&&h.getMonth()===e.getMonth()&&h.getFullYear()===e.getFullYear()){s--;break}}s++}}return e.getFullYear()<1900?D:e};function al(e){return e=pe(e),e instanceof Error?e:e.getFullYear()}function mr(e){return new Date(e,1,29).getMonth()===1}function Sn(e,n){return Math.ceil((n-e)/1e3/60/60/24)}function ct(e,n,t){if(e=pe(e),e instanceof Error)return e;if(n=pe(n),n instanceof Error)return n;t=t||0;let r=e.getDate();const s=e.getMonth()+1,c=e.getFullYear();let a=n.getDate();const g=n.getMonth()+1,h=n.getFullYear();switch(t){case 0:return r===31&&a===31?(r=30,a=30):r===31?r=30:r===30&&a===31&&(a=30),(a+g*30+h*360-(r+s*30+c*360))/360;case 1:{const f=(d,v)=>{const p=d.getFullYear(),E=new Date(p,2,1);if(mr(p)&&d<E&&v>=E)return!0;const m=v.getFullYear(),w=new Date(m,2,1);return mr(m)&&v>=w&&d<w};let o=365;if(c===h||c+1===h&&(s>g||s===g&&r>=a))return(c===h&&mr(c)||f(e,n)||g===1&&a===29)&&(o=366),Sn(e,n)/o;const i=h-c+1,l=(new Date(h+1,0,1)-new Date(c,0,1))/1e3/60/60/24/i;return Sn(e,n)/l}case 2:return Sn(e,n)/360;case 3:return Sn(e,n)/365;case 4:return(a+g*30+h*360-(r+s*30+c*360))/360}}function at(e){return/^[01]{1,10}$/.test(e)}function gl(e,n){return e=R(e),n=R(n),$(e,n)?D:rr.besseli(e,n)}function hl(e,n){return e=R(e),n=R(n),$(e,n)?D:rr.besselj(e,n)}function dl(e,n){return e=R(e),n=R(n),$(e,n)?D:rr.besselk(e,n)}function vl(e,n){return e=R(e),n=R(n),$(e,n)?D:rr.bessely(e,n)}function pl(e){if(!at(e))return P;const n=parseInt(e,2),t=e.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:n}function wl(e,n){if(!at(e))return P;const t=e.toString();if(t.length===10&&t.substring(0,1)==="1")return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);const r=parseInt(e,2).toString(16);return n===void 0?r:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=r.length?We("0",n-r.length)+r:P)}function El(e,n){if(!at(e))return P;const t=e.toString();if(t.length===10&&t.substring(0,1)==="1")return(1073741312+parseInt(t.substring(1),2)).toString(8);const r=parseInt(e,2).toString(8);return n===void 0?r:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=r.length?We("0",n-r.length)+r:P)}function ml(e,n){return e=R(e),n=R(n),$(e,n)?D:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?P:e&n}function Nl(e,n){return e=R(e),n=R(n),$(e,n)?D:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?P:n>=0?e<<n:e>>-n}function Al(e,n){return e=R(e),n=R(n),$(e,n)?D:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?P:e|n}function Rl(e,n){return e=R(e),n=R(n),$(e,n)?D:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?P:n>=0?e>>n:e<<-n}function Il(e,n){return e=R(e),n=R(n),$(e,n)?D:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?P:e^n}function Ue(e,n,t){if(e=R(e),n=R(n),$(e,n))return e;if(t=t===void 0?"i":t,t!=="i"&&t!=="j")return D;if(e===0&&n===0)return 0;if(e===0)return n===1?t:n.toString()+t;if(n===0)return e.toString();{const r=n>0?"+":"";return e.toString()+r+(n===1?t:n.toString()+t)}}function yl(e,n,t){if(e=R(e),e instanceof Error)return e;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m3",["m^3"],"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},c={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,g=null,h=n,f=t,o=1,i=1,u;for(let l=0;l<r.length;l++)u=r[l][2]===null?[]:r[l][2],(r[l][1]===h||u.indexOf(h)>=0)&&(a=r[l]),(r[l][1]===f||u.indexOf(f)>=0)&&(g=r[l]);if(a===null){const l=s[n.substring(0,2)];let d=c[n.substring(0,1)];n.substring(0,2)==="da"&&(d=["dekao",10,"da"]),l?(o=l[2],h=n.substring(2)):d&&(o=d[1],h=n.substring(d[2].length));for(let v=0;v<r.length;v++)u=r[v][2]===null?[]:r[v][2],(r[v][1]===h||u.indexOf(h)>=0)&&(a=r[v])}if(g===null){const l=s[t.substring(0,2)];let d=c[t.substring(0,1)];t.substring(0,2)==="da"&&(d=["dekao",10,"da"]),l?(i=l[2],f=t.substring(2)):d&&(i=d[1],f=t.substring(d[2].length));for(let v=0;v<r.length;v++)u=r[v][2]===null?[]:r[v][2],(r[v][1]===f||u.indexOf(f)>=0)&&(g=r[v])}return a===null||g===null||a[3]!==g[3]?ee:e*a[6]*o/(g[6]*i)}function Ml(e,n){if(e=R(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return P;if(e<0)return"1"+We("0",9-(512+e).toString(2).length)+(512+e).toString(2);const t=parseInt(e,10).toString(2);return typeof n>"u"?t:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=t.length?We("0",n-t.length)+t:P)}function Tl(e,n){if(e=R(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return P;if(e<0)return(1099511627776+e).toString(16);const t=parseInt(e,10).toString(16);return typeof n>"u"?t:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=t.length?We("0",n-t.length)+t:P)}function Cl(e,n){if(e=R(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return P;if(e<0)return(1073741824+e).toString(8);const t=parseInt(e,10).toString(8);return typeof n>"u"?t:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=t.length?We("0",n-t.length)+t:P)}function Dl(e,n){return n=n===void 0?0:n,e=R(e),n=R(n),$(e,n)?D:e===n?1:0}function Po(e,n){return n=n===void 0?0:n,e=R(e),n=R(n),$(e,n)?D:K.erf(e)}function Vo(e){return isNaN(e)?D:K.erfc(e)}function Ol(e,n){return n=n||0,e=R(e),$(n,e)?e:e>=n?1:0}function Ll(e,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return P;const t=e.length===10&&e.substring(0,1).toLowerCase()==="f",r=t?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return P;if(t)return"1"+We("0",9-(512+r).toString(2).length)+(512+r).toString(2);const s=r.toString(2);return n===void 0?s:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=s.length?We("0",n-s.length)+s:P)}function Fl(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return P;const n=parseInt(e,16);return n>=549755813888?n-1099511627776:n}function Pl(e,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return P;const t=parseInt(e,16);if(t>536870911&&t<0xffe0000000)return P;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);const r=t.toString(8);return n===void 0?r:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=r.length?We("0",n-r.length)+r:P)}function gt(e){const n=Re(e),t=Ae(e);return $(n,t)?D:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))}function Ae(e){if(e===void 0||e===!0||e===!1)return D;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e+"",e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let n=e.indexOf("+"),t=e.indexOf("-");n===0&&(n=e.indexOf("+",1)),t===0&&(t=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),s=r==="i"||r==="j";return n>=0||t>=0?s?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?P:Number(e.substring(n+1,e.length-1)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?P:-Number(e.substring(t+1,e.length-1)):P:s?isNaN(e.substring(0,e.length-1))?P:e.substring(0,e.length-1):isNaN(e)?P:0}function ht(e){const n=Re(e),t=Ae(e);return $(n,t)?D:n===0&&t===0?Ve:n===0&&t>0?Math.PI/2:n===0&&t<0?-Math.PI/2:t===0&&n>0?0:t===0&&n<0?-Math.PI:n>0?Math.atan(t/n):n<0&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI}function Vl(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",t!==0?Ue(n,-t,r):e}function ar(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function qo(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function ql(e){const n=Re(e),t=Ae(e);return $(n,t)?D:Nn(ar(e),gr(e))}function Nn(e,n){const t=Re(e),r=Ae(e),s=Re(n),c=Ae(n);if($(t,r,s,c))return D;const a=e.substring(e.length-1),g=n.substring(n.length-1);let h="i";if((a==="j"||g==="j")&&(h="j"),s===0&&c===0)return P;const f=s*s+c*c;return Ue((t*s+r*c)/f,(r*s-t*c)/f,h)}function Ul(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const s=Math.exp(n);return Ue(s*Math.cos(t),s*Math.sin(t),r)}function $l(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),r)}function xl(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),r)}function Hl(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),r)}function zl(e,n){n=R(n);const t=Re(e),r=Ae(e);if($(n,t,r))return D;let s=e.substring(e.length-1);s=s==="i"||s==="j"?s:"i";const c=Math.pow(gt(e),n),a=ht(e);return Ue(c*Math.cos(n*a),c*Math.sin(n*a),s)}function Yl(){let e=arguments[0];if(!arguments.length)return D;for(let n=1;n<arguments.length;n++){const t=Re(e),r=Ae(e),s=Re(arguments[n]),c=Ae(arguments[n]);if($(t,r,s,c))return D;e=Ue(t*s-r*c,t*c+r*s)}return e}function Re(e){if(e===void 0||e===!0||e===!1)return D;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;e=e+"";let n=e.indexOf("+"),t=e.indexOf("-");n===0&&(n=e.indexOf("+",1)),t===0&&(t=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),s=r==="i"||r==="j";return n>=0||t>=0?s?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?P:Number(e.substring(0,n)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?P:Number(e.substring(0,t)):P:s?isNaN(e.substring(0,e.length-1))?P:0:isNaN(e)?P:e}function Bl(e){if(e===!0||e===!1)return D;const n=Re(e),t=Ae(e);return $(n,t)?D:Nn("1",ar(e))}function Gl(e){const n=Re(e),t=Ae(e);return $(n,t)?D:Nn("1",qo(e))}function gr(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function Uo(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",Ue(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,r)}function kl(e){const n=Re(e),t=Ae(e);if($(n,t))return D;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const s=Math.sqrt(gt(e)),c=ht(e);return Ue(s*Math.cos(c/2),s*Math.sin(c/2),r)}function Wl(e){if(e===!0||e===!1)return D;const n=Re(e),t=Ae(e);return $(n,t)?P:Nn("1",gr(e))}function Xl(e){if(e===!0||e===!1)return D;const n=Re(e),t=Ae(e);return $(n,t)?P:Nn("1",Uo(e))}function Kl(e,n){const t=Re(e),r=Ae(e),s=Re(n),c=Ae(n);if($(t,r,s,c))return D;const a=e.substring(e.length-1),g=n.substring(n.length-1);let h="i";return(a==="j"||g==="j")&&(h="j"),Ue(t-s,r-c,h)}function Sl(){if(!arguments.length)return D;const e=z(arguments);let n=0,t=0;for(const r of e){const s=+Re(r),c=+Ae(r);if($(s,c))return D;n+=s,t+=c}return Ue(n,t,"i")}function Zl(e){if(e===!0||e===!1)return D;const n=Re(e),t=Ae(e);return $(n,t)?D:Nn(gr(e),ar(e))}function Ql(e,n){if(!/^[0-7]{1,10}$/.test(e))return P;const t=e.length===10&&e.substring(0,1)==="7",r=t?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return P;if(t)return"1"+We("0",9-(512+r).toString(2).length)+(512+r).toString(2);const s=r.toString(2);return typeof n>"u"?s:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=s.length?We("0",n-s.length)+s:P)}function Jl(e){if(!/^[0-7]{1,10}$/.test(e))return P;const n=parseInt(e,8);return n>=536870912?n-1073741824:n}function bl(e,n){if(!/^[0-7]{1,10}$/.test(e))return P;const t=parseInt(e,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);const r=t.toString(16);return n===void 0?r:isNaN(n)?D:n<0?P:(n=Math.floor(n),n>=r.length?We("0",n-r.length)+r:P)}const _l=xn.DIST,jl=xn.INV,ec=Ln.DIST,nc=ln.MATH,rc=ln.PRECISE,tc=Se.DIST,oc=Se.DIST.RT,sc=Se.INV,ic=Se.INV.RT,fc=Se.TEST,uc=Fn.P,lc=Fn.P,cc=Fn.S,ac=Ln.INV,gc=Vo.PRECISE,hc=Po.PRECISE,dc=nt.DIST,vc=Ze.DIST,pc=Ze.DIST.RT,wc=Ze.INV,Ec=Ze.INV.RT,mc=wn.MATH,Nc=wn.PRECISE,Ac=Ze.TEST,Rc=Hn.DIST,Ic=Hn.INV,yc=rt.PRECISE,Mc=tt.DIST,Tc=Pn.INV,Cc=Pn.DIST,Dc=Pn.INV,Oc=vn.MULT,Lc=vn.SNGL,Fc=st.DIST,Pc=lr.INTL,Vc=Qe.DIST,qc=Qe.INV,Uc=Qe.S.DIST,$c=Qe.S.INV,xc=ke.EXC,Hc=ke.INC,zc=zn.EXC,Yc=zn.INC,Bc=it.DIST,Gc=pn.EXC,kc=pn.INC,Wc=Yn.AVG,Xc=Yn.EQ,Kc=ft.P,Sc=ze.P,Zc=ze.S,Qc=Ye.DIST,Jc=Ye.DIST.RT,bc=Ye.INV,_c=Ye.TEST,jc=xe.P,e0=xe.S,n0=ut.DIST,r0=cr.INTL,t0=lt.TEST;function dt(e){const n=[];return qe(e,t=>{t&&n.push(t)}),n}function Ke(e,n){const t={};for(let c=1;c<e[0].length;++c)t[c]=!0;let r=n[0].length;for(let c=1;c<n.length;++c)n[c].length>r&&(r=n[c].length);for(let c=1;c<e.length;++c)for(let a=1;a<e[c].length;++a){let g=!1,h=!1;for(let f=0;f<n.length;++f){const o=n[f];if(o.length<r)continue;const i=o[0];if(e[c][0]===i){h=!0;for(let u=1;u<o.length;++u)if(!g)if(o[u]===void 0||o[u]==="*")g=!0;else{const d=Dn(o[u]+""),v=[je(e[c][a],an)].concat(d);g=On(v)}}}h&&(t[a]=t[a]&&g)}const s=[];for(let c=0;c<e[0].length;++c)t[c]&&s.push(c-1);return s}function o0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);let c=0;return qe(r,a=>{c+=s[a]}),r.length===0?Ve:c/r.length}function s0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);const c=[];return qe(r,a=>{c.push(s[a])}),Un(c)}function i0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);const c=[];return qe(r,a=>{c.push(s[a])}),$n(c)}function f0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const c=Xe(e,n);s=Ie(e[c])}else s=Ie(e[n]);return r.length===0?D:r.length>1?P:s[r[0]]}function u0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);let c=s[r[0]];return qe(r,a=>{c<s[a]&&(c=s[a])}),c}function l0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);let c=s[r[0]];return qe(r,a=>{c>s[a]&&(c=s[a])}),c}function c0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const g=Xe(e,n);s=Ie(e[g])}else s=Ie(e[n]);let c=[];qe(r,g=>{c.push(s[g])}),c=dt(c);let a=1;return qe(c,g=>{a*=g}),a}function a0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);let c=[];return qe(r,a=>{c.push(s[a])}),c=dt(c),ze.S(c)}function g0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);let c=[];return qe(r,a=>{c.push(s[a])}),c=dt(c),ze.P(c)}function h0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);const c=[];return qe(r,a=>{c.push(s[a])}),rn(c)}function d0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);const c=[];return qe(r,a=>{c.push(s[a])}),xe.S(c)}function v0(e,n,t){if(isNaN(n)&&typeof n!="string")return D;const r=Ke(e,t);let s=[];if(typeof n=="string"){const a=Xe(e,n);s=Ie(e[a])}else s=Ie(e[n]);const c=[];return qe(r,a=>{c.push(s[a])}),xe.P(c)}function Nr(e){return e&&e.getTime&&!isNaN(e.getTime())}function Ar(e){return e instanceof Date?e:new Date(e)}function p0(e,n,t){let r=pe(n);for(r.setFullYear(e.getFullYear()),r<e&&r.setFullYear(r.getFullYear()+1);r>e;)r.setMonth(r.getMonth()+-12/t);return r}function $o(e){return e=R(e),[1,2,4].indexOf(e)===-1?P:e}function xo(e){return e=R(e),[0,1,2,3,4].indexOf(e)===-1?P:e}function w0(e,n,t,r,s,c,a){return e=Ar(e),n=Ar(n),t=Ar(t),c=$o(c),a=xo(a),ce(c,a)?P:!Nr(e)||!Nr(n)||!Nr(t)?D:r<=0||s<=0||t<=e?P:(s=s||0,a=a||0,s*r*ct(e,t,a))}function E0(e,n,t,r){if(r=xo(r),t=$o(t),e=pe(e),n=pe(n),ce(e,n))return D;if(ce(t,r)||e>=n)return P;if(r===1){let c=p0(e,n,t),a=pe(c);return a.setMonth(a.getMonth()+12/t),un(c,a,"D")}let s;switch(r){case 0:case 2:case 4:s=360;break;case 3:s=365;break;default:return P}return s/t}function m0(e,n,t,r,s,c){if(e=R(e),n=R(n),t=R(t),$(e,n,t))return D;if(e<=0||n<=0||t<=0||r<1||s<1||r>s||c!==0&&c!==1)return P;const a=Bn(e,n,t,0,c);let g=0;r===1&&(c===0&&(g=-t),r++);for(let h=r;h<=s;h++)g+=c===1?En(e,h-2,a,t,1)-a:En(e,h-1,a,t,0);return g*=e,g}function N0(e,n,t,r,s,c){if(e=R(e),n=R(n),t=R(t),$(e,n,t))return D;if(e<=0||n<=0||t<=0||r<1||s<1||r>s||c!==0&&c!==1)return P;const a=Bn(e,n,t,0,c);let g=0;r===1&&(g=c===0?a+t*e:a,r++);for(let h=r;h<=s;h++)g+=c>0?a-(En(e,h-2,a,t,1)-a)*e:a-En(e,h-1,a,t,0)*e;return g}function A0(e,n,t,r,s){if(s=s===void 0?12:s,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s))return D;if(e<0||n<0||t<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s)===-1||r>t)return P;if(n>=e)return 0;const c=(1-Math.pow(n/e,1/t)).toFixed(3),a=e*c*s/12;let g=a,h=0;const f=r===t?t-1:r;for(let o=2;o<=f;o++)h=(e-g)*c,g+=h;return r===1?a:r===t?(e-g)*c:h}function R0(e,n,t,r,s){if(s=s===void 0?2:s,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s))return D;if(e<0||n<0||t<0||r<0||s<=0||r>t)return P;if(n>=e)return 0;let c=0,a=0;for(let g=1;g<=r;g++)a=Math.min((e-c)*(s/t),e-n-c),c+=a;return a}function I0(e,n,t,r,s){if(e=pe(e),n=pe(n),t=R(t),r=R(r),s=R(s),s=s||0,$(e,n,t,r,s))return D;if(t<=0||r<=0)return P;if(e>=n)return D;let c,a;switch(s){case 0:c=360,a=cn(e,n,!1);break;case 1:c=365,a=un(e,n,"D");break;case 2:c=360,a=un(e,n,"D");break;case 3:c=365,a=un(e,n,"D");break;case 4:c=360,a=cn(e,n,!0);break;default:return P}return(r-t)/r*c/a}function y0(e,n){if(e=R(e),n=R(n),$(e,n))return D;if(n<0)return P;if(n>=0&&n<1)return Ve;n=parseInt(n,10);let t=parseInt(e,10);t+=e%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;const r=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return t=Math.round(t*r)/r,t}function M0(e,n){if(e=R(e),n=R(n),$(e,n))return D;if(n<0)return P;if(n>=0&&n<1)return Ve;n=parseInt(n,10);let t=parseInt(e,10);return t+=e%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n,t}function T0(e,n){return e=R(e),n=R(n),$(e,n)?D:e<=0||n<1?P:(n=parseInt(n,10),Math.pow(1+e/n,n)-1)}function En(e,n,t,r,s){if(r=r||0,s=s||0,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s))return D;let c;if(e===0)c=r+t*n;else{const a=Math.pow(1+e,n);c=s===1?r*a+t*(1+e)*(a-1)/e:r*a+t*(a-1)/e}return-c}function C0(e,n){if(e=R(e),n=Z(z(n)),$(e,n))return D;const t=n.length;let r=e;for(let s=0;s<t;s++)r*=1+n[s];return r}function Ho(e,n,t,r,s,c){if(s=s||0,c=c||0,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),c=R(c),$(e,n,t,r,s,c))return D;const a=Bn(e,t,r,s,c);return(n===1?c===1?0:-r:c===1?En(e,n-2,a,r,1)-a:En(e,n-1,a,r,0))*e}function D0(e,n){if(n=typeof n=="number"?n:typeof n>"u"?.1:R(n),e=z(e).filter(mn),e=Z(e),$(e,n))return D;const t=new Float64Array(e.length);let r=!1,s=!1;for(let f=0;f<e.length;f++)t[f]=e[f],t[f]>0&&(r=!0),t[f]<0&&(s=!0);if(!r||!s)return P;const c=f=>{f<=-1&&(f=-.999999999);let o=t[0];const i=1+f;let u=1;for(let l=1;l<t.length;l++)u*=i,o+=t[l]/u;return o},a=new Map,g=function(f){const o=Math.round(f*1e10)/1e10;if(a.has(o))return a.get(o);const i=c(o);return a.set(o,i),i};return function(){let i=n,u=i,l=0;for(;l<1e3;){const m=g(i);if(Math.abs(m)<1e-10)return i;if(l>0&&Math.abs(i-u)<1e-10*10)break;const w=Math.max(1e-4,Math.abs(i*1e-4)),N=(g(i+w)-m)/w;if(Math.abs(N)<1e-10)break;u=i;const A=m/N,I=Math.max(.1,Math.abs(i)*.5);Math.abs(A)>I?i-=Math.sign(A)*I:i-=A,i<=-1&&(i=-.99999999),i>1e3&&(i=1e3),l++}let d=g(i);if(Math.abs(d)<1e-10)return i;let v,p;if(d>0){for(v=i,p=i+.1;g(p)>0&&p<1e3;)p=p*2+.1;if(p>=1e3)return i}else{for(p=i,v=Math.max(-.99999999,i-.1);g(v)<0&&v>-.99999999;)v=Math.max(-.99999999,v-.1);if(v<=-.99999999)return i}let E;for(let m=0;m<1e3;m++){E=(v+p)/2;const w=g(E);if(Math.abs(w)<1e-10||Math.abs(p-v)<1e-10)return E;w*g(v)<0?p=E:v=E}return E}()}function O0(e,n,t,r){return e=R(e),n=R(n),t=R(t),r=R(r),$(e,n,t,r)?D:r*e*(n/t-1)}function L0(e,n,t){if(e=Z(z(e)),n=R(n),t=R(t),$(e,n,t))return D;const r=e.length,s=[],c=[];for(let h=0;h<r;h++)e[h]<0?s.push(e[h]):c.push(e[h]);const a=-Wr(t,c)*Math.pow(1+t,r-1),g=Wr(n,s)*(1+n);return Math.pow(a/g,1/(r-1))-1}function F0(e,n){return e=R(e),n=R(n),$(e,n)?D:e<=0||n<1?P:(n=parseInt(n,10),(Math.pow(e+1,1/n)-1)*n)}function P0(e,n,t,r,s){if(s=s===void 0?0:s,r=r===void 0?0:r,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s))return D;if(e===0)return-(t+r)/n;{const c=n*(1+e*s)-r*e,a=t*e+n*(1+e*s);return Math.log(c/a)/Math.log(1+e)}}function Wr(){const e=Z(z(arguments));if(e instanceof Error)return e;const n=e[0];let t=0;for(let r=1;r<e.length;r++)t+=e[r]/Math.pow(1+n,r);return t}function V0(e,n,t){return e=R(e),n=R(n),t=R(t),$(e,n,t)?D:e<=0?P:(Math.log(t)-Math.log(n))/Math.log(1+e)}function Bn(e,n,t,r,s){if(r=r||0,s=s||0,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s))return D;let c;if(e===0)c=(t+r)/n;else{const a=Math.pow(1+e,n);c=s===1?(r*e/(a-1)+t*e/(1-1/a))/(1+e):r*e/(a-1)+t*e/(1-1/a)}return-c}function q0(e,n,t,r,s,c){return s=s||0,c=c||0,e=R(e),t=R(t),r=R(r),s=R(s),c=R(c),$(e,t,r,s,c)?D:Bn(e,t,r,s,c)-Ho(e,n,t,r,s,c)}function U0(e,n,t,r,s){if(e=pe(e),n=pe(n),t=R(t),r=R(r),s=R(s),s=s||0,$(e,n,t,r,s))return D;if(t<=0||r<=0)return P;if(e>=n)return D;let c,a;switch(s){case 0:c=360,a=cn(e,n,!1);break;case 1:c=365,a=un(e,n,"D");break;case 2:c=360,a=un(e,n,"D");break;case 3:c=365,a=un(e,n,"D");break;case 4:c=360,a=cn(e,n,!0);break;default:return P}return r-t*r*a/c}function $0(e,n,t,r,s){return r=r||0,s=s||0,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),$(e,n,t,r,s)?D:e===0?-t*n-r:((1-Math.pow(1+e,n))/e*t*(1+e*s)-r)/Math.pow(1+e,n)}function x0(e,n,t,r,s,c){if(c=c===void 0?.1:c,r=r===void 0?0:r,s=s===void 0?0:s,e=R(e),n=R(n),t=R(t),r=R(r),s=R(s),c=R(c),$(e,n,t,r,s,c))return D;const a=1e-10,g=100;let h=c;s=s?1:0;for(let f=0;f<g;f++){if(h<=-1)return P;let o,i;if(Math.abs(h)<a?o=t*(1+e*h)+n*(1+h*s)*e+r:(i=Math.pow(1+h,e),o=t*i+n*(1/h+s)*(i-1)+r),Math.abs(o)<a)return h;let u;if(Math.abs(h)<a)u=t*e+n*s*e;else{i=Math.pow(1+h,e);const l=e*Math.pow(1+h,e-1);u=t*l+n*(1/h+s)*l+n*(-1/(h*h))*(i-1)}h-=o/u}return h}function H0(e,n,t){return e=R(e),n=R(n),t=R(t),$(e,n,t)?D:e===0||n===0?P:Math.pow(t/n,1/e)-1}function z0(e,n,t){return e=R(e),n=R(n),t=R(t),$(e,n,t)?D:t===0?P:(e-n)/t}function Y0(e,n,t,r){return e=R(e),n=R(n),t=R(t),r=R(r),$(e,n,t,r)?D:t===0||r<1||r>t?P:(r=parseInt(r,10),(e-n)*(t-r+1)*2/(t*(t+1)))}function B0(e,n,t){return e=pe(e),n=pe(n),t=R(t),$(e,n,t)?D:t<=0||e>n||n-e>365*24*60*60*1e3?P:365*t/(360-t*cn(e,n,!1))}function G0(e,n,t){return e=pe(e),n=pe(n),t=R(t),$(e,n,t)?D:t<=0||e>n||n-e>365*24*60*60*1e3?P:100*(1-t*cn(e,n,!1)/360)}function k0(e,n,t){return e=pe(e),n=pe(n),t=R(t),$(e,n,t)?D:t<=0||e>n||n-e>365*24*60*60*1e3?P:(100-t)*360/(t*cn(e,n,!1))}function W0(e,n,t){if(e=Z(z(e)),n=lo(z(n)),t=R(t),$(e,n,t))return D;const r=(l,d,v)=>{const p=v+1;let E=l[0];for(let m=1;m<l.length;m++)E+=l[m]/Math.pow(p,hn(d[m],d[0])/365);return E},s=(l,d,v)=>{const p=v+1;let E=0;for(let m=1;m<l.length;m++){const w=hn(d[m],d[0])/365;E-=w*l[m]/Math.pow(p,w+1)}return E};let c=!1,a=!1;for(let l=0;l<e.length;l++)e[l]>0&&(c=!0),e[l]<0&&(a=!0);if(!c||!a)return P;t=t||.1;let g=t;const h=1e-10;let f,o,i,u=!0;do i=r(e,n,g),f=g-i/s(e,n,g),o=Math.abs(f-g),g=f,u=o>h&&Math.abs(i)>h;while(u);return g}function X0(e,n,t){if(e=R(e),n=Z(z(n)),t=lo(z(t)),$(e,n,t))return D;let r=0;for(let s=0;s<n.length;s++)r+=n[s]/Math.pow(1+e,hn(t[s],t[0])/365);return r}function K0(){const e=z(arguments);let n=D;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===D&&(n=!0),e[t]||(n=!1))}return n}function S0(){return!1}function Z0(e,n,t){return e instanceof Error?e:(n=arguments.length>=2?n:!0,n==null&&(n=0),t=arguments.length===3?t:!1,t==null&&(t=0),e?n:t)}function Q0(){for(let e=0;e<arguments.length/2;e++)if(arguments[e*2])return arguments[e*2+1];return ee}function J0(e,n){return fr(e)?n:e}function b0(e,n){return e===ee?n:e}function _0(e){return typeof e=="string"?D:e instanceof Error?e:!e}function j0(){const e=z(arguments);let n=D;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===D&&(n=!1),e[t]&&(n=!0))}return n}function ea(){return!0}function na(){const e=z(arguments);let n=D;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===D&&(n=0),e[t]&&n++)}return n===D?n:!!(Math.floor(Math.abs(n))&1)}function ra(){let e;if(arguments.length>0){const n=arguments[0],t=arguments.length-1,r=Math.floor(t/2);let s=!1;const c=t%2!==0,a=t%2===0?null:arguments[arguments.length-1];if(r){for(let g=0;g<r;g++)if(n===arguments[g*2+1]){e=arguments[g*2+2],s=!0;break}}s||(e=c?a:ee)}else e=D;return e}const ta={errors:ks,symbols:Su,date:Ks},oa=Object.freeze(Object.defineProperty({__proto__:null,ABS:Tf,ACCRINT:w0,ACOS:Cf,ACOSH:Df,ACOT:Of,ACOTH:Lf,AGGREGATE:Ff,AND:K0,ARABIC:Pf,ASIN:Vf,ASINH:qf,ATAN:Uf,ATAN2:$f,ATANH:xf,AVEDEV:Xi,AVERAGE:dn,AVERAGEA:jr,AVERAGEIF:Ki,AVERAGEIFS:Si,BASE:Hf,BESSELI:gl,BESSELJ:hl,BESSELK:dl,BESSELY:vl,BETA:xn,BETADIST:_l,BETAINV:jl,BIN2DEC:pl,BIN2HEX:wl,BIN2OCT:El,BINOM:Ln,BINOMDIST:ec,BITAND:ml,BITLSHIFT:Nl,BITOR:Al,BITRSHIFT:Rl,BITXOR:Il,CEILING:ln,CEILINGMATH:nc,CEILINGPRECISE:rc,CHAR:po,CHIDIST:tc,CHIDISTRT:oc,CHIINV:sc,CHIINVRT:ic,CHISQ:Se,CHITEST:fc,CHOOSE:gi,CLEAN:Ri,CODE:wo,COLUMN:hi,COLUMNS:di,COMBIN:Mn,COMBINA:zf,COMPLEX:Ue,CONCAT:Ii,CONCATENATE:Eo,CONFIDENCE:et,CONVERT:yl,CORREL:Zi,COS:Yf,COSH:Bf,COT:Gf,COTH:kf,COUNT:Un,COUNTA:$n,COUNTBLANK:No,COUNTIF:Qi,COUNTIFS:Ji,COUPDAYS:E0,COVAR:uc,COVARIANCE:Fn,COVARIANCEP:lc,COVARIANCES:cc,CRITBINOM:ac,CSC:Wf,CSCH:Xf,CUMIPMT:m0,CUMPRINC:N0,DATE:Ju,DATEDIF:un,DATEVALUE:bu,DAVERAGE:o0,DAY:_u,DAYS:hn,DAYS360:cn,DB:A0,DCOUNT:s0,DCOUNTA:i0,DDB:R0,DEC2BIN:Ml,DEC2HEX:Tl,DEC2OCT:Cl,DECIMAL:Kf,DEGREES:Sf,DELTA:Dl,DEVSQ:bi,DGET:f0,DISC:I0,DMAX:u0,DMIN:l0,DOLLAR:yi,DOLLARDE:y0,DOLLARFR:M0,DPRODUCT:c0,DSTDEV:a0,DSTDEVP:g0,DSUM:h0,DVAR:d0,DVARP:v0,EDATE:ju,EFFECT:T0,EOMONTH:el,ERF:Po,ERFC:Vo,ERFCPRECISE:gc,ERFPRECISE:hc,ERROR:co,EVEN:Zf,EXACT:Mi,EXP:Qf,EXPON:nt,EXPONDIST:dc,F:Ze,FACT:en,FACTDOUBLE:Do,FALSE:S0,FDIST:vc,FDISTRT:pc,FIND:Ti,FINV:wc,FINVRT:Ec,FISHER:_i,FISHERINV:ji,FIXED:mo,FLOOR:wn,FLOORMATH:mc,FLOORPRECISE:Nc,FORECAST:Ao,FREQUENCY:ef,FTEST:Ac,FV:En,FVSCHEDULE:C0,GAMMA:Hn,GAMMADIST:Rc,GAMMAINV:Ic,GAMMALN:rt,GAMMALNPRECISE:yc,GAUSS:nf,GCD:Jf,GEOMEAN:rf,GESTEP:Ol,GROWTH:tf,HARMEAN:of,HEX2BIN:Ll,HEX2DEC:Fl,HEX2OCT:Pl,HLOOKUP:vi,HOUR:nl,HYPGEOM:tt,HYPGEOMDIST:Mc,IF:Z0,IFERROR:J0,IFNA:b0,IFS:Q0,IMABS:gt,IMAGINARY:Ae,IMARGUMENT:ht,IMCONJUGATE:Vl,IMCOS:ar,IMCOSH:qo,IMCOT:ql,IMCSC:Wl,IMCSCH:Xl,IMDIV:Nn,IMEXP:Ul,IMLN:$l,IMLOG10:xl,IMLOG2:Hl,IMPOWER:zl,IMPRODUCT:Yl,IMREAL:Re,IMSEC:Bl,IMSECH:Gl,IMSIN:gr,IMSINH:Uo,IMSQRT:kl,IMSUB:Kl,IMSUM:Sl,IMTAN:Zl,INDEX:pi,INT:bf,INTERCEPT:sf,IPMT:Ho,IRR:D0,ISBLANK:oi,ISERR:ao,ISERROR:fr,ISEVEN:si,ISLOGICAL:go,ISNA:ii,ISNONTEXT:fi,ISNUMBER:ur,ISO:_f,ISODD:ui,ISOWEEKNUM:Fo,ISPMT:O0,ISTEXT:ho,KURT:ff,LARGE:Ro,LCM:jf,LEFT:Ci,LEN:Di,LINEST:ot,LN:eu,LOG:nu,LOG10:ru,LOGEST:uf,LOGINV:Tc,LOGNORM:Pn,LOGNORMDIST:Cc,LOGNORMINV:Dc,LOOKUP:wi,LOWER:Oi,MATCH:Ei,MAX:bn,MAXA:lf,MAXIFS:cf,MEDIAN:Io,MID:Li,MIN:_n,MINA:af,MINIFS:gf,MINUTE:rl,MIRR:L0,MMULT:tu,MOD:ou,MODE:vn,MODEMULT:Oc,MODESNGL:Lc,MONTH:tl,MROUND:su,MULTINOMIAL:iu,MUNIT:fu,N:li,NA:ci,NEGBINOM:st,NEGBINOMDIST:Fc,NETWORKDAYS:lr,NETWORKDAYSINTL:Pc,NOMINAL:F0,NORM:Qe,NORMDIST:Vc,NORMINV:qc,NORMSDIST:Uc,NORMSINV:$c,NOT:_0,NOW:ol,NPER:P0,NPV:Wr,NUMBERVALUE:Fi,OCT2BIN:Ql,OCT2DEC:Jl,OCT2HEX:bl,ODD:uu,OR:j0,PDURATION:V0,PEARSON:yo,PERCENTILE:ke,PERCENTILEEXC:xc,PERCENTILEINC:Hc,PERCENTRANK:zn,PERCENTRANKEXC:zc,PERCENTRANKINC:Yc,PERMUT:hf,PERMUTATIONA:df,PHI:vf,PI:lu,PMT:Bn,POISSON:it,POISSONDIST:Bc,POWER:Oo,PPMT:q0,PRICEDISC:U0,PROB:pf,PRODUCT:jn,PROPER:Pi,PV:$0,QUARTILE:pn,QUARTILEEXC:Gc,QUARTILEINC:kc,QUOTIENT:cu,RADIANS:au,RAND:gu,RANDBETWEEN:hu,RANK:Yn,RANKAVG:Wc,RANKEQ:Xc,RATE:x0,REPLACE:Vi,REPT:We,RIGHT:qi,ROMAN:du,ROUND:Lo,ROUNDDOWN:vu,ROUNDUP:pu,ROW:wf,ROWS:mi,RRI:H0,RSQ:Ef,SEARCH:Ui,SEC:wu,SECH:Eu,SECOND:sl,SERIESSUM:mu,SIGN:Nu,SIN:Au,SINH:Ru,SKEW:ft,SKEWP:Kc,SLN:z0,SLOPE:mf,SMALL:Mo,SORT:Ni,SQRT:Iu,SQRTPI:yu,STANDARDIZE:Nf,STDEV:ze,STDEVA:Af,STDEVP:Sc,STDEVPA:Rf,STDEVS:Zc,STEYX:If,SUBSTITUTE:$i,SUBTOTAL:Mu,SUM:rn,SUMIF:Tu,SUMIFS:Cu,SUMPRODUCT:Du,SUMSQ:Ou,SUMX2MY2:Lu,SUMX2PY2:Fu,SUMXMY2:Pu,SWITCH:ra,SYD:Y0,T:Ye,TAN:Vu,TANH:qu,TBILLEQ:B0,TBILLPRICE:G0,TBILLYIELD:k0,TDIST:Qc,TDISTRT:Jc,TEXT:xi,TEXTJOIN:Hi,TIME:il,TIMEVALUE:fl,TINV:bc,TODAY:ul,TRANSPOSE:Ai,TREND:yf,TRIM:zi,TRIMMEAN:Mf,TRUE:ea,TRUNC:Uu,TTEST:_c,TYPE:ai,UNICHAR:Yi,UNICODE:Bi,UNIQUE:_r,UPPER:Gi,VALUE:ki,VAR:xe,VARA:To,VARP:jc,VARPA:Co,VARS:e0,VLOOKUP:vo,WEEKDAY:ll,WEEKNUM:cl,WEIBULL:ut,WEIBULLDIST:n0,WORKDAY:cr,WORKDAYINTL:r0,XIRR:W0,XNPV:X0,XOR:na,YEAR:al,YEARFRAC:ct,Z:lt,ZTEST:t0,utils:ta},Symbol.toStringTag,{value:"Module"}));var Rr,Lt;function hr(){return Lt||(Lt=1,Rr=function(n){for(var t=n+1,r="",s,c=10;t>0&&c--;)s=(t-1)%26,r=String.fromCharCode(s+65)+r,t=(t-s-1)/26;return r}),Rr}var Ir,Ft;function dr(){return Ft||(Ft=1,Ir=function(n){for(var t=0,r=n.replace(/[0-9]+$/,""),s=r.length;s--;)t+=Math.pow(26,r.length-s-1)*(r.charCodeAt(s)-64);return t-1}),Ir}var yr,Pt;function Gn(){return Pt||(Pt=1,yr=function(n){this.setValue=function(t){n=t},this.calc=function(){return n}}),yr}var Mr,Vt;function zo(){return Vt||(Vt=1,Mr=function(n){var t=n.match(/^'(.*)'$/);return t?t[1]:n}),Mr}var Tr,qt;function vt(){if(qt)return Tr;qt=1;const e=dr(),n=hr(),t=zo();return Tr=function(s,c){this.parse=function(){var a,g,h;if(s.indexOf("!")!=-1){var f=s.split("!");g=t(f[0]),a=f[1]}else g=c.sheet_name,a=s;h=c.wb.Sheets[g];var o=a.split(":"),i=parseInt(o[0].replace(/^[A-Z]+/,""),10)||0,u=o[1].replace(/^[A-Z]+/,""),l;u===""&&h["!ref"]&&(u=(h["!ref"].includes(":")?h["!ref"].split(":")[1]:h["!ref"]).replace(/^[A-Z]+/,"")),l=parseInt(u==""?"500000":u,10);var d=e(o[0]),v=e(o[1]);return{sheet_name:g,sheet:h,min_row:i,min_col:d,max_row:l,max_col:v}},this.calc=function(){for(var a=this.parse(),g=a.sheet_name,h=a.sheet,f=a.min_row,o=a.min_col,i=a.max_row,u=a.max_col,l=[],d=f;d<=i;d++){var v=[];l.push(v);for(var p=o;p<=u;p++){var E=n(p)+d,m=g+"!"+E,w=c.formula_ref[m];if(w){if(w.status==="new")c.exec_formula(w);else if(w.status==="working"){if(w.cell.f.includes(c.name))throw new Error("Circular ref");c.exec_formula(w)}h[E].t==="e"?v.push(new Error(h[E].w)):v.push(h[E].v)}else h[E]?h[E].t==="e"?v.push(new Error(h[E].w)):v.push(h[E].v):v.push(null)}}return l}},Tr}var Cr,Ut;function Yo(){if(Ut)return Cr;Ut=1;const e=zo();return Cr=function(t,r){var s=this;this.name="RefValue",this.str_expression=t,this.formula=r,s.parseRef=function(){var c,a,g,h;if(t.indexOf("!")!=-1){var f=t.split("!");a=e(f[0]),c=r.wb.Sheets[a],g=f[1]}else c=r.sheet,a=r.sheet_name,g=t;if(!c)throw Error("Sheet "+a+" not found.");return h=a+"!"+g,{sheet:c,sheet_name:a,cell_name:g,cell_full_name:h}},this.calc=function(){var c=s.parseRef(),a=c.sheet,g=c.cell_name,h=c.cell_full_name,f=a[g];if(!f)return null;var o=r.formula_ref[h];if(o){if(o.status==="new"){if(r.exec_formula(o),f.t==="e")throw console.log("ref is an error with new formula",h,f.w),new Error(f.w);return f.v}else if(o.status==="working"){if(f.f.includes(r.name))throw new Error("Circular ref");return r.exec_formula(o),this.calc()}else if(o.status==="done"){if(f.t==="e")throw console.log("ref is an error after formula eval",h,f.w),new Error(f.w);return f.v}}else{if(f.t==="e")throw console.log("ref is an error with no formula",g),new Error(f.w);return f.v}}},Cr}var Dr,$t;function sa(){return $t||($t=1,Dr=function(n){this.calc=function(){return n()}}),Dr}var Or,xt;function Bo(){if(xt)return Or;xt=1;const e=Gn(),n=Yo(),t=sa(),r=vt();let s,c;function a(g,h){if(!(h.wb.Workbook&&h.wb.Workbook.Names))return null;if(c!==h.wb)return c=h.wb,s=null,a(g,h);if(s)return s[g];const f=Object.values(h.wb.Workbook.Names);if(f.length!==0)return s={},f.forEach(({Name:o,Ref:i})=>{o.includes(".")||(s[o]=i)}),a(g,h)}return Or=function g(h,f){if(!isNaN(h))return new e(+h);if(h==="TRUE")return new e(1);if(h==="FALSE")return new e(0);if(typeof h!="string")return h;if(h=h.trim().replace(/\$/g,""),h.match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new r(h,f);if(h.match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new r(h,f);if(h.match(/^[A-Z]+:[A-Z]+$/))return new r(h,f);if(h.match(/^[^!]+![A-Z]+:[A-Z]+$/))return new r(h,f);if(h.match(/^[A-Z]+[0-9]+$/))return new n(h,f);if(h.match(/^[^!]+![A-Z]+[0-9]+$/))return new n(h,f);if(h.match(/%$/)){var o=g(h.substr(0,h.length-1),f);return new t(()=>o.calc()/100)}return a(h,f)?g(a(h,f),f):h},Or}var Lr,Ht;function kn(){if(Ht)return Lr;Ht=1;const e=new Error("#NULL!"),n=new Error("#DIV/0!"),t=new Error("#VALUE!"),r=new Error("#REF!"),s=new Error("#NAME?"),c=new Error("#NUM!"),a=new Error("#N/A"),g=new Error("#ERROR!"),h=new Error("#GETTING_DATA"),f=new Error("#CALC!"),o={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#CALC!":0};function i(u){return o[u]}return Lr={nil:e,div0:n,value:t,ref:r,name:s,num:c,na:a,error:g,data:h,calc:f,getErrorValueByMessage:i},Lr}var Fr,zt;function Go(){if(zt)return Fr;zt=1;const e=kn();return Fr=function(t){return function(){for(var r=!1,s=[],c=[],a=[],g=0,h=arguments.length;g<h;g++){var f=arguments[g],o=Array.isArray(f);o&&(r=!0);var i=o?f.map(I=>Array.isArray(I)?I:[I]):[[f]];s[g]=i,c[g]=i.length,a[g]=i[0].length}for(var u=Math.max.apply(null,c),l=Math.max.apply(null,a),d=[],v=0;v<u;v++){d[v]=[];for(var p=0;p<l;p++){for(var E=!1,m=[],g=0,h=s.length;g<h;g++){var w=s[g],N=c[g]===1?0:v,A=a[g]===1?0:p;if(N in w)if(w=w[N],A in w)w=w[A];else{E=!0;break}else{E=!0;break}m[g]=w}d[v][p]=E?e.na:t.apply(null,m)}}return r?d:d[0][0]}},Fr}var Pr,Yt;function ia(){if(Yt)return Pr;Yt=1;const e=Gn();vt();const n=Bo(),t=1440*60*1e3,r=dr(),s=hr(),c=Go(),{getErrorValueByMessage:a}=kn();var g=0;function h(f){return Array.isArray(f)&&(f.length===0||Array.isArray(f[0]))}return Pr=function(o){var i=this;i.id=++g,i.args=[],i.name="Expression",i.update_cell_value=u,i.formula=o;function u(){try{if(o.cell.v=i.calc(),o.cell.t=v(o.cell.v),h(o.cell.v)){const y=o.cell.v;o.cell.v=void 0;let C=o.name.match(/([A-Z]+)([0-9]+)/),V=r(C[1]),H=+C[2];for(let B=0;B<y.length;B++){const X=H+B;for(let te=0;te<y[B].length;te++){const ue=y[B][te],we=te+V,Y=s(we)+X;let _=o.sheet[Y];_||(_={},o.sheet[Y]=_),d(_,ue)}}}}catch(y){if(!l(o.cell,y))throw y}finally{o.status="done"}}function l(y,T){const C=T||{};y.t="e";const V=a(C.message);return V!==void 0?(y.w=C.message,y.v=V,!0):!1}function d(y,T){if(T instanceof Error)l(y,T);else{const C=v(T);y.v=T,C&&(y.t=C)}}function v(y){if(typeof y=="string")return"s";if(typeof y=="number")return"n";if(y instanceof Error)return"e"}function p(y){return y==null||y===""}function E(y){if(typeof y.calc!="function")throw new Error("Undefined "+y)}function m(y,T,C){for(var V=0;V<T.length;V++)if(T[V]===y)try{if(V===0&&y==="+"){E(T[V+1]);let H=T[V+1].calc();T.splice(V,2,new e(H))}else{E(T[V-1]),E(T[V+1]);let H=T[V-1].calc(),B=T[V+1].calc();if(H instanceof Error)throw H;if(B instanceof Error)throw B;let X=C(H,B);T.splice(V-1,3,new e(X)),V--}}catch(H){throw H}}function w(y){return Array.isArray(y)?y.map(w):-y}function N(y){for(var T=y.length;T--;)if(y[T]==="-"){E(y[T+1]);var C=y[T+1].calc();if(T>0&&typeof y[T-1]!="string"){if(y.splice(T,1,"+"),C instanceof Date){C=Date.parse(C),E(y[T-1]);var V=y[T-1].calc();V instanceof Date&&(V=Date.parse(V)/t,C=C/t,y.splice(T-1,1,new e(V)))}y.splice(T+1,1,new e(w(C)))}else{if(typeof C=="string")throw new Error("#VALUE!");y.splice(T,2,new e(w(C)))}}}function A(y,T){for(var C=0;C<y.length-2;C++)if(y[C]==="^"&&y[C+1]==="-")try{E(y[C-1]),E(y[C+2]);let V=y[C-1].calc(),H=y[C+2].calc();Array.isArray(V)&&(V=V[getCurrentCellIndex()-1][0]),Array.isArray(H)&&(H=H[getCurrentCellIndex()-1][0]);let B=T(V,H);y.splice(C-1,4,new e(B)),C--}catch(V){throw V}}i.calc=function(){let y=i.args.concat();if(A(y,function(T,C){return Math.pow(+T,0-C)}),m("^",y,c(function(T,C){return Math.pow(+T,+C)})),N(y),m("/",y,c(function(T,C){if(C==0)throw Error("#DIV/0!");return+T/+C})),m("*",y,c(function(T,C){return+T*+C})),m("+",y,c(function(T,C){return T instanceof Date&&typeof C=="number"&&(C=C*t),+T+ +C})),m("&",y,c(function(T,C){var V="";return T!==null&&(V+=T),C!==null&&(V+=C),V})),m("<",y,c(function(T,C){return T<C})),m(">",y,c(function(T,C){return T>C})),m(">=",y,c(function(T,C){return T>=C})),m("<=",y,c(function(T,C){return T<=C})),m("<>",y,c(function(T,C){return T instanceof Date&&C instanceof Date?T.getTime()!==C.getTime():p(T)&&p(C)?!1:T!==C})),m("=",y,c(function(T,C){return T instanceof Date&&C instanceof Date?T.getTime()===C.getTime():p(T)&&p(C)||T==null&&C===0||T===0&&C==null||typeof T=="string"&&typeof C=="string"&&T.toLowerCase()===C.toLowerCase()?!0:T===C})),y.length==1)return typeof y[0].calc!="function"?y[0]:y[0].calc()};var I;i.push=function(y){if(y){var T=n(y,o);T==="="&&(I==">"||I=="<")||I=="<"&&T===">"?i.args[i.args.length-1]+=T:i.args.push(T),I=T}}},Pr}var Vr,Bt;function fa(){if(Bt)return Vr;Bt=1;const{getErrorValueByMessage:e}=kn();return Vr=function(t){var r=this;r.name="UserFn",r.args=[],r.calc=function(){var s;try{if(s=t.apply(r,r.args.map(c=>c.calc())),s instanceof Error)throw s}catch(c){const a=e(c.message);if(t.name==="is_blank"&&a!==void 0)s=0;else if(t.name==="iserror"&&a!==void 0)s=!0;else throw c}return s},r.push=function(s){r.args.push(s)}},Vr}var qr,Gt;function ua(){return Gt||(Gt=1,qr=function(n,t){var r=this;r.name="UserRawFn",r.args=[],r.calc=function(){try{return n.apply(r,r.args)}catch(s){throw s}},r.push=function(s){r.args.push(s)}}),qr}var Ur,kt;function la(){if(kt)return Ur;kt=1;const e=ia(),n=Gn(),t=fa(),r=ua(),s={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};return Ur=function(a,g){a.status="working";var h=g.xlsx_Fx||{},f=g.xlsx_raw_Fx||{},o,i=a.cell.f;i[0]=="="&&(i=i.substr(1));var u=o=new e(a),l="",d=!1,v=[{exp:u}];function p(T){T==='"'?(u.push(new n(l)),d=!0,l="",I=A):l+=T}function E(T){T==="'"&&(I=A),l+=T}function m(){var T,C=l.trim(),V=h[C],H=f[C];if(H)V=new r(H,a);else if(V)V=new t(V,a);else if(C)throw new Error('"'+a.sheet_name+'"!'+a.name+": Function "+l+" not found");T=new e(a),v.push({exp:T,special:V}),u=T,l=""}function w(){var T,C=v.pop();u=C.exp,u.push(l),T=u,l="",u=v[v.length-1].exp,C.special?(C.special.push(T),u.push(C.special)):u.push(T)}function N(T){d||u.push(l),d=!1,u.push(T),l=""}function A(T){T==='"'?(I=p,l=""):T==="'"?(I=E,l="'"):T==="("?m():T===")"?w():s[T]?N(T):T===","&&v[v.length-1].special?(d=!1,v[v.length-1].exp.push(l),v[v.length-1].special.push(v[v.length-1].exp),v[v.length-1].exp=u=new e(a),l=""):T!==" "&&(l+=T)}for(var I=A,y=0;y<i.length;y++)I(i[y]);return o.push(l),o},Ur}var $r,Wt;function ca(){if(Wt)return $r;Wt=1;const e=kn();function n(r){if(typeof r=="boolean"||r instanceof Error)return r;if(typeof r=="number")return r!==0;if(typeof r=="string"){const s=r.toUpperCase();if(s==="TRUE")return!0;if(s==="FALSE")return!1}return r instanceof Date&&!isNaN(r)?!0:e.value}function t(r,s,c){if(!r||!s||!c||s<0||c<0||!Array.isArray(r)||!r.length)return r;for(let a=0;a<r.length;a++)if(!(r[a]instanceof Array))return r;for(let a=0;a<r.length;a++)if(r[a].length<s)for(let g=r[a].length;g<s;g++)r[a].push("");if(r.length<c)for(let a=r.length;a<c;a++){r.push([]);for(let g=0;g<s;g++)r[a].push("")}return r}return $r={addEmptyValuesToArray:t,parseBool:n},$r}var xr,Xt;function aa(){if(Xt)return xr;Xt=1;const e=ca(),n=kn();let t={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,"FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:_,MAX:we,SUM:ue,MIN:Y,CONCATENATE:te,PMT:X,COUNTA:B,IRR:H,"NORM.INV":V,"_xlfn.NORM.INV":V,STDEV:C,AVERAGE:T,EXP:y,LN:Math.log,"_xlfn.VAR.P":I,"VAR.P":I,"_xlfn.COVARIANCE.P":N,"COVARIANCE.P":N,TRIM:m,LEN:E,ISBLANK:w,HLOOKUP:p,INDEX:v,MATCH:d,SUMPRODUCT:f,ISNUMBER:h,TODAY:g,ISERROR:ne,TIME:ie,DAY:G,MONTH:oe,YEAR:q,RIGHT:he,LEFT:le,IFS:fe,ROUND:a,CORREL:c,SUMIF:s,CHOOSE:r,SUBSTITUTE:de,CEILING:J,FILTER:ge(ae),DATEDIF:k,EOMONTH:j};function r(M){return arguments[M]}function s(){let M=arguments[1],O=0;return[].slice.call(arguments)[0][0].forEach((L,U)=>{L!==null&&(L=L.toString(),L.replace(/\'/g,"")===M&&(isNaN([].slice.call(arguments)[2][0][U])||(O+=[].slice.call(arguments)[2][0][U])))}),O}function c(M,O){if(M=A(M),O=A(O),M.length!==O.length)return"N/D";for(var L=1/(M.length-1),U=ue.apply(this,M)/M.length,F=ue.apply(this,O)/O.length,x=0,b=0,me=0,Ee=0;Ee<M.length;Ee++)x+=(M[Ee]-U)*(O[Ee]-F),b+=Math.pow(M[Ee],2),me+=Math.pow(O[Ee],2);return b=Math.sqrt(b/L),me=Math.sqrt(me/L),x/(L*b*me)}function a(M,O){if(arguments.length===0)throw new Error("Err:511");if(arguments.length===1)return Math.round(M);let L=Math.pow(10,O);return Math.round(L*M)/L}function g(){var M=new Date;return M.setHours(0,0,0,0),M}function h(M){return!isNaN(M)}function f(){var M=function(Te){return Te===void 0||Te===""||Te===null||isNaN(Te)?0:parseFloat(Te)},O=function(Te){for(var Be=function(_e=[]){return _e.length},Wn=function(_e=[]){return _e[0]&&_e[0].length},Vn=Be(Te[0]),be=Wn(Te[0]),Rn=1;Rn<Te.length;Rn++)if(Be(Te[Rn])!==Vn||Wn(Te[Rn])!==be)return!1;return!0};if(!arguments||arguments.length===0||!arguments[0]||!O(arguments))throw Error("#VALUE!");for(var L=0;L<arguments.length;L++){var U=arguments[L];if(Array.isArray(U))for(var F=0;F<U.length;F++){var x=U[F];if(Array.isArray(x))for(var De=0;De<x.length;De++){var b=x[De];if(b instanceof Error)throw b}else{var b=x;if(b instanceof Error)throw b}}else{var b=U;if(b instanceof Error)throw b}}for(var me=arguments.length+1,Ee=0,$e,De,An,sn,L=0;L<arguments[0].length;L++)if(arguments[0][L]instanceof Array)for(var F=0;F<arguments[0][L].length;F++){for($e=1,De=1;De<me;De++)sn=M(arguments[De-1][L][F]),$e*=sn;Ee+=$e}else{for($e=1,De=1;De<me;De++)An=M(arguments[De-1][L]),$e*=An;Ee+=$e}return Ee}function o(M,O){for(var L,U,F=0;F<M.length;F++){if(M[F]===O)return F+1;M[F]<O&&(U?M[F]>U&&(L=F+1,U=M[F]):(L=F+1,U=M[F]))}if(!L)throw Error("#N/A");return L}function i(M,O){for(var L=0;L<M.length;L++)if(O=O.replace(/\?/g,"."),Array.isArray(M[L])){if(M[L].length===1&&typeof M[L][0]=="string"&&M[L][0].toLowerCase()===O.toLowerCase())return L+1}else if(typeof M[L]=="string"&&M[L].toLowerCase()===O.toLowerCase())return L+1;throw Error("#N/A")}function u(M,O){for(var L=0;L<M.length;L++)if(Array.isArray(M[L])){if(M[L].length===1&&M[L][0]===O)return L+1}else if(M[L]===O)return L+1;throw Error("#N/A")}function l(M,O){for(var L,U,F=0;F<M.length;F++)if(Array.isArray(M[F])&&M[F].length>0){if(M[F][0]===O)return F+1;M[F][0]>O&&(U?M[F][0]<U&&(L=F+1,U=M[F][0]):(L=F+1,U=M[F][0]))}else{if(M[F]===O)return F+1;M[F]>O&&(U?M[F]<U&&(L=F+1,U=M[F]):(L=F+1,U=M[F]))}if(!L)throw Error("#N/A");return L}function d(M,O,L){if(Array.isArray(O)&&O.length===1&&Array.isArray(O[0])&&(O=O[0]),!M&&!O||(arguments.length===2&&(L=1),!(O instanceof Array)))throw Error("#N/A");if(L===0)return typeof M=="string"?i(O,M):u(O,M);if(L===1)return o(O,M);if(L===-1)return l(O,M);throw Error("#N/A")}function v(M,O,L){if(O<=M.length){var U=M[O-1];if(Array.isArray(U))if(L){if(L<=U.length)return U[L-1]}else return U;else return M[O]}throw Error("#REF!")}function p(M,O,L,U){if(typeof M>"u"||w(M))throw Error("#N/A");L=L||0;let F=O[0],x,b;if(typeof M=="string"){for(b=M.toLowerCase(),x=0;x<F.length;x++)if(U&&F[x]===b||F[x].toLowerCase().indexOf(b)!==-1)return L<O.length+1?O[L-1][x]:O[0][x]}else for(b=M,x=0;x<F.length;x++)if(U&&F[x]===b||F[x]===b)return L<O.length+1?O[L-1][x]:O[0][x];throw Error("#N/A")}function E(M){return(""+M).length}function m(M){return(""+M).trim()}function w(M){return!M}function N(M,O){if(M=A(M),O=A(O),M.length!=O.length)return"N/D";for(var L=1/M.length,U=ue.apply(this,M)/M.length,F=ue.apply(this,O)/O.length,x=0,b=0;b<M.length;b++)x+=(M[b]-U)*(O[b]-F);return x*L}function A(M){for(var O=[],L=0;L<M.length;L++){var U=M[L];if(Array.isArray(U)){for(var F=U,x=F.length;x--;)if(typeof F[x]=="number")O.push(F[x]);else if(Array.isArray(F[x]))for(var b=F[x].length;b--;)typeof F[x][b]=="number"&&O.push(F[x][b])}else typeof U=="number"&&O.push(U)}return O}function I(){for(var M=T.apply(this,arguments),O=0,L=0,U=0;U<arguments.length;U++){var F=arguments[U];if(Array.isArray(F))for(var x=F,b=x.length;b--;)for(var me=x[b].length;me--;)x[b][me]!==null&&x[b][me]!==void 0&&(O+=Math.pow(x[b][me]-M,2),L++);else O+=Math.pow(F-M,2),L++}return O/L}function y(M){return Math.pow(Math.E,M)}function T(){var M=B.apply(this,arguments);if(M==0)throw Error("#DIV/0!");return ue.apply(this,arguments)/M}function C(){var M=A(arguments);function O(F){return F.reduce(function(x,b){return x+b})/F.length}var L=O(M),U=M.map(function(F){return(F-L)*(F-L)});return Math.sqrt(U.reduce(function(F,x){return F+x})/(M.length-1))}function V(M,O,L){if(M<0||M>1)throw"The probality p must be bigger than 0 and smaller than 1";if(L<0)throw"The standard deviation sigma must be positive";if(M==0)return-1/0;if(M==1)return 1/0;if(L==0)return O;var U,F,x;return U=M-.5,Math.abs(U)<=.425?(F=.180625-U*U,x=U*(((((((F*2509.0809287301227+33430.57558358813)*F+67265.7709270087)*F+45921.95393154987)*F+13731.69376550946)*F+1971.5909503065513)*F+133.14166789178438)*F+3.3871328727963665)/(((((((F*5226.495278852854+28729.085735721943)*F+39307.89580009271)*F+21213.794301586597)*F+5394.196021424751)*F+687.1870074920579)*F+42.31333070160091)*F+1)):(U>0?F=1-M:F=M,F=Math.sqrt(-Math.log(F)),F<=5?(F+=-1.6,x=(((((((F*.0007745450142783414+.022723844989269184)*F+.2417807251774506)*F+1.2704582524523684)*F+3.6478483247632045)*F+5.769497221460691)*F+4.630337846156546)*F+1.4234371107496835)/(((((((F*10507500716444169e-25+.0005475938084995345)*F+.015198666563616457)*F+.14810397642748008)*F+.6897673349851)*F+1.6763848301838038)*F+2.053191626637759)*F+1)):(F+=-5,x=(((((((F*20103343992922881e-23+27115555687434876e-21)*F+.0012426609473880784)*F+.026532189526576124)*F+.29656057182850487)*F+1.7848265399172913)*F+5.463784911164114)*F+6.657904643501103)/(((((((F*20442631033899397e-31+1421511758316446e-22)*F+18463183175100548e-21)*F+.0007868691311456133)*F+.014875361290850615)*F+.1369298809227358)*F+.599832206555888)*F+1)),U<0&&(x=-x)),O+L*x}function H(M,O){var L=-2,U=1,F=0;do{for(var x=(L+U)/2,b=0,me=0;me<M.length;me++){var Ee=M[me];b+=Ee[0]/Math.pow(1+x,me)}b>0?(L===U&&(U+=Math.abs(x)),L=x):U=x,F++}while(Math.abs(b)>1e-6&&F<1e5);return x}function B(){for(var M=0,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var U=L,F=U.length;F--;)for(var x=U[F].length;x--;)U[F][x]!==null&&U[F][x]!==void 0&&M++;else L!=null&&M++}return M}function X(M,O,L,U,F){if(F=F||0,U=U||0,M!=0){var x=Math.pow(1+M,O);return-(M*(U+x*L))/((-1+x)*(1+M*F))}else if(O!=0)return-(U+L)/O;return 0}function te(){for(var M="",O=0;O<arguments.length;O++){var L=arguments[O];L!=null&&(M+=L)}return M}function ue(){for(var M=0,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var U=L,F=U.length;F--;)for(var x=U[F].length;x--;)isNaN(U[F][x])||(M+=+U[F][x]);else M+=+L}return M}function we(){for(var M=null,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var U=L,F=U.length;F--;){var x=U[F];if(Array.isArray(x))for(var b=x.length;b--;)(M==null||x[b]!=null&&M<x[b])&&(M=x[b]);else(M==null||x!=null&&M<x)&&(M=x)}else!isNaN(L)&&(M==null||L!=null&&M<L)&&(M=L)}return M}function Y(){for(var M=null,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var U=L,F=U.length;F--;){var x=U[F];if(Array.isArray(x))for(var b=x.length;b--;)(M==null||x[b]!=null&&M>x[b])&&(M=x[b]);else(M==null||x!=null&&M>x)&&(M=x)}else!isNaN(L)&&(M==null||L!=null&&M>L)&&(M=L)}return M}function _(M,O,L,U=!0){for(var F=null,x=0;x<O.length;x++)if(O[x][0]<M)F=O[x][L-1];else if(O[x][0]==M)return O[x][L-1];if(U&&F)return F;throw Error("#N/A")}function ne(){return!1}function ie(M,O,L){return((M*60+O)*60+L)*1e3/864e5}function G(M){if(!M.getDate)throw Error("#VALUE!");var O=M.getUTCDate();if(isNaN(O))throw Error("#VALUE!");return O}function oe(M){if(!M.getMonth)throw Error("#VALUE!");var O=M.getUTCMonth();if(isNaN(O))throw Error("#VALUE!");return O+1}function q(M){if(!M.getFullYear)throw Error("#VALUE!");var O=M.getUTCFullYear();if(isNaN(O))throw Error("#VALUE!");return O}function k(M,O,L){if(M=new Date(M),O=new Date(O),!M||!O||M=="Invalid Date"||O=="Invalid Date")throw Error("#VALUE!");switch(L=L.replace(/[^DMY]/ig,""),L){case"M":return O.getMonth()-M.getMonth()+12*(O.getFullYear()-M.getFullYear());case"Y":return Math.abs(O.getUTCFullYear()-M.getUTCFullYear());case"D":default:var U=Math.abs(O-M);return Math.ceil(U/(1e3*3600*24))}}function j(M,O){if(M=new Date(M),!M||M=="Invalid Date")throw Error("#VALUE!");O=O||0;var L=new Date(M.getUTCFullYear(),M.getUTCMonth()+O+1,0);return L.setUTCHours(0),L.setUTCMinutes(0),L.setUTCSeconds(0),L}function he(M,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return M==null?M="":M=""+M,M.substring(M.length-O)}function le(M,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return M==null?M="":M=""+M,M.substring(0,O)}function fe(){for(var M=0;M+1<arguments.length;M+=2){var O=arguments[M],L=arguments[M+1];if(O)return L}throw Error("#N/A")}function re(M){return M.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function de(M,O,L,U){if(U<=0)throw Error("#VALUE!");if(!M||!O||!L&&L!=="")return M;if(U===void 0)return M.replace(new RegExp(re(O),"g"),L);for(var F=0,x=0;M.indexOf(O,F)>0;)if(F=M.indexOf(O,F+1),x++,x===U)return M.substring(0,F)+L+M.substring(F+O.length)}function J(M,O){return Math.ceil(M/O)*O}function ae(M,O,L){if(!M||!O||!(M instanceof Array)||!(O instanceof Array)||M.length===0||O.length===0)return n.na;for(let Ee=0;Ee<M.length;Ee++)if(!(M[Ee]instanceof Array)||M[Ee].length===0||M[Ee].length!==M[0].length)return n.na;for(let Ee=0;Ee<O.length;Ee++)if(!(O[Ee]instanceof Array)||O[Ee].length===0||O[Ee].length!==O[0].length)return n.na;const U=M[0].length,F=M.length,x=O[0].length,b=O.length;if(U!==x&&F!==b||F>1&&U>1&&(U===x&&b!==1||F===b&&x!==1)||F>1&&U===1&&(x!==1||b!==1&&b!==F))return n.na;const me=[];for(let Ee=0;Ee<F;Ee++){const $e=[];for(let De=0;De<U;De++){const An=Ne(O,Ee,De)||Ne(O,0,De)||Ne(O,Ee,0),sn=e.parseBool(An);if(sn===!0)$e.push(M[Ee][De]);else if(sn instanceof Error)return e.addEmptyValuesToArray([[sn]],U,F)}$e.length>0&&me.push($e)}return me.length===0?L!=null?e.addEmptyValuesToArray([[L]],U,F):e.addEmptyValuesToArray([[n.calc]],U,F):e.addEmptyValuesToArray(me,U,F)}function Ne(M,O,L){if(M[O])return M[O][L]===!1?"FALSE":M[O][L]}function ge(M){return function(){const O=M.apply(this,arguments);if(O instanceof Error)throw O;return O}}return xr=t,xr}var Hr,Kt;function ga(){if(Kt)return Hr;Kt=1;const e=hr(),n=dr(),t=Go(),r=Gn(),s=vt(),c=Yo();function a(d,v,p,E,m){if(E=(E||new r(1)).calc(),m=(m||new r(1)).calc(),d.args.length===1&&d.args[0].name==="RefValue"){var w=d.args[0],N=w.parseRef(),A=n(N.cell_name)+p.calc(),I=e(A),y=+N.cell_name.replace(/^[A-Z]+/g,"")+v.calc(),T=N.sheet_name+"!"+I+y;if(E===1&&m===1)return new c(T,w.formula).calc();var C=e(A+m-1),V=y+E-1,H=C+V,B=T+":"+H;return new s(B,w.formula).calc()}}function g(d){if(d.args.length===0){var v=+d.formula.name.replace(/^[A-Z]+/g,"");return v}else if(d.args.length===1&&d.args[0].name==="RefValue"){var p=d.args[0],E=p.parseRef(),v=+E.cell_name.replace(/^[A-Z]+/g,"");return v}else if(d.args.length===1&&d.args[0]instanceof s){for(var m=d.args[0].parse(),w=m.min_row,N=m.max_row,A=[],I=w;I<=N;I++)A.push(I);return A}}function h(d){if(d.args.length===0){var v=n(d.formula.name);return v+1}else if(d.args.length===1&&d.args[0].name==="RefValue"){var p=d.args[0],E=p.parseRef(),v=n(E.cell_name);return v+1}else if(d.args.length===1&&d.args[0]instanceof s){for(var m=d.args[0].parse(),w=m.min_col,N=m.max_col,A=[],I=w;I<=N;I++)A.push(I+1);return A}}function f(d,v){try{var p=d.calc();return typeof p=="number"&&(isNaN(p)||p===1/0||p===-1/0)?v.calc():p}catch(E){return v.calc()}}function o(d,v,p){var E,m,w;try{E=d.calc()}catch(N){E=N}try{m=v.calc()}catch(N){m=N}try{w=typeof p>"u"?!1:p.calc()}catch(N){w=N}return t(function(N,A,I){return N instanceof Error?N:N?A:I})(E,m,w)}function i(){for(var d=0;d<arguments.length;d++)if(!arguments[d].calc())return!1;return!0}function u(){for(var d=0;d<arguments.length;d++)if(arguments[d].calc())return!0;return!1}function l(d){let p=d.args[0].calc(),m=d.formula.name.match(/([A-Z]+)([0-9]+)/),w=d.formula.sheet,N=n(m[1]),A=+m[2];for(let I=0;I<p.length;I++){let y=p[I];for(let T=0;T<y.length;T++){let C=N+I,V=A+T,H=y[T];w[e(C)+V].v=H}}return p[0][0]}return Hr={OFFSET:a,ROW:g,COLUMN:h,IFERROR:f,IF:o,AND:i,OR:u,TRANSPOSE:l},Hr}var zr,St;function ha(){if(St)return zr;St=1;const e=la();let n={},t={};s(aa()),r(ga());function r(h,f){for(var o in h)t[o]=h[o]}function s(h,f){f=f||{};var o=f.prefix||"";for(var i in h){var u=h[i];typeof u=="function"?(f.override||!n[o+i])&&(n[o+i]=u):typeof u=="object"&&s(u,c(f,{prefix:i+"."}))}}function c(h,f){var o=JSON.parse(JSON.stringify(h));for(var i in f)o[i]=f[i];return o}function a(h){return e(h,{xlsx_Fx:n,xlsx_raw_Fx:t})}function g(h){a(h).update_cell_value()}return g.set_fx=function(f,o){n[f]=o},g.exec_fx=function(f,o){return n[f].apply(this,o)},g.localizeFunctions=function(h){for(let f in h){let o=h[f];n[o]&&(n[f]=n[o]),t[o]&&(t[f]=t[o])}},g.import_functions=s,g.import_raw_functions=r,g.build_expression=a,g.xlsx_Fx=n,zr=g,zr}var Yr,Zt;function ko(){return Zt||(Zt=1,Yr=function(n,t){let r={},s=[];for(let c in n.Sheets){let a=n.Sheets[c];for(let g in a)if(a[g]&&a[g].f){let h=r[c+"!"+g]={formula_ref:r,wb:n,sheet:a,sheet_name:c,cell:a[g],name:g,status:"new",exec_formula:t};s.push(h)}}return s}),Yr}var Br,Qt;function da(){if(Qt)return Br;Qt=1;const e=Gn(),n=Bo(),t=ko();class r{constructor(c,a){this.workbook=c,this.expressions=[],this.exec_formula=a,this.variables={},this.formulas=t(c,a);for(let g=this.formulas.length-1;g>=0;g--){let h=a.build_expression(this.formulas[g]);this.expressions.push(h)}this.calcNames()}setVar(c,a){let g=this.variables[c];g?g.setValue(a):this.expressions.forEach(h=>{this.setVarOfExpression(h,c,a)})}getVars(){let c={};for(let a in this.variables)c[a]=this.variables[a].calc();return c}calcNames(){!this.workbook||!this.workbook.Workbook||!this.workbook.Workbook.Names||this.workbook.Workbook.Names.forEach(c=>{let a=this.getRef(c.Ref);this.variables[c.Name]=a,this.expressions.forEach(g=>{this.setVarOfExpression(g,c.Name)})})}getRef(c){if(!this.formulas.length)throw new Error("No formula found.");let h={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return n(c,h)}setVarOfExpression(c,a,g){for(let h=0;h<c.args.length;h++){let f=c.args[h];f===a?c.args[h]=this.variables[a]||(this.variables[a]=new e(g)):typeof f=="object"&&(f.name==="Expression"||f.name==="UserFn")&&this.setVarOfExpression(f,a,g)}}execute(){this.expressions.forEach(c=>{c.update_cell_value()})}}return Br=r,Br}var Gr,Jt;function va(){if(Jt)return Gr;Jt=1;const e=hr(),n=dr(),t=ha(),r=ko(),s=da();var c=function(a,g){for(var h=r(a,t),f=h.length-1;f>=0;f--)try{if(h[f].status==="done")continue;t(h[f])}catch(o){if(!g||!g.continue_after_error)throw o;g.log_error&&console.log("error executing formula","sheet",h[f].sheet_name,"cell",h[f].name,o)}};return c.calculator=function(g){return new s(g,t)},c.set_fx=t.set_fx,c.exec_fx=t.exec_fx,c.col_str_2_int=n,c.int_2_col_str=e,c.import_functions=t.import_functions,c.import_raw_functions=t.import_raw_functions,c.xlsx_Fx=t.xlsx_Fx,c.localizeFunctions=t.localizeFunctions,c.XLSX_CALC=c,Gr=c,Gr}var pa=va();const bt=Xr(pa);function wa(e,n=50,t=50){var s;const r={SheetNames:[],Sheets:{}};for(const c of e.sheets){r.SheetNames.push(c.name);const a={};for(const g of c.rows)if(!(g.index>n))for(const h of g.cells){const f=/^[A-Z]+/.exec(h.address);if(!f)continue;const o=f[0];let i=0;for(let l=0;l<o.length;l++)i=i*26+(o.charCodeAt(l)-64);if(i>t)continue;const u={};if(h.value!==""){const l=Number(h.value);u.v=Number.isNaN(l)?h.value:l}h.formula&&(u.f=h.formula),a[h.address]=u}r.Sheets[c.name]=a}bt.import_functions(oa);try{bt(r,{continue_after_error:!0})}catch(c){fs.addError(c)}for(const c of e.sheets){const a=r.Sheets[c.name];for(const g of c.rows)if(!(g.index>n)){for(const h of g.cells)if(h.formula&&h.value===""){const f=(s=a[h.address])==null?void 0:s.v;h.value=f!=null?String(f):"This formula is not supported in web preview. Please download to open in your preferred software for the best results."}}}}function Ea(e){"use forget";const n=Kr.c(29),{addressLabel:t,inputFocused:r,selectedValue:s,refColors:c,onFxFocus:a,onFxBlur:g,onFxChange:h,canEdit:f,zoom:o,onZoomChange:i}=e,u=f===void 0?!1:f;let l;n[0]!==t?(l=ve.jsx("div",{className:"text-token-text-secondary w-24 px-2 text-center text-xs font-medium",children:t}),n[0]=t,n[1]=l):l=n[1];let d;n[2]!==r||n[3]!==c||n[4]!==s?(d=r&&ve.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center px-3 py-1 text-xs whitespace-pre",children:s.split(ro).map((C,V)=>c[C]?ve.jsx("span",{style:{color:c[C]},className:"font-normal",children:C},V):C)}),n[2]=r,n[3]=c,n[4]=s,n[5]=d):d=n[5];const v=!u;let p;n[6]!==h?(p=C=>h==null?void 0:h(C.target.value),n[6]=h,n[7]=p):p=n[7];let E;n[8]!==g||n[9]!==a||n[10]!==s||n[11]!==v||n[12]!==p?(E=ve.jsx("input",{type:"text",readOnly:v,value:s,className:"bg-token-bg-primary border-token-border-heavy w-full rounded-md border px-3 py-1 text-xs",onFocus:a,onBlur:g,onKeyDown:Na,onChange:p}),n[8]=g,n[9]=a,n[10]=s,n[11]=v,n[12]=p,n[13]=E):E=n[13];let m;n[14]!==d||n[15]!==E?(m=ve.jsxs("div",{className:"relative w-full",children:[d,E]}),n[14]=d,n[15]=E,n[16]=m):m=n[16];let w;n[17]===Symbol.for("react.memo_cache_sentinel")?(w=[.25,.5,.75,1,1.5,2,3,4].map(ma),n[17]=w):w=n[17];let N;n[18]!==o?(N=Math.round(o*100),n[18]=o,n[19]=N):N=n[19];const A="".concat(N,"%");let I;n[20]!==i?(I=C=>i(Number(C)),n[20]=i,n[21]=I):I=n[21];let y;n[22]!==A||n[23]!==I?(y=ve.jsx(Rs,{options:w,value:void 0,placeholder:A,onValueChange:I,triggerClassName:"text-xs w-16 h-6 border border-token-border-heavy"}),n[22]=A,n[23]=I,n[24]=y):y=n[24];let T;return n[25]!==y||n[26]!==l||n[27]!==m?(T=ve.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-2 p-2 text-sm",children:[l,m,y]}),n[25]=y,n[26]=l,n[27]=m,n[28]=T):T=n[28],T}function ma(e){return{label:"".concat(e*100,"%"),value:e.toString()}}function Na(e){e.key==="Enter"&&(e.preventDefault(),e.currentTarget.blur())}function Aa(e){e=Math.max(1,e);let n="";for(;e>0;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-1)/26)}return n}function Ra(e){const n=e.match(/[A-Z]+/);if(!n)return 0;let t=0;for(const r of n[0])t=t*26+(r.charCodeAt(0)-64);return t-1}function _t(e,n,t){var E;const r=e.startsWith("$"),s=r?1:0;let c=s;for(;c<e.length&&/[A-Za-z]/.test((E=e[c])!=null?E:"");)c++;const a=e.slice(s,c);let g=!1,h=c;e[h]==="$"&&(g=!0,h++);const f=e.slice(h),o=Ra(a),i=parseInt(f,10)||0,u=r?o:Math.max(1,o+n),l=g?i:Math.max(1,i+t),d=Aa(u),v=(r?"$":"")+d,p=(g?"$":"")+String(l);return v+p}function jt(e){var c;let n=0;e[n]==="$"&&n++;const t=n;for(;n<e.length&&/[A-Za-z]/.test((c=e[n])!=null?c:"");)n++;const r=e.slice(t,n);e[n]==="$"&&n++;const s=e.slice(n);return{col:ye(r),row:parseInt(s,10)||0}}const Ia=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function ya(e,n,t){if(!e||!n||!t)return e;const{col:r,row:s}=jt(n),{col:c,row:a}=jt(t),g=c-r,h=a-s;return g===0&&h===0?e:e.replace(Ia,(f,o,i,u)=>{const l=o?String(o):"",d=_t(String(i),g,h);if(!u)return"".concat(l).concat(d);const v=_t(String(u),g,h);return"".concat(l).concat(d,":").concat(v)})}function Ma(e){const{setOpenFilterMenu:n}=e;return S.useCallback(()=>n(null),[n])}function Ta(e,n){return S.useMemo(()=>{const r=Array(500).fill(no);for(const s of e){const a=!!s.hidden?0:ps(s.width);for(let g=s.min-1;g<s.max;g++)r[g]=a}for(const[s,c]of Object.entries(n)){const a=Number(s);Number.isFinite(a)&&a>=0&&a<r.length&&typeof c=="number"&&!Number.isNaN(c)&&(r[a]=c)}return r},[e,n])}function Ca(e){const{rowIndexRemap:n,sheetRows:t}=e;return S.useCallback(r=>{var c;const s=(c=n[r])!=null?c:r;return t.find(a=>a.index-1===s)},[n,t])}function Da(e){const{overlayCanvasRef:n,containerRef:t,selectionStartRef:r,selectionEndRef:s,viewColWidths:c,rowHeights:a,zoom:g,accentFill:h,accentStroke:f,sheet:o,resizeGuide:i,copyOutlineRectRef:u,copyDashOffsetRef:l}=e;return S.useCallback(()=>{var G,oe;const v=n.current,p=t.current;if(!v||!p)return;const E=v.getContext("2d");if(!E)return;const m=p.clientWidth,w=p.clientHeight,N=window.devicePixelRatio;v.width=m*N,v.height=w*N,v.style.width="".concat(m,"px"),v.style.height="".concat(w,"px"),E.setTransform(N,0,0,N,0,0),E.clearRect(0,0,m,w);const A=r.current,I=s.current;let y=0,T=0,C=0,V=0;if(A&&I&&(y=Math.min(A.row,I.row),T=Math.max(A.row,I.row),C=Math.min(A.col,I.col),V=Math.max(A.col,I.col)),A&&I&&A.row===I.row&&A.col===I.col){const k=((G=o.mergedCells)!=null?G:[]).find(j=>{const he=ye(j.startAddress),le=Oe(j.startAddress),fe=ye(j.endAddress),re=Oe(j.endAddress),de=Math.min(he,fe),J=Math.max(he,fe),ae=Math.min(le,re),Ne=Math.max(le,re);return A.col>=de&&A.col<=J&&A.row>=ae&&A.row<=Ne});if(k){const j=ye(k.startAddress),he=Oe(k.startAddress),le=ye(k.endAddress),fe=Oe(k.endAddress);C=Math.min(j,le),V=Math.max(j,le),y=Math.min(he,fe),T=Math.max(he,fe)}}const H=[0];for(let q=0;q<c.length;q++)H[q+1]=H[q]+c[q];const B=[0];for(let q=0;q<a.length;q++)B[q+1]=B[q]+a[q];E.save(),E.scale(g,g);const X=A&&I?Pe+H[C]-p.scrollLeft:0,te=A&&I?Fe+B[y]-p.scrollTop:0,ue=A&&I?H[V+1]-H[C]:0,we=A&&I?B[T+1]-B[y]:0,Y=A?Pe+H[A.col]-p.scrollLeft:0,_=A?Fe+B[A.row]-p.scrollTop:0,ne=A?c[A.col]:0,ie=A?a[A.row]:0;if(A&&I){E.save(),E.fillStyle=h;const q=X+ue,k=te+we,j=Y+ne,he=_+ie;_>te&&E.fillRect(X,te,ue,_-te),he<k&&E.fillRect(X,he,ue,k-he),Y>X&&E.fillRect(X,_,Y-X,ie),j<q&&E.fillRect(j,_,q-j,ie),E.restore()}if(A&&I){E.save(),E.fillStyle=h;for(let q=C;q<=V;q++){const k=Pe+H[q]-p.scrollLeft,j=c[q];E.fillRect(k,0,j,Fe),E.strokeStyle=f,E.lineWidth=2/g,E.beginPath(),E.moveTo(k,Fe),E.lineTo(k+j,Fe),E.stroke()}for(let q=y;q<=T;q++){const k=Fe+B[q]-p.scrollTop,j=a[q];E.fillRect(0,k,Pe,j),E.strokeStyle=f,E.lineWidth=2/g,E.beginPath(),E.moveTo(Pe,k),E.lineTo(Pe,k+j),E.stroke()}E.restore()}if(E.restore(),A&&I&&(E.save(),E.strokeStyle=f,E.lineWidth=1,E.strokeRect(X,te,ue,we),E.restore()),u.current){let{r1:q,c1:k,r2:j,c2:he}=u.current;if(q===j&&k===he){const M=((oe=o.mergedCells)!=null?oe:[]).find(O=>{const L=ye(O.startAddress),U=Oe(O.startAddress),F=ye(O.endAddress),x=Oe(O.endAddress),b=Math.min(L,F),me=Math.max(L,F),Ee=Math.min(U,x),$e=Math.max(U,x);return k>=b&&k<=me&&q>=Ee&&q<=$e});if(M){const O=ye(M.startAddress),L=Oe(M.startAddress),U=ye(M.endAddress),F=Oe(M.endAddress);k=Math.min(O,U),he=Math.max(O,U),q=Math.min(L,F),j=Math.max(L,F)}}const le=[0];for(let ge=0;ge<c.length;ge++)le[ge+1]=le[ge]+c[ge];const fe=[0];for(let ge=0;ge<a.length;ge++)fe[ge+1]=fe[ge]+a[ge];const re=v.getContext("2d");if(!re)return;re.save(),re.scale(g,g);const de=Pe+le[k]-p.scrollLeft,J=Fe+fe[q]-p.scrollTop,ae=le[he+1]-le[k],Ne=fe[j+1]-fe[q];re.strokeStyle=f,re.lineWidth=2/g,re.setLineDash([8,4]),re.lineDashOffset=-l.current,re.strokeRect(de,J,ae,Ne),re.restore()}if(i){const q=v.getContext("2d");if(!q)return;q.save(),q.scale(g,g),q.strokeStyle=f,q.lineWidth=2/g,q.setLineDash([6,4]),i.type==="col"?(q.beginPath(),q.moveTo(i.pos,0),q.lineTo(i.pos,w/g),q.stroke()):(q.beginPath(),q.moveTo(0,i.pos),q.lineTo(m/g,i.pos),q.stroke()),q.restore()}},[n,t,r,s,c,a,g,h,f,o,i,u,l])}function Oa(e){const{canvasRef:n,containerRef:t,sheet:r,viewColWidths:s,rowHeights:c,selRow:a,selCol:g,zoom:h,accentColor:f,styleInfos:o,refColors:i,formulaRefs:u,inputFocused:l,workbook:d,themeMap:v,showFormulas:p,rowIndexRemap:E,unsupportedCellsRef:m,rowAutoHeight:w}=e;return S.useCallback(()=>{const A=n.current,I=t.current;if(!A||!I)return;const y=A.getContext("2d");if(!y)return;const T=I.clientWidth,C=I.clientHeight;A.width=T*window.devicePixelRatio,A.height=C*window.devicePixelRatio,A.style.width="".concat(T,"px"),A.style.height="".concat(C,"px"),y.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),ws(y,r,s,c,I.scrollLeft,I.scrollTop,T,C,a,g,h,o,i,new Set(u),m.current,l,d,v,p,E,void 0,void 0,{accentColor:f,rowAutoHeight:w})},[n,t,r,s,c,a,g,h,f,o,i,u,l,d,v,p,E,m,w])}function vr(e){var s,c,a;const n=e.split(":"),t=(s=n[0])!=null?s:"A1",r=(a=(c=n[1])!=null?c:n[0])!=null?a:"A1";return{c1:ye(t),r1:Oe(t),c2:ye(r),r2:Oe(r)}}function La(e,n,t,r,s){return S.useMemo(()=>{var f,o,i,u;const a=e.defaultRowHeight&&e.defaultRowHeight!==0?e.defaultRowHeight:Sr,g=Array(500).fill(qn(a));for(const l of e.rows)(l.customHeight||l.height!==0)&&l.height!=null&&(g[l.index-1]=qn(l.height)),l.hidden&&(g[l.index-1]=0);for(const[l,d]of Object.entries(n)){const v=Number(l);Number.isFinite(v)&&v>=0&&v<g.length&&typeof d=="number"&&!Number.isNaN(d)&&(g[v]=d)}if(e.tables&&Object.keys(t).length>0){const l=new Map;for(const d of e.rows)l.set(d.index-1,d);for(const d of e.tables){if(!(d!=null&&d.ref))continue;const{c1:v,r1:p,c2:E,r2:m}=vr(d.ref),w=Math.min(v,E),N=Math.max(v,E),A=Math.min(p,m),I=Math.max(0,Math.min(1,(f=d.headerRowCount)!=null?f:1)),y=Math.max(0,Math.min(1,(o=d.totalsRowCount)!=null?o:d.totalsRowShown?1:0)),T=A+I,C=Math.max(A,Math.max(p,m)-y);if(T>C)continue;const V=new Map;for(let H=w;H<=N;H++){const B="".concat(e.name,":").concat((i=d.id)!=null?i:0,":").concat(H),X=t[B];X&&X.size>0&&V.set(H,X)}if(V.size!==0)for(let H=T;H<=C;H++){const B=(u=s[H])!=null?u:H,X=l.get(B);if(!X)continue;let te=!0;for(const[ue,we]of V.entries()){const Y=X.cells.find(ne=>ye(ne.address)===ue),_=Y?Tn(Y,r):"";if(!we.has(_)){te=!1;break}}te||(g[H]=0)}}}const h=g.reduce((l,d)=>l+d,0);return{heights:g,total:h}},[e,n,t,r,s])}function Fa(e,n,t){return S.useMemo(()=>{var g,h,f,o,i,u;const s=Array.from({length:500},(l,d)=>d),c=(g=e.tables)!=null?g:[];if(c.length===0)return s;const a=new Map;for(const l of e.rows)a.set(l.index-1,l);for(const l of c){if(!(l!=null&&l.ref))continue;const d="".concat(e.name,":").concat((h=l.id)!=null?h:0),v=n[d];if(!v)continue;const{r1:p,r2:E}=vr(l.ref),m=Math.min(p,E),w=Math.max(p,E),N=Math.max(0,Math.min(1,(f=l.headerRowCount)!=null?f:1)),A=Math.max(0,Math.min(1,(o=l.totalsRowCount)!=null?o:l.totalsRowShown?1:0)),I=m+N,y=Math.max(m,w-A);if(I>y)continue;const T=[];for(let C=I;C<=y;C++){const V=a.get(C),H=V==null?void 0:V.cells.find(te=>te&&typeof te.address=="string"&&te.address.length>0),B=H?Tn(H,t):"",X=B===""?null:Number(B);T.push({actual:C,keyStr:B,keyNum:Number.isFinite(X)?X:null})}T.sort((C,V)=>{if(C.keyNum!=null&&V.keyNum!=null)return v.dir==="asc"?C.keyNum-V.keyNum:V.keyNum-C.keyNum;const H=C.keyStr.toLowerCase(),B=V.keyStr.toLowerCase(),X=H.localeCompare(B);return v.dir==="asc"?X:-X});for(let C=0;C<T.length;C++){const V=I+C,H=(u=(i=T[C])==null?void 0:i.actual)!=null?u:V;V>=0&&V<s.length&&(s[V]=H)}}return s},[e,n,t])}function Pa(e){return S.useMemo(()=>Es(e),[e])}function Va(e,n,t,r){return S.useMemo(()=>{if(!e){const g=n.reduce((h,f)=>h+f,0);return{widths:n,total:g}}const s=new Set;for(const g of t)for(const h of g.cells)(h.formula&&h.formula!==""||typeof h.sharedFormulaSi=="number")&&s.add(ye(h.address));const c=n.slice();s.forEach(g=>{g in r||g>=0&&g<c.length&&(c[g]=c[g]*2)});const a=c.reduce((g,h)=>g+h,0);return{widths:c,total:a}},[e,n,t,r])}function qa(e){"use forget";var le,fe,re,de;const n=Kr.c(70),{btn:t,isOpen:r,onOpen:s,onClose:c,zoom:a,values:g,selectedValues:h,onToggleValue:f,onSelectAll:o,onSort:i,filterSortTitle:u,filterHeaderLabel:l,noDiscreteValuesLabel:d,selectAllLabel:v,sortAZLabel:p,sortZALabel:E}=e;let m;n[0]===Symbol.for("react.memo_cache_sentinel")?(m={placement:"bottom-end",middleware:[ls(6),cs(),as({padding:8})],whileElementsMounted:us},n[0]=m):m=n[0];const{refs:w,floatingStyles:N,update:A}=gs(m);let I;n[1]!==w?(I=J=>{w.setReference(J)},n[1]=w,n[2]=I):I=n[2];const y=I;let T;n[3]!==w?(T=J=>{w.setFloating(J)},n[3]=w,n[4]=T):T=n[4];const C=T;let V;n[5]!==r||n[6]!==A?(V=()=>{r&&(A==null||A())},n[5]=r,n[6]=A,n[7]=V):V=n[7];let H;n[8]!==t.height||n[9]!==t.left||n[10]!==t.top||n[11]!==t.width||n[12]!==r||n[13]!==A||n[14]!==a?(H=[r,A,t.left,t.top,t.width,t.height,a],n[8]=t.height,n[9]=t.left,n[10]=t.top,n[11]=t.width,n[12]=r,n[13]=A,n[14]=a,n[15]=H):H=n[15],S.useEffect(V,H);let B;n[16]!==r||n[17]!==c||n[18]!==((le=w.floating)==null?void 0:le.current)||n[19]!==((fe=w.reference)==null?void 0:fe.current)?(B=()=>{if(!r)return;const J=Ne=>{var L,U;const ge=Ne.target;if(!(ge instanceof Node))return;const M=(L=w.reference)==null?void 0:L.current,O=(U=w.floating)==null?void 0:U.current;M&&M.contains(ge)||O&&O.contains(ge)||c()},ae=Ne=>{Ne.key==="Escape"&&c()};return window.addEventListener("pointerdown",J,{capture:!0}),window.addEventListener("keydown",ae),()=>{window.removeEventListener("pointerdown",J,!0),window.removeEventListener("keydown",ae)}},n[16]=r,n[17]=c,n[18]=(re=w.floating)==null?void 0:re.current,n[19]=(de=w.reference)==null?void 0:de.current,n[20]=B):B=n[20];let X;n[21]!==r||n[22]!==c||n[23]!==w.floating||n[24]!==w.reference?(X=[r,c,w.floating,w.reference],n[21]=r,n[22]=c,n[23]=w.floating,n[24]=w.reference,n[25]=X):X=n[25],S.useEffect(B,X);const te=t.left*a,ue=t.top*a,we=t.width*a,Y=t.height*a;let _;n[26]!==we||n[27]!==Y||n[28]!==te||n[29]!==ue?(_={left:te,top:ue,width:we,height:Y},n[26]=we,n[27]=Y,n[28]=te,n[29]=ue,n[30]=_):_=n[30];let ne;n[31]===Symbol.for("react.memo_cache_sentinel")?(ne=hs("hover:bg-token-bg-secondary inline-flex items-center gap-0.5 rounded-[2px] border text-[10px] leading-none","border-token-border-heavy bg-white"),n[31]=ne):ne=n[31];let ie;n[32]!==r||n[33]!==c||n[34]!==s?(ie=J=>{J.preventDefault(),J.stopPropagation(),r?c():s()},n[32]=r,n[33]=c,n[34]=s,n[35]=ie):ie=n[35];let G;n[36]!==t.isFiltered?(G=t.isFiltered&&ve.jsx("svg",{"aria-hidden":"true",width:"10",height:"10",viewBox:"0 0 24 24",fill:"currentColor",children:ve.jsx("path",{d:"M3 4h18l-7 8v6l-4 2v-8L3 4z"})}),n[36]=t.isFiltered,n[37]=G):G=n[37];let oe;n[38]!==t.isSorted||n[39]!==t.sortDir?(oe=t.isSorted&&(t.sortDir==="asc"?ve.jsx(ys,{className:"size-3"}):ve.jsx(Is,{className:"size-3"})),n[38]=t.isSorted,n[39]=t.sortDir,n[40]=oe):oe=n[40];let q;n[41]!==t.isFiltered||n[42]!==t.isSorted?(q=!t.isFiltered&&!t.isSorted&&ve.jsx("svg",{"aria-hidden":"true",width:"10",height:"10",viewBox:"0 0 24 24",fill:"currentColor",children:ve.jsx("path",{d:"M7 10l5 5 5-5z"})}),n[41]=t.isFiltered,n[42]=t.isSorted,n[43]=q):q=n[43];let k;n[44]!==u||n[45]!==y||n[46]!==ie||n[47]!==G||n[48]!==oe||n[49]!==q?(k=ve.jsx("div",{className:"flex h-full items-center justify-end px-1",children:ve.jsxs("button",{type:"button",ref:y,"data-walnut-filter-button":"true",className:ne,title:u,onClick:ie,children:[G,oe,q]})}),n[44]=u,n[45]=y,n[46]=ie,n[47]=G,n[48]=oe,n[49]=q,n[50]=k):k=n[50];let j;n[51]!==l||n[52]!==N||n[53]!==r||n[54]!==d||n[55]!==c||n[56]!==o||n[57]!==i||n[58]!==f||n[59]!==v||n[60]!==h||n[61]!==C||n[62]!==p||n[63]!==E||n[64]!==g?(j=r&&ss.createPortal(ve.jsxs("div",{ref:C,"data-walnut-filter-menu":"true",className:"mt-1 w-56 rounded-md border bg-white text-xs shadow-lg",style:gn(He({},N),{zIndex:1e3,pointerEvents:"auto"}),onMouseDown:xa,onMouseUp:$a,onClick:Ua,children:[ve.jsxs("div",{className:"flex items-center justify-between border-b p-2 font-medium",children:[ve.jsx("span",{children:l}),ve.jsx("button",{type:"button",className:"text-token-text-secondary hover:text-token-text-primary text-[11px]",onClick:J=>{J.preventDefault(),J.stopPropagation(),o()},children:v})]}),ve.jsxs("div",{className:"max-h-48 space-y-1 overflow-auto p-2",children:[g.map(J=>{const ae=h?h.has(J):!0;return ve.jsxs("label",{className:"flex items-center gap-2",children:[ve.jsx("input",{type:"checkbox",checked:ae,onChange:()=>f(J)}),ve.jsx("span",{className:"truncate",title:J,children:J})]},J)}),g.length===0&&ve.jsx("div",{className:"text-token-text-secondary",children:d})]}),ve.jsx("div",{className:"flex items-center gap-2 border-t p-2",children:ve.jsxs("div",{className:"ms-auto flex items-center gap-2",children:[ve.jsx("button",{type:"button",className:"flex-1 rounded border px-2 py-1",onClick:J=>{J.preventDefault(),J.stopPropagation(),i("asc"),c()},children:p}),ve.jsx("button",{type:"button",className:"flex-1 rounded border px-2 py-1",onClick:J=>{J.preventDefault(),J.stopPropagation(),i("desc"),c()},children:E})]})})]}),document.body),n[51]=l,n[52]=N,n[53]=r,n[54]=d,n[55]=c,n[56]=o,n[57]=i,n[58]=f,n[59]=v,n[60]=h,n[61]=C,n[62]=p,n[63]=E,n[64]=g,n[65]=j):j=n[65];let he;return n[66]!==_||n[67]!==k||n[68]!==j?(he=ve.jsxs("div",{className:"absolute",style:_,children:[k,j]}),n[66]=_,n[67]=k,n[68]=j,n[69]=he):he=n[69],he}function Ua(e){e.stopPropagation()}function $a(e){e.stopPropagation()}function xa(e){e.stopPropagation()}function eo(e,n,t,r){var N,A,I,y,T,C,V;const s=((N=e.tables)!=null?N:[]).find(H=>{var B;return((B=H.id)!=null?B:0)===r});if(!(s!=null&&s.autoFilter))return[];const{c1:c,r1:a,c2:g,r2:h}=vr((A=s.ref)!=null?A:"A1"),f=t-Math.min(c,g),o=((I=s.autoFilter.columns)!=null?I:[]).find(H=>H.colId===f&&H.type==="filters"),i=(T=(y=o==null?void 0:o.filters)==null?void 0:y.values)!=null?T:[];if(i.length>0)return i.slice(0,200);if(!s.ref)return[];const u=Math.min(a,h),l=Math.max(a,h),d=Math.max(0,Math.min(1,(C=s.headerRowCount)!=null?C:1)),v=Math.max(0,Math.min(1,(V=s.totalsRowCount)!=null?V:s.totalsRowShown?1:0)),p=u+d,E=Math.max(u,l-v);if(p>E)return[];const m=new Set;for(let H=p;H<=E;H++){const B=e.rows.find(ue=>ue.index-1===H);if(!B)continue;const X=B.cells.find(ue=>ye(ue.address)===t),te=X?Tn(X,n):"";if(m.add(te),m.size>2e3)break}const w=Array.from(m);return w.sort((H,B)=>H.localeCompare(B)),w.slice(0,200)}function Ha(e,n,t,r,s,c){const a="".concat(n,":").concat(t,":").concat(r);e(g=>{const h=He({},g),f=g[a],o=new Set(f?Array.from(f):Array.from(s));return o.has(c)?o.delete(c):o.add(c),o.size===s.length?delete h[a]:h[a]=o,h})}const yn={filter:In({id:"walnut.spreadsheet.filter.header",defaultMessage:"Filter"}),noDiscreteValues:In({id:"walnut.spreadsheet.filter.no_values",defaultMessage:"No discrete values"}),sortAZ:In({id:"walnut.spreadsheet.filter.sort_az",defaultMessage:"Sort AZ"}),sortZA:In({id:"walnut.spreadsheet.filter.sort_za",defaultMessage:"Sort ZA"}),filterSort:In({id:"walnut.spreadsheet.filter.sort_title",defaultMessage:"Filter & sort"}),selectAll:In({id:"walnut.spreadsheet.filter.select_all",defaultMessage:"Select all"})};function za(e){return S.useMemo(()=>{const n=[0];for(let t=0;t<e.length;t++)n[t+1]=n[t]+e[t];return n},[e])}function Ya(e,n,t,r,s,c,a){return S.useMemo(()=>{var h,f,o,i,u;const g=[];for(const l of(h=e.tables)!=null?h:[]){if(!l.ref)continue;const{c1:d,r1:v,c2:p,r2:E}=vr(l.ref),m=Math.min(d,p),w=Math.max(d,p),N=Math.min(v,E);if(Math.max(0,Math.min(1,(f=l.headerRowCount)!=null?f:1))===0)continue;const I=N,y=Fe+s[I],T=t[I];for(let C=m;C<=w;C++){const V=Pe+r[C],H=n[C],B="".concat(e.name,":").concat(l.id,":").concat(C),X=!!((o=c[B])!=null&&o.size),te="".concat(e.name,":").concat((i=l.id)!=null?i:0),ue=a[te],we=!!(ue&&ue.colIdx===C),Y=we?ue==null?void 0:ue.dir:void 0;g.push({key:B,left:V,top:y,width:H,height:T,tableId:(u=l.id)!=null?u:0,colIdx:C,isFiltered:X,isSorted:we,sortDir:Y})}}return g},[e,n,t,r,s,c,a])}function Ba(e){return S.useMemo(()=>{const n=[0];for(let t=0;t<e.length;t++)n[t+1]=n[t]+e[t];return n},[e])}function Ga(e){"use forget";const n=Kr.c(27),{sheet:t,viewColWidths:r,rowHeights:s,zoom:c,styleInfos:a,activeFilters:g,setActiveFilters:h,activeSortByTable:f,setActiveSortByTable:o,openFilterMenu:i,setOpenFilterMenu:u,onClose:l}=e,d=is(),v=za(r),p=Ba(s),E=Ya(t,r,s,v,p,g,f);let m;if(n[0]!==g||n[1]!==d||n[2]!==l||n[3]!==(i==null?void 0:i.colIdx)||n[4]!==(i==null?void 0:i.tableId)||n[5]!==E||n[6]!==h||n[7]!==o||n[8]!==u||n[9]!==t||n[10]!==a||n[11]!==c){let N;n[13]!==g||n[14]!==d||n[15]!==l||n[16]!==(i==null?void 0:i.colIdx)||n[17]!==(i==null?void 0:i.tableId)||n[18]!==h||n[19]!==o||n[20]!==u||n[21]!==t||n[22]!==a||n[23]!==c?(N=A=>{const I=(i==null?void 0:i.tableId)===A.tableId&&(i==null?void 0:i.colIdx)===A.colIdx;return ve.jsx(qa,{btn:A,isOpen:I,onOpen:()=>u({tableId:A.tableId,colIdx:A.colIdx}),onClose:l,zoom:c,values:eo(t,a,A.colIdx,A.tableId),selectedValues:g["".concat(t.name,":").concat(A.tableId,":").concat(A.colIdx)],onToggleValue:y=>{const T=eo(t,a,A.colIdx,A.tableId);Ha(h,t.name,A.tableId,A.colIdx,T,y)},onSelectAll:()=>{const y="".concat(t.name,":").concat(A.tableId,":").concat(A.colIdx);h(T=>{const C=He({},T);return delete C[y],C})},onSort:y=>{const T="".concat(t.name,":").concat(A.tableId);o(C=>gn(He({},C),{[T]:{colIdx:A.colIdx,dir:y}}))},filterSortTitle:d.formatMessage(yn.filterSort),filterHeaderLabel:d.formatMessage(yn.filter),noDiscreteValuesLabel:d.formatMessage(yn.noDiscreteValues),selectAllLabel:d.formatMessage(yn.selectAll),sortAZLabel:d.formatMessage(yn.sortAZ),sortZALabel:d.formatMessage(yn.sortZA)},A.key)},n[13]=g,n[14]=d,n[15]=l,n[16]=i==null?void 0:i.colIdx,n[17]=i==null?void 0:i.tableId,n[18]=h,n[19]=o,n[20]=u,n[21]=t,n[22]=a,n[23]=c,n[24]=N):N=n[24],m=E.map(N),n[0]=g,n[1]=d,n[2]=l,n[3]=i==null?void 0:i.colIdx,n[4]=i==null?void 0:i.tableId,n[5]=E,n[6]=h,n[7]=o,n[8]=u,n[9]=t,n[10]=a,n[11]=c,n[12]=m}else m=n[12];let w;return n[25]!==m?(w=ve.jsx(ve.Fragment,{children:m}),n[25]=m,n[26]=w):w=n[26],w}function ka(e){let n="";for(e+=1;e;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-t)/26)}return n}function Wa(e){const n=e.match(/[A-Z]+/);if(!n)return 0;let t=0;for(const r of n[0])t=t*26+(r.charCodeAt(0)-64);return t-1}function Xa(e){const n=e.match(/\d+/);return n?parseInt(n[0],10)-1:0}function Ka(e,n){return"".concat(ka(e)).concat(n+1)}function Sa({cols:e,rows:n,selected:t,setSelected:r,enabled:s=!0}){S.useEffect(()=>{if(!s)return;function c(a){let g=Wa(t.address),h=Xa(t.address);const{key:f,shiftKey:o}=a,i=f==="ArrowLeft"||f==="ArrowRight"||f==="ArrowUp"||f==="ArrowDown",u=f==="Tab",l=f==="Enter";if(!i&&!u&&!l)return;let d=!1;switch(f){case"ArrowLeft":g>0&&(g-=1,d=!0);break;case"ArrowRight":g<e-1&&(g+=1,d=!0);break;case"ArrowUp":h>0&&(h-=1,d=!0);break;case"ArrowDown":h<n-1&&(h+=1,d=!0);break;case"Tab":(o?g>0:g<e-1)&&(g+=o?-1:1,d=!0);break;case"Enter":(o?h>0:h<n-1)&&(h+=o?-1:1,d=!0);break}if((i||u||l)&&a.preventDefault(),d){const v=Ka(g,h);r(h,v)}}return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[e,n,t.address,r,s])}const Za=Ts().domain(Array.from({length:12},(e,n)=>n.toString())).range(Ds);function u1({workbook:e,selectedSheetIdx:n,isEditing:t,setIsEditing:r}){const{focusedWalnutId:s,setSelectedSheetIdx:c}=Ms(),[a,g]=S.useState(n),[h,f]=S.useState({}),[o,i]=S.useState(!1),[u,l]=S.useState([]),d=S.useRef(new Set),[v,p]=S.useState({}),E=e.sheets[a],m=S.useMemo(()=>{const W=E.defaultRowHeight&&E.defaultRowHeight!==0?E.defaultRowHeight:Sr;return qn(W)},[E.defaultRowHeight]),w=Pa(e),N=ms(e.theme),[A,I]=S.useState(!1),[y,T]=S.useState({}),[C,V]=S.useState({}),[H,B]=S.useState({});S.useEffect(()=>{B({})},[e,a]),S.useEffect(()=>{B(W=>{if(!W||Object.keys(W).length===0)return W;let Q=!1;const se=He({},W);for(const Le of Object.keys(C)){const Me=Number(Le);!Number.isNaN(Me)&&se[Me]!=null&&(delete se[Me],Q=!0)}return Q?se:W})},[C]);const X=S.useRef(null),[te,ue]=S.useState(null),we=Ta(E.columns,y),{widths:Y,total:_}=Va(A,we,E.rows,y),[ne,ie]=S.useState({}),[G,oe]=S.useState(0),[q,k]=S.useState(""),j=S.useRef(null),he=S.useRef(null),le=S.useRef(null),fe=S.useRef(null),re=S.useRef(null),de=S.useRef(null),J=S.useRef(0),[ae,Ne]=S.useState(1),[ge,M]=S.useState("A1"),O=S.useRef(null),L=S.useRef(null),[U,F]=S.useState(null),[x,b]=S.useState(!1),me=()=>{const W=j.current,Q=fe.current;if(!W||!Q)return;const se=-W.scrollLeft,Le=-W.scrollTop;Q.style.transform="translate(".concat(se,"px, ").concat(Le,"px)")},[Ee,$e]=S.useState(null),[De,An]=S.useState({}),sn=Ma({setOpenFilterMenu:$e}),Te=ye(ge),Be=Oe(ge),Wn=S.useMemo(()=>He(He({},H),C),[H,C]),Vn=Fa(E,ne,w),{heights:be,total:Rn}=La(E,Wn,De,w,Vn),_e=S.useMemo(()=>{const W=new Map;for(const Q of E.rows)W.set(Q.index-1,Q);return W},[E]),pt=S.useMemo(()=>{const W=new Set;for(const Q of Object.keys(C)){const se=Number(Q);Number.isNaN(se)||W.add(se)}return W},[C]),wt=S.useCallback((W,Q)=>{if(pt.has(W))return!1;const se=Q!=null?Q:_e.get(W);return se?se.hidden?!1:!(!!se.customHeight||typeof se.height=="number"&&se.height!==0):!0},[pt,_e,E]),Et=S.useCallback((W,Q)=>{const se=Q!=null?Q:_e.get(W);return se!=null&&se.height&&se.height!==0?qn(se.height):m},[_e,m,E]),mt=S.useCallback((W,Q)=>{Number.isFinite(Q)&&B(se=>{var Me;if(C[W]!=null){if(se[W]==null)return se;const Je=He({},se);return delete Je[W],Je}const Le=Math.max(0,Math.ceil(Q));if(Le<=m){if(se[W]==null)return se;const Je=He({},se);return delete Je[W],Je}return Math.abs(((Me=se[W])!=null?Me:0)-Le)<=1?se:gn(He({},se),{[W]:Le})})},[C,m]),Wo=S.useMemo(()=>({isRowAuto:wt,requestUpdate:mt,getBaselineHeight:Et}),[Et,mt,wt]);function Xo(){if(i(!0),!q.startsWith("="))return;const W=Fs(q);l(W),p(Object.fromEntries(W.map((Q,se)=>[Q,Za(se.toString())])))}function Ko(){if(t)try{const W=Xn(G),Q=W==null?void 0:W.cells.find(se=>se.address===ge);if(Q){const se=q;if(/^\s*=/.test(se)){const Me=se.replace(/^\s*=\s*/,"");Q.formula=Me,typeof Q.sharedFormulaSi=="number"&&(Q.sharedFormulaSi=void 0),Q.value="",wa(e),k("= ".concat(Me))}else Q.formula="",typeof Q.sharedFormulaSi=="number"&&(Q.sharedFormulaSi=void 0),Q.value=se,k(se);fn()}}catch(W){}i(!1),l([]),p({})}S.useEffect(()=>{i(!1),l([])},[ge,E]),S.useEffect(()=>{const W=Q=>{Q.ctrlKey&&(Q.key==="`"||Q.code==="Backquote")&&(Q.preventDefault(),Q.stopPropagation(),I(se=>!se))};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[]);const{accentFill:So,accentStroke:pr}=Ns(),fn=Oa({canvasRef:he,containerRef:j,sheet:E,viewColWidths:Y,rowHeights:be,selRow:Be,selCol:Te,zoom:ae,accentColor:pr,styleInfos:w,refColors:v,formulaRefs:u,inputFocused:o,workbook:e,themeMap:N,showFormulas:A,rowIndexRemap:Vn,unsupportedCellsRef:d,rowAutoHeight:Wo}),Nt=S.useRef(U),At=S.useRef(Be),Rt=S.useRef(Te),It=S.useRef(E),yt=S.useRef(w);S.useEffect(()=>{Nt.current=U},[U]),S.useEffect(()=>{At.current=Be},[Be]),S.useEffect(()=>{Rt.current=Te},[Te]),S.useEffect(()=>{It.current=E},[E]),S.useEffect(()=>{yt.current=w},[w]);const Xn=Ca({rowIndexRemap:Vn,sheetRows:E.rows}),Mt=Da({overlayCanvasRef:le,containerRef:j,selectionStartRef:O,selectionEndRef:L,viewColWidths:Y,rowHeights:be,zoom:ae,accentFill:So,accentStroke:pr,sheet:E,resizeGuide:te,copyOutlineRectRef:re,copyDashOffsetRef:J}),Ge=S.useCallback(()=>{Mt()},[Mt]);ds(()=>{fn(),Ge(),me()}),S.useEffect(()=>{const W=O.current,Q=L.current;!!!(W&&Q&&(W.row!==Q.row||W.col!==Q.col))&&Be>=0&&Te>=0&&(O.current={row:Be,col:Te},L.current={row:Be,col:Te},F({r1:Be,c1:Te,r2:Be,c2:Te}),Ge())},[Be,Te,Ge]),S.useEffect(()=>{Ge()},[ae,Y,be,Ge]),S.useEffect(()=>{const W=xs({containerRef:j,selectionRectRef:Nt,sheetRef:It,styleInfosRef:yt,selRowRef:At,selColRef:Rt,selectionStartRef:O,selectionEndRef:L,copyOutlineRectRef:re,copyAnimReqRef:de,copyDashOffsetRef:J,redrawSelectionOverlay:Ge});return window.addEventListener("copy",W,!0),()=>window.removeEventListener("copy",W,!0)},[Ge]),S.useEffect(()=>{const W=Q=>{if(Q.key==="Escape")try{de.current!=null&&(cancelAnimationFrame(de.current),de.current=null),re.current=null,Ge()}catch(se){}};return window.addEventListener("keydown",W),()=>{window.removeEventListener("keydown",W)}},[Ge]),S.useEffect(()=>()=>{de.current!=null&&(cancelAnimationFrame(de.current),de.current=null)},[]),S.useEffect(()=>{const W=j.current;if(!W)return;const Q=()=>{fn(),Ge(),me()},se=()=>{fn(),Ge(),me()};return W.addEventListener("scroll",Q),window.addEventListener("resize",se),()=>{W.removeEventListener("scroll",Q),window.removeEventListener("resize",se)}},[fn,Ge]);function Zo(W){Ps(W,{containerRef:j,canvasRef:he,zoom:ae,viewColWidths:Y,rowHeights:be,selectionStartRef:O,selectionEndRef:L,setSelectionRect:Q=>F(Q),setIsDragging:Q=>b(Q),redrawSelectionOverlay:Ge,setResizeGuide:ue,resizingRef:X,setColSizeOverrides:T,setRowSizeOverrides:V,redraw:fn,setSelectedAddr:M,setSelectedRow:oe,sheet:E})}function Qo(W){W.ctrlKey&&Ne(Q=>Math.min(4,Math.max(.5,Q-W.deltaY*.001)))}Sa({cols:Y.length,rows:be.length,selected:{address:ge},setSelected:(W,Q)=>{oe(W),M(Q)},enabled:!o}),S.useEffect(()=>{var se;const W=Xn(G),Q=W==null?void 0:W.cells.find(Le=>Le.address===ge);if(Q)if(Q.formula&&Q.formula!=="")k("= ".concat(Q.formula));else if(Q.sharedFormulaSi&&((se=E.sharedFormulas)!=null&&se.length)){const Me=Ls(E).get(Q.sharedFormulaSi);k(Me?"= ".concat(ya(Me.base,Me.anchor,Q.address)):Tn(Q,w))}else k(Tn(Q,w));else k("");fn()},[G,ge,fn,E,w,Xn]);function Jo(W){var se,Le;const Q=j.current;if(Q){f(Je=>gn(He({},Je),{[a]:{left:Q.scrollLeft,top:Q.scrollTop}}));const Me=h[a];Q.scrollLeft=(se=Me==null?void 0:Me.left)!=null?se:0,Q.scrollTop=(Le=Me==null?void 0:Me.top)!=null?Le:0,me()}g(W),s&&c(s,W)}const bo=_+Pe,_o=Rn+Fe,jo=S.useMemo(()=>{if(x&&U){const{r1:W,c1:Q,r2:se,c2:Le}=U,Me=Math.abs(se-W)+1,Je=Math.abs(Le-Q)+1;if(Me>1||Je>1)return"".concat(Me,"R x ").concat(Je,"C")}return ge},[x,U,ge]);return ve.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[ve.jsx(Ea,{addressLabel:jo,inputFocused:o,selectedValue:q,refColors:v,onFxFocus:Xo,onFxBlur:Ko,onFxChange:W=>k(W),canEdit:t,zoom:ae,onZoomChange:W=>Ne(W)}),ve.jsxs("div",{ref:j,className:"relative flex-1 overflow-auto focus:outline-none focus-visible:outline-none",tabIndex:-1,onWheel:Qo,onMouseMove:W=>Os(W,j,X,ae,Y,be),children:[ve.jsxs("div",{className:"relative sticky start-0 top-0",children:[ve.jsx("canvas",{ref:he,className:"absolute inset-0 focus:outline-none focus-visible:outline-none",tabIndex:-1,onMouseDown:Zo}),ve.jsx("canvas",{ref:le,className:"pointer-events-none absolute inset-0 z-10 focus:outline-none focus-visible:outline-none",tabIndex:-1}),ve.jsx("div",{className:"absolute inset-0 z-20",ref:fe,onMouseDown:W=>{W.stopPropagation()},children:ve.jsx(Ga,{sheet:E,viewColWidths:Y,rowHeights:be,zoom:ae,styleInfos:w,activeFilters:De,setActiveFilters:An,activeSortByTable:ne,setActiveSortByTable:ie,openFilterMenu:Ee,setOpenFilterMenu:$e,onClose:sn})})]}),ve.jsx("div",{style:{width:bo*ae,height:_o*ae}})]}),ve.jsx(As,{workbook:e,activeSheetIdx:a,onSheetClick:Jo,accentStroke:pr,selectionRect:U,sheet:E,getRowByVisualIndex:Xn}),!1]})}export{u1 as SpreadsheetRenderer};
//# sourceMappingURL=ocrnu7ia6cscgitq.js.map
