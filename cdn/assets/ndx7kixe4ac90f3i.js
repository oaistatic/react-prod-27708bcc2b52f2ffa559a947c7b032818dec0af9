const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/hzwjbf9hohqarzkm.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/k65njl5wlgspihfr.js","assets/conversation-small-332fs9rk.css","assets/j41djqzgv0g1dtwh.js","assets/bmppzp3y84hr7irx.js","assets/e4epv5uv3mte9vwk.js","assets/ibhky4acm3xt6dtm.js","assets/kl7k9lkcmwoxg3bk.js","assets/nk8claqige01rjll.js","assets/m5btqmw2ud0umdwr.js","assets/ce3hgmw4iyyhicud.js","assets/mstl8wgfzorpgdoe.js","assets/f2sn8zvpzei2915e.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/ieglwgr2zyuektzv.js","assets/exqqo21frem4no6f.js","assets/l09h2qppleubii6l.js","assets/deakbbf27g8e7ba0.js","assets/j1qri9ykgswuwttk.js","assets/g3lybt7hj0s143gw.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/ba5jyp7qj5r8tn2y.js","assets/nkg72cggx811q5rc.js","assets/kkpvfco69f4rm4dl.js","assets/eoxo2x2yyluwv164.js","assets/f76gy0b8ieo4s693.js","assets/fjbpw3a0vshjd395.js","assets/kz9vfmj7e59u487z.js","assets/fdmssuqzpk9905my.js","assets/e509ngenyrgcehf5.js","assets/nwdwrv5b1h68xdm5.js","assets/kimw6epkq1t36pow.js","assets/ns51nblw8ziscsgd.js","assets/b2l059fz4znz94nm.js","assets/jz17uc4ytadugnwg.js","assets/gk1ydinzmvc3mi3f.js","assets/ktlrbeajo849nxci.js","assets/bkm8et9bp0kf1c7y.js","assets/hx3pmvu9yrya5xfj.js","assets/m2li92t79w0k884q.js","assets/f1xfp952knkxhcnw.js","assets/gfro8vshyz92jyup.js","assets/kgrrqncjl71482vi.js","assets/i5jw6wfkpao2rx5t.js","assets/krwszi9u3lj63i9v.js","assets/irqko7c1s7qpl41n.js","assets/j7vr3wxxnh5g6uxz.js","assets/bhm7utdivrybcfbl.js","assets/ohquqctluwabmb5i.js","assets/efooahjtdr85x1lo.js","assets/km71i01x6ma5r62b.js","assets/c2cj1dlcffke3f7m.js","assets/hb1mva1gmw4bcs8w.js","assets/mivow98b53y1taf8.js","assets/e7t9iekjqjn15qm6.js","assets/bj1ejin6tzi0v3v8.js","assets/g16t1ppnhpknyp01.js","assets/nps4pxexolp79wxq.js","assets/d3gl9smdb5iqto0t.js","assets/ibjz9c01f0uy7k53.js","assets/m89x2zftpo6hrypr.js","assets/tkv1g3prhmmeuid6.js","assets/mbql81gwv5du9dtu.js","assets/k43gn7pl526u53kc.js","assets/dg5jraediw4l39ow.js","assets/mce0eiesimdmeqmr.js","assets/ifrwee0bgh9e2but.js","assets/gqx9i5tb3deqoo5z.js","assets/dhani38x98p00bbg.js","assets/d89jwbh4dprxdpk0.js","assets/h5lbwoaovb563r4k.js","assets/nn3g3bm9s41ua8hv.js","assets/ctbtetl25rmz78uu.js"])))=>i.map(i=>d[i]);
var Je=Object.freeze,ss=Object.defineProperty,Ds=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var es=(t,e,n)=>e in t?ss(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,b=(t,e)=>{for(var n in e||(e={}))st.call(e,n)&&es(t,n,e[n]);if(De)for(var n of De(e))tt.call(e,n)&&es(t,n,e[n]);return t},S=(t,e)=>Ds(t,et(e));var ye=(t,e)=>Je(ss(t,"raw",{value:Je(e||t.slice())}));import{E as vs,r as w,j as s,_ as _e,i as Ce,M as h,F as nt,c as ue,f as he,e as te,a as ot,a0 as it,a9 as at,n as rt}from"./fg33krlcm0qyi6yw.js";import{kA as pe,gH as Be,dF as ce,dH as xe,gp as He,gq as Ve,_ as ze,dW as lt,gr as ct,go as dt,dB as js,b as ne,nR as ut,lq as J,jW as qe,lV as ys,ec as bs,eK as mt,xH as ws,qx as Ms,ot as Ps,d as Te,hH as ft,ur as Ts,hQ as Fe,eh as ge,dL as Qe,eN as pt,mO as gt,e2 as ht,e4 as xt,dR as vt,eT as jt,bh as ke,F as Ke,l as de,py as yt,xI as bt,sn as _s,G as fe,m as ve,w4 as wt,i0 as Mt,g2 as le,ss as Pt,i8 as Tt,H as _t,sr as ae,sq as Xe,xJ as Oe,u3 as Ct,st as kt,su as It,n as Cs,cU as Nt,gJ as Gt,gK as Ye,sM as ks,sP as St,sN as Is,lj as At,xK as Lt,lf as Ee,xL as Rt,le as Ns,sL as Ut,ut as Ge,uu as Se,v as Y,P as Gs,ld as zt,C as Ft,xM as Ss,xN as Ot,c2 as Et,xO as $t,I as Ie,b9 as Me,hP as As,hW as Wt,i5 as Ls,vY as Bt,xP as Ht,r_ as Vt,xQ as qt,i9 as Rs,$ as Qt,xR as ts,T as Us,bv as Kt,bg as zs,a9 as Xt,p as Yt,c0 as Fs,bX as Zt,ga as Os,hp as Jt,lp as Pe,dI as Dt,o as Es,ql as $s,fD as en,xS as sn,aK as ns,ue as tn,xT as nn,W as on,ag as an,h$ as rn,aJ as ln,uq as os,hG as cn,xU as dn,xV as un,fe as mn,xW as fn,dZ as pn,Z as is,S as as,lw as gn,gE as rs,xX as ls,xY as hn,rv as xn,ed as cs,qw as vn}from"./mtk1qztvnb31pw5r.js";import{a as Ws,da as Bs,aw as Hs,e4 as jn,c$ as yn,cL as bn,ku as re,kn as wn,az as Mn,dx as Pn,eN as Tn,uv as _n,kZ as Cn,ao as kn,uw as ds,jz as us,ic as Vs,id as In,fn as ms,ig as Nn,T as Gn,gQ as Sn,by as An,pU as Ln,pV as Rn,nF as Un,cw as zn,jb as Fn,bG as On,hl as En,fO as $n,fM as Wn,a9 as Bn,bM as Hn,r as Vn,bn as qn,bs as Qn,bt as Kn}from"./k65njl5wlgspihfr.js";import{b as fs,s as Xn,c as Yn,g as Zn,A as be,d as Jn,M as Dn}from"./hzwjbf9hohqarzkm.js";import{f as qs}from"./m89x2zftpo6hrypr.js";import{T as Qs}from"./tkv1g3prhmmeuid6.js";import{i as $e}from"./dhani38x98p00bbg.js";import{G as eo}from"./j41djqzgv0g1dtwh.js";import{C as so}from"./d89jwbh4dprxdpk0.js";import{E as to}from"./h5lbwoaovb563r4k.js";import{h as no}from"./mbql81gwv5du9dtu.js";import{u as Ks}from"./k43gn7pl526u53kc.js";import{a as oo,G as io}from"./nn3g3bm9s41ua8hv.js";import{F as ee,a as D,b as Ae,c as ao,G as ro}from"./ibjz9c01f0uy7k53.js";import{u as lo}from"./ctbtetl25rmz78uu.js";function co(t,e){const n=xe(t),o=ce.getTree(n),i=[];let a=ce.getCurrentNode(n);for(;a!=null&&(e==null||a.id!==e);)i.unshift(a.message),a=a.parentId!==""?o.getNodeByIdOrMessageId(a.parentId):void 0;return i}function uo(t){return t.filter(o=>o.recipient==="gizmo_editor.update_behavior").flatMap(o=>o.content.content_type==="text"?o.content.parts:o.content.content_type==="code"?[o.content.text]:[]).map(o=>JSON.parse(o)).reduce((o,i)=>b(b({},o),i),{})}async function mo(t){let e;for(const n of t)if(n.author.name==="gizmo_editor.generate_profile_pic"){const o=ct.getImageAssetPointers(n);o.length>0&&(e=o.at(-1))}if(e!=null){const n=dt(e.asset_pointer),o=await He(n);if(o.status===Ve.Success)return{id:n,permalink:o.download_url}}}async function fo(t,e,n,o){const i=co(e,o),a=uo(i);let r=await mo(i);if($e(a)&&r==null)return;const{name:u,context:l,description:d,profile_pic_file_id:P,prompt_starters:c}=a;if(P!=null)try{const m=await He(P,t.id);m.status===Ve.Success&&(r={id:P,permalink:m.download_url})}catch(m){ze.addError(new Error("Error while retrieving profile pic in update",{cause:m})),n.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const I={name:typeof u=="string"?u:void 0,description:typeof d=="string"?d:void 0,instructions:typeof l=="string"?l:void 0,promptStarters:Array.isArray(c)?c:void 0,profilePictureId:r==null?void 0:r.id,profilePictureUrl:r==null?void 0:r.permalink};return lt(I,m=>m!=null)}function po(t){var l,d,P;const e=new Set;for(const c of t.tools)e.add(c.type);const n=(l=t.name)!=null?l:"",o=(d=t.description)!=null?d:"",i=(P=t.instructions)!=null?P:"",a=Array.from(e).join(","),r=n===""&&o===""&&i==="",u=t.profilePictureUrl!=null;return r?"The GPT you are about to has the following abilities: ".concat(a,"."):"This is the GPT's current set of fields:\n\nname: ".concat(n,"\n\ndescription: ").concat(o,"\n\ncontext: ").concat(i,"\n\nabilities: ").concat(a,"\n\n").concat(u?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior.","\n")}const go=10;function ho(t,e){var P,c,I,m,f,p,g,k,T,C,v;const n=t.current,o=e.current;if(Be(n,o))return;const i={};n.name!==(o==null?void 0:o.name)&&(i.name=n.name),((P=n.description)!=null?P:"")!==((c=o==null?void 0:o.description)!=null?c:"")&&(i.description=(I=n.description)!=null?I:""),n.instructions!==((m=o==null?void 0:o.instructions)!=null?m:"")&&(i.context=(f=n.instructions)!=null?f:"");const a=new Set((g=(p=o==null?void 0:o.files)==null?void 0:p.map(j=>j.file_id))!=null?g:[]),r=new Set((T=(k=n.files)==null?void 0:k.map(j=>j.file_id))!=null?T:[]),u=((C=n.files)!=null?C:[]).filter(j=>!a.has(j.file_id)),l=((v=o==null?void 0:o.files)!=null?v:[]).filter(j=>!r.has(j.file_id));if($e(i)&&u.length===0&&l.length===0)return;const d=[];if(!$e(i)){const j="Explicitly update the GPT's behavior to the following exact fields:\n\n    ".concat(JSON.stringify(i,null,2),'\n\n    "Do not call update_behavior yet. Instead, use these updated fields as the GPT\'s current behavior, and in the next call to update_behavior, incorporate these changes."\n    ');d.push(pe(j))}if(l.length>0&&d.push(pe("The user has removed the following files from the GPT. You can no longer reference these files: ".concat(l.map(j=>j.file_id).join(", ")))),u.length>0){const j=u.slice(0,go);d.push(pe("The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ".concat(j.map(L=>L.file_id).join(", ")),{attachments:j.map(L=>({id:L.file_id,name:L.name,size:L.size}))}))}return d}function xo(t){if(t.length===0)return;const e="The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ".concat(t.map(n=>'"'.concat(n.fileId,'"')).join(", "));return[pe(e)]}function vo(t){const e="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.";if(!ce.findNode(xe(t),o=>o.message.content.content_type==="text"&&o.message.content.parts[0]===e))return[pe(e)]}function jo(t,e){w.useEffect(()=>{ce.findNode(xe(t),o=>gt(o.message)||o.message.author.role===ht.System&&o.message.content.content_type===xt.Text)||Qe(t,o=>{vt.updateTree(o,(i,a)=>{const r=i.findNode(u=>{var l;return((l=u.message.clientMetadata)==null?void 0:l.isPlaceholderTemplateAssistantWelcomeMessage)===!0},a);return r&&(r.id===a&&(a=i.rootId),i.deleteNode(r.id)),e?i.addMessageNode(a,jt(e,void 0,{isPlaceholderTemplateAssistantWelcomeMessage:!0})):a})})},[t,e])}function yo(t,e,n){var l;const o=ne(),i=js(o,t),a=Te(()=>ft(i)),r=(l=a.models.get(Ts))!=null?l:a&&qs(a.models.values(),d=>d.tags.includes(Fe.GPT_4o));Ws(t,{kind:ge.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:n},{forcedModelId:r==null?void 0:r.id}),w.useEffect(()=>{Qe(t,d=>{d.mode={kind:ge.GizmoMagicCreate,gizmo_id:e.id,behavior_overrides:pt(n)}})},[o,t,e.id,n,r,a]);const[u]=w.useState(()=>{const d=e.id==null,P=e.id!=null&&e.name!==""&&e.description!=null&&e.instructions!==""&&e.profilePictureUrl!=null;return d?'Hi! I\'ll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."\n\nWhat would you like to make?':P?"Welcome back! Is there anything ".concat(e.name," should be doing better? Anything you'd like to change?"):"You're back! Let's continue where we left off..."});jo(t,u)}function bo({gizmoEditorData:t,updateGizmo:e,clientThreadId:n,gizmoEditorDataRef:o,magicMakerBehaviorOverrides:i,magicMakerConversationGizmoEditorDataRef:a,requireGizmoId:r}){const u=ne(),l=js(u,n),d=w.useRef(r);d.current=r;const P=w.useMemo(()=>({gizmoEditorData:t,gizmoId:t.id,mode:"magic",behaviorOverrides:i,getGizmoId:d.current}),[t,i]),c=ut(m=>m.files.filter(f=>f.status===J.Ready&&f.gizmoId!=null)),I=w.useCallback(m=>{var f,p,g,k,T;if(e(C=>{var v;return S(b({},C),{files:[...(v=C.files)!=null?v:[],...qe(c.map(j=>{var L;return j.fileId!=null&&{file_id:j.fileId,name:j.file.name,size:j.file.size,type:ys(j.file),last_modified:j.file.lastModified,file_size_tokens:(L=j.fileSpec)==null?void 0:L.fileTokenSize}}))]})}),a.current=bs(o.current),!m.completionType||m.completionType===mt.Next){const C=ce.getCurrentNode(xe(n)),v=(f=C.message.clientMetadata)!=null&&f.isPlaceholderTemplateAssistantWelcomeMessage?C.message:void 0;v&&(m.existingMessages=[v]),m.prependMessages=[...(p=xo(c))!=null?p:[],...(g=ho(o,a))!=null?g:[],...(k=vo(n))!=null?k:[],...(T=m.prependMessages)!=null?T:[]]}return m},[n,c,o,a,e]);return s.jsx(ws.Provider,{value:P,children:s.jsx("div",{className:"relative flex h-full grow overflow-auto",children:s.jsx("div",{className:"grow",children:s.jsx(Ms,{conversation:l,children:s.jsx(Ps,{conversation:l,children:s.jsx(Qs,{conversation:l,withCustomCompletionParams:I})})})})})})}const wo=vs.memo(bo),Mo=ke(()=>_e(()=>import("./hzwjbf9hohqarzkm.js").then(t=>t.e),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(t=>t.ShareGizmoModal)),Po=ke(()=>_e(()=>import("./ibhky4acm3xt6dtm.js"),__vite__mapDeps([9,1,2,3,4,5,0,6,7,8])).then(t=>t.SimpleShareGizmoModal));function We(t){return!!(t&&typeof t=="object"&&"gizmo"in t)}function Xs(t){window.history.length>1?t(-1):t(bt())}function To(t){"use forget";var F;const e=ue.c(38),{gizmo:n,publishedGizmo:o,isUpsertLoading:i,isPromoteLoading:a,isUploadingProfilePic:r,updateGizmo:u,promoteGizmo:l,appealGizmo:d,setAppealState:P,showActionsModal:c}=t,I=ne(),m=_t();let f;if(e[0]!==n||e[1]!==a||e[2]!==r||e[3]!==i){if(f=[],(n==null||a||i)&&f.push(ae.Loading),n!=null){let G;e[5]!==n?(G=Xe(n),e[5]=n,e[6]=G):G=e[6],f.push(...G)}r&&f.push(ae.UploadingProfilePic),e[0]=n,e[1]=a,e[2]=r,e[3]=i,e[4]=f}else f=e[4];const p=f;let g;e[7]!==n?(g=_s(n),e[7]=n,e[8]=g):g=e[8];const k=g;let T;e[9]!==m||e[10]!==d||e[11]!==I||e[12]!==n||e[13]!==l||e[14]!==o||e[15]!==P||e[16]!==c||e[17]!==u?(T=G=>{requestAnimationFrame(()=>Nt(I,m!=null&&m.isWorkspaceAccount()?Mo:Po,{gizmo:n,publishedGizmo:o,promoteGizmo:l,appealGizmo:d,setAppealState:P,showActionsModal:c,updateGizmo:u,shareOnly:G==="share"}))},e[9]=m,e[10]=d,e[11]=I,e[12]=n,e[13]=l,e[14]=o,e[15]=P,e[16]=c,e[17]=u,e[18]=T):T=e[18];const C=T,[v,j]=w.useState(!1),L=n.sharingRecipient?fs[n.sharingRecipient]:fs.private,E=a||i;let M;e[19]!==L||e[20]!==p||e[21]!==n.id||e[22]!==n.sharing||e[23]!==C||e[24]!==E||e[25]!==k||e[26]!==a||e[27]!==i||e[28]!==l||e[29]!==o?(M=k?s.jsx(re,{color:"primary",onClick:()=>C("promote"),loading:p.length>0&&p.every(_o),disabled:E||n.id===void 0||p.length>0,tooltip:p.length>0?p.map(Oe).join("\n"):void 0,"data-testid":"gizmo-editor-create-gpt-button",children:s.jsx(h,{id:"svUGIb",defaultMessage:"Create"})}):s.jsxs(s.Fragment,{children:[s.jsx(re,{color:"secondary",loading:a||!o,disabled:E,icon:L,onClick:()=>C("share"),children:s.jsx(h,{id:"aXKW4G",defaultMessage:"Share"})}),s.jsx(re,{color:"primary",onClick:async()=>{var U;let G=n.sharing.subjects.map(Xn);const B=Ct(n.sharing.subjects);G=kt(n.sharing.recipient,G,(U=B==null?void 0:B.capabilities)!=null?U:It);const O=o&&We(o)?o.gizmo.display.categories[0]:void 0;await l({recipient:n.sharing.recipient,subjects:G},O)&&j(!0)},loading:i||!o,disabled:E||p.length>0,tooltip:p.length>0?p.map(Oe).join("\n"):void 0,children:s.jsx(h,{id:"84QVoj",defaultMessage:"Update"})})]}),e[19]=L,e[20]=p,e[21]=n.id,e[22]=n.sharing,e[23]=C,e[24]=E,e[25]=k,e[26]=a,e[27]=i,e[28]=l,e[29]=o,e[30]=M):M=e[30];let N;e[31]!==(m==null?void 0:m.data)||e[32]!==v||e[33]!==o?(N=v&&o&&s.jsx(Yn,{publishedGizmo:o,sharing:We(o)?o.gizmo.sharing:void 0,onClose:()=>j(!1),workspaceName:(F=m==null?void 0:m.data.name)!=null?F:""}),e[31]=m==null?void 0:m.data,e[32]=v,e[33]=o,e[34]=N):N=e[34];let A;return e[35]!==M||e[36]!==N?(A=s.jsxs(s.Fragment,{children:[M,N]}),e[35]=M,e[36]=N,e[37]=A):A=e[37],A}function _o(t){return[ae.Loading,ae.UploadingProfilePic].includes(t)}function Co(t){"use forget";var L;const e=ue.c(26),{gizmoEditorData:n,publishedGizmo:o,revertDraft:i}=t,a=ne(),r=te(),u=ve(),l=Ce(),[d,P]=w.useState(!1),{canDelete:c}=wt(o),{canCreate:I}=Mt();if(!!!(o||i||n!=null&&n.id&&n.liveVersion>0||c))return null;let f;e[0]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsx(re,{color:"ghost",icon:Gt}),e[0]=f):f=e[0];let p;e[1]!==a||e[2]!==o||e[3]!==u?(p=o!=null&&s.jsxs(le.Item,{onClick:E=>{Pt(a,o,u,E)},children:[s.jsx(Hs,{className:"icon-sm"}),s.jsx(h,b({},se.copyLink))]}),e[1]=a,e[2]=o,e[3]=u,e[4]=p):p=e[4];let g;e[5]!==r||e[6]!==i?(g=i!=null&&s.jsxs(le.Item,{onClick:()=>{window.confirm(r.formatMessage(se.revertConfirm))&&i()},children:[s.jsx(Pn,{className:"icon-sm"}),s.jsx(h,{id:"W2blnV",defaultMessage:"Revert..."})]}),e[5]=r,e[6]=i,e[7]=g):g=e[7];let k;e[8]!==I||e[9]!==n||e[10]!==l?(k=(n==null?void 0:n.id)!=null&&n.liveVersion>0&&s.jsxs(s.Fragment,{children:[s.jsxs(le.Item,{onClick:()=>{l("/g/".concat(n.id,"/view"))},children:[s.jsx(jn,{className:"icon-sm"}),s.jsx(h,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),I&&s.jsxs(le.Item,{onClick:async()=>{const E=await Tt.copyGizmo({gizmoId:n.id});E.gizmo.id&&l("/gpts/editor/".concat(E.gizmo.id))},children:[s.jsx(yn,{className:"icon-sm"}),s.jsx(h,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),e[8]=I,e[9]=n,e[10]=l,e[11]=k):k=e[11];let T;e[12]!==o?(T=o&&We(o)&&((L=o.gizmo.current_user_permission)==null?void 0:L.can_delete)&&s.jsxs(le.Item,{color:"danger",onClick:()=>{P(!0)},children:[s.jsx(bn,{className:"icon-sm"}),s.jsx(h,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),e[12]=o,e[13]=T):T=e[13];let C;e[14]!==p||e[15]!==g||e[16]!==k||e[17]!==T?(C=s.jsxs(Ye,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:f,children:[p,g,k,T]}),e[14]=p,e[15]=g,e[16]=k,e[17]=T,e[18]=C):C=e[18];let v;e[19]!==(n==null?void 0:n.id)||e[20]!==l||e[21]!==d?(v=d&&s.jsx(eo,{gizmoId:(n==null?void 0:n.id)||"",onSuccess:()=>Xs(l),onClose:()=>{P(!1)}}),e[19]=n==null?void 0:n.id,e[20]=l,e[21]=d,e[22]=v):v=e[22];let j;return e[23]!==C||e[24]!==v?(j=s.jsxs(s.Fragment,{children:[C,v]}),e[23]=C,e[24]=v,e[25]=j):j=e[25],j}var gs;const we=Ke.div(gs||(gs=ye(["flex items-center gap-1"])));function ko(t){"use forget";const e=ue.c(7),{gizmoEditorData:n}=t,o=Cs(Io);switch(n.sharingRecipient){case fe.Private:{let i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(we,{children:[s.jsx(Mn,{className:"icon-xs"}),s.jsx(h,b({},se.onlyMe))]}),e[0]=i):i=e[0],i}case fe.Link:{let i;return e[1]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(we,{children:[s.jsx(Hs,{className:"icon-xs"}),s.jsx(h,b({},se.anyoneWithLink))]}),e[1]=i):i=e[1],i}case fe.Workspace:{let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(Tn,{className:"icon-xs"}),e[2]=i):i=e[2];let a;return e[3]!==o?(a=s.jsxs(we,{children:[i,o]}),e[3]=o,e[4]=a):a=e[4],a}case fe.Marketplace:{let i;return e[5]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsxs(we,{children:[s.jsx(wn,{className:"icon-xs"}),s.jsx(h,b({},se.public))]}),e[5]=i):i=e[5],i}default:{let i;return e[6]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx("div",{}),e[6]=i):i=e[6],i}}}function Io(t){var e;return(e=t.currentWorkspace)==null?void 0:e.name}function No(t){"use forget";const e=ue.c(14),{gizmoEditorData:n}=t;let o;e[0]!==n.profilePictureUrl?(o=n.profilePictureUrl!=null?s.jsx(Bs,{isFirstParty:!1,src:n.profilePictureUrl,className:"h-8 w-8"}):s.jsx("div",{className:"border-token-border-medium h-8 w-8 rounded-full border-2 border-dashed"}),e[0]=n.profilePictureUrl,e[1]=o):o=e[1];let i;e[2]!==n.name?(i=n.name||s.jsx(h,b({},se.newGPT)),e[2]=n.name,e[3]=i):i=e[3];let a;e[4]!==i?(a=s.jsx("div",{className:"text-sm font-semibold",children:i}),e[4]=i,e[5]=a):a=e[5];let r;e[6]!==n?(r=s.jsx("div",{className:"text-token-text-secondary text-xs",children:_s(n)?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-token-text-tertiary h-1.5 w-1.5 rounded-full"}),s.jsx(h,b({},se.draft))]}):s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:"bg-brand-green h-1.5 w-1.5 rounded-full"}),n.sharingRecipient===fe.Marketplace?s.jsx(h,b({},se.published)):s.jsx(h,{id:"gizmoEditorHeader.live",defaultMessage:"Live"}),s.jsx(h,S(b({},se.dotSeparator),{tagName:"span"})),s.jsx(ko,{gizmoEditorData:n})]})}),e[6]=n,e[7]=r):r=e[7];let u;e[8]!==a||e[9]!==r?(u=s.jsxs("div",{children:[a,r]}),e[8]=a,e[9]=r,e[10]=u):u=e[10];let l;return e[11]!==o||e[12]!==u?(l=s.jsxs("div",{className:"flex items-center gap-2",children:[o,u]}),e[11]=o,e[12]=u,e[13]=l):l=e[13],l}var hs;const Go=Ke.div(hs||(hs=ye(["\n  cursor-pointer\n  border-b\n  pb-[1px]\n  pt-[2px]\n  text-sm\n  text-token-text-secondary\n  hover:border-token-border-xheavy\n  hover:text-token-text-primary\n  mx-2\n"])));function So({gizmoEditorData:t,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,publishedGizmo:i,updateGizmo:a,promoteGizmo:r,appealGizmo:u,setAppealState:l,revertDraft:d,draftMessage:P,className:c,hasUnpublishedChanges:I,showActionsModal:m}){var p,g;const f=Ce();return s.jsxs("div",{className:de("border-token-border-medium relative flex h-14 w-full items-center justify-between gap-2 border-b px-3",c),children:[s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx("a",{className:"text-token-text-primary cursor-pointer",onClick:()=>Xs(f),children:s.jsx(yt,{className:"icon"})}),s.jsx(No,{gizmoEditorData:t})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[i&&((g=(p=i==null?void 0:i.gizmo)==null?void 0:p.live_version)!=null?g:0)>1&&s.jsx(Go,{onClick:()=>f("/g/".concat(t.id,"/view")),children:s.jsx(h,{id:"P0Ri/k",defaultMessage:"Last edited {date}",values:{date:s.jsx(nt,{value:i.gizmo.updated_at,day:"numeric",month:"short",year:new Date(i.gizmo.updated_at).getFullYear()===new Date().getFullYear()?void 0:"numeric"})}})}),P,s.jsx(Co,{gizmoEditorData:t,publishedGizmo:i,revertDraft:d}),s.jsx(To,{gizmo:t,publishedGizmo:i,isUpsertLoading:e,isPromoteLoading:n,isUploadingProfilePic:o,updateGizmo:a,promoteGizmo:r,appealGizmo:u,setAppealState:l,hasUnpublishedChanges:I,showActionsModal:m})]})]})}const se=he({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"},dotSeparator:{id:"gizmo.dotSeparator",defaultMessage:"Â·"}}),Ao=512;function Lo({gizmoEditorData:t,onFileChange:e}){const n=te(),o=ve(),[i,a]=w.useState(void 0),r=w.useRef(e);w.useEffect(()=>{r.current=e});async function u(P){if(P.length>0){const c=await Lt(P[0],Ao),I=Ee(c);a({tempId:I,file:c,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),r.current("uploading"),Rt(I,c,n,o,Ns.ProfilePicture,{onFileCreated(m,f,p){a(g=>g!=="initial"&&(g==null?void 0:g.tempId)===m&&g.status===J.Uploading?S(b({},g),{progress:10,fileId:f,cdnUrl:p}):g)},onFileUploadProgress(m,f){a(p=>p!=="initial"&&(p==null?void 0:p.tempId)===m&&p.status===J.Uploading?S(b({},p),{progress:f}):p)},onFileUploaded(m,f,p){a(g=>g!=="initial"&&(g==null?void 0:g.tempId)===m?(r.current(g),S(b({},g),{status:J.Ready,progress:100,fileSpec:b({name:g.file.name,id:g.fileId,size:g.file.size},p!=null?p:{})})):g)},onError(m){a(f=>{if(f!=="initial"&&(f==null?void 0:f.tempId)===m){r.current(void 0);return}return f})}})}}const{open:l,getInputProps:d}=Ks(b({disabled:!1,noClick:!0,onDropAccepted:u,onDropRejected:P=>no(P,n,o,At.ProfilePicture),multiple:!0,maxSize:Is},ks(St)));return s.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[s.jsx(Ye,{sideOffset:8,triggerButton:s.jsx("button",{className:"h-20 w-20",children:i!=null&&i!="initial"&&i.status!=J.Ready?s.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[s.jsx(_n,{file:i.file}),i.status===J.Uploading&&i.progress<90?s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:s.jsx(Cn,{percentage:i.progress,className:"h-6 w-6"})}):null]}):(t==null?void 0:t.profilePictureUrl)!=null&&(t==null?void 0:t.profilePictureUrl)!==""?s.jsx(Bs,{isFirstParty:!1,src:t.profilePictureUrl}):s.jsx("div",{className:"border-token-border-medium flex h-full w-full items-center justify-center rounded-full border-2 border-dashed",children:s.jsx(kn,{className:"text-4xl"})})}),children:s.jsx(le.Item,{onClick:l,children:s.jsx(h,{id:"ERQwXg",defaultMessage:"Upload Photo"})})}),s.jsx("input",b({},d()))]})}function Ro({gizmoEditorData:t,requireGizmoId:e,currentModelConfig:n,updateGizmo:o}){var E;const i=te(),a=ve(),[r,u]=w.useState(0),l=w.useRef(new Map),d=Ut(n,void 0),P=(t==null||t.firstPartyProjectType,void 0),c=async M=>{Gs.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const N=await e();M.length>0&&await Promise.all(M.map(A=>{const F=Ee(A);l.current.set(F,{tempId:F,gizmoId:N,file:A,status:J.Uploading,progress:1,fileId:null,cdnUrl:null}),zt(Ee(A),A,i,a,{kind:Ns.Gizmo,gizmoId:N},{onFileUploaded:(G,B,O,$)=>{const U=l.current.get(G);U==null||U.fileId==null||(o(_=>{var q,V;return S(b({},_),{files:[...(q=_.files)!=null?q:[],{file_id:U.fileId,name:U.file.name,size:U.file.size,type:(V=$==null?void 0:$.mimeType)!=null?V:ys(A),last_modified:U.file.lastModified,file_size_tokens:$==null?void 0:$.fileTokenSize}]})}),l.current.delete(G),u(_=>_+1))},onFileCreated:(G,B,O)=>{l.current.set(G,S(b({tempId:G,gizmoId:N,file:A,status:J.Uploading,progress:1},l.current.get(G)),{fileId:B,cdnUrl:O})),u($=>$+1)},onFileUploadProgress:(G,B)=>{const O=l.current.get(G);(O==null?void 0:O.status)===J.Uploading&&l.current.set(G,S(b({},O),{progress:B})),u($=>$+1)},onError:G=>{l.current.delete(G)}},{usesRetrievalIndex:n!=null&&Ge(n,A.type,A.name)===Se.Retrieval,contextScopes:P})}))},{getInputProps:I,open:m}=Ks(b({disabled:!1,noClick:!0,onDropAccepted:c,multiple:!0,maxSize:Is,maxFiles:10},ks(d))),f=(E=t==null?void 0:t.files)!=null?E:[];function p(M){return s.jsx(us,{onRemoveFileClick:()=>{l.current.delete(M.tempId),u(N=>N+1)},file:M.file,loadingPercentage:M.status===J.Uploading?M.progress:void 0},M.tempId)}function g(M){return s.jsx(us,{file:M.name,fileId:M.file_id,onRemoveFileClick:()=>o(N=>{var A;return S(b({},N),{files:(A=N==null?void 0:N.files)==null?void 0:A.filter(F=>F.file_id!==M.file_id)})}),gizmoId:t==null?void 0:t.id},M.file_id)}const k=Array.from(l.current.values()).filter(M=>f.every(N=>N.file_id!==M.fileId)),[T,C]=ds(k,M=>n!=null&&Ge(n,M.file.type,M.file.name)===Se.CodeInterpreter),[v,j]=ds(f,M=>n!=null&&M.type!=null&&Ge(n,M.type,M.name)===Se.CodeInterpreter),L=w.useRef(v.length);return w.useEffect(()=>{v.length>L.current&&o(M=>{var N,A;return(N=M.tools)!=null&&N.some(F=>F.type===Y.PYTHON)?M:S(b({},M),{tools:[...(A=M.tools)!=null?A:[],{type:Y.PYTHON}]})}),L.current=v.length},[v.length]),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("div",{className:"text-token-text-tertiary rounded-lg text-xs",children:s.jsx(h,b({},Uo.knowledgeWarning))}),C.length>0||j.length>0?s.jsxs("div",{className:"flex flex-wrap gap-2",children:[C.map(p),j.map(g)]}):null,T.length>0||v.length>0?s.jsxs("div",{children:[s.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs",children:s.jsx(h,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(p),v.map(g)]})]}):null,s.jsx("div",{children:s.jsxs(re,{onClick:m,children:[s.jsx("input",b({},I())),s.jsx(h,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const Uo=he({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"Conversations with your GPT can potentially reveal part or all of the files uploaded."}});function zo({placeholder:t,text:e,onChange:n,onClose:o}){return s.jsxs(Ft,{testId:"modal-gizmo-editor-form",className:"max-h-[100vh]! max-w-[80vw]!",type:"success",isOpen:!0,onClose:o,primaryButton:s.jsx(re,{onClick:o,children:s.jsx(h,{id:"FeFVdS",defaultMessage:"Close"})}),children:[s.jsx("textarea",{className:"bg-token-main-surface-primary h-[70vh] w-full resize-none rounded-lg dark:border-gray-700",value:e,onChange:i=>{n(i.target.value)},placeholder:t}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(h,b({},Ss.instructionsWarning))})]})}var xs;const Le=Ke.div(xs||(xs=ye(["text-sm text-red-500"])));function Fo({children:t,collapsed:e,initial:n}){return s.jsx(Kt,{initial:n,children:!e&&s.jsx(zs.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:t})})}function Oo(t){"use forget";const e=ue.c(45),{connectors:n,selectedIds:o,onChange:i,isLoading:a}=t,r=te(),[u,l]=w.useState(!1),[d,P]=w.useState("");let c;e[0]!==n?(c=new Map(n.map($o)),e[0]=n,e[1]=c):c=e[1];const I=c;let m,f,p,g,k,T;if(e[2]!==I||e[3]!==n||e[4]!==r||e[5]!==a||e[6]!==u||e[7]!==i||e[8]!==d||e[9]!==o){let j;e[16]!==I?(j=_=>I.get(_),e[16]=I,e[17]=j):j=e[17];const L=o.map(j).filter(Boolean);let E;e[18]!==o?(E=_=>!o.includes(_.id),e[18]=o,e[19]=E):E=e[19];const M=n.filter(E);let N;e[20]!==d?(N=_=>{var q;return((q=_.name)!=null?q:_.id).toLowerCase().includes(d.toLowerCase())},e[20]=d,e[21]=N):N=e[21];const A=M.filter(N);g="mt-3 space-y-2",e[22]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx(D,{label:s.jsx(h,{id:"dh6PUt",defaultMessage:"Apps"}),description:s.jsx(h,{id:"O3GhKh",defaultMessage:"Choose which apps this GPT can use. If none selected, all accessible connectors are allowed."})}),e[22]=k):k=e[22];const F=L.length===0&&s.jsx("span",{className:"text-token-text-tertiary text-sm",children:s.jsx(h,{id:"4Vd2u9",defaultMessage:"All accessible apps allowed"})});let G;e[23]!==r||e[24]!==i||e[25]!==o?(G=_=>{var q,V;return s.jsxs("span",{className:"border-token-border-light bg-token-main-surface-secondary flex items-center gap-2 rounded-full border px-3 py-1 text-sm",children:[s.jsx(ms,{connector:_,size:"xsmall"}),s.jsx("span",{className:"max-w-[180px] truncate",title:(q=_.name)!=null?q:_.id,children:(V=_.name)!=null?V:_.id}),s.jsx("button",{type:"button",className:"text-token-text-tertiary hover:text-token-text-primary",onClick:()=>i(o.filter(oe=>oe!=_.id)),"aria-label":r.formatMessage({id:"klPRjn",defaultMessage:"Remove connector"}),children:s.jsx(Rs,{className:"icon-xs"})})]},_.id)},e[23]=r,e[24]=i,e[25]=o,e[26]=G):G=e[26];const B=L.map(G);e[27]!==F||e[28]!==B?(T=s.jsxs("div",{className:"flex flex-wrap gap-2",children:[F,B]}),e[27]=F,e[28]=B,e[29]=T):T=e[29],m="relative";let O;e[30]===Symbol.for("react.memo_cache_sentinel")?(O=()=>l(Eo),e[30]=O):O=e[30];const $=a||n.length===0;let U;e[31]!==r?(U=r.formatMessage({id:"t4IlVp",defaultMessage:"+ Add"}),e[31]=r,e[32]=U):U=e[32],e[33]!==$||e[34]!==U?(f=s.jsx(Xt,{size:"medium",color:"secondary",onClick:O,disabled:$,children:U}),e[33]=$,e[34]=U,e[35]=f):f=e[35],p=u&&s.jsxs("div",{className:"border-token-border-subtle bg-token-bg-primary absolute bottom-12 z-20 mt-2 w-full max-w-xl rounded-lg border p-3 shadow-lg",children:[s.jsx("input",{className:"border-token-border-light mb-2 w-full rounded-md border bg-transparent p-2 text-sm",placeholder:r.formatMessage({id:"b6Wywn",defaultMessage:"Search apps"}),value:d,onChange:_=>P(_.target.value),autoFocus:!0}),a?s.jsx("div",{className:"text-token-text-tertiary text-sm",children:s.jsx(h,{id:"Qm9soj",defaultMessage:"Loading apps..."})}):A.length===0?s.jsx("div",{className:"text-token-text-tertiary text-sm",children:s.jsx(h,{id:"24HItA",defaultMessage:"No connectors match your search."})}):s.jsx("div",{className:"max-h-64 space-y-1 overflow-y-auto pe-1",children:A.map(_=>{var q;return s.jsxs("button",{type:"button",className:"hover:bg-token-main-surface-secondary flex w-full items-start gap-3 rounded-md p-2 text-start",onClick:()=>{i([...o,_.id]),l(!1),P("")},children:[s.jsx(ms,{connector:_,size:"small"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-token-text-primary font-medium",children:(q=_.name)!=null?q:_.id}),_.description&&s.jsx("div",{className:"text-token-text-tertiary line-clamp-2 text-xs",children:_.description})]})]},_.id)})})]}),e[2]=I,e[3]=n,e[4]=r,e[5]=a,e[6]=u,e[7]=i,e[8]=d,e[9]=o,e[10]=m,e[11]=f,e[12]=p,e[13]=g,e[14]=k,e[15]=T}else m=e[10],f=e[11],p=e[12],g=e[13],k=e[14],T=e[15];let C;e[36]!==m||e[37]!==f||e[38]!==p?(C=s.jsxs("div",{className:m,children:[f,p]}),e[36]=m,e[37]=f,e[38]=p,e[39]=C):C=e[39];let v;return e[40]!==g||e[41]!==k||e[42]!==T||e[43]!==C?(v=s.jsxs("div",{className:g,children:[k,T,C]}),e[40]=g,e[41]=k,e[42]=T,e[43]=C,e[44]=v):v=e[44],v}function Eo(t){return!t}function $o(t){return[t.id,t]}function Wo({gizmo:t,onShowActionsEditor:e,isDisabled:n}){var r,u,l;const o=te(),i=ve(),a=s.jsxs("div",{className:"space-y-1",children:[(r=t==null?void 0:t.tools)==null?void 0:r.map((d,P)=>{var c;return d.type!==Y.JIT_PLUGIN?null:s.jsxs("div",{children:[s.jsx(ro,{isDisabled:n,actionTool:d,onShowActionsEditor:()=>e(d.metadata.domain)}),((c=d.metadata.auth)==null?void 0:c.type)==="oauth"&&s.jsx(so,{label:o.formatMessage(H.callbackUrlLabel),value:"https://chat.openai.com/aip/".concat(d.metadata.action_id,"/oauth/callback"),onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},P)}),((l=(u=t==null?void 0:t.tools)==null?void 0:u.filter(d=>d.type===Y.JIT_PLUGIN))!=null?l:[]).length>=ts?s.jsx("div",{children:o.formatMessage(H.maxActionsReached,{number:ts})}):s.jsx(re,{disabled:n,onClick:()=>{e("Unknown domain")},className:"mt-2",children:s.jsx(h,b({},H.createActionLabel))})]});return n?s.jsx(Us,{side:"top",label:o.formatMessage(H.disabledCustomActionsTooltip),children:a}):a}function Bo(t){var e,n,o;return((n=(e=t.files)==null?void 0:e.length)!=null?n:0)>0||((o=t==null?void 0:t.tools)==null?void 0:o.some(i=>i.type===Y.JIT_PLUGIN))}function Ho({gizmoEditorData:t,updateGizmo:e,currentModelConfig:n,setIsUploadingProfilePic:o,requireGizmoId:i,onShowActionsEditor:a}){var B,O,$,U,_,q,V,oe,je;const r=(B=t==null?void 0:t.tools)!=null?B:[],u=r.find(x=>x.type===Y.CONNECTOR),l=($=(O=u==null?void 0:u.settings)==null?void 0:O.action_ids)!=null?$:[],{availableConnectors:d,isLoading:P}=Ot({purpose:"use"}),c=ne(),I=new Set(Et(c,"3075814186").get("connectors",[])),m=d?Array.from(d.values()).filter(x=>x.status==="ENABLED").filter(x=>!I.has(x.id)).sort((x,W)=>{var Q,X;return((Q=x.name)!=null?Q:"").localeCompare((X=W.name)!=null?X:"")}):[],[f,p]=w.useState(!1),[g,k]=w.useState(!0),T=(U=t==null?void 0:t.promptStarters)!=null?U:[],C=[...T,...T.length<$t?[""]:[]],v=Xe(t),j=Ie(c),L=j==null?void 0:j.isWorkspaceAccount(),E=Vs(Me.WorkspaceGPTCustomActions),M=te(),N=Te(()=>As(c,{isGizmo:!0})),A=j==null?void 0:j.hasPaidFeatures(),{data:F}=Te(()=>Wt(c)),G=F!=null&&F.editor?Ls((_=t==null?void 0:t.tools)!=null?_:[])?F.editor.models_list_with_custom_actions:F.editor.models_list:[];return s.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[s.jsxs("div",{className:"grow",children:[s.jsxs(ee,{children:[s.jsx(Lo,{gizmoEditorData:t,onFileChange:async x=>{if(x!=null&&x!=="uploading"&&x.fileId!=null){const W=await He(x.fileId);W.status===Ve.Success&&e({profilePictureId:x.fileId!=null?x.fileId:void 0,profilePictureUrl:W.download_url})}else e({profilePictureId:void 0,profilePictureUrl:void 0});o(x==="uploading")}}),s.jsx(D,{label:s.jsx(h,{id:"M4dZms",defaultMessage:"Name"}),description:s.jsx(h,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),s.jsx(Ae,{type:"text",placeholder:M.formatMessage(H.gptNamePlaceholder),value:(q=t==null?void 0:t.name)!=null?q:"",onChange:x=>{e({name:x.target.value})},onBlurCapture:()=>e(x=>S(b({},x),{name:x.name.trim()})),"data-testid":"gizmo-name-input"}),v.includes(ae.GizmoNameTooLong)?s.jsx(Le,{className:"mt-1",children:s.jsx(h,S(b({},H.nameTooLong),{values:{length:Bt}}))}):null]}),s.jsxs(ee,{className:"mt-4",children:[s.jsx(D,{label:s.jsx(h,{id:"YDzNvf",defaultMessage:"Description"}),description:s.jsx(h,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),s.jsx(Ae,{type:"text",placeholder:M.formatMessage(H.descriptionPlaceholder),value:(V=t==null?void 0:t.description)!=null?V:"",onChange:x=>e({description:x.target.value}),onBlurCapture:()=>e(x=>{var W,Q;return S(b({},x),{description:(Q=(W=x.description)==null?void 0:W.trim())!=null?Q:""})}),"data-testid":"gizmo-description-input"}),v.includes(ae.GizmoDescriptionTooLong)?s.jsx(Le,{className:"mt-1",children:s.jsx(h,S(b({},H.descriptionTooLong),{values:{length:Ht}}))}):null]}),s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:M.formatMessage(H.instructionsSubtitle)}),s.jsxs("div",{className:"relative",children:[s.jsx(ao,{className:"resize-none",rows:8,value:t==null?void 0:t.instructions,onChange:x=>e({instructions:x.target.value}),onBlurCapture:()=>e(x=>S(b({},x),{instructions:x.instructions.trim()})),placeholder:M.formatMessage(H.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),s.jsx("button",{className:"text-token-text-tertiary absolute end-2 bottom-3",onClick:()=>p(!0),children:s.jsx(to,{className:"icon-sm"})})]}),s.jsx("div",{className:"text-token-text-tertiary text-xs",children:s.jsx(h,b({},Ss.instructionsWarning))}),v.includes(ae.GizmoInstructionsTooLong)?s.jsx(Le,{className:"mt-1",children:s.jsx(h,S(b({},H.instructionsTooLong),{values:{length:Vt}}))}):null]}),s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:s.jsx(h,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),s.jsx("div",{className:"flex flex-col gap-1",children:C.map((x,W)=>s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ae,{className:"rounded-e-none",value:x,type:"text",maxLength:qt,onChange:Q=>{const X=Q.target.value;e(y=>{var R;return S(b({},y),{promptStarters:qe(W>=((R=T.length)!=null?R:0)?[...T!=null?T:[],X]:T.map((z,K)=>K===W?X===""?void 0:X:z))})})}}),s.jsx("button",{className:"border-token-border-medium flex h-9 w-9 items-center justify-center rounded-lg rounded-s-none border border-s-0",onClick:()=>e(Q=>S(b({},Q),{promptStarters:T.filter((X,y)=>y!==W)})),children:s.jsx(Rs,{className:"icon-sm"})})]},W))})]}),s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:M.formatMessage(H.knowledgeExplanation)}),s.jsx(Ro,{gizmoEditorData:t,requireGizmoId:i,currentModelConfig:n,updateGizmo:e})]}),A&&s.jsxs(ee,{children:[s.jsx(D,{label:s.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[s.jsx(h,{id:"wnVs4X",defaultMessage:"Recommended Model"}),s.jsx(oo,{description:s.jsx(h,b({},H.recommendedModelExplainer))})]})}),s.jsx("div",{style:{fontSize:"12px",color:"var(--gray-600)",marginTop:"4px",marginBottom:"8px"},children:s.jsx(h,b({},H.recommendedModelDescriberUnderTitle))}),s.jsxs("select",{className:"border-token-border-medium bg-token-main-surface-primary w-full rounded-lg border px-3 py-2 text-sm",value:(oe=t.defaultModel)!=null?oe:"",onChange:x=>{Qt.logEvent("gizmo_recommended_model_selected",x.target.value),e({defaultModel:x.target.value===""?null:x.target.value})},children:[s.jsx("option",{value:"",children:M.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"})}),[...N.models.values()].filter(x=>G.includes(x.id)).sort((x,W)=>x.title.localeCompare(W.title)).map(x=>s.jsx("option",{value:x.id,children:x.title},x.id))]})]}),s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:s.jsx(h,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),s.jsx(io,{enabledTools:r,onEnabledToolsChange:x=>e({tools:x}),noConnectorsAvailable:P?void 0:m.length===0,isConnectorsLoading:P}),u!=null&&s.jsx(Oo,{connectors:m,selectedIds:l,onChange:x=>{e(W=>{var X;const Q=((X=W.tools)!=null?X:[]).map(y=>y.type!==Y.CONNECTOR?y:S(b({},y),{settings:S(b({},y.settings),{action_ids:x})}));return S(b({},W),{tools:Q})})},isLoading:P})]}),u==null&&s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"7r7v+u",defaultMessage:"Actions"}),description:s.jsx(h,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),s.jsx(Wo,{isDisabled:!!(L&&!E),gizmo:t,onShowActionsEditor:a})]}),!L&&Bo(t)&&s.jsxs(ee,{children:[s.jsx(D,{label:s.jsx(h,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!g,onClick:()=>{k(x=>!x)}}),s.jsx(Fo,{collapsed:g,initial:!1,children:s.jsx(In,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:s.jsx(h,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!t.trainingDisabled,onChange:()=>{e({trainingDisabled:!t.trainingDisabled})}})})]})]}),f&&s.jsx(zo,{text:(je=t.instructions)!=null?je:"",onChange:x=>{e({instructions:x})},onClose:()=>p(!1),placeholder:M.formatMessage(H.instructionsSubtitle)})]})}const H=he({recommendedModelDescriberUnderTitle:{id:"gizmo.recommendedModelDescriberUnderTitle",defaultMessage:"Recommend a model to the user, which should be used by default for best results."},recommendedModelExplainer:{id:"gizmo.recommendedModelExplainer",defaultMessage:"When the user loads a new conversation with the GPT the recommended model will be used. If the model is not available to the user, a similar model may be automatically selected."},nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters. If you need to provide more context, you may want to attach a file or knowledge document."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function Vo(t,e){const n=Os(t);if(!Array.isArray(t.detail))return n;const o=qe(t.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return e.formatMessage(H.nameTooLong,{length:i.ctx.limit_value});case"description":return e.formatMessage(H.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return e.formatMessage(H.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return o.length>0?o.join("\n"):n}function qo({upsertDraftError:t}){const e=te(),n=Vo(t,e);return s.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[s.jsx("div",{children:s.jsx(h,b({},Ys.errorSavingDraft))}),n!=null&&s.jsx(Us,{label:n,children:s.jsx(Zt,{className:"icon-sm"})})]})}function Qo({isPublished:t,isSavingDraft:e,hasUnpublishedChanges:n,upsertDraftError:o,className:i}){return o instanceof Yt?s.jsx(qo,{upsertDraftError:o}):n?s.jsxs("div",{className:de("flex items-center gap-2",i),children:[s.jsx("span",{className:"text-token-text-secondary",children:t?s.jsx(h,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):s.jsx(h,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),s.jsx("div",{className:"text-token-text-tertiary w-4",children:e&&s.jsx(Fs,{})})]}):null}const Ys=he({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}}),Ko=ke(()=>_e(()=>import("./kl7k9lkcmwoxg3bk.js"),__vite__mapDeps([10,1,2,3,4,5,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61])).then(t=>t.CanvasFocusedViewManager));var Xo=(t=>(t.TestGizmoAction="test_gizmo_action",t))(Xo||{});const Yo=new Jt;function Zo({conversation:t,gizmoHasCustomActions:e,preferredModelId:n}){const{modelLabel:o,dropdownSections:i}=Ln(t,e,n),a=s.jsxs(Un,{children:[s.jsx(h,{id:"IhcP1l",defaultMessage:"Model"}),s.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:o}),s.jsx(zn,{className:"icon-sm text-token-text-tertiary"})]});return s.jsx(Ye,{size:"small",alignOffset:-4,triggerButton:a,children:s.jsx(Rn,{sections:i})})}function Jo({gizmoEditorData:t,isSavingDraft:e,showTitle:n=!0}){var k,T,C;const o=ne(),[i,a]=w.useState(()=>Pe(o,{urlGizmoId:t.id}));Ws(i.id,{kind:ge.GizmoTest,gizmo_id:t.id}),w.useEffect(()=>{Qe(i.id,v=>{v.mode={kind:ge.GizmoTest,gizmo_id:t.id}})},[i.id,t.id]);const r=(k=t.files)==null?void 0:k.map(v=>v.file_id).join();w.useEffect(()=>{Dt(i.id)!=null&&a(Pe(o,{urlGizmoId:t.id}))},[o,t.id,t.instructions,t.tools,r,i.id]);const u=w.useMemo(()=>({gizmoEditorData:t,mode:"test"}),[t]),l=Es(o,"1213809372"),d=(T=Ie(o))==null?void 0:T.hasPaidFeatures(),P=l||d,[c,I]=w.useState(0),m=()=>{I(v=>v-360)},f=t.id,p=Do(i);w.useEffect(()=>$s(Yo,{test_gizmo_action:({rootDomain:v,operationName:j})=>{f&&p(f,v,j)}}),[p,f]);const g=w.useCallback(()=>s.jsx("div",{className:"h-full w-full",children:s.jsx(Nn,{gizmo:t,hideOwner:!0,showStarterPrompts:!0})}),[t]);return s.jsx(ws.Provider,{value:u,children:s.jsx(Ms,{conversation:i,children:s.jsx(Ps,{conversation:i,children:s.jsx(Gn,{clientThreadId:i.id,children:s.jsx("div",{className:de("flex h-full w-full",e&&"cursor-wait opacity-80 transition"),children:s.jsxs("div",{className:"flex grow flex-col",children:[s.jsx("div",{className:"relative mb-2 shrink-0",children:s.jsx("div",{className:"flex justify-center py-1",children:n&&s.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[s.jsx("div",{className:"icon"}),s.jsxs("button",{onClick:()=>{m(),a(Pe(o,{urlGizmoId:t.id}))},className:"flex items-center gap-2",children:[s.jsx(h,{id:"2u/6Ja",defaultMessage:"Preview"}),s.jsx(zs.div,{className:"text-token-text-primary",animate:{rotate:c},transition:{duration:.3},children:s.jsx(Sn,{className:"icon invisible group-hover:visible"})})]}),P&&s.jsx(Zo,{conversation:i,gizmoHasCustomActions:!!Ls(t.tools),preferredModelId:(C=t.defaultModel)!=null?C:void 0})]})})}),s.jsxs("div",{className:de("relative grow overflow-auto px-2",e&&"pointer-events-none"),children:[s.jsx(Qs,{conversation:i,renderEmptyState:g()}),s.jsx(An.ContentSidebar,{children:s.jsx(Ko,{clientThreadId:i.id,overrideWidth:0,isAutoFocusDisabled:!0})})]})]})})})})})})}const ps=vs.memo(Jo);function Do(t){"use forget";const e=ue.c(2);let n;return e[0]!==t?(n=(o,i,a)=>{Fn({conversation:t,eventSource:"url",promptMessage:en("Call the ".concat(i," API with the ").concat(a," operation"),{jit_plugin_data:{from_client:{type:"test",operation:a,tool_name:sn(i)}}}),completionMetadata:{conversationMode:{kind:ge.GizmoTest,gizmo_id:o}}})},e[0]=t,e[1]=n):n=e[1],n}const ei=ke(()=>_e(()=>import("./g16t1ppnhpknyp01.js"),__vite__mapDeps([62,1,2,3,63,4,5,64,65,0,6,7,8,66,67,68,69,70,58,55,56,59,50,49,71,72,73,48,54,57,74,75,76,77,78])).then(t=>t.GizmoActionsEditor));var Zs=(t=>(t.MAGIC_MAKER="magic",t.ADVANCED="advanced",t.PREVIEW="preview",t))(Zs||{});function Re({value:t,label:e,testId:n}){return s.jsx(Wn,{value:t,className:"text-md border-token-border-default text-token-text-tertiary hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] w-1/3 grow rounded-lg p-1.5 font-semibold transition md:w-1/2","data-testid":n,children:e})}function si({className:t,editorTab:e,setEditorTab:n}){const o=te();return s.jsxs($n,{className:de("bg-token-main-surface-secondary flex w-full overflow-hidden rounded-xl p-1.5 md:w-1/2",t),value:e,onValueChange:i=>{n(i)},children:[s.jsx(Re,{value:"magic",label:o.formatMessage(Ue.magicMakerLabel)}),s.jsx(Re,{value:"advanced",label:o.formatMessage(Ue.configureLabel),testId:"gizmo-editor-configure-button"}),s.jsx("div",{className:"flex w-1/3 md:hidden",children:s.jsx(Re,{value:"preview",label:o.formatMessage(Ue.previewLabel)})})]})}function ti(t,e){return t.length!==e.length?!1:t.every(n=>e.some(o=>o.type===n.type))}function ni(t,e){var n,o,i,a;return t.name===e.gizmo.display.name&&t.description===e.gizmo.display.description&&t.instructions===e.gizmo.instructions&&ti(t.tools,e.tools)&&Be((o=(n=t.files)==null?void 0:n.map(r=>r.file_id))!=null?o:[],(a=(i=e.files)==null?void 0:i.map(r=>r.file_id))!=null?a:[])&&t.profilePictureUrl==e.gizmo.display.profile_picture_url&&t.profilePictureId==e.gizmo.display.profile_pic_id}const Js=({gizmo:t,onNewGizmoId:e})=>{var X;const n=ot(),o=ln(),i=Vs(Me.BrowsingAvailable),a=(o==null?void 0:o.includes(Me.GizmoCanvasToggle))&&(o==null?void 0:o.includes(Me.Canvas)),r=ne(),u=Es(r,"4148168517"),l=te(),d=ve(),P=()=>{const y=[];i&&y.push({type:Y.BROWSER}),a&&y.push({type:Y.CANVAS});const R=S(b({},ls),{tools:[...ls.tools,...y]});return u?S(b({},R),{tools:[...R.tools.filter(z=>z.type!==Y.DALLE),{type:Y.IMAGE_GEN}]}):R},c=w.useRef(t!=null?os(t):P()),I=w.useRef(t),m=w.useRef(c.current),[f,p]=w.useState(()=>c.current),[g]=w.useState(()=>Pe(r)),[k]=w.useState(()=>({context_message:po(c.current),model_slug:Fe.GPT_4o,enabled_tools:[{tool_id:t!=null?"gizmo_editor":"gizmo_creator"}]}));yo(g.id,m.current,k);const T=Te(()=>As(r,{isGizmo:!0})),C=(X=T.models.get(Ts))!=null?X:T&&qs(T.models.values(),y=>y.tags.includes(Fe.GPT_4o)),{data:v}=cn(c.current.id),j=dn(),{isPending:L,error:E}=j,M=un(),N=w.useMemo(()=>v!=null&&!ni(f,v),[f,v]),A=async()=>{var R;const y=c.current;try{const z=await j.mutateAsync({editorData:y,gizmoId:y.id});if(I.current=z,c.current.id==null){const K=z.gizmo.id;c.current=S(b({},c.current),{id:K,sharingTargets:z.gizmo.sharing_targets}),p(c.current),e==null||e(K)}for(const K of z.tools.filter(Z=>Z.type===Y.JIT_PLUGIN)){const Z=c.current.tools.find(me=>me.type===Y.JIT_PLUGIN&&me.metadata.domain===K.metadata.domain);Z&&Z.metadata.action_id!==K.metadata.action_id&&(Z.metadata=S(b({},Z.metadata),{action_id:K.metadata.action_id}),p(c.current))}return z}catch(z){const K=(R=Os(z))!=null?R:l.formatMessage(Ys.errorSavingDraft);throw d.warning(K,{duration:2}),z}},F=w.useRef(void 0),G=async()=>c.current.id!=null?c.current.id:(F.current==null&&(F.current=A().then(y=>y.gizmo.id).catch(y=>{throw F.current=void 0,y})),F.current),[B]=w.useState(()=>mn(()=>A(),2e3,{trailing:!0})),O=w.useCallback((y,R=!0)=>{const z=typeof y=="function"?y(c.current):fn(c.current,y);Be(z,c.current)||(c.current=z,p(c.current),R&&B())},[B]),$=w.useRef(void 0);w.useEffect(()=>$s(pn,{completionFinished:async y=>{const R=y.serverThreadId;if(R!=null)try{const z=await fo(c.current,R,d,$.current);z!=null&&(O(z),m.current=bs(c.current))}catch(z){ze.addError(z),d.warning("Something went wrong generating your GPT",{duration:3})}finally{$.current=ce.getCurrentNode(xe(R)).message.id}}}),[d,O]);const[U,_]=w.useState(void 0);w.useEffect(()=>{_(Zn(t))},[t==null?void 0:t.gizmo.id]);const q=async(y,R)=>{var me,Ze;const z=Xe(c.current,y.recipient,R);if(z.length>0){d.warning("Could not save GPT:\n\n".concat(z.map(ie=>"- ".concat(Oe(ie))).join("\n")),{duration:3});return}const K=await A(),Z=K.gizmo.id;try{return Gs.logEvent("Promote Gizmo",{gizmo_id:K.gizmo.id,sharing_recipient:y.recipient,editor_tab:V}),await M.mutateAsync({gizmoId:K.gizmo.id,data:{sharingSubjects:y.subjects,sharingRecipient:y.recipient,categories:R==null?void 0:[R]}},{onSuccess(Ne){n.setQueryData(rs(n,Z).queryKey,Ne),n.invalidateQueries({queryKey:["gizmos"]}),n.invalidateQueries({queryKey:["gizmo",{gizmoId:Z}]}),n.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:Z}]})}})}catch(ie){if(ie instanceof hn)_({gizmoId:Z,sharingRecipient:y.recipient,moderationType:Dn.PublishBlocked,sharingTargets:(me=ie.response)==null?void 0:me.sharing_targets,showModal:be.AppealAvailable});else{ze.addError(ie);const Ne=(Ze=ie.detail)!=null?Ze:"An unknown error occurred";d.warning("Error saving GPT - "+Ne,{duration:6})}}},[V,oe]=w.useState(()=>{const y=is.getItem(as.GizmoEditorTab);return Object.values(Zs).includes(y)?y:"magic"});w.useEffect(()=>gn(()=>{const y=En(r).width;y!=null&&y>=768&&V==="preview"&&oe("magic")}),[r,V]);const[je,x]=w.useState(!1),[W,Q]=w.useState(void 0);return s.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[s.jsx(So,{gizmoEditorData:f,isUpsertLoading:j.isPending,isPromoteLoading:M.isPending,hasUnpublishedChanges:N,isUploadingProfilePic:je,publishedGizmo:v,updateGizmo:O,promoteGizmo:async(y,R)=>{const z=await q(y,R);return c.current=S(b({},c.current),{sharingRecipient:y.recipient}),p(c.current),is.setItem(as.GizmoEditorTab,V),z},appealGizmo:async(y,R)=>{U!=null&&_(S(b({},U),{sharingRecipient:y,categories:R==null?void 0:[R],showModal:be.AppealAvailable}))},setAppealState:_,revertDraft:v!=null&&N?()=>{const y=n.getQueryData(rs(n,c.current.id).queryKey);if(y!=null){const R=os(y);c.current=R,p(R),A()}}:void 0,draftMessage:s.jsx(Qo,{isPublished:v!=null&&(v.gizmo.share_recipient==="marketplace"||v.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:N,isSavingDraft:L,upsertDraftError:E,className:"text-sm"}),showActionsModal:y=>{Q(y)},className:"shrink-0"}),U&&s.jsx(Jn,{appealState:U,onAppealClose:()=>_(S(b({},U),{showModal:be.None})),onAppealSubmitted:()=>_(S(b({},U),{showModal:be.AppealSent}))}),s.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[s.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:s.jsx("div",{className:"h-full grow overflow-hidden",children:W!==void 0?s.jsx(ei,{currentlyEditingActionDomain:W,gizmoEditorData:f,updateGizmo:O,onClose:()=>{Q(void 0)}}):s.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[s.jsx("div",{className:"flex w-full flex-row justify-center",children:s.jsx(si,{editorTab:V,setEditorTab:oe,className:"mb-2 shrink-0 self-center"})}),s.jsx("div",{className:"grow overflow-hidden",children:V==="magic"?s.jsx("div",{className:"h-full w-full",children:s.jsx(wo,{gizmoEditorData:f,updateGizmo:O,clientThreadId:g.id,gizmoEditorDataRef:c,magicMakerBehaviorOverrides:k,magicMakerConversationGizmoEditorDataRef:m,requireGizmoId:G},g.id)}):V==="advanced"?s.jsx(Ho,{gizmoEditorData:f,updateGizmo:O,currentModelConfig:C,setIsUploadingProfilePic:x,requireGizmoId:G,onShowActionsEditor:y=>{Q(y)}}):s.jsx(ps,{gizmoEditorData:f,isSavingDraft:L,showTitle:!1})})]})})}),s.jsx("div",{className:de("border-token-border-medium bg-token-main-surface-secondary hidden w-1/2 justify-center border-s pt-4",V!=="preview"&&"md:flex"),children:s.jsx("div",{className:"grow",children:s.jsx(ps,{gizmoEditorData:f,isSavingDraft:L})})})]})]})};function oi({gizmoId:t,version:e}){const{data:n}=nn({gizmoId:t,draft:!0,version:e}),o=Cs(on.accountUserId),i=an(),a=i==null?void 0:i.id,r=rn(n)&&n!=null&&o!=null&&a!=null;return n==null||!r?null:s.jsx(Js,{gizmo:n})}function ii({onNewGizmoId:t}){return s.jsx(Js,{onNewGizmoId:t})}const ai=({gizmoId:t,remixSourceId:e,version:n})=>{const o=Ce(),i=ne(),a=Ie(i),r=w.useRef(void 0);w.useEffect(()=>(ns.enterGizmoEditor(),()=>{ns.exitGizmoEditor()}),[]);let u=t;return t!=null&&r.current===t&&(u=void 0),On({newChatAction:l=>{Bn(i,l,{location:"Keyboard command"}),l.defaultPrevented||Hn(o)}}),a?u!==void 0?s.jsx(oi,{gizmoId:u,version:n},u):s.jsx(ii,{remixSourceId:e,onNewGizmoId:l=>{r.current=l,window.history.replaceState(window.history.state,"",tn(l))}}):s.jsx("div",{className:"flex min-h-screen items-center justify-center",children:s.jsx(Fs,{})})},Ue=he({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}}),Mi=()=>(Vn(),null),Pi=it(function(){const e=ne(),n=Ie(e),o=!!(n!=null&&n.hasPlusFeatures());lo(n==null||o);const i=at(),[a]=rt(),r=Ce(),u=i.slug,l=a.get("version"),d=u?xn(u):void 0,P=a.get("remixFrom");return w.useEffect(()=>{qn(!0).then(c=>{Qn.initializeAndGatherData(c),Kn.initializeAndGatherData(c)})},[]),w.useEffect(()=>{n!=null&&!o&&r("/")},[n,r,o]),w.useEffect(()=>{d&&cs(d)&&r("/g/".concat(u,"/project"))},[d,r,u]),!o||d&&cs(d)?null:s.jsx(vn,{children:s.jsx(ai,{gizmoId:d,remixSourceId:P!=null?P:void 0,version:l!=null?Number(l):void 0})})});export{Yo as G,Xo as a,Mi as c,Pi as g};
//# sourceMappingURL=ndx7kixe4ac90f3i.js.map
