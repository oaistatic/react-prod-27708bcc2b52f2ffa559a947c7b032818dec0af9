const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fykx19ay6ryg125w.js","assets/fg33krlcm0qyi6yw.js","assets/mtk1qztvnb31pw5r.js","assets/root-mcq3deyb.css","assets/glx45q10lwleb6ms.js","assets/orp3d1dh54xbr7c3.js"])))=>i.map(i=>d[i]);
var Ut=Object.defineProperty,Vt=Object.defineProperties;var Bt=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var Qt=Object.prototype.hasOwnProperty,zt=Object.prototype.propertyIsEnumerable;var ut=(s,e,a)=>e in s?Ut(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,he=(s,e)=>{for(var a in e||(e={}))Qt.call(e,a)&&ut(s,a,e[a]);if(mt)for(var a of mt(e))zt.call(e,a)&&ut(s,a,e[a]);return s},Ge=(s,e)=>Vt(s,Bt(e));import{c as ye,e as ve,r as q,j as t,b as qt,M as E,_ as st,a as Kt}from"./fg33krlcm0qyi6yw.js";import{gC as Q,es as $t,b as nt,H as wt,l as et,u2 as De,u6 as Qe,gH as bt,g2 as P,R as Et,nW as St,bX as Ct,bh as at,m as Mt,I as Ft,ag as Ht,du as Gt,sC as Jt,rZ as Xt,tU as b,ix as Zt,gE as Yt,uv as It,T as tt,bJ as es,bc as ft,bd as pt,C as ts,rc as gt,u5 as ss,uw as ht,D as ns,a9 as Je,nP as as,iG as is,ga as rs,cU as xt,hd as yt,sv as os,P as qe,ss as ls,ux as cs,uy as Xe,t as ds}from"./mtk1qztvnb31pw5r.js";import{V as xe,A as ms,cx as us,ci as _t,cw as it,kW as fs,kX as ps,az as Pt,eN as Nt,iH as Lt,cz as gs}from"./k65njl5wlgspihfr.js";import{L as hs,R as xs,X as ys}from"./hod0x7g0nytg7mip.js";import{C as _s}from"./d25rp1v2ymoyzgv9.js";import{c as js,E as ks}from"./l7qr5j8e9lh3l959.js";import{S as vs,C as ws}from"./exm3n162m2u9ltpu.js";import{a as bs}from"./jdzosouyvpzu0tpb.js";import"./og8jhmm6v1nbwzo4.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";const Rt=new Set;function M(s){return s.toLowerCase().trim()}function Ze(s){const[,e]=(s!=null?s:"").toLowerCase().split("@");return e!=null?e:null}function Ke(s){return s.kind==="email"?"".concat(s.kind,":").concat(M(s.id)):"".concat(s.kind,":").concat(s.id)}function Es(s,e){const a=M(e);return s.some(c=>c.kind==="email"?M(c.id)===a:c.kind==="user"&&c.sublabel?M(c.sublabel)===a:!1)}function Ss(s){return s.can_write?us:s.can_view_config?_t:_t}function $e(s){return s.can_write?Q.shareProjectPermissionCanEdit:s.can_view_config?Q.shareProjectPermissionCanChat:Q.shareProjectPermissionUnknown}function Cs(s){return s.can_write?"edit":"view"}function Ot(s){"use forget";const e=ye.c(14),{capabilities:a,selected:c}=s,l=ve(),d=a.can_write?"edit":"view",r=c?"selected":"default";let n;e[0]!==a?(n=Ss(a),e[0]=a,e[1]=n):n=e[1];let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(P.RadioItemCheck,{}),e[2]=p):p=e[2];let u;e[3]!==a||e[4]!==l?(u=l.formatMessage($e(a)),e[3]=a,e[4]=l,e[5]=u):u=e[5];const m=a.can_write?Q.shareProjectPermissionEditDescription:Q.shareProjectPermissionViewDescription;let i;e[6]!==m?(i=t.jsx(E,he({},m)),e[6]=m,e[7]=i):i=e[7];let _;return e[8]!==d||e[9]!==r||e[10]!==n||e[11]!==u||e[12]!==i?(_=t.jsx(P.RadioItem,{value:d,color:r,icon:n,trailing:p,label:u,secondary:i}),e[8]=d,e[9]=r,e[10]=n,e[11]=u,e[12]=i,e[13]=_):_=e[13],_}function rt(s){"use forget";const e=ye.c(21),{capabilities:a,onChange:c,triggerClassNames:l}=s;let d;e[0]!==l?(d=et("text-token-text-secondary hover:bg-token-interactive-bg-secondary-hover radix-state-open:bg-token-interactive-bg-secondary-press whitespace-nowrap",l),e[0]=l,e[1]=d):d=e[1];let r;e[2]!==a?(r=$e(a),e[2]=a,e[3]=r):r=e[3];let n;e[4]!==r?(n=t.jsx(E,he({},r)),e[4]=r,e[5]=n):n=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=t.jsx(it,{className:"icon-sm"}),e[6]=p):p=e[6];let u;e[7]!==d||e[8]!==n?(u=t.jsxs(P.Trigger,{color:"secondary",className:d,children:[n,p]}),e[7]=d,e[8]=n,e[9]=u):u=e[9];const m=a.can_write?"edit":"view";let i;e[10]!==c?(i=j=>{c(j==="edit"?Qe:De)},e[10]=c,e[11]=i):i=e[11];let _;e[12]!==a?(_=[De,Qe].map((j,g)=>t.jsx(Ot,{capabilities:j,selected:bt(j,a)},g)),e[12]=a,e[13]=_):_=e[13];let w;e[14]!==m||e[15]!==i||e[16]!==_?(w=t.jsx(P.Portal,{children:t.jsx(P.Content,{className:"max-w-[320px]",children:t.jsx(P.RadioGroup,{value:m,onValueChange:i,children:_})})}),e[14]=m,e[15]=i,e[16]=_,e[17]=w):w=e[17];let h;return e[18]!==u||e[19]!==w?(h=t.jsxs(P.Root,{children:[u,w]}),e[18]=u,e[19]=w,e[20]=h):h=e[20],h}function Wt(s){"use forget";var K,$,ae,G,J,U,ie;const e=ye.c(45),{publishedGizmo:a,subjects:c,workspaceMembersByEmailRef:l,existingMemberEmails:d,canQueryMembers:r}=s,n=ve(),[,p]=q.useTransition(),[u,m]=q.useState(""),i=wt(),[_,w]=q.useState(""),[h]=bs(_,100),j=d!=null?d:Rt,g=ms(r?i==null?void 0:i.id:void 0,0,h,10);(K=g.data)==null||K.items;let I;e[0]!==(a==null?void 0:a.gizmo)||e[1]!==(($=g.data)==null?void 0:$.items)?(I=(J=(G=(ae=g.data)==null?void 0:ae.items)==null?void 0:G.filter(v=>v.account_user_id!==(a==null?void 0:a.gizmo.author.user_id)).map(Ms))!=null?J:[],e[0]=a==null?void 0:a.gizmo,e[1]=(U=g.data)==null?void 0:U.items,e[2]=I):I=e[2];const T=I;let z;if(e[3]!==j||e[4]!==T){let v;e[6]!==j?(v=V=>V.kind!=="user"||!V.sublabel?!0:!j.has(M(V.sublabel)),e[6]=j,e[7]=v):v=e[7],z=T.filter(v),e[3]=j,e[4]=T,e[5]=z}else z=e[5];const A=z,ee=i==null?void 0:i.id;let S;e[8]!==h||e[9]!==ee?(S=[ee,"groups","filtered",h],e[8]=h,e[9]=ee,e[10]=S):S=e[10];let B;e[11]!==i||e[12]!==h?(B=i?()=>Et.safeGet("/accounts/{account_id}/groups",{parameters:{path:{account_id:i.id},query:{query:h,offset:0,orderby:"@score",limit:20}}}):void 0,e[11]=i,e[12]=h,e[13]=B):B=e[13];let X;e[14]!==r||e[15]!==i||e[16]!==h?(X=r&&h.trim()!==""&&i!=null&&!!i.getWorkspaceId(),e[14]=r,e[15]=i,e[16]=h,e[17]=X):X=e[17];let N;e[18]!==S||e[19]!==B||e[20]!==X?(N={queryKey:S,queryFn:B,enabled:X},e[18]=S,e[19]=B,e[20]=X,e[21]=N):N=e[21];const{data:O,isLoading:W}=qt(N);let re;e[22]!==(O==null?void 0:O.items)||e[23]!==n?(re=(ie=O==null?void 0:O.items.slice(0,10).map(v=>{var V;return{kind:"group",id:v.id,label:v.name,sublabel:n.formatMessage(Q.shareProjectGroupMembersCount,{numMembers:(V=v.num_members)!=null?V:0}),isScimManaged:!!v.is_scim_managed}}))!=null?ie:[],e[22]=O==null?void 0:O.items,e[23]=n,e[24]=re):re=e[24];const oe=re;let L;e[25]!==c?(L=new Set(c.map(Ke)),e[25]=c,e[26]=L):L=e[26];const Z=L;let C;e[27]!==oe||e[28]!==Z||e[29]!==A?(C=[...A,...oe].filter(v=>!Z.has(Ke(v))),e[27]=oe,e[28]=Z,e[29]=A,e[30]=C):C=e[30];const te=C;let se,ne;e[31]!==T||e[32]!==l?(se=()=>{if(l)for(const v of T)v.sublabel&&l.current.set(M(v.sublabel),v)},ne=[T,l],e[31]=T,e[32]=l,e[33]=se,e[34]=ne):(se=e[33],ne=e[34]),q.useEffect(se,ne);let Y;e[35]!==p?(Y=(v,V)=>{m(v),p(()=>{w(v)})},e[35]=p,e[36]=Y):Y=e[36];const le=Y;let H;return e[37]!==W||e[38]!==le||e[39]!==u||e[40]!==te||e[41]!==p||e[42]!==A||e[43]!==g?(H={groupsLoading:W,handleSearch:le,inputValue:u,options:te,userOptions:A,setInputValue:m,setQuery:w,startQueryTransition:p,usersQuery:g},e[37]=W,e[38]=le,e[39]=u,e[40]=te,e[41]=p,e[42]=A,e[43]=g,e[44]=H):H=e[44],H}function Ms(s){var e,a;return{kind:"user",id:s.account_user_id,label:(e=s.name)!=null?e:"Unknown User",sublabel:(a=s.email)!=null?a:""}}function Dt(){"use forget";const s=ye.c(1);let e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(e=t.jsxs("div",{className:"border-token-border-heavy bg-token-bg-tertiary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[t.jsx(St,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),t.jsx(E,{id:"RjrlgU",defaultMessage:"You don't have permission to search your workspace members. Please contact your workspace admin for access or update the workspace settings."})]}),s[0]=e):e=s[0],e}function Is(s){"use forget";const e=ye.c(20),{publishedGizmo:a,memberListAccess:c,capabilities:l,setCapabilities:d,subjects:r,setSubjects:n,workspaceMembersByEmailRef:p}=s,u=c===void 0?"unknown":c,m=ve(),i=u==="allowed";let _;e[0]!==i||e[1]!==a||e[2]!==r||e[3]!==p?(_={publishedGizmo:a,subjects:r,workspaceMembersByEmailRef:p,canQueryMembers:i},e[0]=i,e[1]=a,e[2]=r,e[3]=p,e[4]=_):_=e[4];const{groupsLoading:w,handleSearch:h,inputValue:j,options:g,usersQuery:I}=Wt(_);let T;e[5]!==j?(T=j.trim(),e[5]=j,e[6]=T):T=e[6];const z=T;let A;return e[7]!==l||e[8]!==w||e[9]!==h||e[10]!==j||e[11]!==m||e[12]!==u||e[13]!==g||e[14]!==d||e[15]!==n||e[16]!==r||e[17]!==z||e[18]!==I?(A=u==="denied"?t.jsx(Dt,{}):t.jsx("div",{className:"w-full min-w-0",children:t.jsx(vs,{value:r,classNames:{menuList:Ns,control:Ps},onChange:ee=>n([...ee]),onSearch:h,menuIsOpen:z!=="",inputValue:j,options:g,placeholder:m.formatMessage(Q.shareProjectSearchPeopleOrGroups),trailingComponent:r.length>0&&t.jsx(rt,{capabilities:l,onChange:d,triggerClassNames:"text-token-text-secondary"}),isLoading:I.isLoading||w})}),e[7]=l,e[8]=w,e[9]=h,e[10]=j,e[11]=m,e[12]=u,e[13]=g,e[14]=d,e[15]=n,e[16]=r,e[17]=z,e[18]=I,e[19]=A):A=e[19],A}function Ps(){return"h-auto! min-h-[40px]! max-h-[192px] items-start overflow-y-auto p-1! cursor-text!"}function Ns(){return"bg-token-bg-primary"}function Ls(s){"use forget";const e=ye.c(88),{publishedGizmo:a,memberListAccess:c,capabilities:l,setCapabilities:d,subjects:r,setSubjects:n,existingMemberEmails:p,allowExternalDomainInvites:u,normalizedVerifiedDomainHostnames:m,workspaceMembersByEmailRef:i,isFreeWorkspace:_,currentUserEmail:w}=s,h=c===void 0?"unknown":c,j=nt(),g=ve(),I=p!=null?p:Rt,T=h==="allowed";let z;e[0]!==T||e[1]!==p||e[2]!==a||e[3]!==r||e[4]!==i?(z={publishedGizmo:a,subjects:r,workspaceMembersByEmailRef:i,existingMemberEmails:p,canQueryMembers:T},e[0]=T,e[1]=p,e[2]=a,e[3]=r,e[4]=i,e[5]=z):z=e[5];const{groupsLoading:A,handleSearch:ee,inputValue:S,options:B,userOptions:X,setInputValue:N,setQuery:O,startQueryTransition:W,usersQuery:re}=Wt(z),oe=S.trim(),L=M(oe);let Z;e[6]!==w?(Z=Ze(w),e[6]=w,e[7]=Z):Z=e[7];const C=Z,te=_;let se;e[8]!==g||e[9]!==h?(se=h==="denied"?g.formatMessage({id:"fQBvJ5",defaultMessage:"Enter email addresses"}):g.formatMessage(Q.shareProjectSearchPeopleGroupsOrEmail),e[8]=g,e[9]=h,e[10]=se):se=e[10];const ne=se,Y=te&&xe.test(L)&&Ze(L)!==C,le=q.useRef(null);q.useEffect(()=>{if(!Y){le.current=null;return}L!==""&&le.current!==L&&($t(j,"chatgpt_business_workspace_share_project_modal_invite_domain_mismatch"),le.current=L)},[j,Y,C,L]);let H;e[11]!==te||e[12]!==C?(H=x=>{if(!te)return!0;const f=Ze(x);return f!=null&&f===C},e[11]=te,e[12]=C,e[13]=H):H=e[13];const K=H,$=r.length>0||xe.test(oe);let ae;e:{if(!xe.test(L)){ae=void 0;break e}if(I.has(L)){ae=void 0;break e}let x;if(e[14]!==L||e[15]!==X){let f;e[17]!==L?(f=D=>D.kind==="user"&&D.sublabel?M(D.sublabel)===L:!1,e[17]=L,e[18]=f):f=e[18],x=X.find(f),e[14]=L,e[15]=X,e[16]=x}else x=e[16];ae=x}const G=ae;let J;e[19]!==I||e[20]!==r||e[21]!==i?(J=(x,f)=>{const D=f===void 0?r:f,F=M(x);return I.has(F)||i.current.has(F)?!0:Es(D,F)},e[19]=I,e[20]=r,e[21]=i,e[22]=J):J=e[22];const U=J;let ie;e[23]!==I||e[24]!==U||e[25]!==n?(ie=x=>{n(f=>{const D=Ke(x);return f.some(F=>Ke(F)===D)||x.kind==="user"&&x.sublabel&&I.has(M(x.sublabel))||x.kind==="email"&&U(x.id,f)?f:[...f,x]})},e[23]=I,e[24]=U,e[25]=n,e[26]=ie):ie=e[26];const v=ie;let V;e[27]!==v||e[28]!==I||e[29]!==K||e[30]!==U||e[31]!==N||e[32]!==O||e[33]!==W||e[34]!==i?(V=x=>{const f=M(x);if(!xe.test(f)||!K(f))return;if(I.has(f)){W(()=>{O("")}),N("");return}const D=i.current.get(f);if(D){if(D.sublabel&&I.has(M(D.sublabel))){W(()=>{O("")}),N("");return}v(D),W(()=>{O("")}),N("");return}if(U(f)){N("");return}v({kind:"email",id:f,label:f}),W(()=>{O("")}),N("")},e[27]=v,e[28]=I,e[29]=K,e[30]=U,e[31]=N,e[32]=O,e[33]=W,e[34]=i,e[35]=V):V=e[35];const ce=V;let _e;e[36]!==K||e[37]!==U?(_e=x=>{const f=M(x);return xe.test(f)&&!U(f)&&K(f)},e[36]=K,e[37]=U,e[38]=_e):_e=e[38];const de=_e;let we;e[39]!==g?(we=x=>g.formatMessage(Q.shareProjectInviteEmailOption,{email:x.trim()}),e[39]=g,e[40]=we):we=e[40];const me=we;let be;e[41]!==Y||e[42]!==g||e[43]!==C||e[44]!==U?(be=x=>{const{inputValue:f}=x,D=M(f);return U(D)?g.formatMessage(Q.shareProjectMemberAlreadyAdded):Y?t.jsx("span",{className:"text-[#E02E2A]",children:g.formatMessage(Q.shareProjectMismatchedDomainWarning,{domain:C!=null?C:""})}):xe.test(D)?g.formatMessage(Q.shareProjectInviteEmailPressEnter):g.formatMessage(Q.shareProjectEnterEmailNoOptions)},e[41]=Y,e[42]=g,e[43]=C,e[44]=U,e[45]=be):be=e[45];const Te=be;let Ee;e[46]!==v||e[47]!==ce||e[48]!==S||e[49]!==K||e[50]!==G||e[51]!==N||e[52]!==O||e[53]!==W?(Ee=x=>{if(x.nativeEvent.isComposing)return;const{key:f}=x,D=f===","||f===" "||f==="Spacebar"||f==="Space",F=f==="Enter",ke=f==="Tab";if(!(!D&&!F&&!ke)){if(G){x.preventDefault(),v(G),W(()=>{O("")}),N("");return}ke||xe.test(M(S))&&K(M(S))&&(x.preventDefault(),ce(S))}},e[46]=v,e[47]=ce,e[48]=S,e[49]=K,e[50]=G,e[51]=N,e[52]=O,e[53]=W,e[54]=Ee):Ee=e[54];const Se=Ee;let Ce;e[55]!==l||e[56]!==d||e[57]!==$?(Ce=$?t.jsx(rt,{capabilities:l,onChange:d,triggerClassNames:"text-token-text-secondary"}):void 0,e[55]=l,e[56]=d,e[57]=$,e[58]=Ce):Ce=e[58];const Me=Ce;let Ie;e[59]!==u||e[60]!==g||e[61]!==m||e[62]!==i?(Ie=x=>{var Ae,Ue;if(x.kind!=="email")return;const f=x.id,D=M(f),F=(Ue=(Ae=f.split("@")[1])==null?void 0:Ae.toLowerCase())!=null?Ue:"";if(i.current.has(D))return;const ke=m.length>0,ze=F!==""&&ke&&m.includes(F);return u===!1&&(F!==""&&!ze)?{tooltip:g.formatMessage(Q.shareProjectExternalInviteBlockedTooltip),tone:"danger",leadingIcon:t.jsx("span",{"aria-hidden":!0,className:"text-token-interactive-label-danger-secondary-default inline-flex h-4 w-4 shrink-0 items-center justify-center [&>svg]:h-4 [&>svg]:w-4",children:t.jsx(St,{className:"h-4 w-4","aria-hidden":!0})})}:{tooltip:g.formatMessage(Q.shareProjectExternalInviteNonMemberTooltip),leadingIcon:t.jsx("span",{"aria-hidden":!0,className:"text-token-text-tertiary inline-flex h-4 w-4 shrink-0 items-center justify-center [&>svg]:h-4 [&>svg]:w-4",children:t.jsx(Ct,{className:"h-4 w-4","aria-hidden":!0})})}},e[59]=u,e[60]=g,e[61]=m,e[62]=i,e[63]=Ie):Ie=e[63];const Pe=Ie;let ge;e[64]!==h?(ge=h==="denied"&&t.jsx("div",{className:"mb-3",children:t.jsx(Dt,{})}),e[64]=h,e[65]=ge):ge=e[65];let Ne;e[66]===Symbol.for("react.memo_cache_sentinel")?(Ne={menuList:Os,control:Rs},e[66]=Ne):Ne=e[66];let ue;e[67]!==n?(ue=x=>n([...x]),e[67]=n,e[68]=ue):ue=e[68];const Le=oe!=="",Re=re.isLoading||A;let fe;e[69]!==Te||e[70]!==me||e[71]!==Pe||e[72]!==ce||e[73]!==Se||e[74]!==ee||e[75]!==S||e[76]!==de||e[77]!==B||e[78]!==ne||e[79]!==r||e[80]!==ue||e[81]!==Le||e[82]!==Re||e[83]!==Me?(fe=t.jsx(ws,{value:r,classNames:Ne,onChange:ue,onSearch:ee,menuIsOpen:Le,inputValue:S,options:B,placeholder:ne,trailingComponent:Me,isLoading:Re,noOptionsMessage:Te,onCreateOption:ce,isValidNewOption:de,formatCreateLabel:me,getMultiValueConfig:Pe,onKeyDown:Se}),e[69]=Te,e[70]=me,e[71]=Pe,e[72]=ce,e[73]=Se,e[74]=ee,e[75]=S,e[76]=de,e[77]=B,e[78]=ne,e[79]=r,e[80]=ue,e[81]=Le,e[82]=Re,e[83]=Me,e[84]=fe):fe=e[84];let je;return e[85]!==ge||e[86]!==fe?(je=t.jsxs("div",{className:"w-full min-w-0",children:[ge,fe]}),e[85]=ge,e[86]=fe,e[87]=je):je=e[87],je}function Rs(){return"h-auto! min-h-[40px]! max-h-[192px] items-start overflow-y-auto p-1! cursor-text!"}function Os(){return"bg-token-bg-primary"}function Ws(s){const e=new Set,a=[];for(const c of s){const l=c.toLowerCase();e.has(l)||(e.add(l),a.push(l))}return a}function Ds(s){"use forget";const e=ye.c(15),{capabilities:a,setCapabilities:c,emails:l,setEmails:d}=s,r=ve();let n;e[0]!==l?(n=l.map(Bs),e[0]=l,e[1]=n):n=e[1];const p=n;let u;e[2]!==d?(u=I=>{const T=I.map(Vs);d(Ws(T))},e[2]=d,e[3]=u):u=e[3];const m=u;let i;e[4]!==r?(i=r.formatMessage(Q.shareProjectEmailPlaceholder),e[4]=r,e[5]=i):i=e[5];const _=i,w=Us;let h;e[6]===Symbol.for("react.memo_cache_sentinel")?(h={menuList:As,control:Ts},e[6]=h):h=e[6];let j;e[7]!==a||e[8]!==c?(j=t.jsx(rt,{capabilities:a,onChange:c,triggerClassNames:"text-token-text-secondary"}),e[7]=a,e[8]=c,e[9]=j):j=e[9];let g;return e[10]!==p||e[11]!==m||e[12]!==_||e[13]!==j?(g=t.jsx("div",{className:"w-full min-w-0",children:t.jsx(ks,{value:p,onChange:m,placeholder:_,classNames:h,trailingComponent:j,shouldShowTrailingComponent:w})}),e[10]=p,e[11]=m,e[12]=_,e[13]=j,e[14]=g):g=e[14],g}function Ts(){return"h-auto! min-h-[40px]! max-h-[192px] items-start overflow-y-auto p-0! cursor-text!"}function As(){return"bg-token-bg-primary"}function Us(s,e){return s&&s.length>0?!0:!!(e&&xe.test(e))}function Vs(s){return s.value}function Bs(s){return js(s!=null?s:"")}const Qs=at(()=>st(()=>import("./fykx19ay6ryg125w.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.ShareOutsideWorkspaceConfirmModal)),zs=at(()=>st(()=>import("./glx45q10lwleb6ms.js"),__vite__mapDeps([4,1])).then(s=>s.DirectorySyncResourceManagedIndication));function Tt(s,e){return s===void 0||e===void 0?!1:s.split("__")[0]===e.split("__")[0]}function qs(s,e){return s===void 0||e===void 0?!1:M(s)===M(e)}function jt(s,e){return Tt(s==null?void 0:s.user_id,e==null?void 0:e.id)||qs(s==null?void 0:s.user_email,e==null?void 0:e.email)}function Ks(s,e){const a=new Set,c=new Set,l=new Set,d=new Set,r=[...s];for(const n of s)n.type===b.USER?a.add(n.user_id):n.type===b.EMAIL?l.add(n.user_email):n.type===b.GROUP?c.add(n.group_id):d.add(n.type);for(const n of e)if(n.type===b.EMAIL){if(l.has(n.user_email))continue;l.add(n.user_email),r.push(n)}else if(n.type===b.USER){if(a.has(n.user_id))continue;a.add(n.user_id),r.push(n)}else if(n.type===b.GROUP){if(c.has(n.group_id))continue;c.add(n.group_id),r.push(n)}else{if(d.has(n.type))continue;d.add(n.type),r.push(n)}return r}function $s(s,e){const a=s.filter(c=>cs(c));return e!=null&&a.push(e),a}function Fs(s){return s.some(e=>e.type===b.ALL)?Xe.Link:s.some(e=>e.type===b.WORKSPACE)?Xe.WorkspaceLink:Xe.Private}function Be(s){var e,a,c,l,d;return s.type===b.GROUP?(a=(e=s.group_name)!=null?e:s.group_id)!=null?a:"Unknown group":(d=(l=(c=s.user_name)!=null?c:s.user_email)!=null?l:s.user_id)!=null?d:"Unknown user"}function Hs(s){return s?s.filter(e=>e.status===ns.VERIFIED&&!!e.hostname).map(e=>e.hostname.toLowerCase()):[]}function Gs({subjects:s,allowExternalDomainInvites:e,normalizedVerifiedDomainHostnames:a,workspaceMembersByEmailRef:c}){var p,u;const l=[],d=new Set;let r=!1;const n=a.length>0;for(const m of s){if(m.kind!=="email")continue;const i=M(m.id),_=(u=(p=m.id.split("@")[1])==null?void 0:p.toLowerCase())!=null?u:"",w=c.current.has(i),h=_!==""&&n&&a.includes(_);if(e===!1&&!w&&(_!==""&&!h)){r=!0;continue}d.has(i)||(d.add(i),l.push(m.id))}return{uniquePendingExternalEmails:l,hasBlockedExternalEmails:r}}function Js(s){switch(s){case b.ALL:return"link";case b.WORKSPACE:return"workspaceLink";default:return"invite"}}function At(s){"use forget";const e=ye.c(4),{subjectType:a,workspaceName:c}=s;if(a===b.ALL){let d;return e[0]===Symbol.for("react.memo_cache_sentinel")?(d=t.jsx(E,{id:"Mr1Pk0",defaultMessage:"Anyone with a link"}),e[0]=d):d=e[0],d}if(a===b.WORKSPACE){let d;return e[1]!==c?(d=t.jsx(E,{id:"okIeDq",defaultMessage:"Anyone at {workspaceName} with the link",values:{workspaceName:c}}),e[1]=c,e[2]=d):d=e[2],d}let l;return e[3]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx(E,{id:"fAE/rP",defaultMessage:"Only those invited"}),e[3]=l):l=e[3],l}const kt=s=>e=>{var a,c;return e.kind==="user"?{type:b.USER,user_id:e.id,user_name:e.label,user_email:(a=e.sublabel)!=null?a:"",avatar_url:(c=e.avatarUrl)!=null?c:null,capabilities:s}:{type:b.GROUP,group_id:e.id,group_name:e.label,is_scim_managed:!!e.isScimManaged,capabilities:s}},vt=s=>e=>({type:b.EMAIL,user_email:e,capabilities:s});function pn({gizmo:s,publishedGizmo:e,onClose:a}){"use no forget";var ue,Le,Re,fe,je,x,f,D,F,ke,ze,Fe,Ae,Ue,ot,lt,ct,dt;const c=nt(),l=ve(),d=Mt(),r=Ft(c),n=wt(),p=q.useRef(new Map),u=n==null?void 0:n.id,m=(ue=r==null?void 0:r.isWorkspaceAccount())!=null?ue:!1,i=Ht(),_=l.formatMessage({id:"nJUofg",defaultMessage:"your workspace"}),w=(Le=n==null?void 0:n.name)!=null?Le:_,h=(Re=e.gizmo.display.name)!=null?Re:s.name,j=n==null?void 0:n.id,{data:g,isLoading:I}=Gt(j),T=(je=(fe=n==null?void 0:n.isEnterprisey)==null?void 0:fe.call(n))!=null?je:!1,z=((f=(x=n==null?void 0:n.isAdminOfAccount)==null?void 0:x.call(n))!=null?f:!1)||((F=(D=n==null?void 0:n.isOwnerOfAccount)==null?void 0:D.call(n))!=null?F:!1);let A="unknown";n==null||j==null?A="unknown":!m||!T||z?A="allowed":I?A="unknown":A=((ze=(ke=g==null?void 0:g.permissions)==null?void 0:ke.includes(Jt.MemberRoleView))!=null?ze:!1)?"allowed":"denied";const ee=Xt(),[S,B]=q.useState((Ae=(Fe=s.sharing)==null?void 0:Fe.subjects)!=null?Ae:[]),X=q.useMemo(()=>{const o=new Set;for(const y of S)(y.type===b.USER&&y.user_email||y.type===b.EMAIL)&&o.add(M(y.user_email));const k=e.gizmo.author.user_email;return k&&o.add(M(k)),o},[S,e.gizmo.author.user_email]),[N,O]=q.useState(!1),W=Kt(),{canEdit:re}=Zt(e);q.useEffect(()=>{W.invalidateQueries({queryKey:Yt(W,e.gizmo.id).queryKey})},[e.gizmo.id,W]);const oe=o=>{if(o.type===b.USER&&o.user_id.indexOf("__")===-1){const k=r==null?void 0:r.getWorkspaceId();return Ge(he({},o),{user_id:k!=null&&k.length>0?"".concat(o.user_id,"__").concat(k):o.user_id})}return o},L=async(o,k,y)=>{var Ve,Oe;if(N)return;O(!0);const R=k?y.map(oe):y,pe=Fs(R);try{const We=await ee.mutateAsync({id:o,update:{sharing:{recipient:pe,subjects:R}}});We!=null&&We.resource&&B(is(We.resource).sharing.subjects)}catch(We){const He=rs(We);d.warning(He!=null?He:"Error",{duration:2}),B((Oe=(Ve=s.sharing)==null?void 0:Ve.subjects)!=null?Oe:[])}O(!1),W.invalidateQueries({queryKey:["gizmos"]}),W.refetchQueries({queryKey:["gizmos","discovery"]}),W.refetchQueries({queryKey:["gizmo",{gizmoId:o}]}),W.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:o}]}),W.invalidateQueries({queryKey:["workspace"]}),ft.count(pt.PROJECTS,"snorlax_share_project_modal_invited_users",{is_workspace_sharing:k?"true":"false",num_users_invited:y.length.toString(),recipient:pe})},Z=Tt(e.gizmo.author.user_id.split("__")[0],i==null?void 0:i.id),C=It(S),te=(C==null?void 0:C.type)!==b.WORKSPACE&&(C==null?void 0:C.type)!==b.ALL,se=te?Pt:m?Nt:Lt,ne=t.jsx(E,{id:"wDjvNM",defaultMessage:"Only the owner can change permissions. Contact them if you'd like to update someone's access."}),Y=t.jsx(tt,{label:ne,side:"top",children:t.jsx(At,{subjectType:C==null?void 0:C.type,workspaceName:w})}),le=o=>t.jsx(tt,{label:ne,side:"top",children:t.jsx("span",{className:"text-token-text-primary pe-4 text-sm",children:t.jsx(E,he({},$e(o.capabilities)))})}),H=at(()=>st(()=>import("./orp3d1dh54xbr7c3.js"),__vite__mapDeps([5,1,2,3])).then(o=>o.SnorlaxRemoveUserConfirmationModal)),K=o=>t.jsxs(P.Root,{children:[t.jsxs(P.Trigger,{color:"secondary",className:"text-token-text-primary text-normal hover:bg-token-interactive-bg-secondary-hover radix-state-open:bg-token-interactive-bg-secondary-press whitespace-nowrap",disabled:N,children:[t.jsx(E,he({},$e(o.capabilities))),t.jsx(it,{className:"icon-sm"})]}),t.jsx(P.Portal,{children:t.jsxs(P.Content,{className:"max-w-[320px]",children:[t.jsx(P.RadioGroup,{value:Cs(o.capabilities),onValueChange:k=>{const y=S.map(R=>R===o?Ge(he({},R),{capabilities:k==="edit"?Qe:De}):R);B(y),L(e.gizmo.id,m,y)},children:[De,Qe].map((k,y)=>t.jsx(Ot,{capabilities:k,selected:bt(k,o.capabilities)},y))}),t.jsx(P.Item,{onClick:()=>{var y;const k=ht(o);xt(c,H,{label:(y=k==null?void 0:k.label)!=null?y:k==null?void 0:k.sublabel,projectName:e.gizmo.display.name,onConfirm:async()=>{const R=S.filter(pe=>pe!==o);B(R),await L(e.gizmo.id,m,R),yt(c,H)},onClose:()=>yt(c,H)})},color:"danger",icon:gs,children:t.jsx(E,{id:"HEaMqG",defaultMessage:"Remove from project"})})]})})]}),[$,ae]=q.useState(Qe),[G,J]=q.useState([]),[U,ie]=q.useState([]),v=G.length>0||U.length>0,{data:V}=fs(u!=null?u:void 0,u!=null),ce=V==null?void 0:V.allow_external_domain_invites,_e=Hs(V==null?void 0:V.domains),{uniquePendingExternalEmails:de,hasBlockedExternalEmails:we}=Gs({subjects:G,allowExternalDomainInvites:ce,normalizedVerifiedDomainHostnames:_e,workspaceMembersByEmailRef:p}),me=m&&es(c,"1585040960").get("enabled",!1),be=o=>{!me||o<=0||qe.logEventWithStatsig("Share Project: Workspace Invite Sent","chatgpt_share_project_workspace_invite_sent",he({invite_count:o,project_id:e.gizmo.id},u?{workspace_account_id:u}:{}))},Te=async o=>{if(!u||o.length===0)return;const k=l.formatMessage({id:"v0nBhH",defaultMessage:"We couldn't send those workspace invites. Try again."});try{const{errored_emails:y=[]}=await Et.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:u}},requestBody:{email_addresses:o,role:ds.STANDARD,resend_emails:!1}});if(y.length>0){const R=l.formatMessage({id:"+HIh5u",defaultMessage:"We couldn't invite: {emails}."},{emails:y.map(pe=>pe.email_address).join(", ")});throw new Error(R)}}catch(y){const R=y instanceof Error&&y.message?y.message:k;throw d.danger(R,{loggingTitle:R,loggingDescription:y instanceof Error?y.message:void 0,toastId:"share-project-workspace-invite"}),y}},Ee=async()=>{const k=m?(R=>{if(me){const pe=[],Ve=[];for(const Oe of R)Oe.kind==="email"?Ve.push(Oe.id):pe.push(Oe);return[...pe.map(kt($)),...Ve.map(vt($))]}return R.map(kt($))})(G):U.map(vt($)),y=Ks(S,k);B(y),await L(e.gizmo.id,m,y),ie([]),J([])},Se=N||me&&we,Ce=async()=>{await Te(de),be(de.length);const o=new Set(de.map(k=>M(k)));J(k=>k.filter(R=>R.kind!=="email"?!0:!o.has(M(R.id))))},Me=async()=>{if(me&&de.length>0){xt(c,Qs,{emails:de,workspaceName:w,onSend:async()=>{await Ce()}});return}await Ee()},Ie=()=>{J([]),ie([])},Pe=t.jsx(Je,{color:"secondary",disabled:N,onClick:Ie,children:t.jsx(E,{id:"Pxo4Mv",defaultMessage:"Cancel"})}),ge=m?t.jsx("div",{className:"text-token-text-secondary flex text-xs",children:t.jsx(E,{id:"uAtWCq",defaultMessage:"Project files, chats, and instructions are shared."})}):null,Ne=v&&re?m?t.jsxs("div",{className:"flex items-center gap-2",children:[Pe,t.jsx(Je,{color:"blue",disabled:Se,loading:N,onClick:Me,children:t.jsx(E,{id:"BdwAiM",defaultMessage:"Invite"})})]}):t.jsxs("div",{className:"flex items-center gap-2",children:[Pe,t.jsx(Je,{color:"blue",disabled:Se,loading:N,onClick:Me,children:t.jsx(E,{id:"n1mfg+",defaultMessage:"Invite"})})]}):t.jsx(Zs,{gizmo:e,isBusinessWorkspace:m});return q.useEffect(()=>{ft.count(pt.PROJECTS,"snorlax_share_project_modal_opened")},[]),t.jsx(ts,{testId:"modal-share-project",type:"success",className:"max-w-[512px]",size:"custom",isOpen:!0,onClose:a,footerContent:ge,footerClassName:"mt-5 sm:mt-4",modalActionsClassName:"mt-0!",footerIsSpacedBetween:!0,primaryButton:Ne,title:l.formatMessage(Q.projectShareTitle,{projectName:h}),showCloseButton:!0,children:t.jsxs("div",{className:"flex flex-col space-y-4",children:[re&&(m?me?t.jsx(Ls,{publishedGizmo:e,memberListAccess:A,capabilities:$,setCapabilities:ae,subjects:G,setSubjects:J,existingMemberEmails:X,allowExternalDomainInvites:ce,normalizedVerifiedDomainHostnames:_e,workspaceMembersByEmailRef:p,isFreeWorkspace:(Ue=r==null?void 0:r.isFreeWorkspace())!=null?Ue:!1,currentUserEmail:i==null?void 0:i.email}):t.jsx(Is,{publishedGizmo:e,memberListAccess:A,capabilities:$,setCapabilities:ae,subjects:G,setSubjects:J,workspaceMembersByEmailRef:p}):t.jsx(Ds,{capabilities:$,setCapabilities:ae,emails:U,setEmails:ie})),t.jsx("div",{className:"text-token-text-secondary mb-2 text-sm font-normal",children:t.jsx(E,{id:"eMoeS0",defaultMessage:"Who has access"})}),t.jsxs(ps,{className:"max-h-[220px] overflow-y-auto",children:[t.jsx(Ye,{icon:t.jsx("div",{className:"flex h-6 w-6 items-center justify-center",children:t.jsx(se,{className:te?"h-5 w-5":"h-6 w-6"})}),children:Z?t.jsx(Ys,{newSharingSubjects:S,setNewSharingSubjects:B,saveProject:L,publishedGizmo:e,isBusinessWorkspace:m,isSaving:N,workspaceName:w}):Y}),t.jsx(Ye,{icon:t.jsx(gt,{monogram:{id:(ot=e.gizmo.author.user_id)!=null?ot:"Owner",label:(lt=e.gizmo.author.display_name)!=null?lt:"User",sublabel:e.gizmo.author.user_email},showTooltip:!m}),trailing:t.jsx("span",{className:"text-token-text-primary pe-4 text-sm",children:t.jsx(E,{id:"qb439J",defaultMessage:"Owner"})}),children:Z?t.jsx(E,{id:"I6hNog",defaultMessage:"{userName} {you}",values:{userName:(ct=i==null?void 0:i.name)!=null?ct:i==null?void 0:i.email,you:t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(E,{id:"VZNoWp",defaultMessage:"(you)"})})}}):(dt=e.gizmo.author.display_name)!=null?dt:e.gizmo.author.user_email}),S.map((o,k)=>{var R;const y=o.type===b.EMAIL;return ss(o)&&t.jsx(Ye,{icon:t.jsx(gt,{monogram:ht(o),showTooltip:(o==null?void 0:o.user_name)&&(o==null?void 0:o.user_email)}),trailing:Z?K(o):le(o),disabled:y,children:t.jsxs("div",{className:"flex flex-col justify-center",children:[m&&t.jsxs("span",{className:"flex flex-row items-center",children:[t.jsx("span",{className:et("truncate text-sm leading-tight",y?"text-token-text-secondary":"text-token-text-primary"),children:o.type===b.GROUP?o.group_name:y?Be(o):t.jsx(E,{id:"B3bf3E",defaultMessage:"{userName} {you}",values:{userName:Be(o),you:jt(o,i)?t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(E,{id:"VZNoWp",defaultMessage:"(you)"})}):null}})}),o.type===b.GROUP&&o.is_scim_managed&&t.jsx(zs,{})]}),!m&&t.jsx("span",{className:et("group-data-[disabled]/sharing-row:text-token-text-tertiary truncate text-sm leading-tight",y?"text-token-text-secondary":"text-token-text-primary"),children:jt(o,i)?t.jsx(E,{id:"hxmjY2",defaultMessage:"{user} {you}",values:{user:Be(o),you:t.jsx("span",{className:"text-token-text-secondary group-data-[disabled]/sharing-row:text-token-text-tertiary",children:t.jsx(E,{id:"VZNoWp",defaultMessage:"(you)"})})}}):y?t.jsx(E,{id:"L+nbVd",defaultMessage:"{email} {maybe_invite_sent}",values:{email:(R=o.user_email)!=null?R:Be(o),maybe_invite_sent:t.jsx("span",{className:"text-token-text-secondary group-data-[disabled]/sharing-row:text-token-text-tertiary",children:t.jsx(E,{id:"FkuKTS",defaultMessage:"(invite sent)"})})}}):Be(o)})]})},k)}),t.jsx("hr",{className:"border-token-border-light sticky bottom-0 hidden group-data-scrolled-from-end/scrollport:block"})]}),!m&&t.jsx(Xs,{})]})})}function Xs(){return t.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-3 rounded-xl p-3",children:[t.jsx(Ct,{className:"icon text-token-text-secondary"}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-token-text-primary text-xs font-medium",children:t.jsx(E,{id:"pD1bmW",defaultMessage:"This project may include personal information"})}),t.jsx("span",{className:"text-token-text-secondary text-xs",children:t.jsx(E,{id:"EonGo6",defaultMessage:"All project contents are visible to collaborators. Personal memories are disabled for shared projects."})})]})]})}function Zs({gizmo:s,isBusinessWorkspace:e}){const a=nt(),c=Mt(),l=os(a,s),d=s.gizmo.display.name;return t.jsxs("div",{className:"flex flex-row items-center gap-2",children:[!e&&t.jsxs(t.Fragment,{children:[t.jsx("a",{href:"https://www.linkedin.com/shareArticle?url=".concat(encodeURIComponent(l),"&text=").concat(encodeURIComponent(d)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{qe.logEventWithStatsig("Share Project: LinkedIn Social Clicked","chatgpt_share_project_linkedin_social_clicked",{projectTitle:d})},children:t.jsx(hs,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})}),t.jsx("a",{href:"https://www.reddit.com/submit?url=".concat(encodeURIComponent(l),"&title=").concat(encodeURIComponent(d)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{qe.logEventWithStatsig("Share Project: Reddit Social Clicked","chatgpt_share_project_reddit_social_clicked",{projectTitle:d})},children:t.jsx(xs,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})}),t.jsx("a",{href:"https://twitter.com/intent/tweet?url=".concat(encodeURIComponent(l),"&text=").concat(encodeURIComponent(d)),target:"_blank",rel:"noopener noreferrer",onClick:()=>{qe.logEventWithStatsig("Share Project: X Social Clicked","chatgpt_share_project_x_social_clicked",{projectTitle:d})},children:t.jsx(ys,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)",size:36})})]}),t.jsx(_s,{onClickCopy:r=>ls(a,s,c,r)})]})}function Ys({newSharingSubjects:s,setNewSharingSubjects:e,saveProject:a,publishedGizmo:c,isBusinessWorkspace:l,isSaving:d,workspaceName:r}){var _;const n=ve(),p=(_=It(s))==null?void 0:_.type,u=p===b.WORKSPACE,m=p===b.ALL,i=u||m;return t.jsxs(P.Root,{children:[t.jsx(tt,{label:t.jsx(E,{id:"gWJtAX",defaultMessage:"Shared links give chat-only access. Users can be upgraded to edit access after joining."}),triggerAs:null,disabled:!i,side:"top",children:t.jsxs(P.Trigger,{className:"px-0","data-no-hover-bg":!0,disabled:d,children:[t.jsx(At,{subjectType:p,workspaceName:r}),t.jsx(it,{className:"icon-sm"})]})}),t.jsx(P.Portal,{children:t.jsx(P.Content,{children:t.jsxs(P.RadioGroup,{value:Js(p),onValueChange:w=>{const h=$s(s,w==="link"?{type:b.ALL,capabilities:De}:w==="workspaceLink"?{type:b.WORKSPACE,capabilities:De}:null);e(h),a(c.gizmo.id,l,h)},children:[t.jsx(P.RadioItem,{icon:Pt,value:"invite",label:n.formatMessage({id:"fAE/rP",defaultMessage:"Only those invited"}),trailing:t.jsx(P.RadioItemCheck,{}),color:i?"default":"selected"}),l&&t.jsx(P.RadioItem,{icon:Nt,value:"workspaceLink",label:n.formatMessage({id:"a6GwHG",defaultMessage:"Anyone at {workspaceName} with the link"},{workspaceName:r}),trailing:t.jsx(P.RadioItemCheck,{}),color:u?"selected":"default"}),!l&&t.jsx(P.RadioItem,{icon:Lt,value:"link",label:n.formatMessage({id:"Mr1Pk0",defaultMessage:"Anyone with a link"}),trailing:t.jsx(P.RadioItemCheck,{}),color:m?"selected":"default"})]})})})]})}function Ye({icon:s,children:e,trailing:a,className:c="",disabled:l=!1}){return t.jsxs("div",{className:"mb-1 flex min-h-9 flex-row items-center justify-between space-x-2 ".concat(c," group/sharing-row"),"data-disabled":as(l),children:[t.jsx("div",{className:"shrink-0 grow-0",children:s}),t.jsx("div",{className:"text-token-text-primary grow truncate text-sm",children:e}),a&&t.jsx("div",{children:a})]})}export{pn as ShareProjectModal};
//# sourceMappingURL=bg41hz7jg49p6v5w.js.map
