import{r as E,e as $,j as i,f as q}from"./fg33krlcm0qyi6yw.js";import{ac as K,c_ as V,k1 as B,go as J,mg as X,k2 as Q,k3 as Y,l as p,c0 as Z,nW as D,hK as R}from"./mtk1qztvnb31pw5r.js";import{iK as _,iL as ee,iM as se,eJ as ae,eX as te,iN as ne,iO as oe,iP as re}from"./k65njl5wlgspihfr.js";function ie({asset:a,isOptimisticPlaceholder:t=!1,contextConnectorSourceUrl:l,disableExpandable:u=!1,isSingle:d,isUserTurn:m,className:n}){var b,U;const c=K().flags,[f,s]=E.useState(!1),o=!V(),r=c==null?void 0:c.includes(B.NoAuthEnableFileUploads),h=J(a.asset_pointer),e=_.useState(P=>_.selectFile(P,h)),M=ee((b=e==null?void 0:e.file)!=null?b:null,e==null?void 0:e.file.name,(U=e==null?void 0:e.fileId)!=null?U:void 0,e==null?void 0:e.gizmoId,e==null?void 0:e.contextConnectorInfo,!0,t),F=t?!0:o&&e&&r,{gizmoEditorData:x}=X(),v=se(),T=E.useContext(Q),G=(T==null?void 0:T.serverSharedThreadId)&&m,z=Y(),{isOpen:O}=ae(),j=$(),{data:y,isLoading:W,error:H}=te({asset:a,gizmoId:x==null?void 0:x.id,getServerUrl:!F}),{url:S,width:w,height:C}=M&&(r!=null?r:t)?{width:a.width,height:a.height,url:M}:y!=null?y:{},A=W||!f,I=w&&C?{Landscape:w>C,Portrait:w<C}:void 0,g=["overflow-hidden rounded-lg"];if(d&&(g.push("w-full h-full"),I!=null&&I.Landscape?g.push("max-w-96 max-h-64"):I!=null&&I.Portrait?g.push("max-h-96 max-w-64"):g.push("max-w-64 max-h-64")),n&&g.unshift(n),G&&z())return null;let L;return S!=null&&(L=i.jsx(ne,{alt:j.formatMessage(N.imageAltText),className:p(O?"max-w-[88px]":"max-w-full",!d&&"aspect-square","object-cover object-center",g),src:S,width:w,height:C,onLoad:()=>s(!0)}),!v&&!u&&(L=i.jsx(oe,{src:S,alt:j.formatMessage(N.imageAltText),contextConnectorSourceUrl:l,className:p(g),children:L}))),i.jsx("div",{className:p(g),children:i.jsx("div",{className:p("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!d&&"aspect-square"),children:S!=null?L:i.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:"".concat(w," / ").concat(C),width:w},title:A?j.formatMessage(N.loadingImage):j.formatMessage(N.errorLoadingImage),children:A?i.jsx(Z,{}):H?i.jsx(D,{className:"icon-sm"}):null})})})}const N=q({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function k({assets:a,attachments:t,isUserTurn:l=!0,clientThreadId:u,isOptimisticPlaceholder:d=!1}){const m=a.length===1,{containerClassname:n,imageClassnames:c}=k.computeClassnames(a.length);let f=R.ATTACHMENT;return a&&!(t&&t.length>0)&&(f=R.IMAGE),i.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[i.jsx("div",{className:p("flex flex-row items-center justify-end gap-1",n),children:a.map((s,o)=>{var h;const r=t==null?void 0:t.find(e=>e.id&&s.asset_pointer.includes(e.id));return i.jsx(ie,{asset:s,isSingle:m,isOptimisticPlaceholder:d,isUserTurn:l,contextConnectorSourceUrl:(h=r==null?void 0:r.context_connector_info)==null?void 0:h.source_url,className:c[o]},o)})}),i.jsx(re,{featureType:f,isUserTurn:l,clientThreadId:u})]})}k.computeClassnames=a=>{if(a<2)return{containerClassname:null,imageClassnames:[]};let t=a>=4?"flex-wrap":"";const l=Array(a),u=s=>{l.fill(s)},d=s=>{t+=" ".concat(s)},m=(s,o)=>{l[s]=p(l[s],o)},n=a<=4&&a%2===0?2:3,c=Math.ceil(a/n),f=a%n!==0;n===2?(u("h-32 w-32"),d("max-w-72")):c<=2?(u("h-24 w-24 sm:h-32 sm:w-32"),d("max-w-80 sm:max-w-100")):(u("h-16 w-16"),d("max-w-52"));for(let s=0;s<a;s++){const o=Math.floor(s/n),r=s%n,h=Math.min(a-o*n,n),e=o===0,M=o===c-1,F=o===c-2,x=r===0,v=r===h-1;e&&x&&m(s,"rounded-ss-2xl"),e&&v&&m(s,"rounded-se-2xl"),M&&x&&m(s,"rounded-es-2xl"),M&&v&&m(s,"rounded-ee-sm"),f&&x&&F&&m(s,"rounded-es-2xl")}return{containerClassname:t,imageClassnames:l}};export{k as TextMessageImageGroup};
//# sourceMappingURL=mhbidwr95qkcx6r6.js.map
