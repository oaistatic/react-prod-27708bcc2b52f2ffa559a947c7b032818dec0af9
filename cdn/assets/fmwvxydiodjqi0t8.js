var Gs=Object.defineProperty,zs=Object.defineProperties;var Us=Object.getOwnPropertyDescriptors;var bs=Object.getOwnPropertySymbols;var Vs=Object.prototype.hasOwnProperty,Ks=Object.prototype.propertyIsEnumerable;var ys=(t,e,n)=>e in t?Gs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ms=(t,e)=>{for(var n in e||(e={}))Vs.call(e,n)&&ys(t,n,e[n]);if(bs)for(var n of bs(e))Ks.call(e,n)&&ys(t,n,e[n]);return t},Cs=(t,e)=>zs(t,Us(e));import{g as Xs,h as Ut,A as Oe,i as ee,j as ze,E as Ts}from"./f96c6fguu1kcw0go.js";import{b as Zs,S as xs,r as kt,d as js,g as Fs,a as Ue}from"./ej6tlexkw0sv7caa.js";import{C as Fe}from"./nb22pb07i8ebbv0i.js";const qs=80,Qs=15,ut=40,bt=20;function kl(t){return t==null||t===0?qs:Math.round(t*7)}function Ol(t){const e=t==null||t===0?Qs:t;return Math.round(e*96/72)}function ae(t){let e="";for(t+=1;t;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-n)/26)}return e}function J(t){const e=t.match(/[A-Z]+/);if(!e)return 0;let n=0;for(const o of e[0])n=n*26+(o.charCodeAt(0)-64);return n-1}function Mt(t){const e=t.match(/\d+/);return e?parseInt(e[0],10)-1:0}function Ss(t){const e=t.replace(/^0x/i,"");if(e.length===8){const o=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16),l=parseInt(e.slice(6,8),16);return"rgba(".concat(o,", ").concat(r,", ").concat(l,", ").concat(1 .toFixed(3),")")}return e.length===6?"#".concat(e):"#ffffff"}function Se(t){return t==null?void 0:t===64?"#000000":["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"][t]}const As=xs.get_table(),ws={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Js(t){const e=t.replace(/^#/,"");if(e.length!==6)return null;const n=parseInt(e.slice(0,2),16),o=parseInt(e.slice(2,4),16),r=parseInt(e.slice(4,6),16);return{r:n,g:o,b:r}}function tl(t,e,n){t/=255,e/=255,n/=255;const o=Math.max(t,e,n),r=Math.min(t,e,n);let l=0,c=0;const u=(o+r)/2;if(o!==r){const y=o-r;switch(c=u>.5?y/(2-o-r):y/(o+r),o){case t:l=(e-n)/y+(e<n?6:0);break;case e:l=(n-t)/y+2;break;case n:l=(t-e)/y+4;break}l/=6}return{h:l,s:c,l:u}}function el(t,e,n){let o,r,l;if(e===0)o=r=l=n;else{const c=(L,S,C)=>(C<0&&(C+=1),C>1&&(C-=1),C<.16666666666666666?L+(S-L)*6*C:C<.5?S:C<.6666666666666666?L+(S-L)*(.6666666666666666-C)*6:L),u=n<.5?n*(1+e):n+e-n*e,y=2*n-u;o=c(y,u,t+1/3),r=c(y,u,t),l=c(y,u,t-1/3)}return{r:Math.round(o*255),g:Math.round(r*255),b:Math.round(l*255)}}function nl(t,e){const n=Js(t);if(!n)return t;const{h:o,s:r,l}=tl(n.r,n.g,n.b),c=e/1e5,u=c>=0?l+(1-l)*c:l*(1+c),{r:y,g:L,b:S}=el(o,r,Math.max(0,Math.min(1,u))),C=W=>W.toString(16).padStart(2,"0");return"#".concat(C(y)).concat(C(L)).concat(C(S))}function Rs(t,e,n,o,r,l){var u,y,L,S,C,W,B,tt,v,$,A,dt,mt,Ct,vt,Tt,Lt,Ot,At,Rt;if(!t||!e)return;const c=!o||t.applyAlignment||t.applyAlignment===void 0;if(t.numFmtId!=null){n.numberFormatId=t.numFmtId;const d=(u=e.numberFormats)==null?void 0:u.find(st=>st.id===t.numFmtId);d!=null&&d.formatCode?n.numberFormatCode=d.formatCode:As[t.numFmtId]?n.numberFormatCode=As[t.numFmtId]:ws[t.numFmtId]?n.numberFormatCode=ws[t.numFmtId]:n.numberFormatCode=void 0}if(t.fillId!=null&&(!o||t.applyFill||t.applyFill===void 0)){const d=(y=e.fills)==null?void 0:y[t.fillId],T=((L=d==null?void 0:d.pattern)==null?void 0:L.patternType)===Xs.PATTERN_TYPE_SOLID,lt=!!(d!=null&&d.color||(S=d==null?void 0:d.pattern)!=null&&S.color);if(d!=null&&d.color){const wt=kt(d.color,r);wt&&(n.fill=wt)}else{const wt=(W=(C=d==null?void 0:d.pattern)==null?void 0:C.color)==null?void 0:W.value;wt?n.fill=Ss(wt):T&&!lt&&(n.fill="#000000")}}if(t.fontId!=null&&((B=!o||t.applyFont)==null||B)){const d=e.fonts[t.fontId],st=(tt=n.font)!=null?tt:n.font={};if(typeof(d==null?void 0:d.fontSize)=="number"){const lt=d.fontSize*1.3333333333333333;st.size=lt}st.bold=(v=d==null?void 0:d.bold)!=null?v:st.bold,st.italic=($=d==null?void 0:d.italic)!=null?$:st.italic,st.family=d!=null&&d.name?d.name:st.family;const T=(dt=(A=d==null?void 0:d.fill)==null?void 0:A.color)!=null?dt:d==null?void 0:d.color;if(T){let lt;if(T.type===Ut.COLOR_TYPE_SYSTEM&&typeof T.value=="string"){if(T.value==="auto")lt="#000000";else if(T.value.startsWith("indexed:")){const wt=parseInt((mt=T.value.split(":")[1])!=null?mt:"",10);Number.isNaN(wt)||(lt=Se(wt))}}lt||(lt=kt(T,r)),lt&&(st.color=lt,n.textColor=lt)}}if(t.horizontalAlignment&&c)switch(t.horizontalAlignment){case"left":case"center":case"right":n.align=t.horizontalAlignment;break}if(t.verticalAlignment&&c)switch(String(t.verticalAlignment).toLowerCase()){case"top":n.verticalAlign=Oe.ANCHOR_TYPE_TOP;break;case"center":n.verticalAlign=Oe.ANCHOR_TYPE_MIDDLE;break;case"bottom":n.verticalAlign=Oe.ANCHOR_TYPE_BOTTOM;break}if(t.wrapText!==void 0&&c&&(n.wrapText=t.wrapText),t.borderId!=null&&(!o||t.applyBorder||t.applyBorder===void 0)){const d=e.borders[t.borderId];if(d){(Ct=n.borders)!=null||(n.borders={}),(vt=n.borderStyles)!=null||(n.borderStyles={});const st=(T,lt)=>{var Ht,Vt;if(T){const Wt=T.type===Ut.COLOR_TYPE_SYSTEM,x=T.value;if(T.type===Ut.COLOR_TYPE_SCHEME&&typeof x=="string"&&x.startsWith("theme:")){const Y=parseInt((Ht=x.split(":")[1])!=null?Ht:"",10);if(!Number.isNaN(Y)){const Bt=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"][Y];if(Bt){const Pt=r.colorMap[Bt];if(Pt)return(Vt=T.transform)!=null&&Vt.tint?nl(Pt,T.transform.tint):Pt}else{const Pt=kt(T,r);if(Pt)return Pt}}}if(T.type===Ut.COLOR_TYPE_RGB&&typeof x=="string"){const Y=x.replace(/^#/i,"");if(Y.length===8)return Ss(Y);if(Y.length===6)return"#".concat(Y)}if(Wt&&(x!=null&&x.startsWith("indexed:")||x==="auto")){const Y=Se(lt);if(Y)return Y}return kt(T,r)}return Se(lt)};if((Tt=d.left)!=null&&Tt.style){let T=st(d.left.color,d.left.indexedColorId);T||(T="#000000"),T&&(n.borders.left=T),n.borderStyles.left=d.left.style}if((Lt=d.right)!=null&&Lt.style){let T=st(d.right.color,d.right.indexedColorId);T||(T="#000000"),T&&(n.borders.right=T),n.borderStyles.right=d.right.style}if((Ot=d.top)!=null&&Ot.style){let T=st(d.top.color,d.top.indexedColorId);T||(T="#000000"),T&&(n.borders.top=T),n.borderStyles.top=d.top.style}if((At=d.bottom)!=null&&At.style){let T=st(d.bottom.color,d.bottom.indexedColorId);T||(T="#000000"),T&&(n.borders.bottom=T),n.borderStyles.bottom=d.bottom.style}if((Rt=d.diagonal)!=null&&Rt.style){let T=st(d.diagonal.color,d.diagonal.indexedColorId);T||(T="#000000"),T&&(n.borders.diagonal=T),n.borderStyles.diagonal=d.diagonal.style}d.diagonalUp!=null&&(n.borderDiagonalUp=!!d.diagonalUp),d.diagonalDown!=null&&(n.borderDiagonalDown=!!d.diagonalDown)}}}function Bl(t){const{styles:e}=t,n=Zs(t.theme),o={};return e&&e.cellXfs.forEach((r,l)=>{var u;const c={};if(r.xfId!=null&&e.cellStyleXfs&&e.cellStyleXfs[r.xfId]){const y=(u=e.cellStyleXfs[r.xfId])==null?void 0:u.format;Rs(y,e,c,!1,n)}Rs(r,e,c,!0,n),o[l]=c}),o}const he=t=>t/9525,Es=t=>{if(t==null)return null;const e=typeof t=="number"?t:Number(t);return Number.isFinite(e)?e:null};function ol(t,e,n,o,r,l,c,u,y,L,S){if(!e.drawings||e.drawings.length===0)return;const C=sl(n);for(const W of e.drawings){if(!W.chart||!W.fromAnchor)continue;rl(W.chart,e,C);const B=Number(W.fromAnchor.colId),tt=Number(W.fromAnchor.rowId),v=W.toAnchor,$=o[B],A=r[tt];if($===void 0||A===void 0)continue;const dt=ut+$+he(Number(W.fromAnchor.colOffset))-l,mt=bt+A+he(Number(W.fromAnchor.rowOffset))-c;let Ct=null,vt=null;if(v){const Lt=Number(v.colId),Ot=Number(v.rowId)-1,At=o[Lt],Rt=r[Ot];if(At===void 0||Rt===void 0)continue;Ct=ut+At+he(Number(v.colOffset))-l,vt=bt+Rt+he(Number(v.rowOffset))-c}else{const Lt=Es(W.extentCx),Ot=Es(W.extentCy);if(Lt==null||Ot==null)continue;const At=he(Lt),Rt=he(Ot);if(At<=0||Rt<=0)continue;Ct=dt+At,vt=mt+Rt}if(Ct==null||vt==null||Ct<0||vt<0||dt>u||mt>y)continue;const Tt={x:dt,y:mt,width:Ct-dt,height:vt-mt};Tt.width<=0||Tt.height<=0||js(t,W.chart,Tt,{themeMap:L,excelDefaults:!0})}}function rl(t,e,n){var o,r;if(!(!t||!Array.isArray(t.series))){for(const l of t.series)if(l){if(l.values.length===0&&l.formula){const c=ll(l.formula,n,e);c.length>0&&(l.values=c)}if(l.categories.length===0&&l.categoryFormula){const c=Ns(l.categoryFormula,n,e);c.length>0&&(l.categories=c)}}if(t.categories.length===0){const l=(r=(o=t.series.find(c=>c.categories.length>0))==null?void 0:o.categories)!=null?r:(()=>{var u;const c=(u=t.series[0])==null?void 0:u.categoryFormula;return c?Ns(c,n,e):[]})();l.length>0&&(t.categories=[...l])}}}function sl(t){var n;const e=new Map;for(const o of(n=t.sheets)!=null?n:[]){const r=Hs(o==null?void 0:o.name);r&&o&&e.set(r,o)}return e}function Hs(t){if(!t)return null;const e=t.trim();return e?e.toLowerCase():null}function ll(t,e,n){return Ws(t,e,n,o=>{if(!o||o.value==null||o.value==="")return Number.NaN;if(typeof o.value=="number")return o.value;if(typeof o.value=="string"){const r=o.value.trim();if(!r)return Number.NaN;const l=Number(r);return Number.isFinite(l)?l:Number.NaN}return Number.NaN})}function Ns(t,e,n){return Ws(t,e,n,o=>!o||o.value==null?"":typeof o.value=="string"?o.value:typeof o.value=="number"?String(o.value):"")}function Ws(t,e,n,o){const r=il(t);if(!r)return[];const l=cl(e,r.sheetName,n),c=[];for(let u=r.startRow;u<=r.endRow;u++)for(let y=r.startCol;y<=r.endCol;y++)c.push(o(ul(l,u,y)));return c}function il(t){if(!t)return null;let e=t.trim();if(!e||(e.startsWith("=")&&(e=e.slice(1)),!e))return null;const[n]=e.split(",");if(!n)return null;let o,r=n;const l=n.lastIndexOf("!");if(l!==-1&&(o=n.slice(0,l),r=n.slice(l+1)),r=r.trim(),!r)return null;const c=r.indexOf(":"),u=c===-1?r:r.slice(0,c),y=c===-1?r:r.slice(c+1),L=_s(u),S=_s(y);return!L||!S?null:{sheetName:al(o),startRow:Math.min(L.row,S.row),endRow:Math.max(L.row,S.row),startCol:Math.min(L.col,S.col),endCol:Math.max(L.col,S.col)}}function _s(t){if(!t)return null;const e=t.replace(/\$/g,"").trim();if(!e)return null;const n=e.match(/^([A-Za-z]+)(\d+)$/);if(!n)return null;const[,o,r]=n;if(!o||!r)return null;const l=o.toUpperCase(),c=Number.parseInt(r,10);if(!Number.isFinite(c))return null;const u=J(l),y=c-1;return u<0||y<0?null:{row:y,col:u}}function al(t){if(!t)return;let e=t.trim();if(!e)return;e.startsWith("'")&&e.endsWith("'")&&(e=e.slice(1,-1).replace(/''/g,"'"));const n=e.indexOf("["),o=e.lastIndexOf("]");return n!==-1&&o>n&&(e=e.slice(o+1)),e}function cl(t,e,n){if(e){const o=Hs(e);if(o){const r=t.get(o);if(r)return r}}return n}const vs=new WeakMap;function fl(t){var n;let e=vs.get(t);if(e)return e;e=new Map;for(const o of(n=t.rows)!=null?n:[])!o||typeof o.index!="number"||e.set(o.index-1,o);return vs.set(t,e),e}function ul(t,e,n){var r;const o=fl(t).get(e);if(o){for(const l of(r=o.cells)!=null?r:[])if(J(l.address)===n)return l}}function dl(t){var L,S,C,W;const{sheet:e,rowHeights:n,colWidths:o,rowIndexRemap:r}=t,l=new Set;for(const B of e.rows)B.hidden===!0&&l.add(B.index-1);const c=[];if(l.size>0&&n.length>1){const B=n.length,tt=new Array(B);for(let A=0;A<B;A++){const dt=r&&A<r.length&&(L=r[A])!=null?L:A;tt[A]=dt}let v=null,$=null;for(let A=0;A<B;A++){const dt=n[A];if(dt==null||dt<=0)continue;const mt=tt[A];if(mt==null){v=A,$=null;continue}if(v!=null&&$!=null){const Ct=Math.min($,mt)+1,vt=Math.max($,mt)-1;if(Ct<=vt){for(let Tt=Ct;Tt<=vt;Tt++)if(l.has(Tt)){c.push(v);break}}}v=A,$=mt}}const u=new Set;for(const B of(S=e.columns)!=null?S:[]){if(!(B.hidden===!0))continue;const v=Math.max(0,(B.min||1)-1),$=Math.max(v,((W=(C=B.max)!=null?C:B.min)!=null?W:1)-1);for(let A=v;A<=$;A++)u.add(A)}const y=[];if(u.size>0&&o.length>1){const B=o.length;let tt=null;for(let v=0;v<B;v++){const $=o[v];if(!($==null||$<=0||u.has(v))){if(tt!=null){const dt=Math.min(tt,v)+1,mt=Math.max(tt,v)-1;if(dt<=mt){for(let Ct=dt;Ct<=mt;Ct++)if(u.has(Ct)){y.push(tt);break}}}tt=v}}}return{rowBoundaries:c,colBoundaries:y}}const Ls=new WeakMap;function ml(t){const{sheet:e,rowHeights:n,colWidths:o,rowIndexRemap:r}=t,l=Ls.get(e);if(l&&l.rowRef===n&&l.colRef===o&&l.remapRef===r)return l.markers;const c=dl({sheet:e,rowHeights:n,colWidths:o,rowIndexRemap:r});return Ls.set(e,{rowRef:n,colRef:o,remapRef:r,markers:c}),c}function hl(t,e){var n,o;if(!(t.mergedAnchorsComputed&&t.mergedAnchorsSheetRef===e.mergedCells)){t.mergedRowAnchorByRow.clear(),t.mergedColAnchorByCol.clear();for(const r of(n=e.mergedCells)!=null?n:[]){const l=r.startAddress;if(!l)continue;const c=(o=r.endAddress)!=null?o:l,u=J(l),y=Mt(l),L=J(c),S=Mt(c),C=Math.min(y,S),W=Math.max(y,S),B=Math.min(u,L),tt=Math.max(u,L);for(let v=C;v<=W;v++){const $=t.mergedRowAnchorByRow.get(v);($==null||C<$)&&t.mergedRowAnchorByRow.set(v,C)}for(let v=B;v<=tt;v++){const $=t.mergedColAnchorByCol.get(v);($==null||B<$)&&t.mergedColAnchorByCol.set(v,B)}}t.mergedAnchorsComputed=!0,t.mergedAnchorsSheetRef=e.mergedCells}}function Is(t,e,n){var y,L,S,C,W;if(t.value===""||t.value==null)return"";const o=(L=e[(y=t.styleIndex)!=null?y:0])!=null?L:{},r=(S=o.numberFormatCode)!=null?S:o.numberFormatId!=null?"#".concat(o.numberFormatId):"",l=n?"".concat(t.value,"||").concat(r):void 0;if(l&&(n!=null&&n.has(l)))return(C=n.get(l))!=null?C:"";let c=t.value;const u=(W=o.numberFormatCode)!=null?W:o.numberFormatId;if(u!=null){const B=Number(t.value);if(!Number.isNaN(B))try{c=xs.format(u,B)}catch(tt){c=t.value}}return l&&(n==null||n.set(l,c)),c}function ge(t,e,n){switch(t.save(),n&&(t.strokeStyle=n),t.lineWidth=1,t.setLineDash([]),e){case"thin":t.lineWidth=1;break;case"medium":t.lineWidth=2;break;case"thick":t.lineWidth=3;break;case"dashed":case"mediumDashed":t.lineWidth=e==="mediumDashed"?2:1,t.setLineDash([6,3]);break;case"dashDot":t.setLineDash([6,3,1,3]);break;case"dashDotDot":t.setLineDash([6,3,1,3,1,3]);break;case"slantDashDot":t.setLineDash([]);break;case"double":break;default:t.lineWidth=1;break}}function _e(t,e,n,o,r,l,c){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=1;const u=2;e==="top"?(t.beginPath(),t.moveTo(o,r),t.lineTo(o+l,r),t.stroke(),t.beginPath(),t.moveTo(o,r+u),t.lineTo(o+l,r+u),t.stroke()):e==="bottom"?(t.beginPath(),t.moveTo(o,r+c),t.lineTo(o+l,r+c),t.stroke(),t.beginPath(),t.moveTo(o,r+c-u),t.lineTo(o+l,r+c-u),t.stroke()):e==="left"?(t.beginPath(),t.moveTo(o,r),t.lineTo(o,r+c),t.stroke(),t.beginPath(),t.moveTo(o+u,r),t.lineTo(o+u,r+c),t.stroke()):e==="right"&&(t.beginPath(),t.moveTo(o+l,r),t.lineTo(o+l,r+c),t.stroke(),t.beginPath(),t.moveTo(o+l-u,r),t.lineTo(o+l-u,r+c),t.stroke()),t.restore()}function ve(t,e,n,o,r,l,c){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=2,t.beginPath(),e==="top"?(t.moveTo(o,r),t.lineTo(o+l,r)):e==="bottom"?(t.moveTo(o,r+c),t.lineTo(o+l,r+c)):e==="left"?(t.moveTo(o,r),t.lineTo(o,r+c)):e==="right"&&(t.moveTo(o+l,r),t.lineTo(o+l,r+c)),t.stroke(),t.save(),t.globalAlpha=.5,t.strokeStyle="#ffffff",t.lineWidth=1;const u=8,y=6;if(e==="left"||e==="right"){const L=e==="right"?o+l:o,S=e==="right"?-y:y;for(let C=r;C<=r+c;C+=u)t.beginPath(),t.moveTo(L+S,C),t.lineTo(L,C+y),t.stroke()}else{const L=e==="bottom"?r+c:r,S=e==="bottom"?-y:y;for(let C=o;C<=o+l;C+=u)t.beginPath(),t.moveTo(C,L+S),t.lineTo(C+y,L),t.stroke()}t.restore(),t.restore()}const gl=t=>{if(!t)return;let e=t.replace(/\s*\(Body\)\s*$/i,"");return e=e.replace(/\s+Regular$/i,""),e=e.replace(/\s+Bold$/i,""),e=e.replace(/\s+Italic$/i,""),e.trim()};function pl(t){const e=t.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\)$/i);if(!e)return null;const[,n,o,r]=e;return!n||!o||!r?null:[parseInt(n,10),parseInt(o,10),parseInt(r,10)]}const Le=t=>t/9525,Ie=new Map,Pe=new Map;function bl(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);return n}function Ps(t,e){if(!e)return null;const n=t.images;if(!n||n.length===0)return null;const o=n.find(l=>l.id===e);if(!o)return null;const r=typeof o.data=="string"?bl(o.data):o.data;return{id:o.id,contentType:o.contentType,data:r}}function yl(t,e,n,o,r,l,c,u,y){var S,C,W,B,tt,v,$,A,dt,mt;const L=(S=e.drawings)!=null?S:[];if(L.length!==0)for(const Ct of L){const vt=(C=Ct.imageReference)==null?void 0:C.id;if(!vt)continue;const Tt=Ct.fromAnchor;if(!Tt)continue;const Lt=Ct.toAnchor,Ot=Number(Tt.colId),At=Number(Tt.rowId),Rt=o[Ot],d=r[At];if(typeof Rt>"u"||typeof d>"u")continue;const st=ut+Rt+Le(Number((W=Tt.colOffset)!=null?W:0))-l,T=bt+d+Le(Number((B=Tt.rowOffset)!=null?B:0))-c;let lt=0,wt=0;if(Lt){const Wt=Number(Lt.colId),x=Number(Lt.rowId)-1,Y=o[Wt],Xt=r[x];if(typeof Y>"u"||typeof Xt>"u")continue;const Bt=ut+Y+Le(Number((tt=Lt.colOffset)!=null?tt:0))-l,Pt=bt+Xt+Le(Number((v=Lt.rowOffset)!=null?v:0))-c;lt=Bt-st,wt=Pt-T}else{const Wt=($=o[Ot])!=null?$:0,x=(A=o[Ot+1])!=null?A:Wt,Y=(dt=r[At-1])!=null?dt:0,Xt=(mt=r[At])!=null?mt:Y,Bt=Math.max(0,x-Wt),Pt=Math.max(0,Xt-Y),Zt=Ps(n,vt);if(!Zt)continue;const re=Ie.get(Zt.id);if(!re){if(!Pe.has(Zt.id)){const Ae=Fs(Zt).then(se=>(Ie.set(Zt.id,se),se));Pe.set(Zt.id,Ae)}continue}const fe=re.width,Kt=re.height;if(fe<=0||Kt<=0||Bt<=0||Pt<=0)continue;const jt=Math.min(Bt/fe,Pt/Kt);lt=Math.max(0,Math.floor(fe*jt)),wt=Math.max(0,Math.floor(Kt*jt));const Be=(Bt-lt)/2,ue=(Pt-wt)/2;t.drawImage(re,0,0,fe,Kt,st+Be,T+ue,lt,wt);continue}if(st+lt<0||T+wt<0||st>u||T>y)continue;const Ht=Ps(n,vt);if(!Ht)continue;const Vt=Ie.get(Ht.id);if(Vt){t.drawImage(Vt,0,0,Vt.width,Vt.height,st,T,lt,wt);continue}if(!Pe.has(Ht.id)){const Wt=Fs(Ht).then(x=>(Ie.set(Ht.id,x),x));Pe.set(Ht.id,Wt)}}}const Ce=10/12,ce="#4F81BD",Ml="#60A5FA",pe={headerFill:{type:Ut.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:0,shade:0,lumMod:1e5,lumOff:1180,satMod:0,alpha:1e5}},rowStripeFill:{type:Ut.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},colStripeFill:{type:Ut.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:8e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},firstLastColFill:{type:Ut.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}}},Cl={type:Ut.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},Ds=new WeakMap;function De(t){let e=Ds.get(t);return e||(e={rowCellByColIdx:new Map,rowNonEmptyCols:new Map,textMetrics:new Map,mergedRowAnchorByRow:new Map,mergedColAnchorByCol:new Map,mergedAnchorsComputed:!1,mergedAnchorsSheetRef:void 0},Ds.set(t,e)),e}function Te(t,e){return t+":"+e}function ke(t,e){let n=0,o=t.length;for(;n<o;){const r=n+o>>>1,l=t[r];l!==void 0&&l<e?n=r+1:o=r}return n}function ks(t,e){let n=0,o=t.length;for(;n<o;){const r=n+o>>>1,l=t[r];l!==void 0&&l<=e?n=r+1:o=r}return n}const Tl=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function Os(t){var l;let e=0;t[e]==="$"&&e++;const n=e;for(;e<t.length&&/[A-Za-z]/.test((l=t[e])!=null?l:"");)e++;const o=t.slice(n,e);t[e]==="$"&&e++;const r=t.slice(e);return{col:J(o),row:parseInt(r,10)||0}}function Fl(t){t=Math.max(1,t);let e="";for(;t>0;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-1)/26)}return e}function Bs(t,e,n){var A;const o=t.startsWith("$"),r=o?1:0;let l=r;for(;l<t.length&&/[A-Za-z]/.test((A=t[l])!=null?A:"");)l++;const c=t.slice(r,l);let u=!1,y=l;t[y]==="$"&&(u=!0,y++);const L=t.slice(y),S=J(c),C=parseInt(L,10)||0,W=o?S:Math.max(1,S+e),B=u?C:Math.max(1,C+n),tt=Fl(W),v=(o?"$":"")+tt,$=(u?"$":"")+String(B);return v+$}function $s(t,e,n){if(!t||!e||!n)return t;const{col:o,row:r}=Os(e),{col:l,row:c}=Os(n),u=l-o,y=c-r;return u===0&&y===0?t:t.replace(Tl,(L,S,C,W)=>{const B=S?String(S):"",tt=Bs(String(C),u,y);if(!W)return"".concat(B).concat(tt);const v=Bs(String(W),u,y);return"".concat(B).concat(tt,":").concat(v)})}function Sl(t){var n;const e=new Map;for(const o of(n=t.sharedFormulas)!=null?n:[])typeof o.si=="number"&&o.base&&o.anchor&&e.set(o.si,{base:o.base,anchor:o.anchor});return e}const Al={BLACK:0,WHITE:1,RED:2,GREEN:3,BLUE:4,YELLOW:5,MAGENTA:6,CYAN:7};function wl(t){var r,l;if(!t)return[];const e=[];let n="",o=!1;for(let c=0;c<t.length;c++){const u=(r=t[c])!=null?r:"";if(u==='"'){n+=u,o=!o;continue}if(u==="\\"&&c+1<t.length){n+=u+((l=t[c+1])!=null?l:""),c++;continue}if(u===";"&&!o){e.push(n),n="";continue}n+=u}return e.push(n),e}function Rl(t,e){if(t<=0)return null;if(t===1)return 0;if(t===2)return e<0?1:0;if(t>=3){if(e>0)return 0;if(e<0)return 1;if(Object.is(e,-0)||e===0)return 2}return 0}function El(t){var r,l;const e=t.replace(/\s+/g,"").toUpperCase(),n=Al[e];if(n!=null)return(r=Se(n))!=null?r:null;const o=e.match(/^COLOR(\d{1,2})$/);if(o){const c=Number(o[1]);if(!Number.isNaN(c)&&c>0)return(l=Se(c-1))!=null?l:null}return null}function Nl(t){var n,o;let e=0;for(;e<t.length&&/\s/.test((n=t[e])!=null?n:"");)e++;for(;e<t.length&&t[e]==="[";){const r=t.indexOf("]",e);if(r===-1)break;const l=t.slice(e+1,r),c=El(l);if(c)return c;for(e=r+1;e<t.length&&/\s/.test((o=t[e])!=null?o:"");)e++}return null}function _l(t){const e=t.trim().replace(/^#/,""),n=e.length===6?e:e.slice(-6),o="FF".concat(n.toUpperCase());return{type:Ut.COLOR_TYPE_RGB,value:o,lastColor:o,transform:void 0}}function vl(t,e){var y;if(!(e!=null&&e.numberFormatCode)||t.dataType===Fe.CELL_DATA_TYPE_STRING||t.dataType===Fe.CELL_DATA_TYPE_SHARED_STRING||t.dataType===Fe.CELL_DATA_TYPE_INLINE_STRING)return null;const o=Number(t.value);if(Number.isNaN(o))return null;const r=wl(e.numberFormatCode);if(r.length===0)return null;const l=Rl(r.length,o);if(l==null)return null;const c=(y=r[Math.min(l,r.length-1)])!=null?y:"",u=Nl(c);return u?_l(u):null}function $l(t,e,n,o,r,l,c,u,y,L,S,C,W,B,tt,v,$,A,dt,mt,Ct,vt,Tt){var Xe,Ze,je,qe,Qe,Je,tn,en,nn,on,rn,sn,ln,an,cn,fn,un,dn,mn,hn,gn,pn,bn,yn,Mn,Cn,Tn,Fn,Sn,An,wn,Rn,En,Nn,_n,vn,Ln,In,Pn,Dn,kn,On,Bn,$n,xn,Hn,Wn,Yn,Gn,zn,Un,Vn,Kn,Xn,Zn,jn,qn,Qn,Jn,to,eo,no,oo,ro,so,lo,io,ao,co,fo,uo,mo,ho,go,po,bo,yo,Mo,Co,To,Fo,So,Ao,wo,Ro,Eo,No,_o,vo,Lo,Io,Po,Do,ko,Oo,Bo,$o,xo,Ho,Wo,Yo,Go,zo,Uo,Vo,Ko,Xo,Zo,jo,qo,Qo,Jo,tr,er,nr,or,rr,sr,lr,ir,ar,cr,fr,ur,dr,mr,hr,gr,pr,br,yr,Mr,Cr,Tr,Fr,Sr,Ar,wr,Rr,Er,Nr,_r,vr,Lr,Ir,Pr,Dr,kr,Or,Br,$r,xr,Hr,Wr,Yr,Gr,zr,Ur,Vr,Kr,Xr,Zr,jr,qr,Qr,Jr,ts,es,ns,os,rs,ss,ls,is,as,cs,fs,us,ds,ms,hs;const{darkMode:Lt=!1,accentColor:Ot=Ml,rowAutoHeight:At}=Tt!=null?Tt:{},Rt=Lt?{background:"#202020",grid:"#4d4d4d",headerBg:"#1e1e1e",headerBorder:"#2b2b2b",headerText:"#f5f5f5",unsupportedFill:"#2b2b2b"}:{background:"#ffffff",grid:"#cccccc",headerBg:"#f5f5f5",headerBorder:"#cccccc",headerText:"#333333",unsupportedFill:"#eeeeee"},d=Rt.background,st=Rt.grid,T=Rt.headerBg,lt=Rt.headerBorder,wt=Rt.headerText,Ht=Rt.unsupportedFill,Vt=Lt?"FFFFFFFF":"FF000000",Wt=S||1,x=r/Wt,Y=l/Wt,Xt=new Set,Bt=Sl(e);function Pt(s,a){var f,g,M,m,F;if(!(be.get(s)!=null))return(f=n[a])!=null?f:0;$e(s);const p=(g=De(e).rowNonEmptyCols.get(s))!=null?g:[],w=ks(p,a);let h=(M=p[w])!=null?M:n.length;const I=(N,et)=>{var nt;const it=ne(N,et);if(jt(it)==null)return!1;for(const z of se)if(((nt=z.ranges)!=null?nt:[]).some(E=>E.sheetName&&E.sheetName!==e.name?!1:Kt(N,et,E)))return!0;return!1};for(let N=a+1;N<h;N++)if(I(s,N)){h=N;break}const O=(m=k[a])!=null?m:0,b=(F=k[h])!=null?F:O;return Math.max(0,b-O)}function Zt(s,a){var f,g,M,m;if(a<0)return!1;$e(s);const i=(f=De(e).rowNonEmptyCols.get(s))!=null?f:[],p=ks(i,a)-1;if(p<0)return!1;const w=(g=i[p])!=null?g:-1;if(w<0)return!1;const h=De(e).textMetrics.get(Te(s,w));if(!h||h.isNumeric)return!1;const I=Math.max(0,((M=k[a+1])!=null?M:0)-((m=k[w])!=null?m:0)),O=Math.max(0,I-(h.padLr+h.padLr));return h.firstLineW+.001>=O}function re(s){var w,h,I,O,b;if(typeof s!="number")return null;const a=(w=$.styles)==null?void 0:w.dxfs,i=a==null?void 0:a[s];if(!i)return null;const p=(b=(h=i==null?void 0:i.fill)==null?void 0:h.color)!=null?b:(O=(I=i==null?void 0:i.font)==null?void 0:I.fill)==null?void 0:O.color;return p?kt(p,A,"rgba(0,0,0,1)"):null}function fe(s){var w,h,I;if(typeof s!="number")return null;const a=(w=$.styles)==null?void 0:w.dxfs,i=a==null?void 0:a[s],p=(I=(h=i==null?void 0:i.border)==null?void 0:h.bottom)==null?void 0:I.color;return p?kt(p,A,"#cccccc"):null}function Kt(s,a,i){const p=J(i.startAddress),w=Mt(i.startAddress),h=J(i.endAddress),I=Mt(i.endAddress),O=Math.min(w,I),b=Math.max(w,I),f=Math.min(p,h),g=Math.max(p,h);return s>=O&&s<=b&&a>=f&&a<=g}function jt(s){if(!s)return null;const a=Number(s.value);return Number.isNaN(a)?null:a}function Be(s,a,i){const p=Array.isArray(a)?a:void 0;if(i==null)return!1;const w=(p==null?void 0:p[0])!=null?Number(p[0]):NaN,h=(p==null?void 0:p[1])!=null?Number(p[1]):NaN;switch(s){case"greaterThan":return i>w;case"greaterThanOrEqual":return i>=w;case"lessThan":return i<w;case"lessThanOrEqual":return i<=w;case"equal":return i===w;case"notEqual":return i!==w;case"between":return i>=Math.min(w,h)&&i<=Math.max(w,h);case"notBetween":return!(i>=Math.min(w,h)&&i<=Math.max(w,h));default:return!1}}const ue=(Xe=e.conditionalFormattings)!=null?Xe:[],Ae=[],se=[];for(const s of ue)for(const a of(Ze=s.rules)!=null?Ze:[])if(a.type==="colorScale"&&a.colorScale){const i=[];for(const F of(je=s.ranges)!=null?je:[]){if(F.sheetName&&F.sheetName!==e.name)continue;const N=J(F.startAddress),et=Mt(F.startAddress),it=J(F.endAddress),_=Mt(F.endAddress),nt=Math.min(et,_),z=Math.max(et,_),ot=Math.min(N,it),E=Math.max(N,it);for(let ht=nt;ht<=z;ht++){const gt=e.rows.find(j=>j.index-1===ht);if(gt)for(let j=ot;j<=E;j++){const pt=gt.cells.find(Yt=>J(Yt.address)===j),at=jt(pt);at!=null&&i.push(at)}}}const p=i.slice().sort((F,N)=>F-N),w=F=>{var ot,E;if(p.length===0)return 0;const N=F/100*(p.length-1),et=Math.floor(N),it=Math.min(p.length-1,Math.ceil(N)),_=N-et,nt=(ot=p[et])!=null?ot:0,z=(E=p[it])!=null?E:nt;return nt+(z-nt)*_},h=(qe=a.colorScale.cfvos)!=null?qe:[],I=(Qe=a.colorScale.colors)!=null?Qe:[],O=[],b=[];for(let F=0;F<h.length;F++){const N=h[F];if(!N)continue;let et=0;N.type==="min"?et=(Je=p[0])!=null?Je:0:N.type==="max"?et=(tn=p[p.length-1])!=null?tn:0:N.type==="num"?et=Number((en=N.val)!=null?en:0):N.type==="percentile"?et=w(Number((nn=N.val)!=null?nn:0)):et=Number((on=N.val)!=null?on:0),b.push(et);const it=I[F],_=it?kt(it,A,"rgba(0,0,0,1)"):"rgba(0,0,0,1)",nt=(rn=pl(_))!=null?rn:[0,0,0];O.push({pos:0,rgb:nt})}const f=Math.min(...b),g=Math.max(...b),M=F=>g===f?0:(F-f)/(g-f);for(let F=0;F<O.length;F++){const N=O[F];N&&(N.pos=M((sn=b[F])!=null?sn:0))}const m=(h!=null?h:[]).some(F=>F.type==="min"||F.type==="max");Ae.push({ranges:s.ranges,stops:O,vMin:f,vMax:g,priority:typeof a.priority=="number"?a.priority:9999,includeEndpoints:m})}for(const s of ue)for(const a of(ln=s.rules)!=null?ln:[])if(a.type==="dataBar"){const i=[];for(const I of(an=s.ranges)!=null?an:[]){if(I.sheetName&&I.sheetName!==e.name)continue;const O=J(I.startAddress),b=Mt(I.startAddress),f=J(I.endAddress),g=Mt(I.endAddress),M=Math.min(b,g),m=Math.max(b,g),F=Math.min(O,f),N=Math.max(O,f);for(let et=M;et<=m;et++){const it=e.rows.find(_=>_.index-1===et);if(it)for(let _=F;_<=N;_++){const nt=it.cells.find(ot=>J(ot.address)===_),z=jt(nt);z!=null&&i.push(z)}}}if(i.length===0)continue;const p=Math.min(...i),w=Math.max(...i),h=kt((fn=(cn=a.dataBar)==null?void 0:cn.color)!=null?fn:Cl,A,((un=A.colorMap)==null?void 0:un.accent1)||ce);se.push({ranges:s.ranges,vMin:p,vMax:w,colorCss:h,priority:typeof a.priority=="number"?a.priority:9999,showValue:!0})}t.save(),t.scale(S,S);const we=.5/(window.devicePixelRatio*S),Dt=De(e);function ne(s,a){var i;return $e(s),(i=Dt.rowCellByColIdx.get(s))==null?void 0:i.get(a)}const Ys={thin:1,dashed:2,dashDot:2,dashDotDot:2,medium:3,mediumDashed:3,slantDashDot:3,thick:4,double:5},Re=s=>{var a;return s&&(a=Ys[s])!=null?a:0},k=[0];for(let s=0;s<n.length;s++)k[s+1]=((dn=k[s])!=null?dn:0)+((mn=n[s])!=null?mn:0);const G=[0];for(let s=0;s<o.length;s++)G[s+1]=((hn=G[s])!=null?hn:0)+((gn=o[s])!=null?gn:0);let qt=Math.max(0,ke(k,x)-1);const le=Math.min(n.length-1,ke(k,x+c/S)+1);let oe=Math.max(0,ke(G,Y)-1);const de=Math.min(o.length-1,ke(G,Y+u/S)+1);if(((bn=(pn=e.mergedCells)==null?void 0:pn.length)!=null?bn:0)>0){hl(Dt,e);let s=!0;for(;s;){s=!1;for(let a=oe;a<=de;a++){const i=Dt.mergedRowAnchorByRow.get(a);if(i!=null&&i<oe){oe=Math.max(0,i),s=!0;break}}for(let a=qt;a<=le;a++){const i=Dt.mergedColAnchorByCol.get(a);if(i!=null&&i<qt){qt=Math.max(0,i),s=!0;break}}}}t.clearRect(0,0,c/S,u/S),t.fillStyle=d,t.fillRect(0,0,c/S,u/S);const Ve=new Map;for(const s of e.rows)Ve.set(s.index-1,s);const be=new Map;if(mt&&mt.length>0){const s=o.length;for(let a=0;a<s;a++){const i=(yn=mt[a])!=null?yn:a,p=Ve.get(i);p&&be.set(a,p)}}else for(const s of e.rows)be.set(s.index-1,s);function $e(s){var w;if(Dt.rowCellByColIdx.has(s)&&Dt.rowNonEmptyCols.has(s))return;const a=be.get(s);if(!a){Dt.rowCellByColIdx.set(s,new Map),Dt.rowNonEmptyCols.set(s,[]);return}const i=new Map,p=[];for(const h of a.cells){const I=J(h.address);i.set(I,h);const O=h.value!=null&&String(h.value)!=="",b=!!((w=h.paragraphs)!=null&&w.some(f=>{var g;return(g=f.runs)==null?void 0:g.some(M=>{var m;return((m=M.text)!=null?m:"").length>0})}));(O||b||h.formula||typeof h.sharedFormulaSi=="number")&&p.push(I)}p.sort((h,I)=>h-I),Dt.rowCellByColIdx.set(s,i),Dt.rowNonEmptyCols.set(s,p)}const xe=[];for(const s of(Mn=e.columns)!=null?Mn:[]){const a=s,i=typeof(a==null?void 0:a.styleIndex)=="number"?a.styleIndex:void 0;if(typeof i=="number"){const p=Math.max(0,((Cn=s.min)!=null?Cn:1)-1),w=Math.max(p,((Fn=(Tn=s.max)!=null?Tn:s.min)!=null?Fn:1)-1);for(let h=p;h<=w;h++)xe[h]==null&&(xe[h]=i)}}const He=new Set,We=new Set;if(((An=(Sn=e.pivotTables)==null?void 0:Sn.length)!=null?An:0)>0)for(const s of(wn=e.pivotTables)!=null?wn:[]){const a=s.location,i=(Rn=a==null?void 0:a.reference)!=null?Rn:"";if(!i)continue;const[p,w]=i.split(":"),h=J(p||"A1"),I=Mt(p||"A1"),O=w?J(w):h,b=w?Mt(w):I,f=Math.max(Math.min(h,O),qt),g=Math.min(Math.max(h,O),le),M=Math.max(Math.min(I,b),oe),m=Math.min(Math.max(I,b),de);if(f>g||M>m)continue;const F=typeof(a==null?void 0:a.firstHeaderRow)=="number"&&a.firstHeaderRow>0?a.firstHeaderRow-1:I,N=typeof(a==null?void 0:a.firstDataRow)=="number"&&a.firstDataRow>0?a.firstDataRow-1:Math.min(b,F+1),et=typeof(a==null?void 0:a.firstHeaderColumn)=="number"&&a.firstHeaderColumn>0?a.firstHeaderColumn-1:h,it=typeof(a==null?void 0:a.firstDataColumn)=="number"&&a.firstDataColumn>0?a.firstDataColumn-1:Math.min(O,et+1),_=kt(pe.headerFill,A,((En=A.colorMap)==null?void 0:En.accent1)||ce),nt=kt(pe.firstLastColFill,A,((Nn=A.colorMap)==null?void 0:Nn.accent1)||ce);if(N>=M){const z=M,ot=Math.min(m,N-1);if(ot>=z){const E=ut+((_n=k[f])!=null?_n:0)-x,ht=bt+((vn=G[z])!=null?vn:0)-Y,gt=((Ln=k[g+1])!=null?Ln:0)-((In=k[f])!=null?In:0),j=((Pn=G[ot+1])!=null?Pn:0)-((Dn=G[z])!=null?Dn:0);t.fillStyle=_,t.fillRect(E,ht,gt,j);for(let pt=z;pt<=ot;pt++)for(let at=f;at<=g;at++)He.add("".concat(ae(at)).concat(pt+1))}}if(it>=f){const z=f,ot=Math.min(g,it-1);if(ot>=z){const E=ut+((kn=k[z])!=null?kn:0)-x,ht=bt+((On=G[M])!=null?On:0)-Y,gt=((Bn=k[ot+1])!=null?Bn:0)-(($n=k[z])!=null?$n:0),j=((xn=G[m+1])!=null?xn:0)-((Hn=G[M])!=null?Hn:0);t.fillStyle=_,t.fillRect(E,ht,gt,j);for(let pt=M;pt<=m;pt++)for(let at=z;at<=ot;at++)He.add("".concat(ae(at)).concat(pt+1))}}if(s.rowGrandTotals){const z=m,ot=ut+((Wn=k[f])!=null?Wn:0)-x,E=bt+((Yn=G[z])!=null?Yn:0)-Y,ht=((Gn=k[g+1])!=null?Gn:0)-((zn=k[f])!=null?zn:0),gt=(Un=o[z])!=null?Un:0;t.fillStyle=nt,t.fillRect(ot,E,ht,gt);for(let j=f;j<=g;j++)We.add("".concat(ae(j)).concat(z+1))}if(s.columnGrandTotals){const z=g,ot=ut+((Vn=k[z])!=null?Vn:0)-x,E=bt+((Kn=G[M])!=null?Kn:0)-Y,ht=(Xn=n[z])!=null?Xn:0,gt=((Zn=G[m+1])!=null?Zn:0)-((jn=G[M])!=null?jn:0);t.fillStyle=nt,t.fillRect(ot,E,ht,gt);for(let j=M;j<=m;j++)We.add("".concat(ae(z)).concat(j+1))}}const ye=(qn=e.tables)!=null?qn:[],Ke=new Set;if(ye.length>0)for(const s of ye){if(!s.ref)continue;const[a,i]=s.ref.split(":");if(!a)continue;const p=J(a),w=Mt(a),h=i?J(i):p,I=i?Mt(i):w,O=Math.max(Math.min(p,h),qt),b=Math.min(Math.max(p,h),le),f=Math.max(Math.min(w,I),oe),g=Math.min(Math.max(w,I),de);if(O>b||f>g)continue;const M=Math.max(0,Math.min(1,(Qn=s.headerRowCount)!=null?Qn:1)),m=Math.max(0,Math.min(1,(Jn=s.totalsRowCount)!=null?Jn:s.totalsRowShown?1:0)),F=Math.min(g,Math.max(f,Math.min(w,I)+M)),N=Math.max(f,Math.min(g,Math.max(w,I)-m)),et=kt(pe.headerFill,A,((to=A.colorMap)==null?void 0:to.accent1)||ce),it=kt(pe.rowStripeFill,A,((eo=A.colorMap)==null?void 0:eo.accent1)||ce),_=kt(pe.colStripeFill,A,((no=A.colorMap)==null?void 0:no.accent1)||ce),nt=kt(pe.firstLastColFill,A,((oo=A.colorMap)==null?void 0:oo.accent1)||ce);if(M>0){const E=Math.min(g,Math.min(w,I));if(E>=f&&E<=g){const ht=ut+((ro=k[O])!=null?ro:0)-x,gt=bt+((so=G[E])!=null?so:0)-Y,j=((lo=k[b+1])!=null?lo:0)-((io=k[O])!=null?io:0),pt=(ao=o[E])!=null?ao:0,at=s==null?void 0:s.dataDxfId,Yt=(co=re(at))!=null?co:et;t.fillStyle=Yt,t.fillRect(ht,gt,j,pt);for(let Gt=O;Gt<=b;Gt++)Ke.add("".concat(ae(Gt)).concat(E+1))}}if((fo=s.style)!=null&&fo.showRowStripes&&F<=N){for(let E=F;E<=N;E++)if((E-F)%2===1){const gt=ut+((uo=k[O])!=null?uo:0)-x,j=bt+((mo=G[E])!=null?mo:0)-Y,pt=((ho=k[b+1])!=null?ho:0)-((go=k[O])!=null?go:0),at=(po=o[E])!=null?po:0;t.fillStyle=it,t.fillRect(gt,j,pt,at)}}if((bo=s.style)!=null&&bo.showColumnStripes&&F<=N){for(let E=O;E<=b;E++)if((E-Math.min(p,h))%2===1){const gt=ut+((yo=k[E])!=null?yo:0)-x,j=bt+((Mo=G[F])!=null?Mo:0)-Y,pt=(Co=n[E])!=null?Co:0,at=((To=G[N+1])!=null?To:0)-((Fo=G[F])!=null?Fo:0);t.fillStyle=_,t.fillRect(gt,j,pt,at)}}const z=!!((So=s.style)!=null&&So.showFirstColumn),ot=!!((Ao=s.style)!=null&&Ao.showLastColumn);if(F<=N&&(z||ot)){if(z){const E=Math.min(p,h);if(E>=O&&E<=b){const ht=ut+((wo=k[E])!=null?wo:0)-x,gt=bt+((Ro=G[F])!=null?Ro:0)-Y,j=(Eo=n[E])!=null?Eo:0,pt=((No=G[N+1])!=null?No:0)-((_o=G[F])!=null?_o:0);t.fillStyle=nt,t.fillRect(ht,gt,j,pt)}}if(ot){const E=Math.max(p,h);if(E>=O&&E<=b){const ht=ut+((vo=k[E])!=null?vo:0)-x,gt=bt+((Lo=G[F])!=null?Lo:0)-Y,j=(Io=n[E])!=null?Io:0,pt=((Po=G[N+1])!=null?Po:0)-((Do=G[F])!=null?Do:0);t.fillStyle=nt,t.fillRect(ht,gt,j,pt)}}}}for(let s=oe;s<=de;s++){const a=be.get(s),i=bt+((ko=G[s])!=null?ko:0)-Y,p=(Oo=o[s])!=null?Oo:0,w=!!At&&p>0&&At.isRowAuto(s,a),h=w?($o=(Bo=At.getBaselineHeight)==null?void 0:Bo.call(At,s,a))!=null?$o:p:0;let I=w?h:0;const O=[];for(let b=qt;b<=le;b++){const f=ut+((xo=k[b])!=null?xo:0)-x;let g=(Ho=n[b])!=null?Ho:0,M=p;const m=ne(s,b),F="".concat(ae(b)).concat(s+1),N=a==null?void 0:a.styleIndex,et=xe[b],it=(Go=(Yo=(Wo=m==null?void 0:m.styleIndex)!=null?Wo:N)!=null?Yo:et)!=null?Go:0,_=(zo=C[it])!=null?zo:{},nt=_.wrapText===!0,z=(Uo=_.borders)==null?void 0:Uo.diagonal,ot=!!_.borderDiagonalUp,E=!!_.borderDiagonalDown,ht=(Vo=_.borderStyles)==null?void 0:Vo.diagonal,gt=m&&_?vl(m,_):null;if(m){const R=(()=>{if(dt){if(m.formula)return"= ".concat(m.formula);if(typeof m.sharedFormulaSi=="number"){const ft=Bt.get(m.sharedFormulaSi);if(ft)return"= ".concat($s(ft.base,ft.anchor,m.address))}}return Is(m,C)})(),P=(()=>{if(dt&&(m.formula||typeof m.sharedFormulaSi=="number"&&Bt.has(m.sharedFormulaSi)))return!1;const ft=Number(m.value);return m.dataType!==Fe.CELL_DATA_TYPE_STRING&&!Number.isNaN(ft)})(),X=((Xo=(Ko=_.font)==null?void 0:Ko.size)!=null?Xo:11*(96/72))*Ce,Ft=Math.max(2,Math.round((X||11)*.1)),U=Math.max(1,Math.round((X||11)*.25)),D=nt&&g>0?g:1e6;if(P)Dt.textMetrics.set(Te(s,b),{firstLineW:0,padLr:Ft,padTb:U,isNumeric:P});else{const yt={paragraphs:m.paragraphs&&m.paragraphs.length>0?m.paragraphs:[{runs:[{text:R,citations:[]}]}],textStyle:{alignment:ee.ALIGNMENT_TYPE_LEFT},bbox:{xEmu:0,yEmu:0,widthEmu:Math.round(D*9525),heightEmu:Math.round(M*9525)},type:Ts.ELEMENT_TYPE_TEXT,levelsStyles:[]},Z=Ue(yt,t,A,void 0,{resolvedStyle:{alignment:ee.ALIGNMENT_TYPE_LEFT},bboxPx:{x:0,y:0,width:D,height:M},mode:"layout",textScale:Ce,wrap:nt}),rt=(qo=(jo=(Zo=Z==null?void 0:Z.lines)==null?void 0:Zo[0])==null?void 0:jo.widthPx)!=null?qo:0;Dt.textMetrics.set(Te(s,b),{firstLineW:rt,padLr:Ft,padTb:U,isNumeric:P})}}const j=(Qo=e.mergedCells)!=null?Qo:[];let pt=!1,at=s,Yt=s,Gt=b,me=b,Qt=(Jo=_.borders)!=null?Jo:null,Ee=(tr=_.borderStyles)!=null?tr:null;{const R=j.find(P=>Kt(s,b,P));if(R){const P=J(R.startAddress),ct=Mt(R.startAddress),X=J(R.endAddress),Ft=Mt(R.endAddress);if(at=Math.min(ct,Ft),Yt=Math.max(ct,Ft),Gt=Math.min(P,X),me=Math.max(P,X),pt=s===at&&b===Gt,!pt)continue;g=((er=k[me+1])!=null?er:0)-((nr=k[Gt])!=null?nr:0),M=((or=G[Yt+1])!=null?or:0)-((rr=G[at])!=null?rr:0);let U=0,D=0,ft=0,yt=0;const Z={},rt={};for(let V=Gt;V<=me;V++){const q=ne(at,V),St=(lr=C[(sr=q==null?void 0:q.styleIndex)!=null?sr:0])!=null?lr:{},H=(ir=St.borderStyles)==null?void 0:ir.top,Q=Re(H);(ar=St.borders)!=null&&ar.top&&Q>=U&&(Z.top=St.borders.top,rt.top=H,U=Q)}for(let V=Gt;V<=me;V++){const q=ne(Yt,V),St=(fr=C[(cr=q==null?void 0:q.styleIndex)!=null?cr:0])!=null?fr:{},H=(ur=St.borderStyles)==null?void 0:ur.bottom,Q=Re(H);(dr=St.borders)!=null&&dr.bottom&&Q>=D&&(Z.bottom=St.borders.bottom,rt.bottom=H,D=Q)}for(let V=at;V<=Yt;V++){const q=ne(V,Gt),St=(hr=C[(mr=q==null?void 0:q.styleIndex)!=null?mr:0])!=null?hr:{},H=(gr=St.borderStyles)==null?void 0:gr.left,Q=Re(H);(pr=St.borders)!=null&&pr.left&&Q>=ft&&(Z.left=St.borders.left,rt.left=H,ft=Q)}for(let V=at;V<=Yt;V++){const q=ne(V,me),St=(yr=C[(br=q==null?void 0:q.styleIndex)!=null?br:0])!=null?yr:{},H=(Mr=St.borderStyles)==null?void 0:Mr.right,Q=Re(H);(Cr=St.borders)!=null&&Cr.right&&Q>=yt&&(Z.right=St.borders.right,rt.right=H,yt=Q)}Qt=Z,Ee=rt}}const gs=_.fill;gs&&(t.fillStyle=gs,t.fillRect(f,i,g,M));let ie=null,Ge=null,Ne=Number.POSITIVE_INFINITY,ps=Number.POSITIVE_INFINITY;if(ue.length>0){for(const R of ue)if(((Tr=R.ranges)!=null?Tr:[]).some(ct=>ct.sheetName&&ct.sheetName!==e.name?!1:Kt(s,b,ct)))for(const ct of(Fr=R.rules)!=null?Fr:[]){const X=typeof ct.priority=="number"?ct.priority:9999;if(ct.type==="cellIs"){const Ft=jt(m);if(Be((Sr=ct.operator)!=null?Sr:"",ct.formula,Ft)){const U=ct.dxfId;if(X<Ne){const Z=re(U);Z&&(ie=Z,Ne=X)}const D=(Ar=$.styles)==null?void 0:Ar.dxfs,ft=typeof U=="number"?D==null?void 0:D[U]:void 0,yt=(Rr=(wr=ft==null?void 0:ft.font)==null?void 0:wr.fill)==null?void 0:Rr.color;yt&&X<ps&&(Ge=yt,ps=X),ie||(ie="rgba(255,199,206,1)")}}}for(const R of Ae){if(!((Er=R.ranges)!=null?Er:[]).some(Z=>Z.sheetName&&Z.sheetName!==e.name?!1:Kt(s,b,Z)))continue;const ct=jt(m);if(ct==null)continue;const X=R.vMax===R.vMin?0:(ct-R.vMin)/(R.vMax-R.vMin),Ft=Math.max(0,Math.min(1,X));if(Number.isNaN(Ft))continue;const U=R.stops;if(U.length===0)continue;let D=(_r=(Nr=U[0])==null?void 0:Nr.rgb)!=null?_r:[0,0,0];if(U.length===1)D=(Lr=(vr=U[0])==null?void 0:vr.rgb)!=null?Lr:[0,0,0];else{let Z=0;for(;Z<U.length-1&&Ft>((Pr=(Ir=U[Z+1])==null?void 0:Ir.pos)!=null?Pr:0);)Z++;const rt=U[Z];if(!rt)continue;const V=U[Math.min(Z+1,U.length-1)];if(!V)continue;const q=rt.pos===V.pos?0:(Ft-rt.pos)/(V.pos-rt.pos);D=[Math.round(rt.rgb[0]+(V.rgb[0]-rt.rgb[0])*q),Math.round(rt.rgb[1]+(V.rgb[1]-rt.rgb[1])*q),Math.round(rt.rgb[2]+(V.rgb[2]-rt.rgb[2])*q)]}const ft="rgba(".concat(D[0],",").concat(D[1],",").concat(D[2],",1)"),yt=R.priority;yt<Ne&&(ie=ft,Ne=yt)}}if(ie&&(t.fillStyle=ie,t.fillRect(f,i,g,M)),tt.has("".concat(e.name,":").concat(F))&&(t.fillStyle=Ht,t.fillRect(f,i,g,M)),v&&y===s&&L===b&&(t.fillStyle="rgba(255,255,0,0.2)",t.fillRect(f,i,g,M)),se.length>0){let R=null;for(const P of se)((Dr=P.ranges)!=null?Dr:[]).some(X=>X.sheetName&&X.sheetName!==e.name?!1:Kt(s,b,X))&&(!R||P.priority<R.priority)&&(R=P);if(R){const P=jt(m);if(P!=null){const X=Math.max(0,g-2),Ft=Math.max(0,M-2),U=R.vMin,D=R.vMax;if(D!==U&&X>0&&Ft>0){let ft=f+1,yt=0;if(U>=0)yt=Math.max(0,Math.min(1,(P-U)/(D-U)))*X;else if(D<=0)yt=Math.max(0,Math.min(1,(P-D)/(U-D)))*X,ft=f+1+(X-yt);else{const Z=-U/(D-U),rt=X*Z;if(P>=0){const V=Math.max(0,Math.min(1,P/D));ft=f+1+rt,yt=V*(X-rt)}else{const V=Math.max(0,Math.min(1,P/U));ft=f+1+rt-V*rt,yt=V*rt}}yt>.5&&(t.save(),t.globalAlpha=.6,t.fillStyle=R.colorCss,t.fillRect(ft,i+1,yt,Ft),t.restore())}}}}if(Qt){const R=Qt,P=Ee!=null?Ee:{};R.top&&(P.top==="double"?_e(t,"top",R.top,f,i,g,M):P.top==="slantDashDot"?ve(t,"top",R.top,f,i,g,M):(ge(t,P.top,R.top),t.beginPath(),t.moveTo(f,i),t.lineTo(f+g,i),t.stroke(),t.restore())),R.bottom&&(P.bottom==="double"?_e(t,"bottom",R.bottom,f,i,g,M):P.bottom==="slantDashDot"?ve(t,"bottom",R.bottom,f,i,g,M):(ge(t,P.bottom,R.bottom),t.beginPath(),t.moveTo(f,i+M),t.lineTo(f+g,i+M),t.stroke(),t.restore())),R.left&&(P.left==="double"?_e(t,"left",R.left,f,i,g,M):P.left==="slantDashDot"?ve(t,"left",R.left,f,i,g,M):(ge(t,P.left,R.left),t.beginPath(),t.moveTo(f,i),t.lineTo(f,i+M),t.stroke(),t.restore())),R.right&&(P.right==="double"?_e(t,"right",R.right,f,i,g,M):P.right==="slantDashDot"?ve(t,"right",R.right,f,i,g,M):(ge(t,P.right,R.right),t.beginPath(),t.moveTo(f+g,i),t.lineTo(f+g,i+M),t.stroke(),t.restore()))}if(e.showGridLines!==!1&&!(!!_.fill||!!ie)){t.strokeStyle=st,t.lineWidth=we;const P=(()=>{var Et,Nt;const H=ne(s-1,b),Q=(Et=H==null?void 0:H.styleIndex)!=null?Et:0;return(Nt=C[Q])!=null?Nt:{}})(),ct=(()=>{var Et,Nt;const H=ne(s,b-1),Q=(Et=H==null?void 0:H.styleIndex)!=null?Et:0;return(Nt=C[Q])!=null?Nt:{}})(),X=(H,Q)=>{var Nt;const Et=(Nt=e.mergedCells)!=null?Nt:[];for(const It of Et){const $t=J(It.startAddress),xt=Mt(It.startAddress),zt=J(It.endAddress),Jt=Mt(It.endAddress),_t=Math.min($t,zt),K=Math.max($t,zt),te=Math.min(xt,Jt),Me=Math.max(xt,Jt);if(Q>=_t&&Q<=K&&H-1>=te&&H<=Me)return!0}return!1},Ft=(H,Q)=>{var Nt;const Et=(Nt=e.mergedCells)!=null?Nt:[];for(const It of Et){const $t=J(It.startAddress),xt=Mt(It.startAddress),zt=J(It.endAddress),Jt=Mt(It.endAddress),_t=Math.min($t,zt),K=Math.max($t,zt),te=Math.min(xt,Jt),Me=Math.max(xt,Jt);if(H>=te&&H<=Me&&Q-1>=_t&&Q<=K)return!0}return!1},U=!!(Qt!=null&&Qt.top),D=(H,Q)=>{for(const Et of ye){if(!Et.ref)continue;const Nt=J(Et.ref.split(":")[0]||Et.ref),It=Mt(Et.ref.split(":")[0]||Et.ref),$t=Et.ref.split(":")[1],xt=$t?J($t):Nt,zt=$t?Mt($t):It,Jt=Math.min(Nt,xt),_t=Math.max(Nt,xt),K=Math.min(It,zt),te=Math.max(It,zt);if(Q>=Jt&&Q<=_t&&H-1>=K&&H<=te)return!0}return!1},ft=!!((kr=P.borders)!=null&&kr.bottom),yt=X(s,b),Z=D(s,b);!U&&!ft&&!yt&&!Z&&(t.beginPath(),t.moveTo(f,i),t.lineTo(f+g,i),t.stroke());const rt=!!(Qt!=null&&Qt.left),V=!!((Or=ct.borders)!=null&&Or.right),q=Zt(s,b-1),St=Ft(s,b);!rt&&!V&&!q&&!St&&(t.beginPath(),t.moveTo(f,i),t.lineTo(f,i+M),t.stroke())}if(B.has(F)){const R=W[F];R&&(t.save(),t.fillStyle=R+"22",t.fillRect(f,i,g,M),t.restore(),t.strokeStyle=R,t.lineWidth=2,t.strokeRect(f,i,g,M))}if(m){const R=(()=>{if(dt){if(m.formula)return"= ".concat(m.formula);if(typeof m.sharedFormulaSi=="number"){const _t=Bt.get(m.sharedFormulaSi);if(_t)return"= ".concat($s(_t.base,_t.anchor,m.address))}}return Is(m,C)})(),P=m.paragraphs&&m.paragraphs.length>0?m.paragraphs:[{runs:[{text:R,citations:[]}]}],ct=(()=>{if(dt&&(m.formula||typeof m.sharedFormulaSi=="number"&&Bt.has(m.sharedFormulaSi)))return!1;const _t=Number(m.value);return m.dataType!==Fe.CELL_DATA_TYPE_STRING&&!Number.isNaN(_t)})(),X={anchor:(Br=_.verticalAlign)!=null?Br:Oe.ANCHOR_TYPE_BOTTOM,alignment:_.align==="center"?ee.ALIGNMENT_TYPE_CENTER:_.align==="right"?ee.ALIGNMENT_TYPE_RIGHT:_.align==="left"?ee.ALIGNMENT_TYPE_LEFT:ct?ee.ALIGNMENT_TYPE_RIGHT:ee.ALIGNMENT_TYPE_LEFT},Ft={paragraphs:P,textStyle:X,bbox:{xEmu:Math.round(f*9525),yEmu:Math.round(i*9525),widthEmu:Math.round(g*9525),heightEmu:Math.round(M*9525)},type:Ts.ELEMENT_TYPE_TEXT,levelsStyles:[]},U=(Hr=($r=$.styles)==null?void 0:$r.cellXfs)==null?void 0:Hr[(xr=it!=null?it:m==null?void 0:m.styleIndex)!=null?xr:0],D=U&&U.fontId!=null?(Yr=(Wr=$.styles)==null?void 0:Wr.fonts)==null?void 0:Yr[U.fontId]:void 0,ft=Ke.has(F),yt=He.has(F)||We.has(F);for(const _t of(Gr=Ft.paragraphs)!=null?Gr:[])for(const K of(zr=_t.runs)!=null?zr:[]){if(K.textStyle=(Ur=K.textStyle)!=null?Ur:{},typeof K.textStyle.fontSize=="number"&&K.textStyle.fontSize>0&&K.textStyle.fontSize<100&&(K.textStyle.fontSize=Math.round(K.textStyle.fontSize*100)),!(typeof K.textStyle.fontSize=="number"&&K.textStyle.fontSize>0)){const te=(Vr=_.font)==null?void 0:Vr.size,Me=typeof te=="number"&&te>0?te*72/96:11;K.textStyle.fontSize=Math.round(Me*100)}K.textStyle.bold==null&&((Kr=_.font)==null?void 0:Kr.bold)!=null&&(K.textStyle.bold=!!_.font.bold),(ft||yt)&&(K.textStyle.bold=!0),K.textStyle.italic==null&&((Xr=_.font)==null?void 0:Xr.italic)!=null&&(K.textStyle.italic=!!_.font.italic),K.textStyle.name==null&&(K.textStyle.name=gl((jr=D==null?void 0:D.name)!=null?jr:(Zr=_.font)==null?void 0:Zr.family)),K.textStyle.underline==null&&(D!=null&&D.underline)&&(K.textStyle.underline=D.underline),Ge?K.textStyle.fill={color:Ge,type:ze.FILL_TYPE_SOLID,gradientStops:[]}:!K.textStyle.fill&&gt?K.textStyle.fill={color:gt,type:ze.FILL_TYPE_SOLID,gradientStops:[]}:!K.textStyle.fill&&(D!=null&&D.fill)?K.textStyle.fill=D.fill:K.textStyle.fill||(K.textStyle.fill={color:{type:Ut.COLOR_TYPE_RGB,value:Vt,transform:void 0,lastColor:Vt},type:ze.FILL_TYPE_SOLID,gradientStops:[]})}typeof m.styleIndex=="number"&&!Xt.has(m.styleIndex)&&Xt.size<12&&Xt.add(m.styleIndex);const Z=Pt(s,b),V=((Qr=(qr=_.font)==null?void 0:qr.size)!=null?Qr:11*(96/72))*Ce,q=Math.max(2,Math.round((V||11)*.35)),St=Math.max(1,Math.round((V||11)*.25)),H=Ue(Ft,t,A,void 0,{resolvedStyle:X,bboxPx:{x:0,y:0,width:nt?Math.max(1,g):1e6,height:M},mode:"layout",textScale:Ce,wrap:nt}),Q=(os=(ns=(ts=(Jr=H==null?void 0:H.lines)==null?void 0:Jr[0])==null?void 0:ts.widthPx)!=null?ns:(es=Dt.textMetrics.get(Te(s,b)))==null?void 0:es.firstLineW)!=null?os:0;if(w&&at===Yt){const _t=((rs=H==null?void 0:H.height)!=null?rs:0)+St*2;_t>I&&(I=_t)}Dt.textMetrics.set(Te(s,b),{firstLineW:Q,padLr:q,padTb:St,isNumeric:ct});const Et=Math.max(0,g-(q+q)),Nt=!nt&&!ct&&Q>Et,It=Math.max(g,Q+(q+q)),$t=pt&&(me>Gt||Yt>at)?g:Z,xt=Nt?Math.min($t,It):g,zt=Nt?Cs(Ms({},X),{alignment:ee.ALIGNMENT_TYPE_LEFT}):X,Jt=()=>{t.save(),t.beginPath(),t.rect(f,i,xt,M),t.clip();const _t=nt||zt.alignment!==ee.ALIGNMENT_TYPE_LEFT?xt:Math.max(xt,Q+(q+q));Ue(Ft,t,A,void 0,{resolvedStyle:zt,bboxPx:{x:f,y:i,width:_t,height:M},textScale:Ce,wrap:nt}),t.restore()};O.push(()=>{Jt(),z&&(ot||E)&&(ge(t,ht,z),E&&(t.beginPath(),t.moveTo(f,i),t.lineTo(f+g,i+M),t.stroke()),ot&&(t.beginPath(),t.moveTo(f,i+M),t.lineTo(f+g,i),t.stroke()),t.restore())})}}if(ye.length>0)for(const b of ye){if(!b.ref)continue;const[f,g]=b.ref.split(":"),M=J(f!=null?f:"A1"),m=Mt(f!=null?f:"A1"),F=g?J(g):M,N=g?Mt(g):m,et=Math.max(Math.min(M,F),qt),it=Math.min(Math.max(M,F),le),_=Math.min(m,N),nt=Math.max(m,N);if(!(et>it)&&s>=_&&s<=nt){const z=ut+((ss=k[et])!=null?ss:0)-x,ot=ut+((ls=k[it+1])!=null?ls:0)-x,E=bt+((as=(is=G[s+1])!=null?is:G[s])!=null?as:0)-Y,ht=fe(b==null?void 0:b.dataDxfId)||"#cccccc";ge(t,"thin",ht),t.beginPath(),t.moveTo(z,E),t.lineTo(ot,E),t.stroke(),t.restore()}}for(const b of O)b();if(w){const b=p,f=Math.max(h,I);f>0&&Math.abs(f-b)>.5&&At.requestUpdate(s,f)}}yl(t,e,$,k,G,x,Y,c/S,u/S),ol(t,e,$,k,G,x,Y,c/S,u/S,A),t.textAlign="center",t.textBaseline="middle",t.font="12px sans-serif";for(let s=qt;s<=le;s++){const a=ut+((cs=k[s])!=null?cs:0)-x,i=(fs=n[s])!=null?fs:0;t.fillStyle=T,t.fillRect(a,0,i,bt),t.strokeStyle=lt,t.lineWidth=we,t.strokeRect(a,0,i,bt),t.fillStyle=wt,t.fillText(ae(s),a+i/2,bt/2)}for(let s=oe;s<=de;s++){const a=bt+((us=G[s])!=null?us:0)-Y,i=(ds=o[s])!=null?ds:0;i<=0||(t.fillStyle=T,t.fillRect(0,a,ut,i),t.strokeStyle=lt,t.lineWidth=we,t.strokeRect(0,a,ut,i),t.fillStyle=wt,t.fillText((s+1).toString(),ut/2,a+i/2))}t.fillStyle=T,t.fillRect(0,0,ut,bt),t.strokeStyle=lt,t.lineWidth=we,t.strokeRect(0,0,ut,bt);const Ye=ml({sheet:e,rowHeights:o,colWidths:n,rowIndexRemap:mt});if(Ye){const s=Ot,a=S||1,i=2/a;for(const p of Ye.colBoundaries){if(p<qt||p>=le)continue;const h=ut+((ms=k[p+1])!=null?ms:0)-x-i/2;h+i<0||h>c/a||(t.fillStyle=s,t.fillRect(h,0,i,bt))}for(const p of Ye.rowBoundaries){if(p<oe||p>=de)continue;const h=bt+((hs=G[p+1])!=null?hs:0)-Y-i/2;h+i<0||h>u/a||(t.fillStyle=s,t.fillRect(0,h,ut,i))}}t.restore()}export{bt as C,qs as F,ut as R,Qs as a,Bl as b,kl as c,$l as d,J as e,ae as f,Is as g,Ol as p,Mt as r};
//# sourceMappingURL=fmwvxydiodjqi0t8.js.map
