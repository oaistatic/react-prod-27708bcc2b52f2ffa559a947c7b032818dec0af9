var ge=Object.defineProperty,le=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var F=(i,e,a)=>e in i?ge(i,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[e]=a,d=(i,e)=>{for(var a in e||(e={}))U.call(e,a)&&F(i,a,e[a]);if(D)for(var a of D(e))Y.call(e,a)&&F(i,a,e[a]);return i},G=(i,e)=>le(i,de(e));var K=(i,e)=>{var a={};for(var s in i)U.call(i,s)&&e.indexOf(s)<0&&(a[s]=i[s]);if(i!=null&&D)for(var s of D(i))e.indexOf(s)<0&&Y.call(i,s)&&(a[s]=i[s]);return a};var p=(i,e,a)=>F(i,typeof e!="symbol"?e+"":e,a);import{r as u,e as z,j as n,M as C,a as re,f as ce}from"./fg33krlcm0qyi6yw.js";import{qj as w,fu as X,hw as me,iM as ue,l1 as Ie,eF as _e,g2 as V,dq as pe,l2 as fe,nf as he,gc as ve,ng as be,ge as we,qk as J,fY as je,Y as Se}from"./k65njl5wlgspihfr.js";import{bJ as ke,go as Ge,$ as m,P as g,R as Q,A as q,wc as Me,_ as Pe,g2 as M,gJ as Ee,c_ as O,T as R,l as x,e as Ae,hj as De,c0 as xe}from"./mtk1qztvnb31pw5r.js";import{I as Ne}from"./m3nchqrpfl8vs80b.js";function ze(i){return ke(i,"398474797").get("enabled",!1)}const Ze=u.createContext({model:"gpt-4o"}),W=()=>u.useContext(Ze);function Ue({pointer:i,conversationId:e,messageId:a,source:s,imageIndex:t}){var o,l,c,I,f,_,v;return{imageUrl:i&&"url"in i?i.url:void 0,conversationId:e,messageId:a,generationId:(c=(l=(o=i==null?void 0:i.metadata)==null?void 0:o.generation)==null?void 0:l.gen_id)!=null?c:void 0,parentGenerationId:(_=(f=(I=i==null?void 0:i.metadata)==null?void 0:I.generation)==null?void 0:f.parent_gen_id)!=null?_:void 0,fileId:Ge((v=i==null?void 0:i.asset_pointer)!=null?v:""),model:"gpt-4o",source:s,imageIndex:t}}class r{}p(r,"imageRated",({liked:e,analyticsContext:a})=>{const s=e?"like":"dislike",t=e?"true":"false";m.logEvent("chatgpt_dalle_image_rating",s,d({liked:t},a)),g.logEvent("chatgpt_dalle_image_rating",d({liked:e},a)),m.logEvent("chatgpt_image_rating",s,d({liked:t},a)),g.logEvent("chatgpt_image_rating",d({liked:e},a));var o="thumbs_down";e&&(o="thumbs_up"),a.conversationId&&a.messageId&&a.generationId&&(w("imagegen_rating",a.conversationId,a.messageId,a.generationId,{imagegen_rating:{rating:o}}),Q.safePost("/conversation/message_feedback",{requestBody:{message_id:a.messageId,conversation_id:a.conversationId,rating:e?"thumbsUp":"thumbsDown"},authOption:q.SendIfAvailable}))}),p(r,"imageShared",({analyticsContext:e,source:a})=>{const o=e,{source:s}=o,t=K(o,["source"]);g.logEventWithStatsig("Share Post: Share Button Clicked","chatgpt_post_share_button_clicked",G(d(d({},t),s?{imagegen_source:s}:{}),{source:a})),e.conversationId&&e.messageId&&e.generationId&&w("image_share",e.conversationId,e.messageId,e.generationId)}),p(r,"paragenImageRated",({liked:e,analyticsContext:a})=>{const s=e?"like":"dislike";m.logEvent("chatgpt_imagegen_image_paragen_rating",void 0,{liked:s,hasParent:a.parentGenerationId?"true":"false"}),g.logEvent("chatgpt_imagegen_image_paragen_rating",d({liked:e},a));var t="thumbs_down";e&&(t="thumbs_up"),a.conversationId&&a.messageId&&a.generationId&&w("imagegen_image_paragen_rating",a.conversationId,a.messageId,a.generationId,{imagegen_image_paragen_rating:{rating:t}})}),p(r,"paragenDownload",({analyticsContext:e})=>{m.logEvent("chatgpt_imagegen_image_paragen_download",void 0,{hasParent:e.parentGenerationId?"true":"false"}),g.logEvent("chatgpt_imagegen_image_paragen_download",e),e.conversationId&&e.messageId&&e.generationId&&w("imagegen_image_paragen_download",e.conversationId,e.messageId,e.generationId)}),p(r,"renderingComplete",({analyticsContext:e})=>{m.logEvent("chatgpt_imagegen_image_rendering_complete",void 0,{hasParent:e.parentGenerationId?"true":"false"}),g.logEvent("chatgpt_imagegen_image_rendering_complete",e)}),p(r,"editorClick",({sourceOperation:e,analyticsContext:a})=>{m.logEvent("chatgpt_dalle_image_view_full",null,d({sourceOperation:e},a)),g.logEvent("chatgpt_dalle_image_view_full",d({sourceOperation:e},a)),m.logEvent("chatgpt_image_view_full",null,d({sourceOperation:e},a)),g.logEvent("chatgpt_image_view_full",d({sourceOperation:e},a)),a.conversationId&&a.messageId&&a.generationId&&w("image_view_full",a.conversationId,a.messageId,a.generationId)}),p(r,"inpaintStarted",({analyticsContext:e})=>{m.logEvent("chatgpt_dalle_inpaint_click","click",e),g.logEvent("chatgpt_dalle_inpaint_click",e),m.logEvent("chatgpt_image_inpaint_click",void 0,e),g.logEvent("chatgpt_image_inpaint_click",e)}),p(r,"inpaintClick",({analyticsContext:e})=>{m.logEvent("chatgpt_imagegen_inpaint_click",null,e),g.logEvent("chatgpt_imagegen_inpaint_click",e)}),p(r,"zoom",({zoomType:e,analyticsContext:a})=>{m.logEvent(e==="in"?"chatgpt_image_view_full_zoom_in":"chatgpt_image_view_full_zoom_out",null,{hasParent:a.parentGenerationId?"true":"false"}),g.logEvent(e==="in"?"chatgpt_image_view_full_zoom_in":"chatgpt_image_view_full_zoom_out",G(d({},a),{startMs:performance.now()})),a.conversationId&&a.messageId&&a.generationId&&(e==="in"?w("image_view_full_zoom_in",a.conversationId,a.messageId,a.generationId):w("image_view_full_zoom_out",a.conversationId,a.messageId,a.generationId))}),p(r,"download",({analyticsContext:e})=>{m.logEvent("chatgpt_dalle_image_download","click",e),g.logEvent("chatgpt_dalle_image_download",e),m.logEvent("chatgpt_image_download",void 0,e),g.logEvent("chatgpt_image_download",e),e.conversationId&&e.messageId&&e.generationId&&w("image_download",e.conversationId,e.messageId,e.generationId)}),p(r,"generationSuccess",({analyticsContext:e,durationMs:a})=>{m.logEvent("chatgpt_imagegen_generation_success",a?Math.round(a):void 0),g.logEvent("chatgpt_imagegen_generation_success",G(d({},e),{duration_ms:a}))}),p(r,"generationFailure",({analyticsContext:e,errorReason:a})=>{const s=a?{errorReason:a}:void 0;m.logEvent("chatgpt_imagegen_generation_failure",void 0,s),g.logEvent("chatgpt_imagegen_generation_failure",G(d({},e),{errorReason:a}))});function Fe({messageId:i,serverThreadId:e,rating:a,onClose:s}){const t=z(),o=Object.entries(Me).map(([c,I])=>({label:t.formatMessage(I),value:c})),l=async c=>{var f;const I=o.map(_=>_.value);try{await Q.safePost("/conversation/message_feedback",{requestBody:{message_id:i,conversation_id:e,rating:"thumbsDown",text:(f=c.textFeedback)!=null?f:void 0,tags:c.tags.map(_=>_.value),tag_choices:I},authOption:q.SendIfAvailable})}catch(_){Pe.addError("Failed to submit ".concat(a," image generation feedback: ").concat(_))}s()};return n.jsx("div",{onClick:c=>c.stopPropagation(),children:n.jsx(Ne,{tagOptions:o,modalOnly:!0,multiple:!0,onSubmit:l})})}const Re=({onOpenChange:i,onDownload:e,triggerClassName:a,iconClassName:s,dropdownClassName:t})=>{const o=z(),l=u.useCallback(()=>{e==null||e()},[e]);return n.jsxs(M.Root,{onOpenChange:i,children:[n.jsx(M.Trigger,{"aria-label":o.formatMessage({id:"imagegen.watermark.dropdownName",defaultMessage:"More Download options"}),className:a,tabIndex:0,children:n.jsx(Ee,{style:{filter:"drop-shadow(0px 2px 4px rgba(0, 0, 0, 0.20))"},className:s})}),n.jsx(M.Portal,{children:n.jsx(M.Content,{className:t,side:"bottom",align:"end",children:n.jsx(M.Item,{className:"py-2",children:n.jsxs("button",{type:"button",onClick:l,className:"row text-token-text-primary flex items-center gap-2",children:[n.jsx(X,{}),n.jsxs("div",{className:"ms-2 flex flex-col items-start",children:[n.jsx("span",{className:"font-semibold",children:n.jsx(C,{id:"imagegen.watermark.dropdownLabel",defaultMessage:"Save image"})}),n.jsx("span",{className:"text-token-text-secondary",children:n.jsx(C,{id:"imagegen.watermark.dropdownSecondaryLabel",defaultMessage:"without watermark"})})]})]})})})})]})};function L({rightAlign:i=!1,bottomAlign:e=!1,fullWidth:a=!1,justifyBetween:s=!1,alwaysVisible:t=!1,children:o}){const l=u.useRef(null),c=O(),I=u.useRef(!1),f=W(),_=J()&&c,v=u.useCallback(()=>{_&&(I.current||(g.logEvent("Share Post: Share Button Shown",d({source:"image_gen_action_overlay"},f)),I.current=!0))},[f,_]),Z=u.useCallback(h=>{h.propertyName==="opacity"&&v()},[v]);return u.useEffect(()=>{t&&v()},[t,v]),n.jsxs("div",{ref:l,onTransitionEnd:Z,className:x("absolute z-2 transition-opacity duration-75 ease-out",t?"opacity-100":"opacity-0 group-hover/imagegen-image:opacity-100 group-focus/imagegen-image:opacity-100 focus-within:opacity-100",i?"end-0":"start-0",e?"bottom-0":"top-0",a&&"w-full"),children:[n.jsx("div",{className:x(e?"bg-linear-to-b":"bg-linear-to-t","from-transparent to-black/30","h-20 w-full")}),n.jsx("div",{className:x("absolute inset-0 flex p-1",e?"items-end":"items-start",i?"justify-end":"justify-start",s&&"justify-between"),children:o})]})}function P({icon:i,children:e,disabled:a,onClick:s,ariaLabel:t,selected:o=!1}){return n.jsxs("button",{"aria-pressed":o,className:x("hover:bg-white/15 hover:backdrop-blur-md focus:bg-white/15 focus:backdrop-blur-md","z-11 flex h-10 items-center justify-center gap-1 rounded-xl text-sm font-medium text-white",e==null?"w-10":"px-2"),onClick:s,disabled:a,"aria-label":t,children:[n.jsx(i,{style:{filter:"drop-shadow(0px 2px 4px rgba(0, 0, 0, 0.15))"},className:"icon fill-current"}),e]})}function N(i){return e=>{e.stopPropagation(),i()}}const Ye=({imageAssetPointer:i,imageUrl:e,fullSizeImageAsset:a,downloadFullImage:s=!1,messageId:t,clientThreadId:o,serverThreadId:l,shouldShowOverflow:c=!1,showRatingButtons:I=!0})=>{const f=Ae(),_=re(),v=!O(),Z=ze(f),h=z(),[y,B]=u.useState(!1),[b,$]=u.useState(null),S=W(),H=k=>{b==null&&(r.imageRated({liked:k,analyticsContext:S}),$(k),k||B(!0))},E=u.useCallback(()=>me(h),[h]),ee=ue(),A=Ie(),ae=(A==null?void 0:A.type)===_e.Image&&A.image.asset_pointer===i,[ie,ne]=u.useState(!1),se=u.useCallback(()=>{i&&(V({url:i,fileName:E()}),r.download({analyticsContext:S}))},[i,E,S]),te=u.useCallback(async()=>{if(!e)return;const k=E();let T=e;if(s&&a)try{T=(await pe.fetch(_,{asset:a,conversationId:l,isUnauthenticated:v})).url}catch(oe){}V({url:T,fileName:k}),r.download({analyticsContext:S})},[s,a,_,l,v,e,E,S]);return n.jsxs(n.Fragment,{children:[ee?!ae&&n.jsx(L,{rightAlign:!0,fullWidth:!0,children:n.jsx(P,{icon:fe,ariaLabel:h.formatMessage(j.expand)})}):n.jsx(n.Fragment,{children:n.jsx(L,{bottomAlign:!0,rightAlign:!0,fullWidth:!0,alwaysVisible:ie,children:n.jsxs("div",{className:"flex w-full items-center justify-between",children:[n.jsxs("div",{className:"flex",children:[I&&b!==!1&&n.jsx(R,{label:h.formatMessage({id:"U99PVw",defaultMessage:"Like"}),delayDuration:300,children:n.jsx(P,{icon:b===!0?he:ve,selected:b===!0,onClick:N(()=>H(!0)),ariaLabel:h.formatMessage(j.thumbsUp),disabled:b===!0})}),I&&b!==!0&&n.jsx(R,{label:h.formatMessage({id:"ncGqTt",defaultMessage:"Dislike"}),delayDuration:300,children:n.jsx(P,{icon:b===!1?be:we,selected:b===!1,onClick:N(()=>H(!1)),ariaLabel:h.formatMessage(j.thumbsDown),disabled:b===!1})}),e&&n.jsx(R,{label:h.formatMessage(s?j.downloadTooltipFullSize:j.downloadTooltip),children:n.jsx(P,{icon:X,ariaLabel:h.formatMessage(s?j.downloadFullSize:j.download),onClick:N(()=>{te()})})}),Z&&c&&n.jsx(Re,{onOpenChange:ne,onDownload:se,triggerClassName:"z-11 flex h-10 w-10 items-center justify-center rounded-xl bg-transparent hover:bg-token-icon-surface/10 focus:bg-token-icon-surface/10 focus-visible:bg-token-icon-surface/10",iconClassName:"icon-lg fill-transparent text-white",dropdownClassName:"z-11 min-w-fit origin-top-end text-token-text-primary"})]}),n.jsx("div",{className:"flex",children:n.jsx(Ce,{clientThreadId:o,messageId:t})})]})})}),y&&n.jsx(Fe,{messageId:t,serverThreadId:l!=null?l:"",rating:b,onClose:()=>B(!1)})]})};function Ce({clientThreadId:i,messageId:e}){"use no forget";const[a,s]=u.useState(!1),t=z(),o=O(),l=J()&&o,c=De(),I=je({clientThreadId:i,imageGenMessageId:e}),f=W();return!l||c?null:n.jsx(P,{icon:a?xe:Se,disabled:a,onClick:N(async()=>{s(!0);try{await I()}finally{s(!1)}r.imageShared({analyticsContext:f,source:"image_gen_action_overlay"})}),ariaLabel:t.formatMessage(j.share),children:n.jsx(C,{id:"imageGenActionOverlay.shareButton",defaultMessage:"Share"})})}const j=ce({thumbsUp:{id:"imageGenActionOverlay.thumbsUp",defaultMessage:"Like this image"},thumbsDown:{id:"imageGenActionOverlay.thumbsDown",defaultMessage:"Dislike this image"},inpaint:{id:"imageGenActionOverlay.inpaint",defaultMessage:"Enter inpainting mode"},download:{id:"imageGenActionOverlay.download",defaultMessage:"Download this image"},downloadFullSize:{id:"imageGenActionOverlay.downloadFullSize",defaultMessage:"Download full size image"},downloadTooltip:{id:"0EYire",defaultMessage:"Download"},downloadTooltipFullSize:{id:"imageGenActionOverlay.downloadTooltipFullSize",defaultMessage:"Download full size"},expand:{id:"imageGenActionOverlay.expand",defaultMessage:"Expand this image"},share:{id:"imageGenActionOverlay.share",defaultMessage:"Share this image"}}),Ke="data:image/svg+xml;base64,PHN2ZwogIHdpZHRoPSIzNiIKICBoZWlnaHQ9IjM2IgogIHZpZXdCb3g9IjAgMCAzNiAzNiIKICBmaWxsPSJub25lIgogIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKPgogIDxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF80NjY1XzIzMzApIj4KICAgIDxyZWN0IHdpZHRoPSIzNiIgaGVpZ2h0PSIzNiIgZmlsbD0id2hpdGUiIC8+CiAgICA8cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiMxRTFFMUUiIC8+CiAgICA8cmVjdCB4PSIxOCIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiBmaWxsPSJibGFjayIgLz4KICAgIDxyZWN0IHg9IjE4IiB5PSIxOCIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiBmaWxsPSIjMUUxRTFFIiAvPgogICAgPHJlY3QgeT0iMTgiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbD0iYmxhY2siIC8+CiAgPC9nPgogIDxkZWZzPgogICAgPGNsaXBQYXRoIGlkPSJjbGlwMF80NjY1XzIzMzAiPgogICAgICA8cmVjdCB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIiAvPgogICAgPC9jbGlwUGF0aD4KICA8L2RlZnM+Cjwvc3ZnPgo=",Ve="data:image/svg+xml;base64,PHN2ZwogIHdpZHRoPSIzNiIKICBoZWlnaHQ9IjM2IgogIHZpZXdCb3g9IjAgMCAzNiAzNiIKICBmaWxsPSJub25lIgogIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKPgogIDxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF80NjY1XzIzMTkpIj4KICAgIDxyZWN0IHdpZHRoPSIzNiIgaGVpZ2h0PSIzNiIgZmlsbD0id2hpdGUiIC8+CiAgICA8cmVjdCB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIGZpbGw9IiNFRkVGRjAiIC8+CiAgICA8cmVjdCB4PSIxOCIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiBmaWxsPSJ3aGl0ZSIgLz4KICAgIDxyZWN0IHg9IjE4IiB5PSIxOCIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiBmaWxsPSIjRUZFRkYwIiAvPgogICAgPHJlY3QgeT0iMTgiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbD0id2hpdGUiIC8+CiAgPC9nPgogIDxkZWZzPgogICAgPGNsaXBQYXRoIGlkPSJjbGlwMF80NjY1XzIzMTkiPgogICAgICA8cmVjdCB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIiAvPgogICAgPC9jbGlwUGF0aD4KICA8L2RlZnM+Cjwvc3ZnPgo=";export{Ke as D,Ye as I,Ve as L,Fe as a,r as b,Ue as c,Ze as d,ze as i,W as u};
//# sourceMappingURL=engbryqfkwtfab1c.js.map
